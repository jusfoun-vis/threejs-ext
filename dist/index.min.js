/*!
 * The three.js expansion library v0.92.0
 * Collected by Jusfoun Visualization Department
 * Contact: 
 *   vis@jusfoun.com
 *   http://vis.jusfoun.com
 *   http://jusfoun-vis.github.io
 * 
 * Copyright (c) 2018, Jusfoun Big Data Group Inc.
 * All rights reserved.
 * 
 * LICENSE
 * http://www.jusfoun.com/software/LICENSE.txt
 * 
 * The three.js LICENSE
 * http://threejs.org/license
 */
!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=27)}([function(e,t){e.exports=require("three")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(a.prototype,{setSize:function(e,t){},render:function(e,t,r,a,n){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=r(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(e,t){o.default.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof n.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=n.UniformsUtils.clone(e.uniforms),this.material=new n.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.camera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new n.Scene,this.quad=new n.Mesh(new n.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};s.prototype=Object.assign(Object.create(o.default.prototype),{constructor:s,render:function(e,t,r,a,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}),t.default=s},function(e,t,r){!function(e,r){r(t)}(0,function(e){"use strict";function t(){}function r(e,r){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===r||r,this.encoder=new t}function a(){}function n(){}t.prototype.s2u=function(e){for(var t=this.s2uTable,r="",a=0;a<e.length;){var n=e[a++];if(!(n>=0&&n<=126||n>=161&&n<=223)&&a<e.length&&(n=n<<8|e[a++]),void 0===t[n])throw"unknown char code "+n+".";r+=String.fromCharCode(t[n])}return r},t.prototype.s2uTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:65340,33120:65374,33121:8741,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:65293,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:65504,33170:65505,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:65506,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34624:9312,34625:9313,34626:9314,34627:9315,34628:9316,34629:9317,34630:9318,34631:9319,34632:9320,34633:9321,34634:9322,34635:9323,34636:9324,34637:9325,34638:9326,34639:9327,34640:9328,34641:9329,34642:9330,34643:9331,34644:8544,34645:8545,34646:8546,34647:8547,34648:8548,34649:8549,34650:8550,34651:8551,34652:8552,34653:8553,34655:13129,34656:13076,34657:13090,34658:13133,34659:13080,34660:13095,34661:13059,34662:13110,34663:13137,34664:13143,34665:13069,34666:13094,34667:13091,34668:13099,34669:13130,34670:13115,34671:13212,34672:13213,34673:13214,34674:13198,34675:13199,34676:13252,34677:13217,34686:13179,34688:12317,34689:12319,34690:8470,34691:13261,34692:8481,34693:12964,34694:12965,34695:12966,34696:12967,34697:12968,34698:12849,34699:12850,34700:12857,34701:13182,34702:13181,34703:13180,34704:8786,34705:8801,34706:8747,34707:8750,34708:8721,34709:8730,34710:8869,34711:8736,34712:8735,34713:8895,34714:8757,34715:8745,34716:8746,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081,60736:32394,60737:35100,60738:37704,60739:37512,60740:34012,60741:20425,60742:28859,60743:26161,60744:26824,60745:37625,60746:26363,60747:24389,60748:20008,60749:20193,60750:20220,60751:20224,60752:20227,60753:20281,60754:20310,60755:20370,60756:20362,60757:20378,60758:20372,60759:20429,60760:20544,60761:20514,60762:20479,60763:20510,60764:20550,60765:20592,60766:20546,60767:20628,60768:20724,60769:20696,60770:20810,60771:20836,60772:20893,60773:20926,60774:20972,60775:21013,60776:21148,60777:21158,60778:21184,60779:21211,60780:21248,60781:21255,60782:21284,60783:21362,60784:21395,60785:21426,60786:21469,60787:64014,60788:21660,60789:21642,60790:21673,60791:21759,60792:21894,60793:22361,60794:22373,60795:22444,60796:22472,60797:22471,60798:64015,60800:64016,60801:22686,60802:22706,60803:22795,60804:22867,60805:22875,60806:22877,60807:22883,60808:22948,60809:22970,60810:23382,60811:23488,60812:29999,60813:23512,60814:23532,60815:23582,60816:23718,60817:23738,60818:23797,60819:23847,60820:23891,60821:64017,60822:23874,60823:23917,60824:23992,60825:23993,60826:24016,60827:24353,60828:24372,60829:24423,60830:24503,60831:24542,60832:24669,60833:24709,60834:24714,60835:24798,60836:24789,60837:24864,60838:24818,60839:24849,60840:24887,60841:24880,60842:24984,60843:25107,60844:25254,60845:25589,60846:25696,60847:25757,60848:25806,60849:25934,60850:26112,60851:26133,60852:26171,60853:26121,60854:26158,60855:26142,60856:26148,60857:26213,60858:26199,60859:26201,60860:64018,60861:26227,60862:26265,60863:26272,60864:26290,60865:26303,60866:26362,60867:26382,60868:63785,60869:26470,60870:26555,60871:26706,60872:26560,60873:26625,60874:26692,60875:26831,60876:64019,60877:26984,60878:64020,60879:27032,60880:27106,60881:27184,60882:27243,60883:27206,60884:27251,60885:27262,60886:27362,60887:27364,60888:27606,60889:27711,60890:27740,60891:27782,60892:27759,60893:27866,60894:27908,60895:28039,60896:28015,60897:28054,60898:28076,60899:28111,60900:28152,60901:28146,60902:28156,60903:28217,60904:28252,60905:28199,60906:28220,60907:28351,60908:28552,60909:28597,60910:28661,60911:28677,60912:28679,60913:28712,60914:28805,60915:28843,60916:28943,60917:28932,60918:29020,60919:28998,60920:28999,60921:64021,60922:29121,60923:29182,60924:29361,60992:29374,60993:29476,60994:64022,60995:29559,60996:29629,60997:29641,60998:29654,60999:29667,61e3:29650,61001:29703,61002:29685,61003:29734,61004:29738,61005:29737,61006:29742,61007:29794,61008:29833,61009:29855,61010:29953,61011:30063,61012:30338,61013:30364,61014:30366,61015:30363,61016:30374,61017:64023,61018:30534,61019:21167,61020:30753,61021:30798,61022:30820,61023:30842,61024:31024,61025:64024,61026:64025,61027:64026,61028:31124,61029:64027,61030:31131,61031:31441,61032:31463,61033:64028,61034:31467,61035:31646,61036:64029,61037:32072,61038:32092,61039:32183,61040:32160,61041:32214,61042:32338,61043:32583,61044:32673,61045:64030,61046:33537,61047:33634,61048:33663,61049:33735,61050:33782,61051:33864,61052:33972,61053:34131,61054:34137,61056:34155,61057:64031,61058:34224,61059:64032,61060:64033,61061:34823,61062:35061,61063:35346,61064:35383,61065:35449,61066:35495,61067:35518,61068:35551,61069:64034,61070:35574,61071:35667,61072:35711,61073:36080,61074:36084,61075:36114,61076:36214,61077:64035,61078:36559,61079:64036,61080:64037,61081:36967,61082:37086,61083:64038,61084:37141,61085:37159,61086:37338,61087:37335,61088:37342,61089:37357,61090:37358,61091:37348,61092:37349,61093:37382,61094:37392,61095:37386,61096:37434,61097:37440,61098:37436,61099:37454,61100:37465,61101:37457,61102:37433,61103:37479,61104:37543,61105:37495,61106:37496,61107:37607,61108:37591,61109:37593,61110:37584,61111:64039,61112:37589,61113:37600,61114:37587,61115:37669,61116:37665,61117:37627,61118:64040,61119:37662,61120:37631,61121:37661,61122:37634,61123:37744,61124:37719,61125:37796,61126:37830,61127:37854,61128:37880,61129:37937,61130:37957,61131:37960,61132:38290,61133:63964,61134:64041,61135:38557,61136:38575,61137:38707,61138:38715,61139:38723,61140:38733,61141:38735,61142:38737,61143:38741,61144:38999,61145:39013,61146:64042,61147:64043,61148:39207,61149:64044,61150:39326,61151:39502,61152:39641,61153:39644,61154:39797,61155:39794,61156:39823,61157:39857,61158:39867,61159:39936,61160:40304,61161:40299,61162:64045,61163:40473,61164:40657,61167:8560,61168:8561,61169:8562,61170:8563,61171:8564,61172:8565,61173:8566,61174:8567,61175:8568,61176:8569,61177:65506,61178:65508,61179:65287,61180:65282,61504:57344,61505:57345,61506:57346,61507:57347,61508:57348,61509:57349,61510:57350,61511:57351,61512:57352,61513:57353,61514:57354,61515:57355,61516:57356,61517:57357,61518:57358,61519:57359,61520:57360,61521:57361,61522:57362,61523:57363,61524:57364,61525:57365,61526:57366,61527:57367,61528:57368,61529:57369,61530:57370,61531:57371,61532:57372,61533:57373,61534:57374,61535:57375,61536:57376,61537:57377,61538:57378,61539:57379,61540:57380,61541:57381,61542:57382,61543:57383,61544:57384,61545:57385,61546:57386,61547:57387,61548:57388,61549:57389,61550:57390,61551:57391,61552:57392,61553:57393,61554:57394,61555:57395,61556:57396,61557:57397,61558:57398,61559:57399,61560:57400,61561:57401,61562:57402,61563:57403,61564:57404,61565:57405,61566:57406,61568:57407,61569:57408,61570:57409,61571:57410,61572:57411,61573:57412,61574:57413,61575:57414,61576:57415,61577:57416,61578:57417,61579:57418,61580:57419,61581:57420,61582:57421,61583:57422,61584:57423,61585:57424,61586:57425,61587:57426,61588:57427,61589:57428,61590:57429,61591:57430,61592:57431,61593:57432,61594:57433,61595:57434,61596:57435,61597:57436,61598:57437,61599:57438,61600:57439,61601:57440,61602:57441,61603:57442,61604:57443,61605:57444,61606:57445,61607:57446,61608:57447,61609:57448,61610:57449,61611:57450,61612:57451,61613:57452,61614:57453,61615:57454,61616:57455,61617:57456,61618:57457,61619:57458,61620:57459,61621:57460,61622:57461,61623:57462,61624:57463,61625:57464,61626:57465,61627:57466,61628:57467,61629:57468,61630:57469,61631:57470,61632:57471,61633:57472,61634:57473,61635:57474,61636:57475,61637:57476,61638:57477,61639:57478,61640:57479,61641:57480,61642:57481,61643:57482,61644:57483,61645:57484,61646:57485,61647:57486,61648:57487,61649:57488,61650:57489,61651:57490,61652:57491,61653:57492,61654:57493,61655:57494,61656:57495,61657:57496,61658:57497,61659:57498,61660:57499,61661:57500,61662:57501,61663:57502,61664:57503,61665:57504,61666:57505,61667:57506,61668:57507,61669:57508,61670:57509,61671:57510,61672:57511,61673:57512,61674:57513,61675:57514,61676:57515,61677:57516,61678:57517,61679:57518,61680:57519,61681:57520,61682:57521,61683:57522,61684:57523,61685:57524,61686:57525,61687:57526,61688:57527,61689:57528,61690:57529,61691:57530,61692:57531,61760:57532,61761:57533,61762:57534,61763:57535,61764:57536,61765:57537,61766:57538,61767:57539,61768:57540,61769:57541,61770:57542,61771:57543,61772:57544,61773:57545,61774:57546,61775:57547,61776:57548,61777:57549,61778:57550,61779:57551,61780:57552,61781:57553,61782:57554,61783:57555,61784:57556,61785:57557,61786:57558,61787:57559,61788:57560,61789:57561,61790:57562,61791:57563,61792:57564,61793:57565,61794:57566,61795:57567,61796:57568,61797:57569,61798:57570,61799:57571,61800:57572,61801:57573,61802:57574,61803:57575,61804:57576,61805:57577,61806:57578,61807:57579,61808:57580,61809:57581,61810:57582,61811:57583,61812:57584,61813:57585,61814:57586,61815:57587,61816:57588,61817:57589,61818:57590,61819:57591,61820:57592,61821:57593,61822:57594,61824:57595,61825:57596,61826:57597,61827:57598,61828:57599,61829:57600,61830:57601,61831:57602,61832:57603,61833:57604,61834:57605,61835:57606,61836:57607,61837:57608,61838:57609,61839:57610,61840:57611,61841:57612,61842:57613,61843:57614,61844:57615,61845:57616,61846:57617,61847:57618,61848:57619,61849:57620,61850:57621,61851:57622,61852:57623,61853:57624,61854:57625,61855:57626,61856:57627,61857:57628,61858:57629,61859:57630,61860:57631,61861:57632,61862:57633,61863:57634,61864:57635,61865:57636,61866:57637,61867:57638,61868:57639,61869:57640,61870:57641,61871:57642,61872:57643,61873:57644,61874:57645,61875:57646,61876:57647,61877:57648,61878:57649,61879:57650,61880:57651,61881:57652,61882:57653,61883:57654,61884:57655,61885:57656,61886:57657,61887:57658,61888:57659,61889:57660,61890:57661,61891:57662,61892:57663,61893:57664,61894:57665,61895:57666,61896:57667,61897:57668,61898:57669,61899:57670,61900:57671,61901:57672,61902:57673,61903:57674,61904:57675,61905:57676,61906:57677,61907:57678,61908:57679,61909:57680,61910:57681,61911:57682,61912:57683,61913:57684,61914:57685,61915:57686,61916:57687,61917:57688,61918:57689,61919:57690,61920:57691,61921:57692,61922:57693,61923:57694,61924:57695,61925:57696,61926:57697,61927:57698,61928:57699,61929:57700,61930:57701,61931:57702,61932:57703,61933:57704,61934:57705,61935:57706,61936:57707,61937:57708,61938:57709,61939:57710,61940:57711,61941:57712,61942:57713,61943:57714,61944:57715,61945:57716,61946:57717,61947:57718,61948:57719,62016:57720,62017:57721,62018:57722,62019:57723,62020:57724,62021:57725,62022:57726,62023:57727,62024:57728,62025:57729,62026:57730,62027:57731,62028:57732,62029:57733,62030:57734,62031:57735,62032:57736,62033:57737,62034:57738,62035:57739,62036:57740,62037:57741,62038:57742,62039:57743,62040:57744,62041:57745,62042:57746,62043:57747,62044:57748,62045:57749,62046:57750,62047:57751,62048:57752,62049:57753,62050:57754,62051:57755,62052:57756,62053:57757,62054:57758,62055:57759,62056:57760,62057:57761,62058:57762,62059:57763,62060:57764,62061:57765,62062:57766,62063:57767,62064:57768,62065:57769,62066:57770,62067:57771,62068:57772,62069:57773,62070:57774,62071:57775,62072:57776,62073:57777,62074:57778,62075:57779,62076:57780,62077:57781,62078:57782,62080:57783,62081:57784,62082:57785,62083:57786,62084:57787,62085:57788,62086:57789,62087:57790,62088:57791,62089:57792,62090:57793,62091:57794,62092:57795,62093:57796,62094:57797,62095:57798,62096:57799,62097:57800,62098:57801,62099:57802,62100:57803,62101:57804,62102:57805,62103:57806,62104:57807,62105:57808,62106:57809,62107:57810,62108:57811,62109:57812,62110:57813,62111:57814,62112:57815,62113:57816,62114:57817,62115:57818,62116:57819,62117:57820,62118:57821,62119:57822,62120:57823,62121:57824,62122:57825,62123:57826,62124:57827,62125:57828,62126:57829,62127:57830,62128:57831,62129:57832,62130:57833,62131:57834,62132:57835,62133:57836,62134:57837,62135:57838,62136:57839,62137:57840,62138:57841,62139:57842,62140:57843,62141:57844,62142:57845,62143:57846,62144:57847,62145:57848,62146:57849,62147:57850,62148:57851,62149:57852,62150:57853,62151:57854,62152:57855,62153:57856,62154:57857,62155:57858,62156:57859,62157:57860,62158:57861,62159:57862,62160:57863,62161:57864,62162:57865,62163:57866,62164:57867,62165:57868,62166:57869,62167:57870,62168:57871,62169:57872,62170:57873,62171:57874,62172:57875,62173:57876,62174:57877,62175:57878,62176:57879,62177:57880,62178:57881,62179:57882,62180:57883,62181:57884,62182:57885,62183:57886,62184:57887,62185:57888,62186:57889,62187:57890,62188:57891,62189:57892,62190:57893,62191:57894,62192:57895,62193:57896,62194:57897,62195:57898,62196:57899,62197:57900,62198:57901,62199:57902,62200:57903,62201:57904,62202:57905,62203:57906,62204:57907,62272:57908,62273:57909,62274:57910,62275:57911,62276:57912,62277:57913,62278:57914,62279:57915,62280:57916,62281:57917,62282:57918,62283:57919,62284:57920,62285:57921,62286:57922,62287:57923,62288:57924,62289:57925,62290:57926,62291:57927,62292:57928,62293:57929,62294:57930,62295:57931,62296:57932,62297:57933,62298:57934,62299:57935,62300:57936,62301:57937,62302:57938,62303:57939,62304:57940,62305:57941,62306:57942,62307:57943,62308:57944,62309:57945,62310:57946,62311:57947,62312:57948,62313:57949,62314:57950,62315:57951,62316:57952,62317:57953,62318:57954,62319:57955,62320:57956,62321:57957,62322:57958,62323:57959,62324:57960,62325:57961,62326:57962,62327:57963,62328:57964,62329:57965,62330:57966,62331:57967,62332:57968,62333:57969,62334:57970,62336:57971,62337:57972,62338:57973,62339:57974,62340:57975,62341:57976,62342:57977,62343:57978,62344:57979,62345:57980,62346:57981,62347:57982,62348:57983,62349:57984,62350:57985,62351:57986,62352:57987,62353:57988,62354:57989,62355:57990,62356:57991,62357:57992,62358:57993,62359:57994,62360:57995,62361:57996,62362:57997,62363:57998,62364:57999,62365:58e3,62366:58001,62367:58002,62368:58003,62369:58004,62370:58005,62371:58006,62372:58007,62373:58008,62374:58009,62375:58010,62376:58011,62377:58012,62378:58013,62379:58014,62380:58015,62381:58016,62382:58017,62383:58018,62384:58019,62385:58020,62386:58021,62387:58022,62388:58023,62389:58024,62390:58025,62391:58026,62392:58027,62393:58028,62394:58029,62395:58030,62396:58031,62397:58032,62398:58033,62399:58034,62400:58035,62401:58036,62402:58037,62403:58038,62404:58039,62405:58040,62406:58041,62407:58042,62408:58043,62409:58044,62410:58045,62411:58046,62412:58047,62413:58048,62414:58049,62415:58050,62416:58051,62417:58052,62418:58053,62419:58054,62420:58055,62421:58056,62422:58057,62423:58058,62424:58059,62425:58060,62426:58061,62427:58062,62428:58063,62429:58064,62430:58065,62431:58066,62432:58067,62433:58068,62434:58069,62435:58070,62436:58071,62437:58072,62438:58073,62439:58074,62440:58075,62441:58076,62442:58077,62443:58078,62444:58079,62445:58080,62446:58081,62447:58082,62448:58083,62449:58084,62450:58085,62451:58086,62452:58087,62453:58088,62454:58089,62455:58090,62456:58091,62457:58092,62458:58093,62459:58094,62460:58095,62528:58096,62529:58097,62530:58098,62531:58099,62532:58100,62533:58101,62534:58102,62535:58103,62536:58104,62537:58105,62538:58106,62539:58107,62540:58108,62541:58109,62542:58110,62543:58111,62544:58112,62545:58113,62546:58114,62547:58115,62548:58116,62549:58117,62550:58118,62551:58119,62552:58120,62553:58121,62554:58122,62555:58123,62556:58124,62557:58125,62558:58126,62559:58127,62560:58128,62561:58129,62562:58130,62563:58131,62564:58132,62565:58133,62566:58134,62567:58135,62568:58136,62569:58137,62570:58138,62571:58139,62572:58140,62573:58141,62574:58142,62575:58143,62576:58144,62577:58145,62578:58146,62579:58147,62580:58148,62581:58149,62582:58150,62583:58151,62584:58152,62585:58153,62586:58154,62587:58155,62588:58156,62589:58157,62590:58158,62592:58159,62593:58160,62594:58161,62595:58162,62596:58163,62597:58164,62598:58165,62599:58166,62600:58167,62601:58168,62602:58169,62603:58170,62604:58171,62605:58172,62606:58173,62607:58174,62608:58175,62609:58176,62610:58177,62611:58178,62612:58179,62613:58180,62614:58181,62615:58182,62616:58183,62617:58184,62618:58185,62619:58186,62620:58187,62621:58188,62622:58189,62623:58190,62624:58191,62625:58192,62626:58193,62627:58194,62628:58195,62629:58196,62630:58197,62631:58198,62632:58199,62633:58200,62634:58201,62635:58202,62636:58203,62637:58204,62638:58205,62639:58206,62640:58207,62641:58208,62642:58209,62643:58210,62644:58211,62645:58212,62646:58213,62647:58214,62648:58215,62649:58216,62650:58217,62651:58218,62652:58219,62653:58220,62654:58221,62655:58222,62656:58223,62657:58224,62658:58225,62659:58226,62660:58227,62661:58228,62662:58229,62663:58230,62664:58231,62665:58232,62666:58233,62667:58234,62668:58235,62669:58236,62670:58237,62671:58238,62672:58239,62673:58240,62674:58241,62675:58242,62676:58243,62677:58244,62678:58245,62679:58246,62680:58247,62681:58248,62682:58249,62683:58250,62684:58251,62685:58252,62686:58253,62687:58254,62688:58255,62689:58256,62690:58257,62691:58258,62692:58259,62693:58260,62694:58261,62695:58262,62696:58263,62697:58264,62698:58265,62699:58266,62700:58267,62701:58268,62702:58269,62703:58270,62704:58271,62705:58272,62706:58273,62707:58274,62708:58275,62709:58276,62710:58277,62711:58278,62712:58279,62713:58280,62714:58281,62715:58282,62716:58283,62784:58284,62785:58285,62786:58286,62787:58287,62788:58288,62789:58289,62790:58290,62791:58291,62792:58292,62793:58293,62794:58294,62795:58295,62796:58296,62797:58297,62798:58298,62799:58299,62800:58300,62801:58301,62802:58302,62803:58303,62804:58304,62805:58305,62806:58306,62807:58307,62808:58308,62809:58309,62810:58310,62811:58311,62812:58312,62813:58313,62814:58314,62815:58315,62816:58316,62817:58317,62818:58318,62819:58319,62820:58320,62821:58321,62822:58322,62823:58323,62824:58324,62825:58325,62826:58326,62827:58327,62828:58328,62829:58329,62830:58330,62831:58331,62832:58332,62833:58333,62834:58334,62835:58335,62836:58336,62837:58337,62838:58338,62839:58339,62840:58340,62841:58341,62842:58342,62843:58343,62844:58344,62845:58345,62846:58346,62848:58347,62849:58348,62850:58349,62851:58350,62852:58351,62853:58352,62854:58353,62855:58354,62856:58355,62857:58356,62858:58357,62859:58358,62860:58359,62861:58360,62862:58361,62863:58362,62864:58363,62865:58364,62866:58365,62867:58366,62868:58367,62869:58368,62870:58369,62871:58370,62872:58371,62873:58372,62874:58373,62875:58374,62876:58375,62877:58376,62878:58377,62879:58378,62880:58379,62881:58380,62882:58381,62883:58382,62884:58383,62885:58384,62886:58385,62887:58386,62888:58387,62889:58388,62890:58389,62891:58390,62892:58391,62893:58392,62894:58393,62895:58394,62896:58395,62897:58396,62898:58397,62899:58398,62900:58399,62901:58400,62902:58401,62903:58402,62904:58403,62905:58404,62906:58405,62907:58406,62908:58407,62909:58408,62910:58409,62911:58410,62912:58411,62913:58412,62914:58413,62915:58414,62916:58415,62917:58416,62918:58417,62919:58418,62920:58419,62921:58420,62922:58421,62923:58422,62924:58423,62925:58424,62926:58425,62927:58426,62928:58427,62929:58428,62930:58429,62931:58430,62932:58431,62933:58432,62934:58433,62935:58434,62936:58435,62937:58436,62938:58437,62939:58438,62940:58439,62941:58440,62942:58441,62943:58442,62944:58443,62945:58444,62946:58445,62947:58446,62948:58447,62949:58448,62950:58449,62951:58450,62952:58451,62953:58452,62954:58453,62955:58454,62956:58455,62957:58456,62958:58457,62959:58458,62960:58459,62961:58460,62962:58461,62963:58462,62964:58463,62965:58464,62966:58465,62967:58466,62968:58467,62969:58468,62970:58469,62971:58470,62972:58471,63040:58472,63041:58473,63042:58474,63043:58475,63044:58476,63045:58477,63046:58478,63047:58479,63048:58480,63049:58481,63050:58482,63051:58483,63052:58484,63053:58485,63054:58486,63055:58487,63056:58488,63057:58489,63058:58490,63059:58491,63060:58492,63061:58493,63062:58494,63063:58495,63064:58496,63065:58497,63066:58498,63067:58499,63068:58500,63069:58501,63070:58502,63071:58503,63072:58504,63073:58505,63074:58506,63075:58507,63076:58508,63077:58509,63078:58510,63079:58511,63080:58512,63081:58513,63082:58514,63083:58515,63084:58516,63085:58517,63086:58518,63087:58519,63088:58520,63089:58521,63090:58522,63091:58523,63092:58524,63093:58525,63094:58526,63095:58527,63096:58528,63097:58529,63098:58530,63099:58531,63100:58532,63101:58533,63102:58534,63104:58535,63105:58536,63106:58537,63107:58538,63108:58539,63109:58540,63110:58541,63111:58542,63112:58543,63113:58544,63114:58545,63115:58546,63116:58547,63117:58548,63118:58549,63119:58550,63120:58551,63121:58552,63122:58553,63123:58554,63124:58555,63125:58556,63126:58557,63127:58558,63128:58559,63129:58560,63130:58561,63131:58562,63132:58563,63133:58564,63134:58565,63135:58566,63136:58567,63137:58568,63138:58569,63139:58570,63140:58571,63141:58572,63142:58573,63143:58574,63144:58575,63145:58576,63146:58577,63147:58578,63148:58579,63149:58580,63150:58581,63151:58582,63152:58583,63153:58584,63154:58585,63155:58586,63156:58587,63157:58588,63158:58589,63159:58590,63160:58591,63161:58592,63162:58593,63163:58594,63164:58595,63165:58596,63166:58597,63167:58598,63168:58599,63169:58600,63170:58601,63171:58602,63172:58603,63173:58604,63174:58605,63175:58606,63176:58607,63177:58608,63178:58609,63179:58610,63180:58611,63181:58612,63182:58613,63183:58614,63184:58615,63185:58616,63186:58617,63187:58618,63188:58619,63189:58620,63190:58621,63191:58622,63192:58623,63193:58624,63194:58625,63195:58626,63196:58627,63197:58628,63198:58629,63199:58630,63200:58631,63201:58632,63202:58633,63203:58634,63204:58635,63205:58636,63206:58637,63207:58638,63208:58639,63209:58640,63210:58641,63211:58642,63212:58643,63213:58644,63214:58645,63215:58646,63216:58647,63217:58648,63218:58649,63219:58650,63220:58651,63221:58652,63222:58653,63223:58654,63224:58655,63225:58656,63226:58657,63227:58658,63228:58659,63296:58660,63297:58661,63298:58662,63299:58663,63300:58664,63301:58665,63302:58666,63303:58667,63304:58668,63305:58669,63306:58670,63307:58671,63308:58672,63309:58673,63310:58674,63311:58675,63312:58676,63313:58677,63314:58678,63315:58679,63316:58680,63317:58681,63318:58682,63319:58683,63320:58684,63321:58685,63322:58686,63323:58687,63324:58688,63325:58689,63326:58690,63327:58691,63328:58692,63329:58693,63330:58694,63331:58695,63332:58696,63333:58697,63334:58698,63335:58699,63336:58700,63337:58701,63338:58702,63339:58703,63340:58704,63341:58705,63342:58706,63343:58707,63344:58708,63345:58709,63346:58710,63347:58711,63348:58712,63349:58713,63350:58714,63351:58715,63352:58716,63353:58717,63354:58718,63355:58719,63356:58720,63357:58721,63358:58722,63360:58723,63361:58724,63362:58725,63363:58726,63364:58727,63365:58728,63366:58729,63367:58730,63368:58731,63369:58732,63370:58733,63371:58734,63372:58735,63373:58736,63374:58737,63375:58738,63376:58739,63377:58740,63378:58741,63379:58742,63380:58743,63381:58744,63382:58745,63383:58746,63384:58747,63385:58748,63386:58749,63387:58750,63388:58751,63389:58752,63390:58753,63391:58754,63392:58755,63393:58756,63394:58757,63395:58758,63396:58759,63397:58760,63398:58761,63399:58762,63400:58763,63401:58764,63402:58765,63403:58766,63404:58767,63405:58768,63406:58769,63407:58770,63408:58771,63409:58772,63410:58773,63411:58774,63412:58775,63413:58776,63414:58777,63415:58778,63416:58779,63417:58780,63418:58781,63419:58782,63420:58783,63421:58784,63422:58785,63423:58786,63424:58787,63425:58788,63426:58789,63427:58790,63428:58791,63429:58792,63430:58793,63431:58794,63432:58795,63433:58796,63434:58797,63435:58798,63436:58799,63437:58800,63438:58801,63439:58802,63440:58803,63441:58804,63442:58805,63443:58806,63444:58807,63445:58808,63446:58809,63447:58810,63448:58811,63449:58812,63450:58813,63451:58814,63452:58815,63453:58816,63454:58817,63455:58818,63456:58819,63457:58820,63458:58821,63459:58822,63460:58823,63461:58824,63462:58825,63463:58826,63464:58827,63465:58828,63466:58829,63467:58830,63468:58831,63469:58832,63470:58833,63471:58834,63472:58835,63473:58836,63474:58837,63475:58838,63476:58839,63477:58840,63478:58841,63479:58842,63480:58843,63481:58844,63482:58845,63483:58846,63484:58847,63552:58848,63553:58849,63554:58850,63555:58851,63556:58852,63557:58853,63558:58854,63559:58855,63560:58856,63561:58857,63562:58858,63563:58859,63564:58860,63565:58861,63566:58862,63567:58863,63568:58864,63569:58865,63570:58866,63571:58867,63572:58868,63573:58869,63574:58870,63575:58871,63576:58872,63577:58873,63578:58874,63579:58875,63580:58876,63581:58877,63582:58878,63583:58879,63584:58880,63585:58881,63586:58882,63587:58883,63588:58884,63589:58885,63590:58886,63591:58887,63592:58888,63593:58889,63594:58890,63595:58891,63596:58892,63597:58893,63598:58894,63599:58895,63600:58896,63601:58897,63602:58898,63603:58899,63604:58900,63605:58901,63606:58902,63607:58903,63608:58904,63609:58905,63610:58906,63611:58907,63612:58908,63613:58909,63614:58910,63616:58911,63617:58912,63618:58913,63619:58914,63620:58915,63621:58916,63622:58917,63623:58918,63624:58919,63625:58920,63626:58921,63627:58922,63628:58923,63629:58924,63630:58925,63631:58926,63632:58927,63633:58928,63634:58929,63635:58930,63636:58931,63637:58932,63638:58933,63639:58934,63640:58935,63641:58936,63642:58937,63643:58938,63644:58939,63645:58940,63646:58941,63647:58942,63648:58943,63649:58944,63650:58945,63651:58946,63652:58947,63653:58948,63654:58949,63655:58950,63656:58951,63657:58952,63658:58953,63659:58954,63660:58955,63661:58956,63662:58957,63663:58958,63664:58959,63665:58960,63666:58961,63667:58962,63668:58963,63669:58964,63670:58965,63671:58966,63672:58967,63673:58968,63674:58969,63675:58970,63676:58971,63677:58972,63678:58973,63679:58974,63680:58975,63681:58976,63682:58977,63683:58978,63684:58979,63685:58980,63686:58981,63687:58982,63688:58983,63689:58984,63690:58985,63691:58986,63692:58987,63693:58988,63694:58989,63695:58990,63696:58991,63697:58992,63698:58993,63699:58994,63700:58995,63701:58996,63702:58997,63703:58998,63704:58999,63705:59e3,63706:59001,63707:59002,63708:59003,63709:59004,63710:59005,63711:59006,63712:59007,63713:59008,63714:59009,63715:59010,63716:59011,63717:59012,63718:59013,63719:59014,63720:59015,63721:59016,63722:59017,63723:59018,63724:59019,63725:59020,63726:59021,63727:59022,63728:59023,63729:59024,63730:59025,63731:59026,63732:59027,63733:59028,63734:59029,63735:59030,63736:59031,63737:59032,63738:59033,63739:59034,63740:59035,64064:8560,64065:8561,64066:8562,64067:8563,64068:8564,64069:8565,64070:8566,64071:8567,64072:8568,64073:8569,64074:8544,64075:8545,64076:8546,64077:8547,64078:8548,64079:8549,64080:8550,64081:8551,64082:8552,64083:8553,64084:65506,64085:65508,64086:65287,64087:65282,64088:12849,64089:8470,64090:8481,64091:8757,64092:32394,64093:35100,64094:37704,64095:37512,64096:34012,64097:20425,64098:28859,64099:26161,64100:26824,64101:37625,64102:26363,64103:24389,64104:20008,64105:20193,64106:20220,64107:20224,64108:20227,64109:20281,64110:20310,64111:20370,64112:20362,64113:20378,64114:20372,64115:20429,64116:20544,64117:20514,64118:20479,64119:20510,64120:20550,64121:20592,64122:20546,64123:20628,64124:20724,64125:20696,64126:20810,64128:20836,64129:20893,64130:20926,64131:20972,64132:21013,64133:21148,64134:21158,64135:21184,64136:21211,64137:21248,64138:21255,64139:21284,64140:21362,64141:21395,64142:21426,64143:21469,64144:64014,64145:21660,64146:21642,64147:21673,64148:21759,64149:21894,64150:22361,64151:22373,64152:22444,64153:22472,64154:22471,64155:64015,64156:64016,64157:22686,64158:22706,64159:22795,64160:22867,64161:22875,64162:22877,64163:22883,64164:22948,64165:22970,64166:23382,64167:23488,64168:29999,64169:23512,64170:23532,64171:23582,64172:23718,64173:23738,64174:23797,64175:23847,64176:23891,64177:64017,64178:23874,64179:23917,64180:23992,64181:23993,64182:24016,64183:24353,64184:24372,64185:24423,64186:24503,64187:24542,64188:24669,64189:24709,64190:24714,64191:24798,64192:24789,64193:24864,64194:24818,64195:24849,64196:24887,64197:24880,64198:24984,64199:25107,64200:25254,64201:25589,64202:25696,64203:25757,64204:25806,64205:25934,64206:26112,64207:26133,64208:26171,64209:26121,64210:26158,64211:26142,64212:26148,64213:26213,64214:26199,64215:26201,64216:64018,64217:26227,64218:26265,64219:26272,64220:26290,64221:26303,64222:26362,64223:26382,64224:63785,64225:26470,64226:26555,64227:26706,64228:26560,64229:26625,64230:26692,64231:26831,64232:64019,64233:26984,64234:64020,64235:27032,64236:27106,64237:27184,64238:27243,64239:27206,64240:27251,64241:27262,64242:27362,64243:27364,64244:27606,64245:27711,64246:27740,64247:27782,64248:27759,64249:27866,64250:27908,64251:28039,64252:28015,64320:28054,64321:28076,64322:28111,64323:28152,64324:28146,64325:28156,64326:28217,64327:28252,64328:28199,64329:28220,64330:28351,64331:28552,64332:28597,64333:28661,64334:28677,64335:28679,64336:28712,64337:28805,64338:28843,64339:28943,64340:28932,64341:29020,64342:28998,64343:28999,64344:64021,64345:29121,64346:29182,64347:29361,64348:29374,64349:29476,64350:64022,64351:29559,64352:29629,64353:29641,64354:29654,64355:29667,64356:29650,64357:29703,64358:29685,64359:29734,64360:29738,64361:29737,64362:29742,64363:29794,64364:29833,64365:29855,64366:29953,64367:30063,64368:30338,64369:30364,64370:30366,64371:30363,64372:30374,64373:64023,64374:30534,64375:21167,64376:30753,64377:30798,64378:30820,64379:30842,64380:31024,64381:64024,64382:64025,64384:64026,64385:31124,64386:64027,64387:31131,64388:31441,64389:31463,64390:64028,64391:31467,64392:31646,64393:64029,64394:32072,64395:32092,64396:32183,64397:32160,64398:32214,64399:32338,64400:32583,64401:32673,64402:64030,64403:33537,64404:33634,64405:33663,64406:33735,64407:33782,64408:33864,64409:33972,64410:34131,64411:34137,64412:34155,64413:64031,64414:34224,64415:64032,64416:64033,64417:34823,64418:35061,64419:35346,64420:35383,64421:35449,64422:35495,64423:35518,64424:35551,64425:64034,64426:35574,64427:35667,64428:35711,64429:36080,64430:36084,64431:36114,64432:36214,64433:64035,64434:36559,64435:64036,64436:64037,64437:36967,64438:37086,64439:64038,64440:37141,64441:37159,64442:37338,64443:37335,64444:37342,64445:37357,64446:37358,64447:37348,64448:37349,64449:37382,64450:37392,64451:37386,64452:37434,64453:37440,64454:37436,64455:37454,64456:37465,64457:37457,64458:37433,64459:37479,64460:37543,64461:37495,64462:37496,64463:37607,64464:37591,64465:37593,64466:37584,64467:64039,64468:37589,64469:37600,64470:37587,64471:37669,64472:37665,64473:37627,64474:64040,64475:37662,64476:37631,64477:37661,64478:37634,64479:37744,64480:37719,64481:37796,64482:37830,64483:37854,64484:37880,64485:37937,64486:37957,64487:37960,64488:38290,64489:63964,64490:64041,64491:38557,64492:38575,64493:38707,64494:38715,64495:38723,64496:38733,64497:38735,64498:38737,64499:38741,64500:38999,64501:39013,64502:64042,64503:64043,64504:39207,64505:64044,64506:39326,64507:39502,64508:39641,64576:39644,64577:39797,64578:39794,64579:39823,64580:39857,64581:39867,64582:39936,64583:40304,64584:40299,64585:64045,64586:40473,64587:40657},r.prototype={constructor:r,getInt8:function(){var e=this.dv.getInt8(this.offset);return this.offset+=1,e},getInt8Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt8());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint8Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint8());return t},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt16Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt16());return t},getUint16:function(){var e=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,e},getUint16Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint16());return t},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getUint32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint32());return t},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getIndex:function(e,t){switch(e){case 1:return!0===t?this.getUint8():this.getInt8();case 2:return!0===t?this.getUint16():this.getInt16();case 4:return this.getInt32();default:throw"unknown number type "+e+" exception."}},getIndexArray:function(e,t,r){for(var a=[],n=0;n<t;n++)a.push(this.getIndex(e,r));return a},getChars:function(e){for(var t="";e>0;){var r=this.getUint8();if(e--,0===r)break;t+=String.fromCharCode(r)}for(;e>0;)this.getUint8(),e--;return t},getSjisStringsAsUnicode:function(e){for(var t=[];e>0;){var r=this.getUint8();if(e--,0===r)break;t.push(r)}for(;e>0;)this.getUint8(),e--;return this.encoder.s2u(new Uint8Array(t))},getUnicodeStrings:function(e){for(var t="";e>0;){var r=this.getUint16();if(e-=2,0===r)break;t+=String.fromCharCode(r)}for(;e>0;)this.getUint8(),e--;return t},getTextBuffer:function(){var e=this.getUint32();return this.getUnicodeStrings(e)}},a.prototype={constructor:a,leftToRightVector3:function(e){e[2]=-e[2]},leftToRightQuaternion:function(e){e[0]=-e[0],e[1]=-e[1]},leftToRightEuler:function(e){e[0]=-e[0],e[1]=-e[1]},leftToRightIndexOrder:function(e){var t=e[2];e[2]=e[0],e[0]=t},leftToRightVector3Range:function(e,t){var r=-t[2];t[2]=-e[2],e[2]=r},leftToRightEulerRange:function(e,t){var r=-t[0],a=-t[1];t[0]=-e[0],t[1]=-e[1],e[0]=r,e[1]=a}},n.prototype.parsePmd=function(e,t){var a={},n=new r(e);a.metadata={},a.metadata.format="pmd",a.metadata.coordinateSystem="left";return function(){var e=a.metadata;if(e.magic=n.getChars(3),"Pmd"!==e.magic)throw"PMD file magic is not Pmd, but "+e.magic;e.version=n.getFloat32(),e.modelName=n.getSjisStringsAsUnicode(20),e.comment=n.getSjisStringsAsUnicode(256)}(),function(){var e=a.metadata;e.vertexCount=n.getUint32(),a.vertices=[];for(var t=0;t<e.vertexCount;t++)a.vertices.push(function(){var e={};return e.position=n.getFloat32Array(3),e.normal=n.getFloat32Array(3),e.uv=n.getFloat32Array(2),e.skinIndices=n.getUint16Array(2),e.skinWeights=[n.getUint8()/100],e.skinWeights.push(1-e.skinWeights[0]),e.edgeFlag=n.getUint8(),e}())}(),function(){var e=a.metadata;e.faceCount=n.getUint32()/3,a.faces=[];for(var t=0;t<e.faceCount;t++)a.faces.push(function(){var e={};return e.indices=n.getUint16Array(3),e}())}(),function(){var e=a.metadata;e.materialCount=n.getUint32(),a.materials=[];for(var t=0;t<e.materialCount;t++)a.materials.push(function(){var e={};return e.diffuse=n.getFloat32Array(4),e.shininess=n.getFloat32(),e.specular=n.getFloat32Array(3),e.ambient=n.getFloat32Array(3),e.toonIndex=n.getInt8(),e.edgeFlag=n.getUint8(),e.faceCount=n.getUint32()/3,e.fileName=n.getSjisStringsAsUnicode(20),e}())}(),function(){var e=a.metadata;e.boneCount=n.getUint16(),a.bones=[];for(var t=0;t<e.boneCount;t++)a.bones.push(function(){var e={};return e.name=n.getSjisStringsAsUnicode(20),e.parentIndex=n.getInt16(),e.tailIndex=n.getInt16(),e.type=n.getUint8(),e.ikIndex=n.getInt16(),e.position=n.getFloat32Array(3),e}())}(),function(){var e=a.metadata;e.ikCount=n.getUint16(),a.iks=[];for(var t=0;t<e.ikCount;t++)a.iks.push(function(){var e={};e.target=n.getUint16(),e.effector=n.getUint16(),e.linkCount=n.getUint8(),e.iteration=n.getUint16(),e.maxAngle=n.getFloat32(),e.links=[];for(var t=0;t<e.linkCount;t++){var r={};r.index=n.getUint16(),e.links.push(r)}return e}())}(),function(){var e=a.metadata;e.morphCount=n.getUint16(),a.morphs=[];for(var t=0;t<e.morphCount;t++)a.morphs.push(function(){var e={};e.name=n.getSjisStringsAsUnicode(20),e.elementCount=n.getUint32(),e.type=n.getUint8(),e.elements=[];for(var t=0;t<e.elementCount;t++)e.elements.push({index:n.getUint32(),position:n.getFloat32Array(3)});return e}())}(),function(){var e=a.metadata;e.morphFrameCount=n.getUint8(),a.morphFrames=[];for(var t=0;t<e.morphFrameCount;t++)a.morphFrames.push(function(){var e={};return e.index=n.getUint16(),e}())}(),function(){var e=a.metadata;e.boneFrameNameCount=n.getUint8(),a.boneFrameNames=[];for(var t=0;t<e.boneFrameNameCount;t++)a.boneFrameNames.push(function(){var e={};return e.name=n.getSjisStringsAsUnicode(50),e}())}(),function(){var e=a.metadata;e.boneFrameCount=n.getUint32(),a.boneFrames=[];for(var t=0;t<e.boneFrameCount;t++)a.boneFrames.push(function(){var e={};return e.boneIndex=n.getInt16(),e.frameIndex=n.getUint8(),e}())}(),function(){var e=a.metadata;e.englishCompatibility=n.getUint8(),e.englishCompatibility>0&&(e.englishModelName=n.getSjisStringsAsUnicode(20),e.englishComment=n.getSjisStringsAsUnicode(256))}(),function(){var e=a.metadata;if(0!==e.englishCompatibility){a.englishBoneNames=[];for(var t=0;t<e.boneCount;t++)a.englishBoneNames.push(function(){var e={};return e.name=n.getSjisStringsAsUnicode(20),e}())}}(),function(){var e=a.metadata;if(0!==e.englishCompatibility){a.englishMorphNames=[];for(var t=0;t<e.morphCount-1;t++)a.englishMorphNames.push(function(){var e={};return e.name=n.getSjisStringsAsUnicode(20),e}())}}(),function(){var e=a.metadata;if(0!==e.englishCompatibility){a.englishBoneFrameNames=[];for(var t=0;t<e.boneFrameNameCount;t++)a.englishBoneFrameNames.push(function(){var e={};return e.name=n.getSjisStringsAsUnicode(50),e}())}}(),function(){a.toonTextures=[];for(var e=0;e<10;e++)a.toonTextures.push(function(){var e={};return e.fileName=n.getSjisStringsAsUnicode(100),e}())}(),function(){var e=a.metadata;e.rigidBodyCount=n.getUint32(),a.rigidBodies=[];for(var t=0;t<e.rigidBodyCount;t++)a.rigidBodies.push(function(){var e={};return e.name=n.getSjisStringsAsUnicode(20),e.boneIndex=n.getInt16(),e.groupIndex=n.getUint8(),e.groupTarget=n.getUint16(),e.shapeType=n.getUint8(),e.width=n.getFloat32(),e.height=n.getFloat32(),e.depth=n.getFloat32(),e.position=n.getFloat32Array(3),e.rotation=n.getFloat32Array(3),e.weight=n.getFloat32(),e.positionDamping=n.getFloat32(),e.rotationDamping=n.getFloat32(),e.restitution=n.getFloat32(),e.friction=n.getFloat32(),e.type=n.getUint8(),e}())}(),function(){var e=a.metadata;e.constraintCount=n.getUint32(),a.constraints=[];for(var t=0;t<e.constraintCount;t++)a.constraints.push(function(){var e={};return e.name=n.getSjisStringsAsUnicode(20),e.rigidBodyIndex1=n.getUint32(),e.rigidBodyIndex2=n.getUint32(),e.position=n.getFloat32Array(3),e.rotation=n.getFloat32Array(3),e.translationLimitation1=n.getFloat32Array(3),e.translationLimitation2=n.getFloat32Array(3),e.rotationLimitation1=n.getFloat32Array(3),e.rotationLimitation2=n.getFloat32Array(3),e.springPosition=n.getFloat32Array(3),e.springRotation=n.getFloat32Array(3),e}())}(),!0===t&&this.leftToRightModel(a),a},n.prototype.parsePmx=function(e,t){var a={},n=new r(e);a.metadata={},a.metadata.format="pmx",a.metadata.coordinateSystem="left";return function(){var e=a.metadata;if(e.magic=n.getChars(4),"PMX "!==e.magic)throw"PMX file magic is not PMX , but "+e.magic;if(e.version=n.getFloat32(),2!==e.version&&2.1!==e.version)throw"PMX version "+e.version+" is not supported.";e.headerSize=n.getUint8(),e.encoding=n.getUint8(),e.additionalUvNum=n.getUint8(),e.vertexIndexSize=n.getUint8(),e.textureIndexSize=n.getUint8(),e.materialIndexSize=n.getUint8(),e.boneIndexSize=n.getUint8(),e.morphIndexSize=n.getUint8(),e.rigidBodyIndexSize=n.getUint8(),e.modelName=n.getTextBuffer(),e.englishModelName=n.getTextBuffer(),e.comment=n.getTextBuffer(),e.englishComment=n.getTextBuffer()}(),function(){var e=a.metadata;e.vertexCount=n.getUint32(),a.vertices=[];for(var t=0;t<e.vertexCount;t++)a.vertices.push(function(){var t={};t.position=n.getFloat32Array(3),t.normal=n.getFloat32Array(3),t.uv=n.getFloat32Array(2),t.auvs=[];for(var r=0;r<a.metadata.additionalUvNum;r++)t.auvs.push(n.getFloat32Array(4));t.type=n.getUint8();var i=e.boneIndexSize;if(0===t.type)t.skinIndices=n.getIndexArray(i,1),t.skinWeights=[1];else if(1===t.type)t.skinIndices=n.getIndexArray(i,2),t.skinWeights=n.getFloat32Array(1),t.skinWeights.push(1-t.skinWeights[0]);else if(2===t.type)t.skinIndices=n.getIndexArray(i,4),t.skinWeights=n.getFloat32Array(4);else{if(3!==t.type)throw"unsupport bone type "+t.type+" exception.";t.skinIndices=n.getIndexArray(i,2),t.skinWeights=n.getFloat32Array(1),t.skinWeights.push(1-t.skinWeights[0]),t.skinC=n.getFloat32Array(3),t.skinR0=n.getFloat32Array(3),t.skinR1=n.getFloat32Array(3),t.type=1}return t.edgeRatio=n.getFloat32(),t}())}(),function(){var e=a.metadata;e.faceCount=n.getUint32()/3,a.faces=[];for(var t=0;t<e.faceCount;t++)a.faces.push(function(){var t={};return t.indices=n.getIndexArray(e.vertexIndexSize,3,!0),t}())}(),function(){var e=a.metadata;e.textureCount=n.getUint32(),a.textures=[];for(var t=0;t<e.textureCount;t++)a.textures.push(function(){return n.getTextBuffer()}())}(),function(){var e=a.metadata;e.materialCount=n.getUint32(),a.materials=[];for(var t=0;t<e.materialCount;t++)a.materials.push(function(){var e={};if(e.name=n.getTextBuffer(),e.englishName=n.getTextBuffer(),e.diffuse=n.getFloat32Array(4),e.specular=n.getFloat32Array(3),e.shininess=n.getFloat32(),e.ambient=n.getFloat32Array(3),e.flag=n.getUint8(),e.edgeColor=n.getFloat32Array(4),e.edgeSize=n.getFloat32(),e.textureIndex=n.getIndex(a.metadata.textureIndexSize),e.envTextureIndex=n.getIndex(a.metadata.textureIndexSize),e.envFlag=n.getUint8(),e.toonFlag=n.getUint8(),0===e.toonFlag)e.toonIndex=n.getIndex(a.metadata.textureIndexSize);else{if(1!==e.toonFlag)throw"unknown toon flag "+e.toonFlag+" exception.";e.toonIndex=n.getInt8()}return e.comment=n.getTextBuffer(),e.faceCount=n.getUint32()/3,e}())}(),function(){var e=a.metadata;e.boneCount=n.getUint32(),a.bones=[];for(var t=0;t<e.boneCount;t++)a.bones.push(function(){var e={};if(e.name=n.getTextBuffer(),e.englishName=n.getTextBuffer(),e.position=n.getFloat32Array(3),e.parentIndex=n.getIndex(a.metadata.boneIndexSize),e.transformationClass=n.getUint32(),e.flag=n.getUint16(),1&e.flag?e.connectIndex=n.getIndex(a.metadata.boneIndexSize):e.offsetPosition=n.getFloat32Array(3),256&e.flag||512&e.flag){var t={};t.isLocal=0!=(128&e.flag),t.affectRotation=0!=(256&e.flag),t.affectPosition=0!=(512&e.flag),t.parentIndex=n.getIndex(a.metadata.boneIndexSize),t.ratio=n.getFloat32(),e.grant=t}if(1024&e.flag&&(e.fixAxis=n.getFloat32Array(3)),2048&e.flag&&(e.localXVector=n.getFloat32Array(3),e.localZVector=n.getFloat32Array(3)),8192&e.flag&&(e.key=n.getUint32()),32&e.flag){var r={};r.effector=n.getIndex(a.metadata.boneIndexSize),r.target=null,r.iteration=n.getUint32(),r.maxAngle=n.getFloat32(),r.linkCount=n.getUint32(),r.links=[];for(var i=0;i<r.linkCount;i++){var o={};o.index=n.getIndex(a.metadata.boneIndexSize),o.angleLimitation=n.getUint8(),1===o.angleLimitation&&(o.lowerLimitationAngle=n.getFloat32Array(3),o.upperLimitationAngle=n.getFloat32Array(3)),r.links.push(o)}e.ik=r}return e}())}(),function(){var e=a.metadata;e.morphCount=n.getUint32(),a.morphs=[];for(var t=0;t<e.morphCount;t++)a.morphs.push(function(){var e={};e.name=n.getTextBuffer(),e.englishName=n.getTextBuffer(),e.panel=n.getUint8(),e.type=n.getUint8(),e.elementCount=n.getUint32(),e.elements=[];for(var t=0;t<e.elementCount;t++)if(0===e.type){var r={};r.index=n.getIndex(a.metadata.morphIndexSize),r.ratio=n.getFloat32(),e.elements.push(r)}else if(1===e.type){var r={};r.index=n.getIndex(a.metadata.vertexIndexSize,!0),r.position=n.getFloat32Array(3),e.elements.push(r)}else if(2===e.type){var r={};r.index=n.getIndex(a.metadata.boneIndexSize),r.position=n.getFloat32Array(3),r.rotation=n.getFloat32Array(4),e.elements.push(r)}else if(3===e.type){var r={};r.index=n.getIndex(a.metadata.vertexIndexSize,!0),r.uv=n.getFloat32Array(4),e.elements.push(r)}else if(4===e.type);else if(5===e.type);else if(6===e.type);else if(7===e.type);else if(8===e.type){var r={};r.index=n.getIndex(a.metadata.materialIndexSize),r.type=n.getUint8(),r.diffuse=n.getFloat32Array(4),r.specular=n.getFloat32Array(3),r.shininess=n.getFloat32(),r.ambient=n.getFloat32Array(3),r.edgeColor=n.getFloat32Array(4),r.edgeSize=n.getFloat32(),r.textureColor=n.getFloat32Array(4),r.sphereTextureColor=n.getFloat32Array(4),r.toonColor=n.getFloat32Array(4),e.elements.push(r)}return e}())}(),function(){var e=a.metadata;e.frameCount=n.getUint32(),a.frames=[];for(var t=0;t<e.frameCount;t++)a.frames.push(function(){var e={};e.name=n.getTextBuffer(),e.englishName=n.getTextBuffer(),e.type=n.getUint8(),e.elementCount=n.getUint32(),e.elements=[];for(var t=0;t<e.elementCount;t++){var r={};r.target=n.getUint8(),r.index=0===r.target?n.getIndex(a.metadata.boneIndexSize):n.getIndex(a.metadata.morphIndexSize),e.elements.push(r)}return e}())}(),function(){var e=a.metadata;e.rigidBodyCount=n.getUint32(),a.rigidBodies=[];for(var t=0;t<e.rigidBodyCount;t++)a.rigidBodies.push(function(){var e={};return e.name=n.getTextBuffer(),e.englishName=n.getTextBuffer(),e.boneIndex=n.getIndex(a.metadata.boneIndexSize),e.groupIndex=n.getUint8(),e.groupTarget=n.getUint16(),e.shapeType=n.getUint8(),e.width=n.getFloat32(),e.height=n.getFloat32(),e.depth=n.getFloat32(),e.position=n.getFloat32Array(3),e.rotation=n.getFloat32Array(3),e.weight=n.getFloat32(),e.positionDamping=n.getFloat32(),e.rotationDamping=n.getFloat32(),e.restitution=n.getFloat32(),e.friction=n.getFloat32(),e.type=n.getUint8(),e}())}(),function(){var e=a.metadata;e.constraintCount=n.getUint32(),a.constraints=[];for(var t=0;t<e.constraintCount;t++)a.constraints.push(function(){var e={};return e.name=n.getTextBuffer(),e.englishName=n.getTextBuffer(),e.type=n.getUint8(),e.rigidBodyIndex1=n.getIndex(a.metadata.rigidBodyIndexSize),e.rigidBodyIndex2=n.getIndex(a.metadata.rigidBodyIndexSize),e.position=n.getFloat32Array(3),e.rotation=n.getFloat32Array(3),e.translationLimitation1=n.getFloat32Array(3),e.translationLimitation2=n.getFloat32Array(3),e.rotationLimitation1=n.getFloat32Array(3),e.rotationLimitation2=n.getFloat32Array(3),e.springPosition=n.getFloat32Array(3),e.springRotation=n.getFloat32Array(3),e}())}(),!0===t&&this.leftToRightModel(a),a},n.prototype.parseVmd=function(e,t){var a={},n=new r(e);a.metadata={},a.metadata.coordinateSystem="left";return function(){var e=a.metadata;if(e.magic=n.getChars(30),"Vocaloid Motion Data 0002"!==e.magic)throw"VMD file magic is not Vocaloid Motion Data 0002, but "+e.magic;e.name=n.getSjisStringsAsUnicode(20)}(),function(){var e=a.metadata;e.motionCount=n.getUint32(),a.motions=[];for(var t=0;t<e.motionCount;t++)a.motions.push(function(){var e={};return e.boneName=n.getSjisStringsAsUnicode(15),e.frameNum=n.getUint32(),e.position=n.getFloat32Array(3),e.rotation=n.getFloat32Array(4),e.interpolation=n.getUint8Array(64),e}())}(),function(){var e=a.metadata;e.morphCount=n.getUint32(),a.morphs=[];for(var t=0;t<e.morphCount;t++)a.morphs.push(function(){var e={};return e.morphName=n.getSjisStringsAsUnicode(15),e.frameNum=n.getUint32(),e.weight=n.getFloat32(),e}())}(),function(){var e=a.metadata;e.cameraCount=n.getUint32(),a.cameras=[];for(var t=0;t<e.cameraCount;t++)a.cameras.push(function(){var e={};return e.frameNum=n.getUint32(),e.distance=n.getFloat32(),e.position=n.getFloat32Array(3),e.rotation=n.getFloat32Array(3),e.interpolation=n.getUint8Array(24),e.fov=n.getUint32(),e.perspective=n.getUint8(),e}())}(),!0===t&&this.leftToRightVmd(a),a},n.prototype.parseVpd=function(e,t){function r(){throw"the file seems not vpd file."}var a={};a.metadata={},a.metadata.coordinateSystem="left",a.bones=[];var n=/\/\/\w*(\r|\n|\r\n)/g,i=/\r|\n|\r\n/,o=e.replace(n,"").split(i);return function(){"Vocaloid Pose Data file"!==o[0]&&r()}(),function(){o.length<4&&r(),a.metadata.parentFile=o[2],a.metadata.boneCount=parseInt(o[3])}(),function(){for(var e=/^\s*(Bone[0-9]+)\s*\{\s*(.*)$/,t=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,n=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,i=/^\s*}/,s=a.bones,l=null,u=null,c=null,d=4;d<o.length;d++){var f,h=o[d];f=h.match(e),null!==f&&(null!==l&&r(),l=f[2]),f=h.match(t),null!==f&&(null!==u&&r(),u=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])]),f=h.match(n),null!==f&&(null!==c&&r(),c=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),parseFloat(f[4])]),null!==(f=h.match(i))&&(null!==l&&null!==u&&null!==c||r(),s.push({name:l,translation:u,quaternion:c}),l=null,u=null,c=null)}null===l&&null===u&&null===c||r()}(),!0===t&&this.leftToRightVpd(a),a},n.prototype.mergeVmds=function(e){var t={};t.metadata={},t.metadata.name=e[0].metadata.name,t.metadata.coordinateSystem=e[0].metadata.coordinateSystem,t.metadata.motionCount=0,t.metadata.morphCount=0,t.metadata.cameraCount=0,t.motions=[],t.morphs=[],t.cameras=[];for(var r=0;r<e.length;r++){var a=e[r];t.metadata.motionCount+=a.metadata.motionCount,t.metadata.morphCount+=a.metadata.morphCount,t.metadata.cameraCount+=a.metadata.cameraCount;for(var n=0;n<a.metadata.motionCount;n++)t.motions.push(a.motions[n]);for(var n=0;n<a.metadata.morphCount;n++)t.morphs.push(a.morphs[n]);for(var n=0;n<a.metadata.cameraCount;n++)t.cameras.push(a.cameras[n])}return t},n.prototype.leftToRightModel=function(e){if("right"!==e.metadata.coordinateSystem){e.metadata.coordinateSystem="right";for(var t=new a,r=0;r<e.metadata.vertexCount;r++)t.leftToRightVector3(e.vertices[r].position),t.leftToRightVector3(e.vertices[r].normal);for(var r=0;r<e.metadata.faceCount;r++)t.leftToRightIndexOrder(e.faces[r].indices);for(var r=0;r<e.metadata.boneCount;r++)t.leftToRightVector3(e.bones[r].position);for(var r=0;r<e.metadata.morphCount;r++){var n=e.morphs[r];if("pmx"!==e.metadata.format||1===n.type)for(var i=0;i<n.elements.length;i++)t.leftToRightVector3(n.elements[i].position)}for(var r=0;r<e.metadata.rigidBodyCount;r++)t.leftToRightVector3(e.rigidBodies[r].position),t.leftToRightEuler(e.rigidBodies[r].rotation);for(var r=0;r<e.metadata.constraintCount;r++)t.leftToRightVector3(e.constraints[r].position),t.leftToRightEuler(e.constraints[r].rotation),t.leftToRightVector3Range(e.constraints[r].translationLimitation1,e.constraints[r].translationLimitation2),t.leftToRightEulerRange(e.constraints[r].rotationLimitation1,e.constraints[r].rotationLimitation2)}},n.prototype.leftToRightVmd=function(e){if("right"!==e.metadata.coordinateSystem){e.metadata.coordinateSystem="right";for(var t=new a,r=0;r<e.metadata.motionCount;r++)t.leftToRightVector3(e.motions[r].position),t.leftToRightQuaternion(e.motions[r].rotation);for(var r=0;r<e.metadata.cameraCount;r++)t.leftToRightVector3(e.cameras[r].position),t.leftToRightEuler(e.cameras[r].rotation)}},n.prototype.leftToRightVpd=function(e){if("right"!==e.metadata.coordinateSystem){e.metadata.coordinateSystem="right";for(var t=new a,r=0;r<e.bones.length;r++)t.leftToRightVector3(e.bones[r].translation),t.leftToRightQuaternion(e.bones[r].quaternion)}},e.CharsetEncoder=t,e.Parser=n,Object.defineProperty(e,"__esModule",{value:!0})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(){function e(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.dracoLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}function r(){if(!n.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=y.MSFT_TEXTURE_DDS,this.ddsLoader=new n.DDSLoader}function a(e){this.name=y.KHR_LIGHTS,this.lights={};var t=e.extensions&&e.extensions[y.KHR_LIGHTS]||{},r=t.lights||{};for(var a in r){var i,o=r[a],s=(new n.Color).fromArray(o.color);switch(o.type){case"directional":i=new n.DirectionalLight(s),i.target.position.set(0,0,1),i.add(i.target);break;case"point":i=new n.PointLight(s);break;case"spot":i=new n.SpotLight(s),o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,1),i.add(i.target);break;case"ambient":i=new n.AmbientLight(s)}i&&(i.decay=2,void 0!==o.intensity&&(i.intensity=o.intensity),i.name=o.name||"light_"+a,this.lights[a]=i)}}function i(e){this.name=y.KHR_MATERIALS_UNLIT}function o(e){this.name=y.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,b);if(this.header={magic:n.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==x)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var r=new DataView(e,b),a=0;a<r.byteLength;){var i=r.getUint32(a,!0);a+=4;var o=r.getUint32(a,!0);if(a+=4,o===A.JSON){var s=new Uint8Array(e,b+a,i);this.content=n.LoaderUtils.decodeText(s)}else if(o===A.BIN){var l=b+a;this.body=e.slice(l,l+i)}a+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function s(e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=y.KHR_DRACO_MESH_COMPRESSION,this.dracoLoader=e}function l(){return{name:y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return n.ShaderMaterial},extendParams:function(e,t,r){var a=t.extensions[this.name],i=n.ShaderLib.standard,o=n.UniformsUtils.clone(i.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),d=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),f=i.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",d);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new n.Color).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=i.vertexShader,e.fragmentShader=f,e.uniforms=o,e.defines={STANDARD:""},e.color=new n.Color(1,1,1),e.opacity=1;var h=[];if(Array.isArray(a.diffuseFactor)){var p=a.diffuseFactor;e.color.fromArray(p),e.opacity=p[3]}if(void 0!==a.diffuseTexture&&h.push(r.assignTexture(e,"map",a.diffuseTexture.index)),e.emissive=new n.Color(0,0,0),e.glossiness=void 0!==a.glossinessFactor?a.glossinessFactor:1,e.specular=new n.Color(1,1,1),Array.isArray(a.specularFactor)&&e.specular.fromArray(a.specularFactor),void 0!==a.specularGlossinessTexture){var m=a.specularGlossinessTexture.index;h.push(r.assignTexture(e,"glossinessMap",m)),h.push(r.assignTexture(e,"specularMap",m))}return Promise.all(h)},createMaterial:function(e){var t=new n.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var r=this.specularGlossinessParams,a=0,n=r.length;a<n;a++)t[r[a]]=e[r[a]];return t},refreshUniforms:function(e,t,r,a,n,i){if(!0===n.isGLTFSpecularGlossinessMaterial){var o=n.uniforms,s=n.defines;o.opacity.value=n.opacity,o.diffuse.value.copy(n.color),o.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),o.map.value=n.map,o.specularMap.value=n.specularMap,o.alphaMap.value=n.alphaMap,o.lightMap.value=n.lightMap,o.lightMapIntensity.value=n.lightMapIntensity,o.aoMap.value=n.aoMap,o.aoMapIntensity.value=n.aoMapIntensity;var l;if(n.map?l=n.map:n.specularMap?l=n.specularMap:n.displacementMap?l=n.displacementMap:n.normalMap?l=n.normalMap:n.bumpMap?l=n.bumpMap:n.glossinessMap?l=n.glossinessMap:n.alphaMap?l=n.alphaMap:n.emissiveMap&&(l=n.emissiveMap),void 0!==l){l.isWebGLRenderTarget&&(l=l.texture);var u,c;if(void 0!==l.matrix){if(!0===l.matrixAutoUpdate){u=l.offset,c=l.repeat;var d=l.rotation,f=l.center;l.matrix.setUvTransform(u.x,u.y,c.x,c.y,d,f.x,f.y)}o.uvTransform.value.copy(l.matrix)}else u=l.offset,c=l.repeat,o.offsetRepeat.value.set(u.x,u.y,c.x,c.y)}o.envMap.value=n.envMap,o.envMapIntensity.value=n.envMapIntensity,o.flipEnvMap.value=n.envMap&&n.envMap.isCubeTexture?-1:1,o.refractionRatio.value=n.refractionRatio,o.specular.value.copy(n.specular),o.glossiness.value=n.glossiness,o.glossinessMap.value=n.glossinessMap,o.emissiveMap.value=n.emissiveMap,o.bumpMap.value=n.bumpMap,o.normalMap.value=n.normalMap,o.displacementMap.value=n.displacementMap,o.displacementScale.value=n.displacementScale,o.displacementBias.value=n.displacementBias,null!==o.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===o.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)}}}}function u(e,t,r,a){n.Interpolant.call(this,e,t,r,a)}function c(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function d(){return new n.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.FrontSide})}function f(e,t,r,a){for(var n=e.geometry,i=r.targets,o=!1,s=!1,l=0,u=i.length;l<u;l++){var c=i[l];if(void 0!==c.POSITION&&(o=!0),void 0!==c.NORMAL&&(s=!0),o&&s)break}if(o||s){for(var d=[],f=[],l=0,u=i.length;l<u;l++){var c=i[l],h="morphTarget"+l;if(o){if(void 0!==c.POSITION){var p=m(a[c.POSITION]);p.name=h;for(var v=n.attributes.position,g=0,y=p.count;g<y;g++)p.setXYZ(g,p.getX(g)+v.getX(g),p.getY(g)+v.getY(g),p.getZ(g)+v.getZ(g))}else p=n.attributes.position;d.push(p)}if(s){var x;if(void 0!==c.NORMAL){var x=m(a[c.NORMAL]);x.name=h;for(var b=n.attributes.normal,g=0,y=x.count;g<y;g++)x.setXYZ(g,x.getX(g)+b.getX(g),x.getY(g)+b.getY(g),x.getZ(g)+b.getZ(g))}else x=n.attributes.normal;f.push(x)}}if(o&&(n.morphAttributes.position=d),s&&(n.morphAttributes.normal=f),e.updateMorphTargets(),void 0!==t.weights)for(var l=0,u=t.weights.length;l<u;l++)e.morphTargetInfluences[l]=t.weights[l];if(t.extras&&Array.isArray(t.extras.targetNames)){var A=t.extras.targetNames;if(e.morphTargetInfluences.length===A.length){e.morphTargetDictionary={};for(var l=0,u=A.length;l<u;l++)e.morphTargetDictionary[A[l]]=l}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}}function h(e,t){if(e.indices!==t.indices)return!1;var r=e.attributes||{},a=t.attributes||{},n=Object.keys(r),i=Object.keys(a);if(n.length!==i.length)return!1;for(var o=0,s=n.length;o<s;o++){var l=n[o];if(r[l]!==a[l])return!1}return!0}function p(e,t){for(var r=0,a=e.length;r<a;r++){var n=e[r];if(h(n.primitive,t))return n.promise}return null}function m(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,r=e.itemSize,a=e.array.slice(0,t*r),i=0;i<t;++i)a[i]=e.getX(i),r>=2&&(a[i+1]=e.getY(i)),r>=3&&(a[i+2]=e.getZ(i)),r>=4&&(a[i+3]=e.getW(i));return new n.BufferAttribute(a,r,e.normalized)}return e.clone()}function v(e,r,a){this.json=e||{},this.extensions=r||{},this.options=a||{},this.cache=new t,this.primitiveCache=[],this.textureLoader=new n.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new n.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function g(e,t,r){var a=t.attributes;for(var n in a){var i=P[n],o=r[a[n]];i&&(i in e.attributes||e.addAttribute(i,o))}void 0===t.indices||e.index||e.setIndex(r[t.indices])}e.prototype={constructor:e,crossOrigin:"Anonymous",load:function(e,t,r,a){var i=this,o=void 0!==this.path?this.path:n.LoaderUtils.extractUrlBase(e),s=new n.FileLoader(i.manager);s.setResponseType("arraybuffer"),s.load(e,function(e){try{i.parse(e,o,t,a)}catch(e){if(void 0===a)throw e;a(e)}},r,a)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,t,u,c){var d,f={};if("string"==typeof e)d=e;else{if(n.LoaderUtils.decodeText(new Uint8Array(e,0,4))===x){try{f[y.KHR_BINARY_GLTF]=new o(e)}catch(e){return void(c&&c(e))}d=f[y.KHR_BINARY_GLTF].content}else d=n.LoaderUtils.decodeText(new Uint8Array(e))}var h=JSON.parse(d);if(void 0===h.asset||h.asset.version[0]<2)return void(c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.")));h.extensionsUsed&&(h.extensionsUsed.indexOf(y.KHR_LIGHTS)>=0&&(f[y.KHR_LIGHTS]=new a(h)),h.extensionsUsed.indexOf(y.KHR_MATERIALS_UNLIT)>=0&&(f[y.KHR_MATERIALS_UNLIT]=new i(h)),h.extensionsUsed.indexOf(y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(f[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new l),h.extensionsUsed.indexOf(y.KHR_DRACO_MESH_COMPRESSION)>=0&&(f[y.KHR_DRACO_MESH_COMPRESSION]=new s(this.dracoLoader)),h.extensionsUsed.indexOf(y.MSFT_TEXTURE_DDS)>=0&&(f[y.MSFT_TEXTURE_DDS]=new r)),new v(h,f,{path:t||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(function(e,t,r,a,n){u({scene:e,scenes:t,cameras:r,animations:a,asset:n})},c)}};var y={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};i.prototype.getMaterialType=function(e){return n.MeshBasicMaterial},i.prototype.extendParams=function(e,t,r){var a=[];e.color=new n.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==i.baseColorTexture&&a.push(r.assignTexture(e,"map",i.baseColorTexture.index))}return Promise.all(a)};var x="glTF",b=12,A={JSON:1313821514,BIN:5130562};s.prototype.decodePrimitive=function(e,t){var r=this.dracoLoader,a=e.extensions[this.name].bufferView,n=e.extensions[this.name].attributes,i={};for(var o in n)o in P&&(i[P[o]]=n[o]);return t.getDependency("bufferView",a).then(function(e){return new Promise(function(t){r.decodeDracoFile(e,t,i)})})},u.prototype=Object.create(n.Interpolant.prototype),u.prototype.constructor=u,u.prototype.interpolate_=function(e,t,r,a){for(var n=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,u=a-t,c=(r-t)/u,d=c*c,f=d*c,h=e*l,p=h-l,m=2*f-3*d+1,v=f-2*d+c,g=-2*f+3*d,y=f-d,x=0;x!==o;x++){var b=i[p+x+o],A=i[p+x+s]*u,w=i[h+x+o],M=i[h+x]*u;n[x]=m*b+v*A+g*w+y*M}return n};var w={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},M=(Number,n.Matrix3,n.Matrix4,n.Vector2,n.Vector3,n.Vector4,n.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),T={9728:n.NearestFilter,9729:n.LinearFilter,9984:n.NearestMipMapNearestFilter,9985:n.LinearMipMapNearestFilter,9986:n.NearestMipMapLinearFilter,9987:n.LinearMipMapLinearFilter},S={33071:n.ClampToEdgeWrapping,33648:n.MirroredRepeatWrapping,10497:n.RepeatWrapping},F={6406:n.AlphaFormat,6407:n.RGBFormat,6408:n.RGBAFormat,6409:n.LuminanceFormat,6410:n.LuminanceAlphaFormat},E={5121:n.UnsignedByteType,32819:n.UnsignedShort4444Type,32820:n.UnsignedShort5551Type,33635:n.UnsignedShort565Type},_=(n.BackSide,n.FrontSide,n.NeverDepth,n.LessDepth,n.EqualDepth,n.LessEqualDepth,n.GreaterEqualDepth,n.NotEqualDepth,n.GreaterEqualDepth,n.AlwaysDepth,n.AddEquation,n.SubtractEquation,n.ReverseSubtractEquation,n.ZeroFactor,n.OneFactor,n.SrcColorFactor,n.OneMinusSrcColorFactor,n.SrcAlphaFactor,n.OneMinusSrcAlphaFactor,n.DstAlphaFactor,n.OneMinusDstAlphaFactor,n.DstColorFactor,n.OneMinusDstColorFactor,n.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),P={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD0:"uv",TEXCOORD:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",COLOR0:"color",COLOR:"color",WEIGHTS_0:"skinWeight",WEIGHT:"skinWeight",JOINTS_0:"skinIndex",JOINT:"skinIndex"},L={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},C={CUBICSPLINE:n.InterpolateSmooth,LINEAR:n.InterpolateLinear,STEP:n.InterpolateDiscrete},N={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};return v.prototype.parse=function(e,t){var r=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(t){var a=t.scenes||[],n=a[r.scene||0],i=t.animations||[],o=r.asset,s=t.cameras||[];e(n,a,s,i,o)}).catch(t)},v.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],a={},n={},i=0,o=t.length;i<o;i++)for(var s=t[i].joints,l=0,u=s.length;l<u;l++)e[s[l]].isBone=!0;for(var c=0,d=e.length;c<d;c++){var f=e[c];void 0!==f.mesh&&(void 0===a[f.mesh]&&(a[f.mesh]=n[f.mesh]=0),a[f.mesh]++,void 0!==f.skin&&(r[f.mesh].isSkinnedMesh=!0))}this.json.meshReferences=a,this.json.meshUses=n},v.prototype.getDependency=function(e,t){var r=e+":"+t,a=this.cache.get(r);if(!a){switch(e){case"scene":a=this.loadScene(t);break;case"node":a=this.loadNode(t);break;case"mesh":a=this.loadMesh(t);break;case"accessor":a=this.loadAccessor(t);break;case"bufferView":a=this.loadBufferView(t);break;case"buffer":a=this.loadBuffer(t);break;case"material":a=this.loadMaterial(t);break;case"texture":a=this.loadTexture(t);break;case"skin":a=this.loadSkin(t);break;case"animation":a=this.loadAnimation(t);break;case"camera":a=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,a)}return a},v.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,a=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(a.map(function(t,a){return r.getDependency(e,a)})),this.cache.add(e,t)}return t},v.prototype.getMultiDependencies=function(e){for(var t={},r=[],a=0,n=e.length;a<n;a++){var i=e[a],o=this.getDependencies(i);o=o.then(function(e,r){t[e]=r}.bind(this,i+("mesh"===i?"es":"s"))),r.push(o)}return Promise.all(r).then(function(){return t})},v.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[y.KHR_BINARY_GLTF].body);var a=this.options;return new Promise(function(e,n){r.load(c(t.uri,a.path),e,void 0,function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},v.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,a=t.byteOffset||0;return e.slice(a,a+r)})},v.prototype.loadAccessor=function(e){var t=this,r=this.json,a=this.json.accessors[e];if(void 0===a.bufferView&&void 0===a.sparse)return null;var i=[];return void 0!==a.bufferView?i.push(this.getDependency("bufferView",a.bufferView)):i.push(null),void 0!==a.sparse&&(i.push(this.getDependency("bufferView",a.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",a.sparse.values.bufferView))),Promise.all(i).then(function(e){var i,o,s=e[0],l=_[a.type],u=M[a.componentType],c=u.BYTES_PER_ELEMENT,d=c*l,f=a.byteOffset||0,h=r.bufferViews[a.bufferView].byteStride,p=!0===a.normalized;if(h&&h!==d){var m="InterleavedBuffer:"+a.bufferView+":"+a.componentType,v=t.cache.get(m);v||(i=new u(s),v=new n.InterleavedBuffer(i,h/c),t.cache.add(m,v)),o=new n.InterleavedBufferAttribute(v,l,f/c,p)}else i=null===s?new u(a.count*l):new u(s,f,a.count*l),o=new n.BufferAttribute(i,l,p);if(void 0!==a.sparse){var g=_.SCALAR,y=M[a.sparse.indices.componentType],x=a.sparse.indices.byteOffset||0,b=a.sparse.values.byteOffset||0,A=new y(e[1],x,a.sparse.count*g),w=new u(e[2],b,a.sparse.count*l);null!==s&&o.setArray(o.array.slice());for(var T=0,S=A.length;T<S;T++){var F=A[T];if(o.setX(F,w[T*l]),l>=2&&o.setY(F,w[T*l+1]),l>=3&&o.setZ(F,w[T*l+2]),l>=4&&o.setW(F,w[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o})},v.prototype.loadTexture=function(e){var t,r=this,a=this.json,i=this.options,o=this.textureLoader,s=window.URL||window.webkitURL,l=a.textures[e],u=l.extensions||{};t=u[y.MSFT_TEXTURE_DDS]?a.images[u[y.MSFT_TEXTURE_DDS].source]:a.images[l.source];var d=t.uri,f=!1;return void 0!==t.bufferView&&(d=r.getDependency("bufferView",t.bufferView).then(function(e){f=!0;var r=new Blob([e],{type:t.mimeType});return d=s.createObjectURL(r)})),Promise.resolve(d).then(function(e){var t=n.Loader.Handlers.get(e);return t||(t=u[y.MSFT_TEXTURE_DDS]?r.extensions[y.MSFT_TEXTURE_DDS].ddsLoader:o),new Promise(function(r,a){t.load(c(e,i.path),r,void 0,a)})}).then(function(e){!0===f&&s.revokeObjectURL(d),e.flipY=!1,void 0!==l.name&&(e.name=l.name),u[y.MSFT_TEXTURE_DDS]||(e.format=void 0!==l.format?F[l.format]:n.RGBAFormat),void 0!==l.internalFormat&&e.format!==F[l.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),e.type=void 0!==l.type?E[l.type]:n.UnsignedByteType;var t=a.samplers||{},r=t[l.sampler]||{};return e.magFilter=T[r.magFilter]||n.LinearFilter,e.minFilter=T[r.minFilter]||n.LinearMipMapLinearFilter,e.wrapS=S[r.wrapS]||n.RepeatWrapping,e.wrapT=S[r.wrapT]||n.RepeatWrapping,e})},v.prototype.assignTexture=function(e,t,r){return this.getDependency("texture",r).then(function(r){e[t]=r})},v.prototype.loadMaterial=function(e){var t,r=this,a=(this.json,this.extensions),i=this.json.materials[e],o={},s=i.extensions||{},l=[];if(s[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=a[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(i),l.push(u.extendParams(o,i,r))}else if(s[y.KHR_MATERIALS_UNLIT]){var c=a[y.KHR_MATERIALS_UNLIT];t=c.getMaterialType(i),l.push(c.extendParams(o,i,r))}else{t=n.MeshStandardMaterial;var d=i.pbrMetallicRoughness||{};if(o.color=new n.Color(1,1,1),o.opacity=1,Array.isArray(d.baseColorFactor)){var f=d.baseColorFactor;o.color.fromArray(f),o.opacity=f[3]}if(void 0!==d.baseColorTexture&&l.push(r.assignTexture(o,"map",d.baseColorTexture.index)),o.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,o.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture){var h=d.metallicRoughnessTexture.index;l.push(r.assignTexture(o,"metalnessMap",h)),l.push(r.assignTexture(o,"roughnessMap",h))}}!0===i.doubleSided&&(o.side=n.DoubleSide);var p=i.alphaMode||N.OPAQUE;return p===N.BLEND?o.transparent=!0:(o.transparent=!1,p===N.MASK&&(o.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==n.MeshBasicMaterial&&(l.push(r.assignTexture(o,"normalMap",i.normalTexture.index)),o.normalScale=new n.Vector2(1,1),void 0!==i.normalTexture.scale&&o.normalScale.set(i.normalTexture.scale,i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==n.MeshBasicMaterial&&(l.push(r.assignTexture(o,"aoMap",i.occlusionTexture.index)),void 0!==i.occlusionTexture.strength&&(o.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==n.MeshBasicMaterial&&(o.emissive=(new n.Color).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==n.MeshBasicMaterial&&l.push(r.assignTexture(o,"emissiveMap",i.emissiveTexture.index)),Promise.all(l).then(function(){var e;return e=t===n.ShaderMaterial?a[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),void 0!==i.name&&(e.name=i.name),e.normalScale&&(e.normalScale.y=-e.normalScale.y),e.map&&(e.map.encoding=n.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=n.sRGBEncoding),i.extras&&(e.userData=i.extras),e})},v.prototype.loadGeometries=function(e){var t=this,r=this.extensions,a=this.primitiveCache;return this.getDependencies("accessor").then(function(i){for(var o=[],s=0,l=e.length;s<l;s++){var u=e[s],c=p(a,u);if(c)o.push(c);else if(u.extensions&&u.extensions[y.KHR_DRACO_MESH_COMPRESSION]){var d=r[y.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(e){return g(e,u,i),e});a.push({primitive:u,promise:d}),o.push(d)}else{var f=new n.BufferGeometry;g(f,u,i);var d=Promise.resolve(f);a.push({primitive:u,promise:d}),o.push(d)}}return Promise.all(o)})},v.prototype.loadMesh=function(e){var t=this,r=(this.json,this.extensions),a=this.json.meshes[e];return this.getMultiDependencies(["accessor","material"]).then(function(i){var o=new n.Group,s=a.primitives;return t.loadGeometries(s).then(function(l){for(var u=0,c=s.length;u<c;u++){var h=s[u],p=l[u],m=void 0===h.material?d():i.materials[h.material];m.aoMap&&void 0===p.attributes.uv2&&void 0!==p.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),p.addAttribute("uv2",new n.BufferAttribute(p.attributes.uv.array,2)));var v=void 0!==p.attributes.color,g=void 0===p.attributes.normal,x=!0===a.isSkinnedMesh,b=void 0!==h.targets;if(v||g||x||b)if(m.isGLTFSpecularGlossinessMaterial){var A=r[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];m=A.cloneMaterial(m)}else m=m.clone();v&&(m.vertexColors=n.VertexColors,m.needsUpdate=!0),g&&(m.flatShading=!0);var M;if(h.mode===w.TRIANGLES||h.mode===w.TRIANGLE_STRIP||h.mode===w.TRIANGLE_FAN||void 0===h.mode)x?(M=new n.SkinnedMesh(p,m),m.skinning=!0):M=new n.Mesh(p,m),h.mode===w.TRIANGLE_STRIP?M.drawMode=n.TriangleStripDrawMode:h.mode===w.TRIANGLE_FAN&&(M.drawMode=n.TriangleFanDrawMode);else if(h.mode===w.LINES||h.mode===w.LINE_STRIP||h.mode===w.LINE_LOOP){var T="LineBasicMaterial:"+m.uuid,S=t.cache.get(T);S||(S=new n.LineBasicMaterial,n.Material.prototype.copy.call(S,m),S.color.copy(m.color),S.lights=!1,t.cache.add(T,S)),m=S,M=h.mode===w.LINES?new n.LineSegments(p,m):h.mode===w.LINE_STRIP?new n.Line(p,m):new n.LineLoop(p,m)}else{if(h.mode!==w.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);var T="PointsMaterial:"+m.uuid,F=t.cache.get(T);F||(F=new n.PointsMaterial,n.Material.prototype.copy.call(F,m),F.color.copy(m.color),F.map=m.map,F.lights=!1,t.cache.add(T,F)),m=F,M=new n.Points(p,m)}if(M.name=a.name||"mesh_"+e,b&&(f(M,a,h,i.accessors),m.morphTargets=!0,void 0!==M.geometry.morphAttributes.normal&&(m.morphNormals=!0)),void 0!==a.extras&&(M.userData=a.extras),void 0!==h.extras&&(M.geometry.userData=h.extras),!0===m.isGLTFSpecularGlossinessMaterial&&(M.onBeforeRender=r[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),!(s.length>1))return M;M.name+="_"+u,o.add(M)}return o})})},v.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],a=r[r.type];return a?("perspective"===r.type?t=new n.PerspectiveCamera(n.Math.radToDeg(a.yfov),a.aspectRatio||1,a.znear||1,a.zfar||2e6):"orthographic"===r.type&&(t=new n.OrthographicCamera(a.xmag/-2,a.xmag/2,a.ymag/2,a.ymag/-2,a.znear,a.zfar)),void 0!==r.name&&(t.name=r.name),r.extras&&(t.userData=r.extras),Promise.resolve(t)):void console.warn("THREE.GLTFLoader: Missing camera parameters.")},v.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},v.prototype.loadAnimation=function(e){var t=(this.json,this.json.animations[e]);return this.getMultiDependencies(["accessor","node"]).then(function(r){for(var a=[],i=0,o=t.channels.length;i<o;i++){var s=t.channels[i],l=t.samplers[s.sampler];if(l){var c=s.target,d=void 0!==c.node?c.node:c.id,f=void 0!==t.parameters?t.parameters[l.input]:l.input,h=void 0!==t.parameters?t.parameters[l.output]:l.output,p=r.accessors[f],m=r.accessors[h],v=r.nodes[d];if(v){v.updateMatrix(),v.matrixAutoUpdate=!0;var g;switch(L[c.path]){case L.weights:g=n.NumberKeyframeTrack;break;case L.rotation:g=n.QuaternionKeyframeTrack;break;case L.position:case L.scale:default:g=n.VectorKeyframeTrack}var y=v.name?v.name:v.uuid,x=void 0!==l.interpolation?C[l.interpolation]:n.InterpolateLinear,b=[];L[c.path]===L.weights?v.traverse(function(e){!0===e.isMesh&&!0===e.material.morphTargets&&b.push(e.name?e.name:e.uuid)}):b.push(y);for(var A=0,w=b.length;A<w;A++){var M=new g(b[A]+"."+L[c.path],n.AnimationUtils.arraySlice(p.array,0),n.AnimationUtils.arraySlice(m.array,0),x);"CUBICSPLINE"===l.interpolation&&(M.createInterpolant=function(e){return new u(this.times,this.values,this.getValueSize()/3,e)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),a.push(M)}}}}var d=void 0!==t.name?t.name:"animation_"+e;return new n.AnimationClip(d,void 0,a)})},v.prototype.loadNode=function(e){var t=(this.json,this.extensions),r=this.json.meshReferences,a=this.json.meshUses,i=this.json.nodes[e];return this.getMultiDependencies(["mesh","skin","camera","light"]).then(function(e){var o;if(!0===i.isBone)o=new n.Bone;else if(void 0!==i.mesh){var s=e.meshes[i.mesh];if(o=s.clone(),!0===s.isGroup)for(var l=0,u=s.children.length;l<u;l++){var c=s.children[l];c.material&&!0===c.material.isGLTFSpecularGlossinessMaterial&&(o.children[l].onBeforeRender=c.onBeforeRender)}else s.material&&!0===s.material.isGLTFSpecularGlossinessMaterial&&(o.onBeforeRender=s.onBeforeRender);r[i.mesh]>1&&(o.name+="_instance_"+a[i.mesh]++)}else if(void 0!==i.camera)o=e.cameras[i.camera];else if(i.extensions&&i.extensions[y.KHR_LIGHTS]&&void 0!==i.extensions[y.KHR_LIGHTS].light){var d=t[y.KHR_LIGHTS].lights;o=d[i.extensions[y.KHR_LIGHTS].light]}else o=new n.Object3D;if(void 0!==i.name&&(o.name=n.PropertyBinding.sanitizeNodeName(i.name)),i.extras&&(o.userData=i.extras),void 0!==i.matrix){var f=new n.Matrix4;f.fromArray(i.matrix),o.applyMatrix(f)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return o})},v.prototype.loadScene=function(){function e(t,r,a,i,o){var s=i[t],l=a.nodes[t];if(void 0!==l.skin)for(var u=!0===s.isGroup?s.children:[s],c=0,d=u.length;c<d;c++){for(var f=u[c],h=o[l.skin],p=[],m=[],v=0,g=h.joints.length;v<g;v++){var y=h.joints[v],x=i[y];if(x){p.push(x);var b=new n.Matrix4;void 0!==h.inverseBindMatrices&&b.fromArray(h.inverseBindMatrices.array,16*v),m.push(b)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',y)}f.bind(new n.Skeleton(p,m),f.matrixWorld)}if(r.add(s),l.children)for(var A=l.children,c=0,d=A.length;c<d;c++){var w=A[c];e(w,s,a,i,o)}}return function(t){var r=this.json,a=this.extensions,i=this.json.scenes[t];return this.getMultiDependencies(["node","skin"]).then(function(t){var o=new n.Scene;void 0!==i.name&&(o.name=i.name),i.extras&&(o.userData=i.extras);for(var s=i.nodes||[],l=0,u=s.length;l<u;l++)e(s[l],o,r,t.nodes,t.skins);if(i.extensions&&i.extensions[y.KHR_LIGHTS]&&void 0!==i.extensions[y.KHR_LIGHTS].light){var c=a[y.KHR_LIGHTS].lights;o.add(c[i.extensions[y.KHR_LIGHTS].light])}return o})}}(),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype=Object.create(n.DataTextureLoader.prototype),i.prototype._parser=function(e){var t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},r=function(e,t,r){t=t||1024;for(var a=e.pos,n=-1,i=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));0>(n=s.indexOf("\n"))&&i<t&&a<e.byteLength;)o+=s,i+=s.length,a+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));return-1<n&&(!1!==r&&(e.pos+=i+n+1),o+s.slice(0,n))},a=new Uint8Array(e);a.byteLength;a.pos=0;var i=function(e){var a,n,i=/^#\?(\S+)$/,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,l=/^\s*FORMAT=(\S+)\s*$/,u=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(a=r(e)))return t(1,"no header found");if(!(n=a.match(i)))return t(3,"bad initial token");for(c.valid|=1,c.programtype=n[1],c.string+=a+"\n";;){if(!1===(a=r(e)))break;if(c.string+=a+"\n","#"!==a.charAt(0)){if((n=a.match(o))&&(c.gamma=parseFloat(n[1],10)),(n=a.match(s))&&(c.exposure=parseFloat(n[1],10)),(n=a.match(l))&&(c.valid|=2,c.format=n[1]),(n=a.match(u))&&(c.valid|=4,c.height=parseInt(n[1],10),c.width=parseInt(n[2],10)),2&c.valid&&4&c.valid)break}else c.comments+=a+"\n"}return 2&c.valid?4&c.valid?c:t(3,"missing image size specifier"):t(3,"missing format specifier")}(a);if(-1!==i){var o=i.width,s=i.height,l=function(e,r,a){var n,i,o,s,l,u,c,d,f,h,p,m,v,g=r,y=a;if(g<8||g>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(g!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");if(!(n=new Uint8Array(4*r*a))||!n.length)return t(4,"unable to allocate buffer space");for(i=0,o=0,d=4*g,v=new Uint8Array(4),u=new Uint8Array(d);y>0&&o<e.byteLength;){if(o+4>e.byteLength)return t(1);if(v[0]=e[o++],v[1]=e[o++],v[2]=e[o++],v[3]=e[o++],2!=v[0]||2!=v[1]||(v[2]<<8|v[3])!=g)return t(3,"bad rgbe scanline format");for(c=0;c<d&&o<e.byteLength;){if(s=e[o++],m=s>128,m&&(s-=128),0===s||c+s>d)return t(3,"bad scanline data");if(m)for(l=e[o++],f=0;f<s;f++)u[c++]=l;else u.set(e.subarray(o,o+s),c),c+=s,o+=s}for(h=g,f=0;f<h;f++)p=0,n[i]=u[f+p],p+=g,n[i+1]=u[f+p],p+=g,n[i+2]=u[f+p],p+=g,n[i+3]=u[f+p],i+=4;y--}return n}(a.subarray(a.pos),o,s);if(-1!==l)return{width:o,height:s,data:l,header:i.string,gamma:i.gamma,exposure:i.exposure,format:n.RGBEFormat,type:n.UnsignedByteType}}return null},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=r(8),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=o.default,l={};l.Validator={isValid:function(e){return null!==e&&void 0!==e},verifyInput:function(e,t){return null===e||void 0===e?t:e}},l.Callbacks=function(){function e(){this.onProgress=null,this.onMeshAlter=null,this.onLoad=null,this.onLoadMaterials=null}var t=l.Validator;return e.prototype.setCallbackOnProgress=function(e){this.onProgress=t.verifyInput(e,this.onProgress)},e.prototype.setCallbackOnMeshAlter=function(e){this.onMeshAlter=t.verifyInput(e,this.onMeshAlter)},e.prototype.setCallbackOnLoad=function(e){this.onLoad=t.verifyInput(e,this.onLoad)},e.prototype.setCallbackOnLoadMaterials=function(e){this.onLoadMaterials=t.verifyInput(e,this.onLoadMaterials)},e}(),l.LoadedMeshUserOverride=function(){function e(e,t){this.disregardMesh=!0===e,this.alteredMesh=!0===t,this.meshes=[]}return e.prototype.addMesh=function(e){this.meshes.push(e),this.alteredMesh=!0},e.prototype.isDisregardMesh=function(){return this.disregardMesh},e.prototype.providesAlteredMeshes=function(){return this.alteredMesh},e}(),l.ResourceDescriptor=function(){function e(e,r){var a=e.split("/");a.length<2?(this.path=null,this.name=e,this.url=e):(this.path=t.verifyInput(a.slice(0,a.length-1).join("/")+"/",null),this.name=t.verifyInput(a[a.length-1],null),this.url=e),this.extension=t.verifyInput(r,"default"),this.extension=this.extension.trim(),this.content=null}var t=l.Validator;return e.prototype.setContent=function(e){this.content=t.verifyInput(e,null)},e}(),l.PrepData=function(){function e(e){this.logging={enabled:!0,debug:!1},this.modelName=t.verifyInput(e,""),this.resources=[],this.callbacks=new l.Callbacks}var t=l.Validator;return e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.getCallbacks=function(){return this.callbacks},e.prototype.addResource=function(e){this.resources.push(e)},e.prototype.clone=function(){var e=new l.PrepData(this.modelName);e.logging.enabled=this.logging.enabled,e.logging.debug=this.logging.debug,e.resources=this.resources,e.callbacks=this.callbacks;var t,r;for(t in this)r=this[t],e.hasOwnProperty(t)||"function"==typeof this[t]||(e[t]=r);return e},e.prototype.checkResourceDescriptorFiles=function(e,r){var a,n,i,o,s={};for(var l in e)if(a=e[l],o=!1,t.isValid(a.name))if(t.isValid(a.content)){for(i=0;i<r.length&&!o;i++)if(n=r[i],a.extension.toLowerCase()===n.ext.toLowerCase())if(n.ignore)o=!0;else if("ArrayBuffer"===n.type){if(!(a.content instanceof ArrayBuffer||a.content instanceof Uint8Array))throw"Provided content is not of type ArrayBuffer! Aborting...";s[n.ext]=a,o=!0}else if("String"===n.type){if(!("string"==typeof a.content||a.content instanceof String))throw"Provided  content is not of type String! Aborting...";s[n.ext]=a,o=!0}if(!o)throw'Unidentified resource "'+a.name+'": '+a.url}else{if(!("string"==typeof a.name||a.name instanceof String))throw"Provided file is not properly defined! Aborting...";for(i=0;i<r.length&&!o;i++)n=r[i],a.extension.toLowerCase()===n.ext.toLowerCase()&&(n.ignore||(s[n.ext]=a),o=!0);if(!o)throw'Unidentified resource "'+a.name+'": '+a.url}return s},e}(),l.MeshBuilder=function(){function e(){console.info("Using THREE.LoaderSupport.MeshBuilder version: "+t),this.logging={enabled:!0,debug:!1},this.callbacks=new l.Callbacks,this.materials=[]}var t="1.2.0",r=l.Validator;return e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.init=function(){var e=new n.MeshStandardMaterial({color:14479871});e.name="defaultMaterial";var t=new n.MeshStandardMaterial({color:14479871});t.name="defaultVertexColorMaterial",t.vertexColors=n.VertexColors;var r=new n.LineBasicMaterial;r.name="defaultLineMaterial";var a=new n.PointsMaterial({size:1});a.name="defaultPointMaterial";var i={};i[e.name]=e,i[t.name]=t,i[r.name]=r,i[a.name]=a,this.updateMaterials({cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:i}})},e.prototype.setMaterials=function(e){var t={cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:r.isValid(this.callbacks.onLoadMaterials)?this.callbacks.onLoadMaterials(e):e}};this.updateMaterials(t)},e.prototype._setCallbacks=function(e){r.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),r.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),r.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),r.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials)},e.prototype.processPayload=function(e){return"meshData"===e.cmd?this.buildMeshes(e):"materialData"===e.cmd?(this.updateMaterials(e),null):void 0},e.prototype.buildMeshes=function(e){var t=e.params.meshName,a=new n.BufferGeometry;a.addAttribute("position",new n.BufferAttribute(new Float32Array(e.buffers.vertices),3)),r.isValid(e.buffers.indices)&&a.setIndex(new n.BufferAttribute(new Uint32Array(e.buffers.indices),1)),r.isValid(e.buffers.colors)&&a.addAttribute("color",new n.BufferAttribute(new Float32Array(e.buffers.colors),3)),r.isValid(e.buffers.normals)?a.addAttribute("normal",new n.BufferAttribute(new Float32Array(e.buffers.normals),3)):a.computeVertexNormals(),r.isValid(e.buffers.uvs)&&a.addAttribute("uv",new n.BufferAttribute(new Float32Array(e.buffers.uvs),2));var i,o,s,l=e.materials.materialNames,u=e.materials.multiMaterial,c=[];for(s in l)o=l[s],i=this.materials[o],u&&c.push(i);if(u){i=c;var d,f=e.materials.materialGroups;for(s in f)d=f[s],a.addGroup(d.start,d.count,d.index)}var h,p,m=[],v=this.callbacks.onMeshAlter,g=!0,y=r.verifyInput(e.geometryType,0);if(r.isValid(v)&&(p=v({detail:{meshName:t,bufferGeometry:a,material:i,geometryType:y}}),r.isValid(p))){if(!p.isDisregardMesh()&&p.providesAlteredMeshes())for(var x in p.meshes)m.push(p.meshes[x]);g=!1}g&&(e.computeBoundingSphere&&a.computeBoundingSphere(),h=0===y?new n.Mesh(a,i):1===y?new n.LineSegments(a,i):new n.Points(a,i),h.name=t,m.push(h));var b;if(r.isValid(m)&&m.length>0){var A=[];for(var x in m)h=m[x],A[x]=h.name;b="Adding mesh(es) ("+A.length+": "+A+") from input mesh: "+t,b+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else b="Not adding mesh: "+t,b+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";var w=this.callbacks.onProgress;if(r.isValid(w)){w(new CustomEvent("MeshBuilderEvent",{detail:{type:"progress",modelName:e.params.meshName,text:b,numericalValue:e.progress.numericalValue}}))}return m},e.prototype.updateMaterials=function(e){var t,a,i=e.materials.materialCloneInstructions;if(r.isValid(i)){var o=i.materialNameOrg,s=this.materials[o];if(r.isValid(o)){t=s.clone(),a=i.materialName,t.name=a;var l=i.materialProperties;for(var u in l)t.hasOwnProperty(u)&&l.hasOwnProperty(u)&&(t[u]=l[u]);this.materials[a]=t}else console.warn('Requested material "'+o+'" is not available!')}var c=e.materials.serializedMaterials;if(r.isValid(c)&&Object.keys(c).length>0){var d,f=new n.MaterialLoader;for(a in c)d=c[a],r.isValid(d)&&(t=f.parse(d),this.logging.enabled&&console.info('De-serialized material with name "'+a+'" will be added.'),this.materials[a]=t)}if(c=e.materials.runtimeMaterials,r.isValid(c)&&Object.keys(c).length>0)for(a in c)t=c[a],this.logging.enabled&&console.info('Material with name "'+a+'" will be added.'),this.materials[a]=t},e.prototype.getMaterialsJSON=function(){var e,t={};for(var r in this.materials)e=this.materials[r],t[r]=e.toJSON();return t},e.prototype.getMaterials=function(){return this.materials},e}(),l.WorkerRunnerRefImpl=function(){function e(){var e=this,t=function(t){e.processMessage(t.data)};self.addEventListener("message",t,!1)}return e.prototype.applyProperties=function(e,t){var r,a,n;for(r in t)a="set"+r.substring(0,1).toLocaleUpperCase()+r.substring(1),n=t[r],"function"==typeof e[a]?e[a](n):e.hasOwnProperty(r)&&(e[r]=n)},e.prototype.processMessage=function(e){if("run"===e.cmd){var t={callbackMeshBuilder:function(e){self.postMessage(e)},callbackProgress:function(t){e.logging.enabled&&e.logging.debug&&console.debug("WorkerRunner: progress: "+t)}},r=new Parser;"function"==typeof r.setLogging&&r.setLogging(e.logging.enabled,e.logging.debug),this.applyProperties(r,e.params),this.applyProperties(r,e.materials),this.applyProperties(r,t),r.workerScope=self,r.parse(e.data.input,e.data.options),e.logging.enabled&&console.log("WorkerRunner: Run complete!"),t.callbackMeshBuilder({cmd:"complete",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+e.cmd)},e}(),l.WorkerSupport=function(){function e(){if(console.info("Using THREE.LoaderSupport.WorkerSupport version: "+t),this.logging={enabled:!0,debug:!1},void 0===s.Worker)throw"This browser does not support web workers!";if(void 0===s.Blob)throw"This browser does not support Blob!";if("function"!=typeof s.URL.createObjectURL)throw"This browser does not support Object creation from URL!";this.loaderWorker=new a}var t="2.2.0",r=l.Validator,a=function(){function e(){this._reset()}return e.prototype._reset=function(){this.logging={enabled:!0,debug:!1},this.worker=null,this.runnerImplName=null,this.callbacks={meshBuilder:null,onLoad:null},this.terminateRequested=!1,this.queuedMessage=null,this.started=!1,this.forceCopy=!1},e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.setForceCopy=function(e){this.forceCopy=!0===e},e.prototype.initWorker=function(e,t){this.runnerImplName=t;var r=new Blob([e],{type:"application/javascript"});this.worker=new Worker(s.URL.createObjectURL(r)),this.worker.onmessage=this._receiveWorkerMessage,this.worker.runtimeRef=this,this._postMessage()},e.prototype._receiveWorkerMessage=function(e){var t=e.data;switch(t.cmd){case"meshData":case"materialData":case"imageData":this.runtimeRef.callbacks.meshBuilder(t);break;case"complete":this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run is complete. Terminating application on request!"),this.runtimeRef._terminate());break;case"error":console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Reported error: "+t.msg),this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(t.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run reported error. Terminating application on request!"),this.runtimeRef._terminate());break;default:console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Received unknown command: "+t.cmd)}},e.prototype.setCallbacks=function(e,t){this.callbacks.meshBuilder=r.verifyInput(e,this.callbacks.meshBuilder),this.callbacks.onLoad=r.verifyInput(t,this.callbacks.onLoad)},e.prototype.run=function(e){if(r.isValid(this.queuedMessage))return void console.warn("Already processing message. Rejecting new run instruction");if(this.queuedMessage=e,this.started=!0,!r.isValid(this.callbacks.meshBuilder))throw'Unable to run as no "MeshBuilder" callback is set.';if(!r.isValid(this.callbacks.onLoad))throw'Unable to run as no "onLoad" callback is set.';"run"!==e.cmd&&(e.cmd="run"),r.isValid(e.logging)?(e.logging.enabled=!0===e.logging.enabled,e.logging.debug=!0===e.logging.debug):e.logging={enabled:!0,debug:!1},this._postMessage()},e.prototype._postMessage=function(){if(r.isValid(this.queuedMessage)&&r.isValid(this.worker))if(this.queuedMessage.data.input instanceof ArrayBuffer){var e;e=this.forceCopy?this.queuedMessage.data.input.slice(0):this.queuedMessage.data.input,this.worker.postMessage(this.queuedMessage,[e])}else this.worker.postMessage(this.queuedMessage)},e.prototype.setTerminateRequested=function(e){this.terminateRequested=!0===e,this.terminateRequested&&r.isValid(this.worker)&&!r.isValid(this.queuedMessage)&&this.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate())},e.prototype._terminate=function(){this.worker.terminate(),this._reset()},e}();e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.loaderWorker.setLogging(this.logging.enabled,this.logging.debug)},e.prototype.setForceWorkerDataCopy=function(e){this.loaderWorker.setForceCopy(e)},e.prototype.validate=function(e,t,a,s,u){if(!r.isValid(this.loaderWorker.worker)){this.logging.enabled&&(console.info("WorkerSupport: Building worker code..."),console.time("buildWebWorkerCode")),r.isValid(u)?this.logging.enabled&&console.info('WorkerSupport: Using "'+u.name+'" as Runner class for worker.'):(u=l.WorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "THREE.LoaderSupport.WorkerRunnerRefImpl" as Runner class for worker.'));var c=e(i,o);c+="var Parser = "+t+";\n\n",c+=o(u.name,u),c+="new "+u.name+"();\n\n";var d=this;if(r.isValid(a)&&a.length>0){var f="";!function e(t,r){if(0===r.length)d.loaderWorker.initWorker(f+c,u.name),d.logging.enabled&&console.timeEnd("buildWebWorkerCode");else{var a=function(a){f+=a,e(t,r)},i=new n.FileLoader;i.setPath(t),i.setResponseType("text"),i.load(r[0],a),r.shift()}}(s,a)}else this.loaderWorker.initWorker(c,u.name),this.logging.enabled&&console.timeEnd("buildWebWorkerCode")}},e.prototype.setCallbacks=function(e,t){this.loaderWorker.setCallbacks(e,t)},e.prototype.run=function(e){this.loaderWorker.run(e)},e.prototype.setTerminateRequested=function(e){this.loaderWorker.setTerminateRequested(e)};var i=function(e,t){var r,a=e+" = {\n";for(var n in t)r=t[n],"string"==typeof r||r instanceof String?(r=r.replace("\n","\\n"),r=r.replace("\r","\\r"),a+="\t"+n+': "'+r+'",\n'):r instanceof Array?a+="\t"+n+": ["+r+"],\n":Number.isInteger(r)?a+="\t"+n+": "+r+",\n":"function"==typeof r&&(a+="\t"+n+": "+r+",\n");return a+="}\n\n"},o=function(e,t,a,n,i){var o,s,l,u="",c=r.isValid(a)?a:t.name;i=r.verifyInput(i,[]);for(var d in t.prototype)s=t.prototype[d],"constructor"===d?(o=s.toString(),o=o.replace("function",""),l="\tfunction "+c+o+";\n\n"):"function"==typeof s&&i.indexOf(d)<0&&(o=s.toString(),u+="\t"+c+".prototype."+d+" = "+o+";\n\n");u+="\treturn "+c+";\n",u+="})();\n\n";var f="";return r.isValid(n)&&(f+="\n",f+=c+".prototype = Object.create( "+n+".prototype );\n",f+=c+".constructor = "+c+";\n",f+="\n"),r.isValid(l)?u=e+" = (function () {\n\n"+f+l+u:(l=e+" = (function () {\n\n",l+=f+"\t"+t.prototype.constructor.toString()+"\n\n",u=l+u),u};return e}(),l.WorkerDirector=function(){function e(e){if(console.info("Using THREE.LoaderSupport.WorkerDirector version: "+t),this.logging={enabled:!0,debug:!1},this.maxQueueSize=i,this.maxWebWorkers=a,this.crossOrigin=null,!r.isValid(e))throw"Provided invalid classDef: "+e;this.workerDescription={classDef:e,globalCallbacks:{},workerSupports:{},forceWorkerDataCopy:!0},this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0,this.callbackOnFinishedProcessing=null}var t="2.2.0",r=l.Validator,a=16,i=8192;return e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.getMaxQueueSize=function(){return this.maxQueueSize},e.prototype.getMaxWebWorkers=function(){return this.maxWebWorkers},e.prototype.setCrossOrigin=function(e){this.crossOrigin=e},e.prototype.setForceWorkerDataCopy=function(e){this.workerDescription.forceWorkerDataCopy=!0===e},e.prototype.prepareWorkers=function(e,t,o){r.isValid(e)&&(this.workerDescription.globalCallbacks=e),this.maxQueueSize=Math.min(t,i),this.maxWebWorkers=Math.min(o,a),this.maxWebWorkers=Math.min(this.maxWebWorkers,this.maxQueueSize),this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0;for(var s=0;s<this.maxWebWorkers;s++){var l=new n.LoaderSupport.WorkerSupport;l.setLogging(this.logging.enabled,this.logging.debug),l.setForceWorkerDataCopy(this.workerDescription.forceWorkerDataCopy),this.workerDescription.workerSupports[s]={instanceNo:s,inUse:!1,terminateRequested:!1,workerSupport:l,loader:null}}},e.prototype.enqueueForRun=function(e){this.instructionQueue.length<this.maxQueueSize&&this.instructionQueue.push(e)},e.prototype.isRunning=function(){var e=Object.keys(this.workerDescription.workerSupports);return this.instructionQueue.length>0&&this.instructionQueuePointer<this.instructionQueue.length||e.length>0},e.prototype.processQueue=function(){var e,t;for(var r in this.workerDescription.workerSupports)t=this.workerDescription.workerSupports[r],t.inUse||(this.instructionQueuePointer<this.instructionQueue.length?(e=this.instructionQueue[this.instructionQueuePointer],this._kickWorkerRun(e,t),this.instructionQueuePointer++):this._deregister(t));this.isRunning()||null===this.callbackOnFinishedProcessing||(this.callbackOnFinishedProcessing(),this.callbackOnFinishedProcessing=null)},e.prototype._kickWorkerRun=function(e,t){t.inUse=!0,t.workerSupport.setTerminateRequested(t.terminateRequested),this.logging.enabled&&console.info("\nAssigning next item from queue to worker (queue length: "+this.instructionQueue.length+")\n\n");var a=this,n=e.getCallbacks(),i=this.workerDescription.globalCallbacks,o=function(e){r.isValid(i.onLoad)&&i.onLoad(e),r.isValid(n.onLoad)&&n.onLoad(e),a.objectsCompleted++,t.inUse=!1,a.processQueue()},s=function(e){r.isValid(i.onProgress)&&i.onProgress(e),r.isValid(n.onProgress)&&n.onProgress(e)},u=function(e){r.isValid(i.onMeshAlter)&&i.onMeshAlter(e),r.isValid(n.onMeshAlter)&&n.onMeshAlter(e)};t.loader=this._buildLoader(t.instanceNo);var c=new l.Callbacks;c.setCallbackOnLoad(o),c.setCallbackOnProgress(s),c.setCallbackOnMeshAlter(u),e.callbacks=c,t.loader.run(e,t.workerSupport)},e.prototype._buildLoader=function(e){var t=this.workerDescription.classDef,a=Object.create(t.prototype);if(t.call(a,n.DefaultLoadingManager),!a.hasOwnProperty("instanceNo"))throw t.name+' has no property "instanceNo".';if(a.instanceNo=e,!a.hasOwnProperty("workerSupport"))throw t.name+' has no property "workerSupport".';if("function"!=typeof a.run)throw t.name+' has no function "run".';return a.hasOwnProperty("callbacks")&&r.isValid(a.callbacks)||(console.warn(t.name+' has an invalid property "callbacks". Will change to "THREE.LoaderSupport.Callbacks"'),a.callbacks=new n.LoaderSupport.Callbacks),a},e.prototype._deregister=function(e){if(r.isValid(e)){e.workerSupport.setTerminateRequested(!0),this.logging.enabled&&console.info("Requested termination of worker #"+e.instanceNo+".");var t=e.loader.callbacks;r.isValid(t.onProgress)&&t.onProgress({detail:{text:""}}),delete this.workerDescription.workerSupports[e.instanceNo]}},e.prototype.tearDown=function(e){this.logging.enabled&&console.info("WorkerDirector received the deregister call. Terminating all workers!"),this.instructionQueuePointer=this.instructionQueue.length,this.callbackOnFinishedProcessing=r.verifyInput(e,null);for(var t in this.workerDescription.workerSupports)this.workerDescription.workerSupports[t].terminateRequested=!0},e}(),t.default=l},function(e,t,r){(function(t){var r;r="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=r}).call(t,r(67))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(this.manager);o.setPath(this.path),o.load(e,function(e){t(i.parse(e))},r,a)},setPath:function(e){return this.path=e,this},setTexturePath:function(e){return this.texturePath=e,this},setBaseUrl:function(e){return console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e){for(var t=e.split("\n"),r={},a=/\s+/,n={},o=0;o<t.length;o++){var s=t[o];if(s=s.trim(),0!==s.length&&"#"!==s.charAt(0)){var l=s.indexOf(" "),u=l>=0?s.substring(0,l):s;u=u.toLowerCase();var c=l>=0?s.substring(l+1):"";if(c=c.trim(),"newmtl"===u)r={name:c},n[c]=r;else if(r)if("ka"===u||"kd"===u||"ks"===u){var d=c.split(a,3);r[u]=[parseFloat(d[0]),parseFloat(d[1]),parseFloat(d[2])]}else r[u]=c}}var f=new i.MaterialCreator(this.texturePath||this.path,this.materialOptions);return f.setCrossOrigin(this.crossOrigin),f.setManager(this.manager),f.setMaterials(n),f}},i.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:n.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:n.RepeatWrapping},i.MaterialCreator.prototype={constructor:i.MaterialCreator,crossOrigin:"Anonymous",setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var a=e[r],n={};t[r]=n;for(var i in a){var o=!0,s=a[i],l=i.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(n[l]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){function t(e,t){return"string"!=typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}function r(e,r){if(!o[e]){var n=a.getTextureParams(r,o),i=a.loadTexture(t(a.baseUrl,n.url));i.repeat.copy(n.scale),i.offset.copy(n.offset),i.wrapS=a.wrap,i.wrapT=a.wrap,o[e]=i}}var a=this,i=this.materialsInfo[e],o={name:e,side:this.side};for(var s in i){var l,u=i[s];if(""!==u)switch(s.toLowerCase()){case"kd":o.color=(new n.Color).fromArray(u);break;case"ks":o.specular=(new n.Color).fromArray(u);break;case"map_kd":r("map",u);break;case"map_ks":r("specularMap",u);break;case"norm":r("normalMap",u);break;case"map_bump":case"bump":r("bumpMap",u);break;case"ns":o.shininess=parseFloat(u);break;case"d":l=parseFloat(u),l<1&&(o.opacity=l,o.transparent=!0);break;case"tr":l=parseFloat(u),this.options&&this.options.invertTrProperty&&(l=1-l),l>0&&(o.opacity=1-l,o.transparent=!0)}}return this.materials[e]=new n.MeshPhongMaterial(o),this.materials[e]},getTextureParams:function(e,t){var r,a={scale:new n.Vector2(1,1),offset:new n.Vector2(0,0)},i=e.split(/\s+/);return r=i.indexOf("-bm"),r>=0&&(t.bumpScale=parseFloat(i[r+1]),i.splice(r,2)),r=i.indexOf("-s"),r>=0&&(a.scale.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),r=i.indexOf("-o"),r>=0&&(a.offset.set(parseFloat(i[r+1]),parseFloat(i[r+2])),i.splice(r,4)),a.url=i.join(" ").trim(),a},loadTexture:function(e,t,r,a,i){var o,s=n.Loader.Handlers.get(e),l=void 0!==this.manager?this.manager:n.DefaultLoadingManager;return null===s&&(s=new n.TextureLoader(l)),s.setCrossOrigin&&s.setCrossOrigin(this.crossOrigin),o=s.load(e,r,a,i),void 0!==t&&(o.mapping=t),o}},t.default=i},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(exports,"__esModule",{value:!0});var _three=__webpack_require__(0),THREE=_interopRequireWildcard(_three),Volume=function(e,t,r,a,n){if(arguments.length>0){switch(this.xLength=Number(e)||1,this.yLength=Number(t)||1,this.zLength=Number(r)||1,a){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":this.data=new Uint8Array(n);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(n);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(n);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(n);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(n);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(n);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw"Error in THREE.Volume constructor : this type is not supported in JavaScript";case"Float32":case"float32":case"float":this.data=new Float32Array(n);break;case"Float64":case"float64":case"double":this.data=new Float64Array(n);break;default:this.data=new Uint8Array(n)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw"Error in THREE.Volume constructor, lengths are not matching arrayBuffer size"}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new THREE.Matrix3,this.matrix.identity();var i=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return i},set:function(e){i=e,this.sliceList.forEach(function(e){e.geometryNeedsUpdate=!0})}});var o=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return o},set:function(e){o=e,this.sliceList.forEach(function(e){e.geometryNeedsUpdate=!0})}}),this.sliceList=[]};Volume.prototype={constructor:Volume,getData:function(e,t,r){return this.data[r*this.xLength*this.yLength+t*this.xLength+e]},access:function(e,t,r){return r*this.xLength*this.yLength+t*this.xLength+e},reverseAccess:function(e){var t=Math.floor(e/(this.yLength*this.xLength)),r=Math.floor((e-t*this.yLength*this.xLength)/this.xLength);return[e-t*this.yLength*this.xLength-r*this.xLength,r,t]},map:function(e,t){var r=this.data.length;t=t||this;for(var a=0;a<r;a++)this.data[a]=e.call(t,this.data[a],a,this.data);return this},extractPerpendicularPlane:function extractPerpendicularPlane(axis,RASIndex){var iLength,jLength,sliceAccess,planeMatrix=(new THREE.Matrix4).identity(),volume=this,planeWidth,planeHeight,firstSpacing,secondSpacing,positionOffset,IJKIndex,axisInIJK=new THREE.Vector3,firstDirection=new THREE.Vector3,secondDirection=new THREE.Vector3,dimensions=new THREE.Vector3(this.xLength,this.yLength,this.zLength);switch(axis){case"x":axisInIJK.set(1,0,0),firstDirection.set(0,0,-1),secondDirection.set(0,-1,0),firstSpacing=this.spacing[2],secondSpacing=this.spacing[1],IJKIndex=new THREE.Vector3(RASIndex,0,0),planeMatrix.multiply((new THREE.Matrix4).makeRotationY(Math.PI/2)),positionOffset=(volume.RASDimensions[0]-1)/2,planeMatrix.setPosition(new THREE.Vector3(RASIndex-positionOffset,0,0));break;case"y":axisInIJK.set(0,1,0),firstDirection.set(1,0,0),secondDirection.set(0,0,1),firstSpacing=this.spacing[0],secondSpacing=this.spacing[2],IJKIndex=new THREE.Vector3(0,RASIndex,0),planeMatrix.multiply((new THREE.Matrix4).makeRotationX(-Math.PI/2)),positionOffset=(volume.RASDimensions[1]-1)/2,planeMatrix.setPosition(new THREE.Vector3(0,RASIndex-positionOffset,0));break;case"z":default:axisInIJK.set(0,0,1),firstDirection.set(1,0,0),secondDirection.set(0,-1,0),firstSpacing=this.spacing[0],secondSpacing=this.spacing[1],IJKIndex=new THREE.Vector3(0,0,RASIndex),positionOffset=(volume.RASDimensions[2]-1)/2,planeMatrix.setPosition(new THREE.Vector3(0,0,RASIndex-positionOffset))}firstDirection.applyMatrix4(volume.inverseMatrix).normalize(),firstDirection.argVar="i",secondDirection.applyMatrix4(volume.inverseMatrix).normalize(),secondDirection.argVar="j",axisInIJK.applyMatrix4(volume.inverseMatrix).normalize(),iLength=Math.floor(Math.abs(firstDirection.dot(dimensions))),jLength=Math.floor(Math.abs(secondDirection.dot(dimensions))),planeWidth=Math.abs(iLength*firstSpacing),planeHeight=Math.abs(jLength*secondSpacing),IJKIndex=Math.abs(Math.round(IJKIndex.applyMatrix4(volume.inverseMatrix).dot(axisInIJK)));var base=[new THREE.Vector3(1,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1)],iDirection=[firstDirection,secondDirection,axisInIJK].find(function(e){return Math.abs(e.dot(base[0]))>.9}),jDirection=[firstDirection,secondDirection,axisInIJK].find(function(e){return Math.abs(e.dot(base[1]))>.9}),kDirection=[firstDirection,secondDirection,axisInIJK].find(function(e){return Math.abs(e.dot(base[2]))>.9}),argumentsWithInversion=["volume.xLength-1-","volume.yLength-1-","volume.zLength-1-"],argArray=[iDirection,jDirection,kDirection].map(function(e,t){return(e.dot(base[t])>0?"":argumentsWithInversion[t])+(e===axisInIJK?"IJKIndex":e.argVar)}),argString=argArray.join(",");return sliceAccess=eval("(function sliceAccess (i,j) {return volume.access( "+argString+");})"),{iLength:iLength,jLength:jLength,sliceAccess:sliceAccess,matrix:planeMatrix,planeWidth:planeWidth,planeHeight:planeHeight}},extractSlice:function(e,t){var r=new THREE.VolumeSlice(this,t,e);return this.sliceList.push(r),r},repaintAllSlices:function(){return this.sliceList.forEach(function(e){e.repaint()}),this},computeMinMax:function(){var e=1/0,t=-1/0,r=this.data.length,a=0;for(a=0;a<r;a++)if(!isNaN(this.data[a])){var n=this.data[a];e=Math.min(e,n),t=Math.max(t,n)}return this.min=e,this.max=t,[e,t]}},exports.default=Volume},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","float l = linearToRelativeLuminance( texel.rgb );","gl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","uniform sampler2D luminanceMap;","#else","uniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","#ifdef ADAPTED_LUMINANCE","float fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","#else","float fLumAvg = averageLuminance;","#endif","float fLumPixel = linearToRelativeLuminance( vColor );","float fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","return fLumCompressed * vColor;","}","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new n.Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(e){var t,r,a,n,i=2*Math.ceil(3*e)+1;for(i>25&&(i=25),n=.5*(i-1),r=new Array(i),a=0,t=0;t<i;++t)r[t]=function(e,t){return Math.exp(-e*e/(2*t*t))}(t-n,e),a+=r[t];for(t=0;t<i;++t)r[t]/=a;return r}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:1},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","vec2 aspectcorrect = vec2( 1.0, aspect );","float viewZ = getViewZ( getDepth( vUv ) );","float factor = ( focus + viewZ );","vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","vec2 dofblur9 = dofblur * 0.9;","vec2 dofblur7 = dofblur * 0.7;","vec2 dofblur4 = dofblur * 0.4;","vec4 col = vec4( 0.0 );","col += texture2D( tColor, vUv.xy );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","gl_FragColor = col / 41.0;","gl_FragColor.a = 1.0;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{tDiffuse:{value:null},tSize:{value:new n.Vector2(256,256)},center:{value:new n.Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","float s = sin( angle ), c = cos( angle );","vec2 tex = vUv * tSize - center;","vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","return ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","vec4 color = texture2D( tDiffuse, vUv );","float average = ( color.r + color.g + color.b ) / 3.0;","gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float dx = rand( vUv + time );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","if( grayscale ) {","cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","}","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(byp<1) {","vec2 p = vUv;","float xs = floor(gl_FragCoord.x / 0.5);","float ys = floor(gl_FragCoord.y / 0.5);","vec4 normal = texture2D (tDisp, p*seed*seed);","if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","if(seed_x>0.){","p.y = 1. - (p.y + distortion_y);","}","else {","p.y = distortion_y;","}","}","if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","if(seed_y>0.){","p.x=distortion_x;","}","else {","p.x = 1. - (p.x + distortion_x);","}","}","p.x+=normal.x*seed_x*(seed/5.);","p.y+=normal.y*seed_y*(seed/5.);","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, p + offset);","vec4 cga = texture2D(tDiffuse, p);","vec4 cb = texture2D(tDiffuse, p - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","gl_FragColor = gl_FragColor+ snow;","}","else {","gl_FragColor=texture2D (tDiffuse, vUv);","}","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:4},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:0},width:{value:1},height:{value:1},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:["varying vec2 vUV;","void main() {","vUV = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define SQRT2_MINUS_ONE 0.41421356","#define SQRT2_HALF_MINUS_ONE 0.20710678","#define PI2 6.28318531","#define SHAPE_DOT 1","#define SHAPE_ELLIPSE 2","#define SHAPE_LINE 3","#define SHAPE_SQUARE 4","#define BLENDING_LINEAR 1","#define BLENDING_MULTIPLY 2","#define BLENDING_ADD 3","#define BLENDING_LIGHTER 4","#define BLENDING_DARKER 5","uniform sampler2D tDiffuse;","uniform float radius;","uniform float rotateR;","uniform float rotateG;","uniform float rotateB;","uniform float scatter;","uniform float width;","uniform float height;","uniform int shape;","uniform bool disable;","uniform float blending;","uniform int blendingMode;","varying vec2 vUV;","uniform bool greyscale;","const int samples = 8;","float blend( float a, float b, float t ) {","return a * ( 1.0 - t ) + b * t;","}","float hypot( float x, float y ) {","return sqrt( x * x + y * y );","}","float rand( vec2 seed ){","return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}","float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {","float dist = hypot( coord.x - p.x, coord.y - p.y );","float rad = channel;","if ( shape == SHAPE_DOT ) {","rad = pow( abs( rad ), 1.125 ) * rad_max;","} else if ( shape == SHAPE_ELLIPSE ) {","rad = pow( abs( rad ), 1.125 ) * rad_max;","if ( dist != 0.0 ) {","float dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );","dist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;","}","} else if ( shape == SHAPE_LINE ) {","rad = pow( abs( rad ), 1.5) * rad_max;","float dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;","dist = hypot( normal.x * dot_p, normal.y * dot_p );","} else if ( shape == SHAPE_SQUARE ) {","float theta = atan( p.y - coord.y, p.x - coord.x ) - angle;","float sin_t = abs( sin( theta ) );","float cos_t = abs( cos( theta ) );","rad = pow( abs( rad ), 1.4 );","rad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );","}","return rad - dist;","}","struct Cell {","vec2 normal;","vec2 p1;","vec2 p2;","vec2 p3;","vec2 p4;","float samp2;","float samp1;","float samp3;","float samp4;","};","vec4 getSample( vec2 point ) {","vec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );","float base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;","float step = PI2 / float( samples );","float dist = radius * 0.66;","for ( int i = 0; i < samples; ++i ) {","float r = base + step * float( i );","vec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );","tex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );","}","tex /= float( samples ) + 1.0;","return tex;","}","float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {","float dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;","if ( channel == 0 ) {","c.samp1 = getSample( c.p1 ).r;","c.samp2 = getSample( c.p2 ).r;","c.samp3 = getSample( c.p3 ).r;","c.samp4 = getSample( c.p4 ).r;","} else if (channel == 1) {","c.samp1 = getSample( c.p1 ).g;","c.samp2 = getSample( c.p2 ).g;","c.samp3 = getSample( c.p3 ).g;","c.samp4 = getSample( c.p4 ).g;","} else {","c.samp1 = getSample( c.p1 ).b;","c.samp3 = getSample( c.p3 ).b;","c.samp2 = getSample( c.p2 ).b;","c.samp4 = getSample( c.p4 ).b;","}","dist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );","dist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );","dist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );","dist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );","res = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;","res += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;","res = clamp( res, 0.0, 1.0 );","return res;","}","Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {","Cell c;","vec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );","float threshold = step * 0.5;","float dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );","float dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );","vec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );","float offset_normal = mod( hypot( offset.x, offset.y ), step );","float normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;","float normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;","float offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );","float line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;","float line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;","c.normal = n;","c.p1.x = p.x - n.x * normal_scale + n.y * line_scale;","c.p1.y = p.y - n.y * normal_scale - n.x * line_scale;","if ( scatter != 0.0 ) {","float off_mag = scatter * threshold * 0.5;","float off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;","c.p1.x += cos( off_angle ) * off_mag;","c.p1.y += sin( off_angle ) * off_mag;","}","float normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );","float line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );","c.p2.x = c.p1.x - n.x * normal_step;","c.p2.y = c.p1.y - n.y * normal_step;","c.p3.x = c.p1.x + n.y * line_step;","c.p3.y = c.p1.y - n.x * line_step;","c.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;","c.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;","return c;","}","float blendColour( float a, float b, float t ) {","if ( blendingMode == BLENDING_LINEAR ) {","return blend( a, b, 1.0 - t );","} else if ( blendingMode == BLENDING_ADD ) {","return blend( a, min( 1.0, a + b ), t );","} else if ( blendingMode == BLENDING_MULTIPLY ) {","return blend( a, max( 0.0, a * b ), t );","} else if ( blendingMode == BLENDING_LIGHTER ) {","return blend( a, max( a, b ), t );","} else if ( blendingMode == BLENDING_DARKER ) {","return blend( a, min( a, b ), t );","} else {","return blend( a, b, 1.0 - t );","}","}","void main() {","if ( ! disable ) {","vec2 p = vec2( vUV.x * width, vUV.y * height );","vec2 origin = vec2( 0, 0 );","float aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;","Cell cell_r = getReferenceCell( p, origin, rotateR, radius );","Cell cell_g = getReferenceCell( p, origin, rotateG, radius );","Cell cell_b = getReferenceCell( p, origin, rotateB, radius );","float r = getDotColour( cell_r, p, 0, rotateR, aa );","float g = getDotColour( cell_g, p, 1, rotateG, aa );","float b = getDotColour( cell_b, p, 2, rotateB, aa );","vec4 colour = texture2D( tDiffuse, vUV );","r = blendColour( r, colour.r, blending );","g = blendColour( g, colour.g, blending );","b = blendColour( b, colour.b, blending );","if ( greyscale ) {","r = g = b = (r + b + g) / 3.0;","}","gl_FragColor = vec4( r, g, b, 1.0 );","} else {","gl_FragColor = texture2D( tDiffuse, vUV );","}","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{type:"t",value:null},tDiffuse:{type:"t",value:null},tNormal:{type:"t",value:null},size:{type:"v2",value:new n.Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},cameraProjectionMatrix:{type:"m4",value:new n.Matrix4},cameraInverseProjectionMatrix:{type:"m4",value:new n.Matrix4},scale:{type:"f",value:1},intensity:{type:"f",value:.1},bias:{type:"f",value:.5},minResolution:{type:"f",value:0},kernelRadius:{type:"f",value:100},randomSeed:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new n.Vector2(512,512)},sampleUvOffsets:{type:"v2v",value:[new n.Vector2(0,0)]},sampleWeights:{type:"1fv",value:[1]},tDepth:{type:"t",value:null},cameraNear:{type:"f",value:10},cameraFar:{type:"f",value:1e3},depthCutoff:{type:"f",value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","gl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={createSampleWeights:function(e,t){for(var r=[],a=0;a<=e;a++)r.push(function(e,t){return Math.exp(-e*e/(t*t*2))/(Math.sqrt(2*Math.PI)*t)}(a,t));return r},createSampleOffsets:function(e,t){for(var r=[],a=0;a<=e;a++)r.push(t.clone().multiplyScalar(a));return r},configure:function(e,t,r,n){e.defines.KERNEL_RADIUS=t,e.uniforms.sampleUvOffsets.value=a.createSampleOffsets(t,n),e.uniforms.sampleWeights.value=a.createSampleWeights(t,r),e.needsUpdate=!0}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=[{defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new n.Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","void SMAAEdgeDetectionVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );","vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );","}","void main() {","vUv = uv;","SMAAEdgeDetectionVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {","vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );","vec4 delta;","vec3 C = texture2D( colorTex, texcoord ).rgb;","vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;","vec3 t = abs( C - Cleft );","delta.x = max( max( t.r, t.g ), t.b );","vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;","t = abs( C - Ctop );","delta.y = max( max( t.r, t.g ), t.b );","vec2 edges = step( threshold, delta.xy );","if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )","discard;","vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;","t = abs( C - Cright );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;","t = abs( C - Cbottom );","delta.w = max( max( t.r, t.g ), t.b );","float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );","vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;","t = abs( C - Cleftleft );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;","t = abs( C - Ctoptop );","delta.w = max( max( t.r, t.g ), t.b );","maxDelta = max( max( maxDelta, delta.z ), delta.w );","edges.xy *= step( 0.5 * maxDelta, delta.xy );","return vec4( edges, 0.0, 0.0 );","}","void main() {","gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );","}"].join("\n")},{defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new n.Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","varying vec2 vPixcoord;","void SMAABlendingWeightCalculationVS( vec2 texcoord ) {","vPixcoord = texcoord / resolution;","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );","vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );","}","void main() {","vUv = uv;","SMAABlendingWeightCalculationVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )","uniform sampler2D tDiffuse;","uniform sampler2D tArea;","uniform sampler2D tSearch;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[3];","varying vec2 vPixcoord;","vec2 round( vec2 x ) {","return sign( x ) * floor( abs( x ) + 0.5 );","}","float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {","e.r = bias + e.r * scale;","return 255.0 * texture2D( searchTex, e, 0.0 ).r;","}","float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x += 0.25 * resolution.x;","texcoord.x += resolution.x;","texcoord.x += 2.0 * resolution.x;","texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);","return texcoord.x;","}","float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x -= 0.25 * resolution.x;","texcoord.x -= resolution.x;","texcoord.x -= 2.0 * resolution.x;","texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );","return texcoord.x;","}","float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y -= 0.25 * resolution.y;","texcoord.y -= resolution.y;","texcoord.y -= 2.0 * resolution.y;","texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );","return texcoord.y;","}","float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y += 0.25 * resolution.y;","texcoord.y += resolution.y;","texcoord.y += 2.0 * resolution.y;","texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );","return texcoord.y;","}","vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {","vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;","texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );","texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;","return texture2D( areaTex, texcoord, 0.0 ).rg;","}","vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {","vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );","vec2 e = texture2D( edgesTex, texcoord ).rg;","if ( e.g > 0.0 ) {","vec2 d;","vec2 coords;","coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );","coords.y = offset[ 1 ].y;","d.x = coords.x;","float e1 = texture2D( edgesTex, coords, 0.0 ).r;","coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );","d.y = coords.x;","d = d / resolution.x - pixcoord.x;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;","weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );","}","if ( e.r > 0.0 ) {","vec2 d;","vec2 coords;","coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );","coords.x = offset[ 0 ].x;","d.x = coords.y;","float e1 = texture2D( edgesTex, coords, 0.0 ).g;","coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );","d.y = coords.y;","d = d / resolution.y - pixcoord.y;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;","weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );","}","return weights;","}","void main() {","gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );","}"].join("\n")},{uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new n.Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","void SMAANeighborhoodBlendingVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );","}","void main() {","vUv = uv;","SMAANeighborhoodBlendingVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tColor;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {","vec4 a;","a.xz = texture2D( blendTex, texcoord ).xz;","a.y = texture2D( blendTex, offset[ 1 ].zw ).g;","a.w = texture2D( blendTex, offset[ 1 ].xy ).a;","if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {","return texture2D( colorTex, texcoord, 0.0 );","} else {","vec2 offset;","offset.x = a.a > a.b ? a.a : -a.b;","offset.y = a.g > a.r ? -a.g : a.r;","if ( abs( offset.x ) > abs( offset.y )) {","offset.y = 0.0;","} else {","offset.x = 0.0;","}","vec4 C = texture2D( colorTex, texcoord, 0.0 );","texcoord += sign( offset ) * resolution;","vec4 Cop = texture2D( colorTex, texcoord, 0.0 );","float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );","C.xyz = pow(C.xyz, vec3(2.2));","Cop.xyz = pow(Cop.xyz, vec3(2.2));","vec4 mixed = mix(C, Cop, s);","mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));","return mixed;","}","}","void main() {","gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );","}"].join("\n")}];t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(2),u=a(l),c=function(e,t,r,a){s.default.call(this),this.scene=e,this.camera=t,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==r?r:0,this.clearAlpha=void 0!==a?a:0,void 0===u.default&&console.error("THREE.SSAARenderPass relies on THREE.CopyShader");var n=u.default;this.copyUniforms=i.UniformsUtils.clone(n.uniforms),this.copyMaterial=new i.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:i.AdditiveBlending,depthTest:!1,depthWrite:!1}),this.camera2=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene2=new i.Scene,this.quad2=new i.Mesh(new i.PlaneBufferGeometry(2,2),this.copyMaterial),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2)};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(e,t){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,t)},render:function(e,t,r){this.sampleRenderTarget||(this.sampleRenderTarget=new i.WebGLRenderTarget(r.width,r.height,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBAFormat}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");var a=c.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],n=e.autoClear;e.autoClear=!1;var o=e.getClearColor().getHex(),s=e.getClearAlpha(),l=1/a.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;for(var u=r.width,d=r.height,f=0;f<a.length;f++){var h=a[f];this.camera.setViewOffset&&this.camera.setViewOffset(u,d,.0625*h[0],.0625*h[1],u,d);var p=l;if(this.unbiased){p+=1/32*((f+.5)/a.length-.5)}this.copyUniforms.opacity.value=p,e.setClearColor(this.clearColor,this.clearAlpha),e.render(this.scene,this.camera,this.sampleRenderTarget,!0),0===f&&e.setClearColor(0,0),e.render(this.scene2,this.camera2,this.renderToScreen?null:t,0===f)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),e.autoClear=n,e.setClearColor(o,s)}}),c.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]],t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{tDiffuse:{value:null},tDepth:{value:null},size:{value:new n.Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},radius:{value:32},onlyAO:{value:0},aoClamp:{value:.25},lumInfluence:{value:.7}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cameraNear;","uniform float cameraFar;","#ifdef USE_LOGDEPTHBUF","uniform float logDepthBufFC;","#endif","uniform float radius;","uniform bool onlyAO;","uniform vec2 size;","uniform float aoClamp;","uniform float lumInfluence;","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","varying vec2 vUv;","#define DL 2.399963229728653","#define EULER 2.718281828459045","const int samples = 64;","const bool useNoise = true;","const float noiseAmount = 0.0004;","const float diffArea = 0.4;","const float gDisplace = 0.4;","#include <packing>","vec2 rand( const vec2 coord ) {","vec2 noise;","if ( useNoise ) {","float nx = dot ( coord, vec2( 12.9898, 78.233 ) );","float ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );","noise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );","} else {","float ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );","float gg = fract( coord.t * ( size.y / 2.0 ) );","noise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;","}","return ( noise * 2.0  - 1.0 ) * noiseAmount;","}","float readDepth( const in vec2 coord ) {","float cameraFarPlusNear = cameraFar + cameraNear;","float cameraFarMinusNear = cameraFar - cameraNear;","float cameraCoef = 2.0 * cameraNear;","#ifdef USE_LOGDEPTHBUF","float logz = unpackRGBAToDepth( texture2D( tDepth, coord ) );","float w = pow(2.0, (logz / logDepthBufFC)) - 1.0;","float z = (logz / w) + 1.0;","#else","float z = unpackRGBAToDepth( texture2D( tDepth, coord ) );","#endif","return cameraCoef / ( cameraFarPlusNear - z * cameraFarMinusNear );","}","float compareDepths( const in float depth1, const in float depth2, inout int far ) {","float garea = 8.0;","float diff = ( depth1 - depth2 ) * 100.0;","if ( diff < gDisplace ) {","garea = diffArea;","} else {","far = 1;","}","float dd = diff - gDisplace;","float gauss = pow( EULER, -2.0 * ( dd * dd ) / ( garea * garea ) );","return gauss;","}","float calcAO( float depth, float dw, float dh ) {","vec2 vv = vec2( dw, dh );","vec2 coord1 = vUv + radius * vv;","vec2 coord2 = vUv - radius * vv;","float temp1 = 0.0;","float temp2 = 0.0;","int far = 0;","temp1 = compareDepths( depth, readDepth( coord1 ), far );","if ( far > 0 ) {","temp2 = compareDepths( readDepth( coord2 ), depth, far );","temp1 += ( 1.0 - temp1 ) * temp2;","}","return temp1;","}","void main() {","vec2 noise = rand( vUv );","float depth = readDepth( vUv );","float tt = clamp( depth, aoClamp, 1.0 );","float w = ( 1.0 / size.x ) / tt + ( noise.x * ( 1.0 - noise.x ) );","float h = ( 1.0 / size.y ) / tt + ( noise.y * ( 1.0 - noise.y ) );","float ao = 0.0;","float dz = 1.0 / float( samples );","float l = 0.0;","float z = 1.0 - dz / 2.0;","for ( int i = 0; i <= samples; i ++ ) {","float r = sqrt( 1.0 - z );","float pw = cos( l ) * r;","float ph = sin( l ) * r;","ao += calcAO( depth, pw * w, ph * h );","z = z - dz;","l = l + DL;","}","ao /= float( samples );","ao = 1.0 - ao;","vec3 color = texture2D( tDiffuse, vUv ).rgb;","vec3 lumcoeff = vec3( 0.299, 0.587, 0.114 );","float lum = dot( color.rgb, lumcoeff );","vec3 luminance = vec3( lum );","vec3 final = vec3( color * mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","if ( onlyAO ) {","final = vec3( mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","}","gl_FragColor = vec4( final, 1.0 );","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{type:"t",value:null},luminosityThreshold:{type:"f",value:1},smoothWidth:{type:"f",value:1},defaultColor:{type:"c",value:new n.Color(0)},defaultOpacity:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(28);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var n=r(40);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(48);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=r(90);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var s=r(112);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var l=r(144);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})})},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.VRControls=t.TransformControls=t.TrackballControls=t.PointerLockControls=t.OrthographicTrackballControls=t.OrbitControls=t.FlyControls=t.FirstPersonControls=t.EditorControls=t.DragControls=t.DeviceOrientationControls=void 0;var n=r(29),i=a(n),o=r(30),s=a(o),l=r(31),u=a(l),c=r(32),d=a(c),f=r(33),h=a(f),p=r(34),m=a(p),v=r(35),g=a(v),y=r(36),x=a(y),b=r(37),A=a(b),w=r(38),M=a(w),T=r(39),S=a(T);t.DeviceOrientationControls=i.default,t.DragControls=s.default,t.EditorControls=u.default,t.FirstPersonControls=d.default,t.FlyControls=h.default,t.OrbitControls=m.default,t.OrthographicTrackballControls=g.default,t.PointerLockControls=x.default,t.TrackballControls=A.default,t.TransformControls=M.default,t.VRControls=S.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var r=function(e){t.deviceOrientation=e},a=function(){t.screenOrientation=window.orientation||0},i=function(){var e=new n.Vector3(0,0,1),t=new n.Euler,r=new n.Quaternion,a=new n.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(n,i,o,s,l){t.set(o,i,-s,"YXZ"),n.setFromEuler(t),n.multiply(a),n.multiply(r.setFromAxisAngle(e,-l))}}();this.connect=function(){a(),window.addEventListener("orientationchange",a,!1),window.addEventListener("deviceorientation",r,!1),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",a,!1),window.removeEventListener("deviceorientation",r,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation;if(e){var r=e.alpha?n.Math.degToRad(e.alpha)+t.alphaOffset:0,a=e.beta?n.Math.degToRad(e.beta):0,o=e.gamma?n.Math.degToRad(e.gamma):0,s=t.screenOrientation?n.Math.degToRad(t.screenOrientation):0;i(t.object.quaternion,r,a,o,s)}}},this.dispose=function(){t.disconnect()},this.connect()};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t,r){function a(){r.addEventListener("mousemove",s,!1),r.addEventListener("mousedown",l,!1),r.addEventListener("mouseup",u,!1),r.addEventListener("mouseleave",u,!1),r.addEventListener("touchmove",c,!1),r.addEventListener("touchstart",d,!1),r.addEventListener("touchend",f,!1)}function i(){r.removeEventListener("mousemove",s,!1),r.removeEventListener("mousedown",l,!1),r.removeEventListener("mouseup",u,!1),r.removeEventListener("mouseleave",u,!1),r.removeEventListener("touchmove",c,!1),r.removeEventListener("touchstart",d,!1),r.removeEventListener("touchend",f,!1)}function o(){i()}function s(a){a.preventDefault();var n=r.getBoundingClientRect();if(v.x=(a.clientX-n.left)/n.width*2-1,v.y=-(a.clientY-n.top)/n.height*2+1,m.setFromCamera(v,t),x&&A.enabled)return m.ray.intersectPlane(p,y)&&x.position.copy(y.sub(g)),void A.dispatchEvent({type:"drag",object:x});m.setFromCamera(v,t);var i=m.intersectObjects(e);if(i.length>0){var o=i[0].object;p.setFromNormalAndCoplanarPoint(t.getWorldDirection(p.normal),o.position),b!==o&&(A.dispatchEvent({type:"hoveron",object:o}),r.style.cursor="pointer",b=o)}else null!==b&&(A.dispatchEvent({type:"hoveroff",object:b}),r.style.cursor="auto",b=null)}function l(a){a.preventDefault(),m.setFromCamera(v,t);var n=m.intersectObjects(e);n.length>0&&(x=n[0].object,m.ray.intersectPlane(p,y)&&g.copy(y).sub(x.position),r.style.cursor="move",A.dispatchEvent({type:"dragstart",object:x}))}function u(e){e.preventDefault(),x&&(A.dispatchEvent({type:"dragend",object:x}),x=null),r.style.cursor="auto"}function c(e){e.preventDefault(),e=e.changedTouches[0];var a=r.getBoundingClientRect();if(v.x=(e.clientX-a.left)/a.width*2-1,v.y=-(e.clientY-a.top)/a.height*2+1,m.setFromCamera(v,t),x&&A.enabled)return m.ray.intersectPlane(p,y)&&x.position.copy(y.sub(g)),void A.dispatchEvent({type:"drag",object:x})}function d(a){a.preventDefault(),a=a.changedTouches[0];var n=r.getBoundingClientRect();v.x=(a.clientX-n.left)/n.width*2-1,v.y=-(a.clientY-n.top)/n.height*2+1,m.setFromCamera(v,t);var i=m.intersectObjects(e);i.length>0&&(x=i[0].object,p.setFromNormalAndCoplanarPoint(t.getWorldDirection(p.normal),x.position),m.ray.intersectPlane(p,y)&&g.copy(y).sub(x.position),r.style.cursor="move",A.dispatchEvent({type:"dragstart",object:x}))}function f(e){e.preventDefault(),x&&(A.dispatchEvent({type:"dragend",object:x}),x=null),r.style.cursor="auto"}if(e instanceof n.Camera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var h=e;e=t,t=h}var p=new n.Plane,m=new n.Raycaster,v=new n.Vector2,g=new n.Vector3,y=new n.Vector3,x=null,b=null,A=this;a(),this.enabled=!0,this.activate=a,this.deactivate=i,this.dispose=o,this.setObjects=function(){console.error("THREE.DragControls: setObjects() has been removed.")},this.on=function(e,t){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead."),A.addEventListener(e,t)},this.off=function(e,t){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead."),A.removeEventListener(e,t)},this.notify=function(e){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead."),A.dispatchEvent({type:e})}};i.prototype=Object.create(n.EventDispatcher.prototype),i.prototype.constructor=i,t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){function r(e){!1!==c.enabled&&(0===e.button?h=f.ROTATE:1===e.button?h=f.ZOOM:2===e.button&&(h=f.PAN),g.set(e.clientX,e.clientY),t.addEventListener("mousemove",a,!1),t.addEventListener("mouseup",i,!1),t.addEventListener("mouseout",i,!1),t.addEventListener("dblclick",i,!1))}function a(e){if(!1!==c.enabled){v.set(e.clientX,e.clientY);var t=v.x-g.x,r=v.y-g.y;h===f.ROTATE?c.rotate(new n.Vector3(-t*c.rotationSpeed,-r*c.rotationSpeed,0)):h===f.ZOOM?c.zoom(new n.Vector3(0,0,r)):h===f.PAN&&c.pan(new n.Vector3(-t,r,0)),g.set(e.clientX,e.clientY)}}function i(e){t.removeEventListener("mousemove",a,!1),t.removeEventListener("mouseup",i,!1),t.removeEventListener("mouseout",i,!1),t.removeEventListener("dblclick",i,!1),h=f.NONE}function o(e){e.preventDefault(),c.zoom(new n.Vector3(0,0,e.deltaY))}function s(e){e.preventDefault()}function l(e){if(!1!==c.enabled){switch(e.touches.length){case 1:b[0].set(e.touches[0].pageX,e.touches[0].pageY,0),b[1].set(e.touches[0].pageX,e.touches[0].pageY,0);break;case 2:b[0].set(e.touches[0].pageX,e.touches[0].pageY,0),b[1].set(e.touches[1].pageX,e.touches[1].pageY,0),w=b[0].distanceTo(b[1])}A[0].copy(b[0]),A[1].copy(b[1])}}function u(e){function t(e,t){var r=t[0];for(var a in t)r.distanceTo(e)>t[a].distanceTo(e)&&(r=t[a]);return r}if(!1!==c.enabled){switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:b[0].set(e.touches[0].pageX,e.touches[0].pageY,0),b[1].set(e.touches[0].pageX,e.touches[0].pageY,0),c.rotate(b[0].sub(t(b[0],A)).multiplyScalar(-c.rotationSpeed));break;case 2:b[0].set(e.touches[0].pageX,e.touches[0].pageY,0),b[1].set(e.touches[1].pageX,e.touches[1].pageY,0);var r=b[0].distanceTo(b[1]);c.zoom(new n.Vector3(0,0,w-r)),w=r;var a=b[0].clone().sub(t(b[0],A)),i=b[1].clone().sub(t(b[1],A));a.x=-a.x,i.x=-i.x,c.pan(a.add(i).multiplyScalar(.5))}A[0].copy(b[0]),A[1].copy(b[1])}}t=void 0!==t?t:document,this.enabled=!0,this.center=new n.Vector3,this.panSpeed=.001,this.zoomSpeed=.001,this.rotationSpeed=.005;var c=this,d=new n.Vector3,f={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},h=f.NONE,p=this.center,m=new n.Matrix3,v=new n.Vector2,g=new n.Vector2,y=new n.Spherical,x={type:"change"};this.focus=function(t){var r,a=(new n.Box3).setFromObject(t);!1===a.isEmpty()?(p.copy(a.getCenter()),r=a.getBoundingSphere().radius):(p.setFromMatrixPosition(t.matrixWorld),r=.1);var i=new n.Vector3(0,0,1);i.applyQuaternion(e.quaternion),i.multiplyScalar(4*r),e.position.copy(p).add(i),c.dispatchEvent(x)},this.pan=function(t){var r=e.position.distanceTo(p);t.multiplyScalar(r*c.panSpeed),t.applyMatrix3(m.getNormalMatrix(e.matrix)),e.position.add(t),p.add(t),c.dispatchEvent(x)},this.zoom=function(t){var r=e.position.distanceTo(p);t.multiplyScalar(r*c.zoomSpeed),t.length()>r||(t.applyMatrix3(m.getNormalMatrix(e.matrix)),e.position.add(t),c.dispatchEvent(x))},this.rotate=function(t){d.copy(e.position).sub(p),y.setFromVector3(d),y.theta+=t.x,y.phi+=t.y,y.makeSafe(),d.setFromSpherical(y),e.position.copy(p).add(d),e.lookAt(p),c.dispatchEvent(x)},this.dispose=function(){t.removeEventListener("contextmenu",s,!1),t.removeEventListener("mousedown",r,!1),t.removeEventListener("wheel",o,!1),t.removeEventListener("mousemove",a,!1),t.removeEventListener("mouseup",i,!1),t.removeEventListener("mouseout",i,!1),t.removeEventListener("dblclick",i,!1),t.removeEventListener("touchstart",l,!1),t.removeEventListener("touchmove",u,!1)},t.addEventListener("contextmenu",s,!1),t.addEventListener("mousedown",r,!1),t.addEventListener("wheel",o,!1);var b=[new n.Vector3,new n.Vector3,new n.Vector3],A=[new n.Vector3,new n.Vector3,new n.Vector3],w=null;t.addEventListener("touchstart",l,!1),t.addEventListener("touchmove",u,!1)};i.prototype=Object.create(n.EventDispatcher.prototype),i.prototype.constructor=i,t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){function r(e){e.preventDefault()}function a(e,t){return function(){t.apply(e,arguments)}}this.object=e,this.target=new n.Vector3(0,0,0),this.domElement=void 0!==t?t:document,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(e){if(e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(e){this.domElement===document?(this.mouseX=e.pageX-this.viewHalfX,this.mouseY=e.pageY-this.viewHalfY):(this.mouseX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=e.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}},this.onKeyUp=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.update=function(e){if(!1!==this.enabled){if(this.heightSpeed){var t=n.Math.clamp(this.object.position.y,this.heightMin,this.heightMax),r=t-this.heightMin;this.autoSpeedFactor=e*(r*this.heightCoef)}else this.autoSpeedFactor=0;var a=e*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(a+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(a),this.moveLeft&&this.object.translateX(-a),this.moveRight&&this.object.translateX(a),this.moveUp&&this.object.translateY(a),this.moveDown&&this.object.translateY(-a);var i=e*this.lookSpeed;this.activeLook||(i=0);var o=1;this.constrainVertical&&(o=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*i,this.lookVertical&&(this.lat-=this.mouseY*i*o),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=n.Math.degToRad(90-this.lat),this.theta=n.Math.degToRad(this.lon),this.constrainVertical&&(this.phi=n.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));var s=this.target,l=this.object.position;s.x=l.x+100*Math.sin(this.phi)*Math.cos(this.theta),s.y=l.y+100*Math.cos(this.phi),s.z=l.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(s)}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",r,!1),this.domElement.removeEventListener("mousedown",o,!1),this.domElement.removeEventListener("mousemove",i,!1),this.domElement.removeEventListener("mouseup",s,!1),window.removeEventListener("keydown",l,!1),window.removeEventListener("keyup",u,!1)};var i=a(this,this.onMouseMove),o=a(this,this.onMouseDown),s=a(this,this.onMouseUp),l=a(this,this.onKeyDown),u=a(this,this.onKeyUp);this.domElement.addEventListener("contextmenu",r,!1),this.domElement.addEventListener("mousemove",i,!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mouseup",s,!1),window.addEventListener("keydown",l,!1),window.addEventListener("keyup",u,!1),this.handleResize()};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){function r(e,t){return function(){t.apply(e,arguments)}}function a(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,t&&this.domElement.setAttribute("tabindex",-1),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this.tmpQuaternion=new n.Quaternion,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new n.Vector3(0,0,0),this.rotationVector=new n.Vector3(0,0,0),this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)},this.keydown=function(e){if(!e.altKey){switch(e.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(e){switch(e.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(e){if(!this.dragToLook||this.mouseStatus>0){var t=this.getContainerDimensions(),r=t.size[0]/2,a=t.size[1]/2;this.moveState.yawLeft=-(e.pageX-t.offset[0]-r)/r,this.moveState.pitchDown=(e.pageY-t.offset[1]-a)/a,this.updateRotationVector()}},this.mouseup=function(e){if(e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(e){var t=e*this.movementSpeed,r=e*this.rollSpeed;this.object.translateX(this.moveVector.x*t),this.object.translateY(this.moveVector.y*t),this.object.translateZ(this.moveVector.z*t),this.tmpQuaternion.set(this.rotationVector.x*r,this.rotationVector.y*r,this.rotationVector.z*r,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),this.object.rotation.setFromQuaternion(this.object.quaternion,this.object.rotation.order)},this.updateMovementVector=function(){var e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-e+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",a,!1),this.domElement.removeEventListener("mousedown",o,!1),this.domElement.removeEventListener("mousemove",i,!1),this.domElement.removeEventListener("mouseup",s,!1),window.removeEventListener("keydown",l,!1),window.removeEventListener("keyup",u,!1)};var i=r(this,this.mousemove),o=r(this,this.mousedown),s=r(this,this.mouseup),l=r(this,this.keydown),u=r(this,this.keyup);this.domElement.addEventListener("contextmenu",a,!1),this.domElement.addEventListener("mousemove",i,!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mouseup",s,!1),window.addEventListener("keydown",l,!1),window.addEventListener("keyup",u,!1),this.updateMovementVector(),this.updateRotationVector()};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){function r(){return 2*Math.PI/60/60*N.autoRotateSpeed}function a(){return Math.pow(.95,N.zoomSpeed)}function i(e){j.theta-=e}function o(e){j.phi-=e}function s(e){N.object.isPerspectiveCamera?V/=e:N.object.isOrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom*e)),N.object.updateProjectionMatrix(),z=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function l(e){N.object.isPerspectiveCamera?V*=e:N.object.isOrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom/e)),N.object.updateProjectionMatrix(),z=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function u(e){H.set(e.clientX,e.clientY)}function c(e){K.set(e.clientX,e.clientY)}function d(e){W.set(e.clientX,e.clientY)}function f(e){X.set(e.clientX,e.clientY),Y.subVectors(X,H).multiplyScalar(N.rotateSpeed);var t=N.domElement===document?N.domElement.body:N.domElement;i(2*Math.PI*Y.x/t.clientHeight),o(2*Math.PI*Y.y/t.clientHeight),H.copy(X),N.update()}function h(e){Z.set(e.clientX,e.clientY),J.subVectors(Z,K),J.y>0?s(a()):J.y<0&&l(a()),K.copy(Z),N.update()}function p(e){Q.set(e.clientX,e.clientY),q.subVectors(Q,W).multiplyScalar(N.panSpeed),te(q.x,q.y),W.copy(Q),N.update()}function m(e){}function v(e){e.deltaY<0?l(a()):e.deltaY>0&&s(a()),N.update()}function g(e){switch(e.keyCode){case N.keys.UP:te(0,N.keyPanSpeed),N.update();break;case N.keys.BOTTOM:te(0,-N.keyPanSpeed),N.update();break;case N.keys.LEFT:te(N.keyPanSpeed,0),N.update();break;case N.keys.RIGHT:te(-N.keyPanSpeed,0),N.update()}}function y(e){H.set(e.touches[0].pageX,e.touches[0].pageY)}function x(e){if(N.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);K.set(0,a)}if(N.enablePan){var n=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);W.set(n,i)}}function b(e){X.set(e.touches[0].pageX,e.touches[0].pageY),Y.subVectors(X,H).multiplyScalar(N.rotateSpeed);var t=N.domElement===document?N.domElement.body:N.domElement;i(2*Math.PI*Y.x/t.clientHeight),o(2*Math.PI*Y.y/t.clientHeight),H.copy(X),N.update()}function A(e){if(N.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);Z.set(0,a),J.set(0,Math.pow(Z.y/K.y,N.zoomSpeed)),s(J.y),K.copy(Z)}if(N.enablePan){var n=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);Q.set(n,i),q.subVectors(Q,W).multiplyScalar(N.panSpeed),te(q.x,q.y),W.copy(Q)}N.update()}function w(e){}function M(e){if(!1!==N.enabled){switch(e.preventDefault(),e.button){case N.mouseButtons.ORBIT:if(!1===N.enableRotate)return;u(e),R=D.ROTATE;break;case N.mouseButtons.ZOOM:if(!1===N.enableZoom)return;c(e),R=D.DOLLY;break;case N.mouseButtons.PAN:if(!1===N.enablePan)return;d(e),R=D.PAN}R!==D.NONE&&(document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",S,!1),N.dispatchEvent(I))}}function T(e){if(!1!==N.enabled)switch(e.preventDefault(),R){case D.ROTATE:if(!1===N.enableRotate)return;f(e);break;case D.DOLLY:if(!1===N.enableZoom)return;h(e);break;case D.PAN:if(!1===N.enablePan)return;p(e)}}function S(e){!1!==N.enabled&&(m(e),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",S,!1),N.dispatchEvent(U),R=D.NONE)}function F(e){!1===N.enabled||!1===N.enableZoom||R!==D.NONE&&R!==D.ROTATE||(e.preventDefault(),e.stopPropagation(),N.dispatchEvent(I),v(e),N.dispatchEvent(U))}function E(e){!1!==N.enabled&&!1!==N.enableKeys&&!1!==N.enablePan&&g(e)}function _(e){if(!1!==N.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===N.enableRotate)return;y(e),R=D.TOUCH_ROTATE;break;case 2:if(!1===N.enableZoom&&!1===N.enablePan)return;x(e),R=D.TOUCH_DOLLY_PAN;break;default:R=D.NONE}R!==D.NONE&&N.dispatchEvent(I)}}function P(e){if(!1!==N.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===N.enableRotate)return;if(R!==D.TOUCH_ROTATE)return;b(e);break;case 2:if(!1===N.enableZoom&&!1===N.enablePan)return;if(R!==D.TOUCH_DOLLY_PAN)return;A(e);break;default:R=D.NONE}}function L(e){!1!==N.enabled&&(w(e),N.dispatchEvent(U),R=D.NONE)}function C(e){!1!==N.enabled&&e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new n.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:n.MOUSE.LEFT,ZOOM:n.MOUSE.MIDDLE,PAN:n.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return B.phi},this.getAzimuthalAngle=function(){return B.theta},this.saveState=function(){N.target0.copy(N.target),N.position0.copy(N.object.position),N.zoom0=N.object.zoom},this.reset=function(){N.target.copy(N.target0),N.object.position.copy(N.position0),N.object.zoom=N.zoom0,N.object.updateProjectionMatrix(),N.dispatchEvent(O),N.update(),R=D.NONE},this.update=function(){var t=new n.Vector3,a=(new n.Quaternion).setFromUnitVectors(e.up,new n.Vector3(0,1,0)),o=a.clone().inverse(),s=new n.Vector3,l=new n.Quaternion;return function(){var e=N.object.position;return t.copy(e).sub(N.target),t.applyQuaternion(a),B.setFromVector3(t),N.autoRotate&&R===D.NONE&&i(r()),B.theta+=j.theta,B.phi+=j.phi,B.theta=Math.max(N.minAzimuthAngle,Math.min(N.maxAzimuthAngle,B.theta)),B.phi=Math.max(N.minPolarAngle,Math.min(N.maxPolarAngle,B.phi)),B.makeSafe(),B.radius*=V,B.radius=Math.max(N.minDistance,Math.min(N.maxDistance,B.radius)),N.target.add(G),t.setFromSpherical(B),t.applyQuaternion(o),e.copy(N.target).add(t),N.object.lookAt(N.target),!0===N.enableDamping?(j.theta*=1-N.dampingFactor,j.phi*=1-N.dampingFactor,G.multiplyScalar(1-N.dampingFactor)):(j.set(0,0,0),G.set(0,0,0)),V=1,!!(z||s.distanceToSquared(N.object.position)>k||8*(1-l.dot(N.object.quaternion))>k)&&(N.dispatchEvent(O),s.copy(N.object.position),l.copy(N.object.quaternion),z=!1,!0)}}(),this.dispose=function(){N.domElement.removeEventListener("contextmenu",C,!1),N.domElement.removeEventListener("mousedown",M,!1),N.domElement.removeEventListener("wheel",F,!1),N.domElement.removeEventListener("touchstart",_,!1),N.domElement.removeEventListener("touchend",L,!1),N.domElement.removeEventListener("touchmove",P,!1),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",S,!1),window.removeEventListener("keydown",E,!1)};var N=this,O={type:"change"},I={type:"start"},U={type:"end"},D={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},R=D.NONE,k=1e-6,B=new n.Spherical,j=new n.Spherical,V=1,G=new n.Vector3,z=!1,H=new n.Vector2,X=new n.Vector2,Y=new n.Vector2,W=new n.Vector2,Q=new n.Vector2,q=new n.Vector2,K=new n.Vector2,Z=new n.Vector2,J=new n.Vector2,$=function(){var e=new n.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),G.add(e)}}(),ee=function(){var e=new n.Vector3;return function(t,r){!0===N.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(N.object.up,e)),e.multiplyScalar(t),G.add(e)}}(),te=function(){var e=new n.Vector3;return function(t,r){var a=N.domElement===document?N.domElement.body:N.domElement;if(N.object.isPerspectiveCamera){var n=N.object.position;e.copy(n).sub(N.target);var i=e.length();i*=Math.tan(N.object.fov/2*Math.PI/180),$(2*t*i/a.clientHeight,N.object.matrix),ee(2*r*i/a.clientHeight,N.object.matrix)}else N.object.isOrthographicCamera?($(t*(N.object.right-N.object.left)/N.object.zoom/a.clientWidth,N.object.matrix),ee(r*(N.object.top-N.object.bottom)/N.object.zoom/a.clientHeight,N.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),N.enablePan=!1)}}();N.domElement.addEventListener("contextmenu",C,!1),N.domElement.addEventListener("mousedown",M,!1),N.domElement.addEventListener("wheel",F,!1),N.domElement.addEventListener("touchstart",_,!1),N.domElement.addEventListener("touchend",L,!1),N.domElement.addEventListener("touchmove",P,!1),window.addEventListener("keydown",E,!1),this.update()};i.prototype=Object.create(n.EventDispatcher.prototype),i.prototype.constructor=i,Object.defineProperties(i.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){function r(e){!1!==h.enabled&&(window.removeEventListener("keydown",r),g=v,v===p.NONE&&(e.keyCode!==h.keys[p.ROTATE]||h.noRotate?e.keyCode!==h.keys[p.ZOOM]||h.noZoom?e.keyCode!==h.keys[p.PAN]||h.noPan||(v=p.PAN):v=p.ZOOM:v=p.ROTATE))}function a(e){!1!==h.enabled&&(v=g,window.addEventListener("keydown",r,!1))}function i(e){!1!==h.enabled&&(e.preventDefault(),e.stopPropagation(),v===p.NONE&&(v=e.button),v!==p.ROTATE||h.noRotate?v!==p.ZOOM||h.noZoom?v!==p.PAN||h.noPan||(S.copy(L(e.pageX,e.pageY)),F.copy(S)):(A.copy(L(e.pageX,e.pageY)),w.copy(A)):(x.copy(C(e.pageX,e.pageY)),b.copy(x)),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",s,!1),h.dispatchEvent(_))}function o(e){!1!==h.enabled&&(e.preventDefault(),e.stopPropagation(),v!==p.ROTATE||h.noRotate?v!==p.ZOOM||h.noZoom?v!==p.PAN||h.noPan||F.copy(L(e.pageX,e.pageY)):w.copy(L(e.pageX,e.pageY)):b.copy(C(e.pageX,e.pageY)))}function s(e){!1!==h.enabled&&(e.preventDefault(),e.stopPropagation(),v=p.NONE,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",s),h.dispatchEvent(P))}function l(e){!1!==h.enabled&&(e.preventDefault(),e.stopPropagation(),A.y+=.01*e.deltaY,h.dispatchEvent(_),h.dispatchEvent(P))}function u(e){if(!1!==h.enabled){switch(e.touches.length){case 1:v=p.TOUCH_ROTATE,x.copy(C(e.touches[0].pageX,e.touches[0].pageY)),b.copy(x);break;case 2:v=p.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;T=M=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;S.copy(L(a,n)),F.copy(S);break;default:v=p.NONE}h.dispatchEvent(_)}}function c(e){if(!1!==h.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:b.copy(C(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;T=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;F.copy(L(a,n));break;default:v=p.NONE}}function d(e){if(!1!==h.enabled){switch(e.touches.length){case 1:b.copy(C(e.touches[0].pageX,e.touches[0].pageY)),x.copy(b);break;case 2:M=T=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;F.copy(L(t,r)),S.copy(F)}v=p.NONE,h.dispatchEvent(P)}}function f(e){e.preventDefault()}var h=this,p={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.radius=0,this.rotateSpeed=1,this.zoomSpeed=1.2,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new n.Vector3;var m=!0,v=p.NONE,g=p.NONE,y=new n.Vector3,x=new n.Vector3,b=new n.Vector3,A=new n.Vector2,w=new n.Vector2,M=0,T=0,S=new n.Vector2,F=new n.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom;var E={type:"change"},_={type:"start"},P={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var L=function(){var e=new n.Vector2;return function(t,r){return e.set((t-h.screen.left)/h.screen.width,(r-h.screen.top)/h.screen.height),e}}(),C=function(){var e=new n.Vector3,t=new n.Vector3,r=new n.Vector3;return function(a,n){r.set((a-.5*h.screen.width-h.screen.left)/h.radius,(.5*h.screen.height+h.screen.top-n)/h.radius,0);var i=r.length();return h.noRoll?i<Math.SQRT1_2?r.z=Math.sqrt(1-i*i):r.z=.5/i:i>1?r.normalize():r.z=Math.sqrt(1-i*i),y.copy(h.object.position).sub(h.target),e.copy(h.object.up).setLength(r.y),e.add(t.copy(h.object.up).cross(y).setLength(r.x)),e.add(y.setLength(r.z)),e}}();this.rotateCamera=function(){var e=new n.Vector3,t=new n.Quaternion;return function(){var r=Math.acos(x.dot(b)/x.length()/b.length());r&&(e.crossVectors(x,b).normalize(),r*=h.rotateSpeed,t.setFromAxisAngle(e,-r),y.applyQuaternion(t),h.object.up.applyQuaternion(t),b.applyQuaternion(t),h.staticMoving?x.copy(b):(t.setFromAxisAngle(e,r*(h.dynamicDampingFactor-1)),x.applyQuaternion(t)),m=!0)}}(),this.zoomCamera=function(){if(v===p.TOUCH_ZOOM_PAN){var e=T/M;M=T,h.object.zoom*=e,m=!0}else{var e=1+(w.y-A.y)*h.zoomSpeed;Math.abs(e-1)>1e-6&&e>0&&(h.object.zoom/=e,h.staticMoving?A.copy(w):A.y+=(w.y-A.y)*this.dynamicDampingFactor,m=!0)}},this.panCamera=function(){var e=new n.Vector2,t=new n.Vector3,r=new n.Vector3;return function(){if(e.copy(F).sub(S),e.lengthSq()){var a=(h.object.right-h.object.left)/h.object.zoom,n=(h.object.top-h.object.bottom)/h.object.zoom;e.x*=a,e.y*=n,r.copy(y).cross(h.object.up).setLength(e.x),r.add(t.copy(h.object.up).setLength(e.y)),h.object.position.add(r),h.target.add(r),h.staticMoving?S.copy(F):S.add(e.subVectors(F,S).multiplyScalar(h.dynamicDampingFactor)),m=!0}}}(),this.update=function(){y.subVectors(h.object.position,h.target),h.noRotate||h.rotateCamera(),h.noZoom||(h.zoomCamera(),m&&h.object.updateProjectionMatrix()),h.noPan||h.panCamera(),h.object.position.addVectors(h.target,y),h.object.lookAt(h.target),m&&(h.dispatchEvent(E),m=!1)},this.reset=function(){v=p.NONE,g=p.NONE,h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.up.copy(h.up0),y.subVectors(h.object.position,h.target),h.object.left=h.left0,h.object.right=h.right0,h.object.top=h.top0,h.object.bottom=h.bottom0,h.object.lookAt(h.target),h.dispatchEvent(E),m=!1},this.dispose=function(){this.domElement.removeEventListener("contextmenu",f,!1),this.domElement.removeEventListener("mousedown",i,!1),this.domElement.removeEventListener("wheel",l,!1),this.domElement.removeEventListener("touchstart",u,!1),this.domElement.removeEventListener("touchend",d,!1),this.domElement.removeEventListener("touchmove",c,!1),document.removeEventListener("mousemove",o,!1),document.removeEventListener("mouseup",s,!1),window.removeEventListener("keydown",r,!1),window.removeEventListener("keyup",a,!1)},this.domElement.addEventListener("contextmenu",f,!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("wheel",l,!1),this.domElement.addEventListener("touchstart",u,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",c,!1),window.addEventListener("keydown",r,!1),window.addEventListener("keyup",a,!1),this.handleResize(),this.update()};i.prototype=Object.create(n.EventDispatcher.prototype),i.prototype.constructor=i,t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){var t=this;e.rotation.set(0,0,0);var r=new n.Object3D;r.add(e);var a=new n.Object3D;a.position.y=10,a.add(r);var i=Math.PI/2,o=function(e){if(!1!==t.enabled){var n=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;a.rotation.y-=.002*n,r.rotation.x-=.002*o,r.rotation.x=Math.max(-i,Math.min(i,r.rotation.x))}};this.dispose=function(){document.removeEventListener("mousemove",o,!1)},document.addEventListener("mousemove",o,!1),this.enabled=!1,this.getObject=function(){return a},this.getDirection=function(){var e=new n.Vector3(0,0,-1),t=new n.Euler(0,0,0,"YXZ");return function(n){return t.set(r.rotation.x,a.rotation.y,0),n.copy(e).applyEuler(t),n}}()};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){function r(e){!1!==h.enabled&&(window.removeEventListener("keydown",r),g=v,v===p.NONE&&(e.keyCode!==h.keys[p.ROTATE]||h.noRotate?e.keyCode!==h.keys[p.ZOOM]||h.noZoom?e.keyCode!==h.keys[p.PAN]||h.noPan||(v=p.PAN):v=p.ZOOM:v=p.ROTATE))}function a(e){!1!==h.enabled&&(v=g,window.addEventListener("keydown",r,!1))}function i(e){!1!==h.enabled&&(e.preventDefault(),e.stopPropagation(),v===p.NONE&&(v=e.button),v!==p.ROTATE||h.noRotate?v!==p.ZOOM||h.noZoom?v!==p.PAN||h.noPan||(E.copy(N(e.pageX,e.pageY)),_.copy(E)):(M.copy(N(e.pageX,e.pageY)),T.copy(M)):(b.copy(O(e.pageX,e.pageY)),x.copy(b)),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",s,!1),h.dispatchEvent(L))}function o(e){!1!==h.enabled&&(e.preventDefault(),e.stopPropagation(),v!==p.ROTATE||h.noRotate?v!==p.ZOOM||h.noZoom?v!==p.PAN||h.noPan||_.copy(N(e.pageX,e.pageY)):T.copy(N(e.pageX,e.pageY)):(x.copy(b),b.copy(O(e.pageX,e.pageY))))}function s(e){!1!==h.enabled&&(e.preventDefault(),e.stopPropagation(),v=p.NONE,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",s),h.dispatchEvent(C))}function l(e){if(!1!==h.enabled&&!0!==h.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:M.y-=.025*e.deltaY;break;case 1:M.y-=.01*e.deltaY;break;default:M.y-=25e-5*e.deltaY}h.dispatchEvent(L),h.dispatchEvent(C)}}function u(e){if(!1!==h.enabled){switch(e.touches.length){case 1:v=p.TOUCH_ROTATE,b.copy(O(e.touches[0].pageX,e.touches[0].pageY)),x.copy(b);break;default:v=p.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;F=S=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;E.copy(N(a,n)),_.copy(E)}h.dispatchEvent(L)}}function c(e){if(!1!==h.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:x.copy(b),b.copy(O(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;F=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,n=(e.touches[0].pageY+e.touches[1].pageY)/2;_.copy(N(a,n))}}function d(e){if(!1!==h.enabled){switch(e.touches.length){case 0:v=p.NONE;break;case 1:v=p.TOUCH_ROTATE,b.copy(O(e.touches[0].pageX,e.touches[0].pageY)),x.copy(b)}h.dispatchEvent(C)}}function f(e){!1!==h.enabled&&e.preventDefault()}var h=this,p={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new n.Vector3;var m=new n.Vector3,v=p.NONE,g=p.NONE,y=new n.Vector3,x=new n.Vector2,b=new n.Vector2,A=new n.Vector3,w=0,M=new n.Vector2,T=new n.Vector2,S=0,F=0,E=new n.Vector2,_=new n.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var P={type:"change"},L={type:"start"},C={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var N=function(){var e=new n.Vector2;return function(t,r){return e.set((t-h.screen.left)/h.screen.width,(r-h.screen.top)/h.screen.height),e}}(),O=function(){var e=new n.Vector2;return function(t,r){return e.set((t-.5*h.screen.width-h.screen.left)/(.5*h.screen.width),(h.screen.height+2*(h.screen.top-r))/h.screen.width),e}}();this.rotateCamera=function(){var e,t=new n.Vector3,r=new n.Quaternion,a=new n.Vector3,i=new n.Vector3,o=new n.Vector3,s=new n.Vector3;return function(){s.set(b.x-x.x,b.y-x.y,0),e=s.length(),e?(y.copy(h.object.position).sub(h.target),a.copy(y).normalize(),i.copy(h.object.up).normalize(),o.crossVectors(i,a).normalize(),i.setLength(b.y-x.y),o.setLength(b.x-x.x),s.copy(i.add(o)),t.crossVectors(s,y).normalize(),e*=h.rotateSpeed,r.setFromAxisAngle(t,e),y.applyQuaternion(r),h.object.up.applyQuaternion(r),A.copy(t),w=e):!h.staticMoving&&w&&(w*=Math.sqrt(1-h.dynamicDampingFactor),y.copy(h.object.position).sub(h.target),r.setFromAxisAngle(A,w),y.applyQuaternion(r),h.object.up.applyQuaternion(r)),x.copy(b)}}(),this.zoomCamera=function(){var e;v===p.TOUCH_ZOOM_PAN?(e=S/F,S=F,y.multiplyScalar(e)):(e=1+(T.y-M.y)*h.zoomSpeed,1!==e&&e>0&&y.multiplyScalar(e),h.staticMoving?M.copy(T):M.y+=(T.y-M.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new n.Vector2,t=new n.Vector3,r=new n.Vector3;return function(){e.copy(_).sub(E),e.lengthSq()&&(e.multiplyScalar(y.length()*h.panSpeed),r.copy(y).cross(h.object.up).setLength(e.x),r.add(t.copy(h.object.up).setLength(e.y)),h.object.position.add(r),h.target.add(r),h.staticMoving?E.copy(_):E.add(e.subVectors(_,E).multiplyScalar(h.dynamicDampingFactor)))}}(),this.checkDistances=function(){h.noZoom&&h.noPan||(y.lengthSq()>h.maxDistance*h.maxDistance&&(h.object.position.addVectors(h.target,y.setLength(h.maxDistance)),M.copy(T)),y.lengthSq()<h.minDistance*h.minDistance&&(h.object.position.addVectors(h.target,y.setLength(h.minDistance)),M.copy(T)))},this.update=function(){y.subVectors(h.object.position,h.target),h.noRotate||h.rotateCamera(),h.noZoom||h.zoomCamera(),h.noPan||h.panCamera(),h.object.position.addVectors(h.target,y),h.checkDistances(),h.object.lookAt(h.target),m.distanceToSquared(h.object.position)>1e-6&&(h.dispatchEvent(P),m.copy(h.object.position))},this.reset=function(){v=p.NONE,g=p.NONE,h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.up.copy(h.up0),y.subVectors(h.object.position,h.target),h.object.lookAt(h.target),h.dispatchEvent(P),m.copy(h.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",f,!1),this.domElement.removeEventListener("mousedown",i,!1),this.domElement.removeEventListener("wheel",l,!1),this.domElement.removeEventListener("touchstart",u,!1),this.domElement.removeEventListener("touchend",d,!1),this.domElement.removeEventListener("touchmove",c,!1),document.removeEventListener("mousemove",o,!1),document.removeEventListener("mouseup",s,!1),window.removeEventListener("keydown",r,!1),window.removeEventListener("keyup",a,!1)},this.domElement.addEventListener("contextmenu",f,!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("wheel",l,!1),this.domElement.addEventListener("touchstart",u,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",c,!1),window.addEventListener("keydown",r,!1),window.addEventListener("keyup",a,!1),this.handleResize(),this.update()};i.prototype=Object.create(n.EventDispatcher.prototype),i.prototype.constructor=i,t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a);t.default=function(){var e=function(e){n.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.fog=!1,this.side=n.FrontSide,this.transparent=!0,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};e.prototype=Object.create(n.MeshBasicMaterial.prototype),e.prototype.constructor=e;var t=function(e){n.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.fog=!1,this.transparent=!0,this.linewidth=1,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};t.prototype=Object.create(n.LineBasicMaterial.prototype),t.prototype.constructor=t;var r=new e({visible:!1,transparent:!1}),a=function(){this.init=function(){n.Object3D.call(this),this.handles=new n.Object3D,this.pickers=new n.Object3D,this.planes=new n.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes);var e=new n.PlaneBufferGeometry(50,50,2,2),t=new n.MeshBasicMaterial({visible:!1,side:n.DoubleSide}),r={XY:new n.Mesh(e,t),YZ:new n.Mesh(e,t),XZ:new n.Mesh(e,t),XYZE:new n.Mesh(e,t)};this.activePlane=r.XYZE,r.YZ.rotation.set(0,Math.PI/2,0),r.XZ.rotation.set(-Math.PI/2,0,0);for(var a in r)r[a].name=a,this.planes.add(r[a]),this.planes[a]=r[a];var i=function(e,t){for(var r in e)for(a=e[r].length;a--;){var n=e[r][a][0],i=e[r][a][1],o=e[r][a][2];n.name=r,n.renderOrder=1/0,i&&n.position.set(i[0],i[1],i[2]),o&&n.rotation.set(o[0],o[1],o[2]),t.add(n)}};i(this.handleGizmos,this.handles),i(this.pickerGizmos,this.pickers),this.traverse(function(e){if(e instanceof n.Mesh){e.updateMatrix();var t=e.geometry.clone();t.applyMatrix(e.matrix),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}})},this.highlight=function(e){this.traverse(function(t){t.material&&t.material.highlight&&(t.name===e?t.material.highlight(!0):t.material.highlight(!1))})}};a.prototype=Object.create(n.Object3D.prototype),a.prototype.constructor=a,a.prototype.update=function(e,t){var r=new n.Vector3(0,0,0),a=new n.Vector3(0,1,0),i=new n.Matrix4;this.traverse(function(n){-1!==n.name.search("E")?n.quaternion.setFromRotationMatrix(i.lookAt(t,r,a)):-1===n.name.search("X")&&-1===n.name.search("Y")&&-1===n.name.search("Z")||n.quaternion.setFromEuler(e)})};var i=function(){a.call(this);var i=new n.Geometry,o=new n.Mesh(new n.CylinderGeometry(0,.05,.2,12,1,!1));o.position.y=.5,o.updateMatrix(),i.merge(o.geometry,o.matrix);var s=new n.BufferGeometry;s.addAttribute("position",new n.Float32BufferAttribute([0,0,0,1,0,0],3));var l=new n.BufferGeometry;l.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,1,0],3));var u=new n.BufferGeometry;u.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new n.Mesh(i,new e({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new n.Line(s,new t({color:16711680}))]],Y:[[new n.Mesh(i,new e({color:65280})),[0,.5,0]],[new n.Line(l,new t({color:65280}))]],Z:[[new n.Mesh(i,new e({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new n.Line(u,new t({color:255}))]],XYZ:[[new n.Mesh(new n.OctahedronGeometry(.1,0),new e({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new n.Mesh(new n.PlaneBufferGeometry(.29,.29),new e({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new n.Mesh(new n.PlaneBufferGeometry(.29,.29),new e({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new n.Mesh(new n.PlaneBufferGeometry(.29,.29),new e({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,.6,0]]],Z:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new n.Mesh(new n.OctahedronGeometry(.2,0),r)]],XY:[[new n.Mesh(new n.PlaneBufferGeometry(.4,.4),r),[.2,.2,0]]],YZ:[[new n.Mesh(new n.PlaneBufferGeometry(.4,.4),r),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new n.Mesh(new n.PlaneBufferGeometry(.4,.4),r),[.2,0,.2],[-Math.PI/2,0,0]]]},this.setActivePlane=function(e,t){var r=new n.Matrix4;t.applyMatrix4(r.getInverse(r.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE),"XY"===e&&(this.activePlane=this.planes.XY),"YZ"===e&&(this.activePlane=this.planes.YZ),"XZ"===e&&(this.activePlane=this.planes.XZ)},this.init()};i.prototype=Object.create(a.prototype),i.prototype.constructor=i;var o=function(){a.call(this);var e=function(e,t,r){var a=new n.BufferGeometry,i=[];r=r||1;for(var o=0;o<=64*r;++o)"x"===t&&i.push(0,Math.cos(o/32*Math.PI)*e,Math.sin(o/32*Math.PI)*e),"y"===t&&i.push(Math.cos(o/32*Math.PI)*e,0,Math.sin(o/32*Math.PI)*e),"z"===t&&i.push(Math.sin(o/32*Math.PI)*e,Math.cos(o/32*Math.PI)*e,0);return a.addAttribute("position",new n.Float32BufferAttribute(i,3)),a};this.handleGizmos={X:[[new n.Line(new e(1,"x",.5),new t({color:16711680}))]],Y:[[new n.Line(new e(1,"y",.5),new t({color:65280}))]],Z:[[new n.Line(new e(1,"z",.5),new t({color:255}))]],E:[[new n.Line(new e(1.25,"z",1),new t({color:13421568}))]],XYZE:[[new n.Line(new e(1,"z",1),new t({color:7895160}))]]},this.pickerGizmos={X:[[new n.Mesh(new n.TorusBufferGeometry(1,.12,4,12,Math.PI),r),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new n.Mesh(new n.TorusBufferGeometry(1,.12,4,12,Math.PI),r),[0,0,0],[Math.PI/2,0,0]]],Z:[[new n.Mesh(new n.TorusBufferGeometry(1,.12,4,12,Math.PI),r),[0,0,0],[0,0,-Math.PI/2]]],E:[[new n.Mesh(new n.TorusBufferGeometry(1.25,.12,2,24),r)]],XYZE:[[new n.Mesh(new n.TorusBufferGeometry(1,.12,2,24),r)]]},this.pickerGizmos.XYZE[0][0].visible=!1,this.setActivePlane=function(e){"E"===e&&(this.activePlane=this.planes.XYZE),"X"===e&&(this.activePlane=this.planes.YZ),"Y"===e&&(this.activePlane=this.planes.XZ),"Z"===e&&(this.activePlane=this.planes.XY)},this.update=function(e,t){a.prototype.update.apply(this,arguments);var r=new n.Matrix4,i=new n.Euler(0,0,1),o=new n.Quaternion,s=new n.Vector3(1,0,0),l=new n.Vector3(0,1,0),u=new n.Vector3(0,0,1),c=new n.Quaternion,d=new n.Quaternion,f=new n.Quaternion,h=t.clone();i.copy(this.planes.XY.rotation),o.setFromEuler(i),r.makeRotationFromQuaternion(o).getInverse(r),h.applyMatrix4(r),this.traverse(function(e){o.setFromEuler(i),"X"===e.name&&(c.setFromAxisAngle(s,Math.atan2(-h.y,h.z)),o.multiplyQuaternions(o,c),e.quaternion.copy(o)),"Y"===e.name&&(d.setFromAxisAngle(l,Math.atan2(h.x,h.z)),o.multiplyQuaternions(o,d),e.quaternion.copy(o)),"Z"===e.name&&(f.setFromAxisAngle(u,Math.atan2(h.y,h.x)),o.multiplyQuaternions(o,f),e.quaternion.copy(o))})},this.init()};o.prototype=Object.create(a.prototype),o.prototype.constructor=o;var s=function(){a.call(this);var i=new n.Geometry,o=new n.Mesh(new n.BoxGeometry(.125,.125,.125));o.position.y=.5,o.updateMatrix(),i.merge(o.geometry,o.matrix);var s=new n.BufferGeometry;s.addAttribute("position",new n.Float32BufferAttribute([0,0,0,1,0,0],3));var l=new n.BufferGeometry;l.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,1,0],3));var u=new n.BufferGeometry;u.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new n.Mesh(i,new e({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new n.Line(s,new t({color:16711680}))]],Y:[[new n.Mesh(i,new e({color:65280})),[0,.5,0]],[new n.Line(l,new t({color:65280}))]],Z:[[new n.Mesh(i,new e({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new n.Line(u,new t({color:255}))]],XYZ:[[new n.Mesh(new n.BoxBufferGeometry(.125,.125,.125),new e({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,.6,0]]],Z:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new n.Mesh(new n.BoxBufferGeometry(.4,.4,.4),r)]]},this.setActivePlane=function(e,t){var r=new n.Matrix4;t.applyMatrix4(r.getInverse(r.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE)},this.init()};s.prototype=Object.create(a.prototype),s.prototype.constructor=s;var l=function(e,t){function r(e){if(void 0!==d.object&&!0!==h&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e,r=c(t,p[f].pickers.children),a=null;r&&(a=r.object.name,e.preventDefault()),d.axis!==a&&(d.axis=a,d.update(),d.dispatchEvent(g))}}function a(e){if(void 0!==d.object&&!0!==h&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e;if(0===t.button||void 0===t.button){var r=c(t,p[f].pickers.children);if(r){e.preventDefault(),e.stopPropagation(),d.axis=r.object.name,d.dispatchEvent(y),d.update(),P.copy(q).sub(Y).normalize(),p[f].setActivePlane(d.axis,P);var a=c(t,[p[f].activePlane]);a&&(V.copy(d.object.position),G.copy(d.object.scale),z.extractRotation(d.object.matrix),Q.extractRotation(d.object.matrixWorld),H.extractRotation(d.object.parent.matrixWorld),X.setFromMatrixScale(L.getInverse(d.object.parent.matrixWorld)),T.copy(a.point))}}h=!0}}function l(e){if(void 0!==d.object&&null!==d.axis&&!1!==h&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e,r=c(t,[p[f].activePlane]);!1!==r&&(e.preventDefault(),e.stopPropagation(),M.copy(r.point),"translate"===f?(M.sub(T),M.multiply(X),"local"===d.space&&(M.applyMatrix4(L.getInverse(Q)),-1===d.axis.search("X")&&(M.x=0),-1===d.axis.search("Y")&&(M.y=0),-1===d.axis.search("Z")&&(M.z=0),M.applyMatrix4(z),d.object.position.copy(V),d.object.position.add(M)),"world"!==d.space&&-1===d.axis.search("XYZ")||(-1===d.axis.search("X")&&(M.x=0),-1===d.axis.search("Y")&&(M.y=0),-1===d.axis.search("Z")&&(M.z=0),M.applyMatrix4(L.getInverse(H)),d.object.position.copy(V),d.object.position.add(M)),null!==d.translationSnap&&("local"===d.space&&d.object.position.applyMatrix4(L.getInverse(Q)),-1!==d.axis.search("X")&&(d.object.position.x=Math.round(d.object.position.x/d.translationSnap)*d.translationSnap),-1!==d.axis.search("Y")&&(d.object.position.y=Math.round(d.object.position.y/d.translationSnap)*d.translationSnap),-1!==d.axis.search("Z")&&(d.object.position.z=Math.round(d.object.position.z/d.translationSnap)*d.translationSnap),"local"===d.space&&d.object.position.applyMatrix4(Q))):"scale"===f?(M.sub(T),M.multiply(X),"local"===d.space&&("XYZ"===d.axis?(E=1+M.y/Math.max(G.x,G.y,G.z),d.object.scale.x=G.x*E,d.object.scale.y=G.y*E,d.object.scale.z=G.z*E):(M.applyMatrix4(L.getInverse(Q)),"X"===d.axis&&(d.object.scale.x=G.x*(1+M.x/G.x)),"Y"===d.axis&&(d.object.scale.y=G.y*(1+M.y/G.y)),"Z"===d.axis&&(d.object.scale.z=G.z*(1+M.z/G.z))))):"rotate"===f&&(M.sub(Y),M.multiply(X),C.copy(T).sub(Y),C.multiply(X),"E"===d.axis?(M.applyMatrix4(L.getInverse(_)),C.applyMatrix4(L.getInverse(_)),S.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),F.set(Math.atan2(C.z,C.y),Math.atan2(C.x,C.z),Math.atan2(C.y,C.x)),N.setFromRotationMatrix(L.getInverse(H)),j.setFromAxisAngle(P,S.z-F.z),D.setFromRotationMatrix(Q),N.multiplyQuaternions(N,j),N.multiplyQuaternions(N,D),d.object.quaternion.copy(N)):"XYZE"===d.axis?(j.setFromEuler(M.clone().cross(C).normalize()),N.setFromRotationMatrix(L.getInverse(H)),R.setFromAxisAngle(j,-M.clone().angleTo(C)),D.setFromRotationMatrix(Q),N.multiplyQuaternions(N,R),N.multiplyQuaternions(N,D),d.object.quaternion.copy(N)):"local"===d.space?(M.applyMatrix4(L.getInverse(Q)),C.applyMatrix4(L.getInverse(Q)),S.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),F.set(Math.atan2(C.z,C.y),Math.atan2(C.x,C.z),Math.atan2(C.y,C.x)),D.setFromRotationMatrix(z),null!==d.rotationSnap?(R.setFromAxisAngle(O,Math.round((S.x-F.x)/d.rotationSnap)*d.rotationSnap),k.setFromAxisAngle(I,Math.round((S.y-F.y)/d.rotationSnap)*d.rotationSnap),B.setFromAxisAngle(U,Math.round((S.z-F.z)/d.rotationSnap)*d.rotationSnap)):(R.setFromAxisAngle(O,S.x-F.x),k.setFromAxisAngle(I,S.y-F.y),B.setFromAxisAngle(U,S.z-F.z)),"X"===d.axis&&D.multiplyQuaternions(D,R),"Y"===d.axis&&D.multiplyQuaternions(D,k),"Z"===d.axis&&D.multiplyQuaternions(D,B),d.object.quaternion.copy(D)):"world"===d.space&&(S.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),F.set(Math.atan2(C.z,C.y),Math.atan2(C.x,C.z),Math.atan2(C.y,C.x)),N.setFromRotationMatrix(L.getInverse(H)),null!==d.rotationSnap?(R.setFromAxisAngle(O,Math.round((S.x-F.x)/d.rotationSnap)*d.rotationSnap),k.setFromAxisAngle(I,Math.round((S.y-F.y)/d.rotationSnap)*d.rotationSnap),B.setFromAxisAngle(U,Math.round((S.z-F.z)/d.rotationSnap)*d.rotationSnap)):(R.setFromAxisAngle(O,S.x-F.x),k.setFromAxisAngle(I,S.y-F.y),B.setFromAxisAngle(U,S.z-F.z)),D.setFromRotationMatrix(Q),"X"===d.axis&&N.multiplyQuaternions(N,R),"Y"===d.axis&&N.multiplyQuaternions(N,k),"Z"===d.axis&&N.multiplyQuaternions(N,B),N.multiplyQuaternions(N,D),d.object.quaternion.copy(N))),d.update(),d.dispatchEvent(g),d.dispatchEvent(b))}}function u(e){e.preventDefault(),void 0!==e.button&&0!==e.button||(h&&null!==d.axis&&(x.mode=f,d.dispatchEvent(x)),h=!1,"TouchEvent"in window&&e instanceof TouchEvent?(d.axis=null,d.update(),d.dispatchEvent(g)):r(e))}function c(r,a){var n=t.getBoundingClientRect(),i=(r.clientX-n.left)/n.width,o=(r.clientY-n.top)/n.height;w.set(2*i-1,-2*o+1),A.setFromCamera(w,e);var s=A.intersectObjects(a,!0);return!!s[0]&&s[0]}n.Object3D.call(this),t=void 0!==t?t:document,this.object=void 0,this.visible=!1,this.translationSnap=null,this.rotationSnap=null,this.space="world",this.size=1,this.axis=null;var d=this,f="translate",h=!1,p={translate:new i,rotate:new o,scale:new s};for(var m in p){var v=p[m];v.visible=m===f,this.add(v)}var g={type:"change"},y={type:"mouseDown"},x={type:"mouseUp",mode:f},b={type:"objectChange"},A=new n.Raycaster,w=new n.Vector2,M=new n.Vector3,T=new n.Vector3,S=new n.Vector3,F=new n.Vector3,E=1,_=new n.Matrix4,P=new n.Vector3,L=new n.Matrix4,C=new n.Vector3,N=new n.Quaternion,O=new n.Vector3(1,0,0),I=new n.Vector3(0,1,0),U=new n.Vector3(0,0,1),D=new n.Quaternion,R=new n.Quaternion,k=new n.Quaternion,B=new n.Quaternion,j=new n.Quaternion,V=new n.Vector3,G=new n.Vector3,z=new n.Matrix4,H=new n.Matrix4,X=new n.Vector3,Y=new n.Vector3,W=new n.Euler,Q=new n.Matrix4,q=new n.Vector3,K=new n.Euler;t.addEventListener("mousedown",a,!1),t.addEventListener("touchstart",a,!1),t.addEventListener("mousemove",r,!1),t.addEventListener("touchmove",r,!1),t.addEventListener("mousemove",l,!1),t.addEventListener("touchmove",l,!1),t.addEventListener("mouseup",u,!1),t.addEventListener("mouseout",u,!1),t.addEventListener("touchend",u,!1),t.addEventListener("touchcancel",u,!1),t.addEventListener("touchleave",u,!1),this.dispose=function(){t.removeEventListener("mousedown",a),t.removeEventListener("touchstart",a),t.removeEventListener("mousemove",r),t.removeEventListener("touchmove",r),t.removeEventListener("mousemove",l),t.removeEventListener("touchmove",l),t.removeEventListener("mouseup",u),t.removeEventListener("mouseout",u),t.removeEventListener("touchend",u),t.removeEventListener("touchcancel",u),t.removeEventListener("touchleave",u)},this.attach=function(e){this.object=e,this.visible=!0,this.update()},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.getMode=function(){return f},this.setMode=function(e){"scale"===(f=e||f)&&(d.space="local");for(var t in p)p[t].visible=t===f;this.update(),d.dispatchEvent(g)},this.setTranslationSnap=function(e){d.translationSnap=e},this.setRotationSnap=function(e){d.rotationSnap=e},this.setSize=function(e){d.size=e,this.update(),d.dispatchEvent(g)},this.setSpace=function(e){d.space=e,this.update(),d.dispatchEvent(g)},this.update=function(){void 0!==d.object&&(d.object.updateMatrixWorld(),Y.setFromMatrixPosition(d.object.matrixWorld),W.setFromRotationMatrix(L.extractRotation(d.object.matrixWorld)),e.updateMatrixWorld(),q.setFromMatrixPosition(e.matrixWorld),K.setFromRotationMatrix(L.extractRotation(e.matrixWorld)),E=Y.distanceTo(q)/6*d.size,this.position.copy(Y),this.scale.set(E,E,E),e instanceof n.PerspectiveCamera?P.copy(q).sub(Y).normalize():e instanceof n.OrthographicCamera&&P.copy(q).normalize(),"local"===d.space?p[f].update(W,P):"world"===d.space&&p[f].update(new n.Euler,P),p[f].highlight(d.axis))}};return l.prototype=Object.create(n.Object3D.prototype),l.prototype.constructor=l,l}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){function r(e){i=e,e.length>0?a=e[0]:t&&t("VR input not available.")}var a,i,o=this,s=new n.Matrix4,l=null;"VRFrameData"in window&&(l=new VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(r).catch(function(){console.warn("THREE.VRControls: Unable to get VR Displays")}),this.scale=1,this.standing=!1,this.userHeight=1.6,this.getVRDisplay=function(){return a},this.setVRDisplay=function(e){a=e},this.getVRDisplays=function(){return console.warn("THREE.VRControls: getVRDisplays() is being deprecated."),i},this.getStandingMatrix=function(){return s},this.update=function(){if(a){var t;a.getFrameData?(a.getFrameData(l),t=l.pose):a.getPose&&(t=a.getPose()),null!==t.orientation&&e.quaternion.fromArray(t.orientation),null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0),this.standing&&(a.stageParameters?(e.updateMatrix(),s.fromArray(a.stageParameters.sittingToStandingTransform),e.applyMatrix(s)):e.position.setY(e.position.y+this.userHeight)),e.position.multiplyScalar(o.scale)}},this.dispose=function(){a=null}};t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TypedGeometryExporter=t.STLExporter=t.STLBinaryExporter=t.PLYExporter=t.OBJExporter=t.MMDExporter=t.GLTFExporter=void 0;var n=r(41),i=a(n),o=r(42),s=a(o),l=r(43),u=a(l),c=r(44),d=a(c),f=r(45),h=a(f),p=r(46),m=a(p),v=r(47),g=a(v);t.GLTFExporter=i.default,t.MMDExporter=s.default,t.OBJExporter=u.default,t.PLYExporter=d.default,t.STLBinaryExporter=h.default,t.STLExporter=m.default,t.TypedGeometryExporter=g.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987},o={1003:i.NEAREST,1004:i.NEAREST_MIPMAP_NEAREST,1005:i.NEAREST_MIPMAP_LINEAR,1006:i.LINEAR,1007:i.LINEAR_MIPMAP_NEAREST,1008:i.LINEAR_MIPMAP_LINEAR},s={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},l=function(){};l.prototype={constructor:l,parse:function(e,t,r){function a(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function l(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,a=e.length;r<a;r++){var n=e.charCodeAt(r);t[r]=n>255?32:n}return t.buffer}function u(e,t,r){for(var a={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},n=t;n<t+r;n++)for(var i=0;i<e.itemSize;i++){var o=e.array[n*e.itemSize+i];a.min[i]=Math.min(a.min[i],o),a.max[i]=Math.max(a.max[i],o)}return a}function c(e){return n.Math.isPowerOfTwo(e.width)&&n.Math.isPowerOfTwo(e.height)}function d(e){if(B.attributes.has(e))return!1;for(var t=new n.Vector3,r=0,a=e.count;r<a;r++)if(Math.abs(t.fromArray(e.array,3*r).length()-1)>5e-4)return!1;return!0}function f(e){if(B.attributes.has(e))return B.textures.get(e);for(var t=e.clone(),r=new n.Vector3,a=0,i=t.count;a<i;a++)r.fromArray(t.array,3*a),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),r.toArray(t.array,3*a);return B.attributes.set(e,t),t}function h(e){return 4*Math.ceil(e/4)}function p(e,t){t=t||0;var r=h(e.byteLength);if(r!==e.byteLength){var a=new Uint8Array(r);if(a.set(new Uint8Array(e)),0!==t)for(var n=e.byteLength;n<r;n++)a[n]=t;return a.buffer}return e}function m(e){return N.buffers||(N.buffers=[{byteLength:0}]),I.push(e),0}function v(e,t,r,a,n){N.bufferViews||(N.bufferViews=[]);var o;o=t===i.UNSIGNED_BYTE?1:t===i.UNSIGNED_SHORT?2:4;for(var s=h(a*e.itemSize*o),l=new DataView(new ArrayBuffer(s)),u=0,c=r;c<r+a;c++)for(var d=0;d<e.itemSize;d++){var f=e.array[c*e.itemSize+d];t===i.FLOAT?l.setFloat32(u,f,!0):t===i.UNSIGNED_INT?l.setUint32(u,f,!0):t===i.UNSIGNED_SHORT?l.setUint16(u,f,!0):t===i.UNSIGNED_BYTE&&l.setUint8(u,f),u+=o}var p={buffer:m(l.buffer),byteOffset:O,byteLength:s};return void 0!==n&&(p.target=n),n===i.ARRAY_BUFFER&&(p.byteStride=e.itemSize*o),O+=s,N.bufferViews.push(p),{id:N.bufferViews.length-1,byteLength:0}}function g(e){return N.bufferViews||(N.bufferViews=[]),new Promise(function(t){var r=new window.FileReader;r.readAsArrayBuffer(e),r.onloadend=function(){var e=p(r.result),a={buffer:m(e),byteOffset:O,byteLength:e.byteLength};O+=e.byteLength,N.bufferViews.push(a),t(N.bufferViews.length-1)}})}function y(e,t,a,n){var o,s={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"};if(e.array.constructor===Float32Array)o=i.FLOAT;else if(e.array.constructor===Uint32Array)o=i.UNSIGNED_INT;else if(e.array.constructor===Uint16Array)o=i.UNSIGNED_SHORT;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");o=i.UNSIGNED_BYTE}if(void 0===a&&(a=0),void 0===n&&(n=e.count),r.truncateDrawRange&&void 0!==t&&null===t.index){var l=a+n,c=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;a=Math.max(a,t.drawRange.start),n=Math.min(l,c)-a,n<0&&(n=0)}if(0===n)return null;var d,f=u(e,a,n);void 0!==t&&(d=e===t.index?i.ELEMENT_ARRAY_BUFFER:i.ARRAY_BUFFER);var h=v(e,o,a,n,d),p={bufferView:h.id,byteOffset:h.byteOffset,componentType:o,count:n,max:f.max,min:f.min,type:s[e.itemSize]};return N.accessors||(N.accessors=[]),N.accessors.push(p),N.accessors.length-1}function x(e){N.images||(N.images=[]);var t=e.format===n.RGBAFormat?"image/png":"image/jpeg",a={mimeType:t};if(r.embedImages){var i=C=C||document.createElement("canvas");i.width=e.image.width,i.height=e.image.height,r.forcePowerOfTwoTextures&&!c(e.image)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",e.image),i.width=n.Math.floorPowerOfTwo(i.width),i.height=n.Math.floorPowerOfTwo(i.height));var o=i.getContext("2d");!0===e.flipY&&(o.translate(0,i.height),o.scale(1,-1)),o.drawImage(e.image,0,0,i.width,i.height),!0===r.binary?U.push(new Promise(function(e){i.toBlob(function(t){g(t).then(function(t){a.bufferView=t,e()})},t)})):a.uri=i.toDataURL(t)}else a.uri=e.image.src;return N.images.push(a),N.images.length-1}function b(e){N.samplers||(N.samplers=[]);var t={magFilter:o[e.magFilter],minFilter:o[e.minFilter],wrapS:o[e.wrapS],wrapT:o[e.wrapT]};return N.samplers.push(t),N.samplers.length-1}function A(e){if(B.textures.has(e))return B.textures.get(e);N.textures||(N.textures=[]);var t={sampler:b(e),source:x(e)};N.textures.push(t);var r=N.textures.length-1;return B.textures.set(e,r),r}function w(e){if(B.materials.has(e))return B.materials.get(e);if(N.materials||(N.materials=[]),e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},k.KHR_materials_unlit=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var r=e.color.toArray().concat([e.opacity]);if(a(r,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=r),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),(e.metalnessMap||e.roughnessMap)&&(e.metalnessMap===e.roughnessMap?t.pbrMetallicRoughness.metallicRoughnessTexture={index:A(e.metalnessMap)}:console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.")),e.map&&(t.pbrMetallicRoughness.baseColorTexture={index:A(e.map)}),e.isMeshBasicMaterial||e.isLineBasicMaterial||e.isPointsMaterial);else{var i=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();a(i,[0,0,0])||(t.emissiveFactor=i),e.emissiveMap&&(t.emissiveTexture={index:A(e.emissiveMap)})}e.normalMap&&(t.normalTexture={index:A(e.normalMap)},-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),t.normalTexture.scale=e.normalScale.x)),e.aoMap&&(t.occlusionTexture={index:A(e.aoMap)},1!==e.aoMapIntensity&&(t.occlusionTexture.strength=e.aoMapIntensity)),(e.transparent||e.alphaTest>0)&&(t.alphaMode=e.opacity<1?"BLEND":"MASK",e.alphaTest>0&&.5!==e.alphaTest&&(t.alphaCutoff=e.alphaTest)),e.side===n.DoubleSide&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),N.materials.push(t);var o=N.materials.length-1;return B.materials.set(e,o),o}function M(e){var t,a=e.geometry;if(e.isLineSegments)t=i.LINES;else if(e.isLineLoop)t=i.LINE_LOOP;else if(e.isLine)t=i.LINE_STRIP;else if(e.isPoints)t=i.POINTS;else{if(!a.isBufferGeometry){var o=new n.BufferGeometry;o.fromGeometry(a),a=o}e.drawMode===n.TriangleFanDrawMode?(console.warn("GLTFExporter: TriangleFanDrawMode and wireframe incompatible."),t=i.TRIANGLE_FAN):t=e.drawMode===n.TriangleStripDrawMode?e.material.wireframe?i.LINE_STRIP:i.TRIANGLE_STRIP:e.material.wireframe?i.LINES:i.TRIANGLES}var s={},l={},u=[],c=[],h={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},p=a.getAttribute("normal");void 0===p||d(p)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.addAttribute("normal",f(p)));for(var m in a.attributes){var v=a.attributes[m];m=h[m]||m.toUpperCase();var g=v.array;if("JOINTS_0"!==m||g instanceof Uint16Array||g instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),v=new n.BufferAttribute(new Uint16Array(g),v.itemSize,v.normalized)),"MORPH"!==m.substr(0,5)){var x=y(v,a);null!==x&&(l[m]=x)}}if(void 0!==p&&a.addAttribute("normal",p),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var b=[],A=[],M={};if(void 0!==e.morphTargetDictionary)for(var T in e.morphTargetDictionary)M[e.morphTargetDictionary[T]]=T;for(var S=0;S<e.morphTargetInfluences.length;++S){var F={},E=!1;for(var m in a.morphAttributes)if("position"===m||"normal"===m){for(var v=a.morphAttributes[m][S],_=a.attributes[m],P=v.clone(),L=0,C=v.count;L<C;L++)P.setXYZ(L,v.getX(L)-_.getX(L),v.getY(L)-_.getY(L),v.getZ(L)-_.getZ(L));F[m.toUpperCase()]=y(P,a)}else E||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),E=!0);c.push(F),b.push(e.morphTargetInfluences[S]),void 0!==e.morphTargetDictionary&&A.push(M[S])}s.weights=b,A.length>0&&(s.extras={},s.extras.targetNames=A)}var O=r.forceIndices,I=Array.isArray(e.material);if(I&&0===e.geometry.groups.length)return null;!O&&null===a.index&&I&&(console.warn("THREE.GLTFExporter: Creating index for non-indexed multi-material mesh."),O=!0);var U=!1;if(null===a.index&&O){for(var D=[],S=0,R=a.attributes.position.count;S<R;S++)D[S]=S;a.setIndex(D),U=!0}for(var k=I?e.material:[e.material],B=I?e.geometry.groups:[{materialIndex:0,start:void 0,count:void 0}],S=0,R=B.length;S<R;S++){var j={mode:t,attributes:l};c.length>0&&(j.targets=c),null!==a.index&&(j.indices=y(a.index,a,B[S].start,B[S].count));var V=w(k[B[S].materialIndex]);null!==V&&(j.material=V),u.push(j)}return U&&a.setIndex(null),s.primitives=u,N.meshes||(N.meshes=[]),N.meshes.push(s),N.meshes.length-1}function T(e){N.cameras||(N.cameras=[]);var t=e.isOrthographicCamera,r={type:t?"orthographic":"perspective"};return t?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:n.Math.degToRad(e.fov)/e.aspect,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),N.cameras.push(r),N.cameras.length-1}function S(e,t){N.animations||(N.animations=[]);for(var r=[],a=[],i=0;i<e.tracks.length;++i){var o=e.tracks[i],l=n.PropertyBinding.parseTrackName(o.name),u=n.PropertyBinding.findNode(t,l.nodeName),c=s[l.propertyName];if("bones"===l.objectName&&(u=!0===u.isSkinnedMesh?u.skeleton.getBoneByName(l.objectIndex):void 0),!u||!c)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',o.name),null;var d=o.values.length/o.times.length;c===s.morphTargetInfluences&&(d/=u.morphTargetInfluences.length);var f;!0===o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(f="CUBICSPLINE",d/=3):f=o.getInterpolation()===n.InterpolateDiscrete?"STEP":"LINEAR",a.push({input:y(new n.BufferAttribute(o.times,1)),output:y(new n.BufferAttribute(o.values,d)),interpolation:f}),r.push({sampler:a.length-1,target:{node:D.get(u),path:c}})}return N.animations.push({name:e.name||"clip_"+N.animations.length,samplers:a,channels:r}),N.animations.length-1}function F(e){var t=N.nodes[D.get(e)],r=e.skeleton,a=e.skeleton.bones[0];if(void 0===a)return null;for(var i=[],o=new Float32Array(16*r.bones.length),s=0;s<r.bones.length;++s)i.push(D.get(r.bones[s])),r.boneInverses[s].toArray(o,16*s);return void 0===N.skins&&(N.skins=[]),N.skins.push({inverseBindMatrices:y(new n.BufferAttribute(o,16)),joints:i,skeleton:D.get(a)}),t.skin=N.skins.length-1}function E(e){if(e.isLight)return console.warn("GLTFExporter: Unsupported node type:",e.constructor.name),null;N.nodes||(N.nodes=[]);var t={};if(r.trs){var n=e.quaternion.toArray(),i=e.position.toArray(),o=e.scale.toArray();a(n,[0,0,0,1])||(t.rotation=n),a(i,[0,0,0])||(t.translation=i),a(o,[1,1,1])||(t.scale=o)}else e.updateMatrix(),a(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(t.matrix=e.matrix.elements);if(""!==e.name&&(t.name=String(e.name)),e.userData&&Object.keys(e.userData).length>0)try{t.extras=JSON.parse(JSON.stringify(e.userData))}catch(e){throw new Error("THREE.GLTFExporter: userData can't be serialized")}if(e.isMesh||e.isLine||e.isPoints){var s=M(e);null!==s&&(t.mesh=s)}else e.isCamera&&(t.camera=T(e));if(e.isSkinnedMesh&&R.push(e),e.children.length>0){for(var l=[],u=0,c=e.children.length;u<c;u++){var d=e.children[u];if(d.visible||!1===r.onlyVisible){var f=E(d);null!==f&&l.push(f)}}l.length>0&&(t.children=l)}N.nodes.push(t);var h=N.nodes.length-1;return D.set(e,h),h}function _(e){N.scenes||(N.scenes=[],N.scene=0);var t={nodes:[]};""!==e.name&&(t.name=e.name),N.scenes.push(t);for(var a=[],n=0,i=e.children.length;n<i;n++){var o=e.children[n];if(o.visible||!1===r.onlyVisible){var s=E(o);null!==s&&a.push(s)}}a.length>0&&(t.nodes=a)}function P(e){var t=new n.Scene;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);_(t)}var L={trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1};r=Object.assign({},L,r),r.animations.length>0&&(r.trs=!0);var C,N={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},O=0,I=[],U=[],D=new Map,R=[],k={},B={attributes:new Map,materials:new Map,textures:new Map};!function(e){e=e instanceof Array?e:[e];for(var t=[],a=0;a<e.length;a++)e[a]instanceof n.Scene?_(e[a]):t.push(e[a]);t.length>0&&P(t);for(var a=0;a<R.length;++a)F(R[a]);for(var a=0;a<r.animations.length;++a)S(r.animations[a],e[0])}(e),Promise.all(U).then(function(){var e=new Blob(I,{type:"application/octet-stream"}),a=Object.keys(k);if(a.length>0&&(N.extensionsUsed=a),N.buffers&&N.buffers.length>0){N.buffers[0].byteLength=e.size;var n=new window.FileReader;if(!0===r.binary){n.readAsArrayBuffer(e),n.onloadend=function(){var e=p(n.result),r=new DataView(new ArrayBuffer(8));r.setUint32(0,e.byteLength,!0),r.setUint32(4,5130562,!0);var a=p(l(JSON.stringify(N)),32),i=new DataView(new ArrayBuffer(8));i.setUint32(0,a.byteLength,!0),i.setUint32(4,1313821514,!0);var o=new ArrayBuffer(12),s=new DataView(o);s.setUint32(0,1179937895,!0),s.setUint32(4,2,!0);var u=12+i.byteLength+a.byteLength+r.byteLength+e.byteLength;s.setUint32(8,u,!0);var c=new Blob([o,i,a,r,e],{type:"application/octet-stream"}),d=new window.FileReader;d.readAsArrayBuffer(c),d.onloadend=function(){t(d.result)}}}else n.readAsDataURL(e),n.onloadend=function(){var e=n.result;N.buffers[0].uri=e,t(N)}}else t(N)})}},t.default=l},function(e,t,r){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=a(n),o=r(4),s=a(o),l=function(){function e(e){if(void 0===r){var t=new s.CharsetEncoder,a=t.s2uTable;r={};for(var n=Object.keys(a),i=0,o=n.length;i<o;i++){var l=n[i],u=a[l];l=parseInt(l),r[u]=l}}for(var c=[],i=0,o=e.length;i<o;i++){var d=e.charCodeAt(i),u=r[d];if(void 0===u)throw"cannot convert charcode 0x"+d.toString(16);u>255?(c.push(u>>8&255),c.push(255&u)):c.push(255&u)}return new Uint8Array(c)}function t(e){var t=e.clone();return t.pose(),t.skeleton.bones}var r;this.parseVpd=function(r,a,n){function o(e){Math.abs(e)<1e-6&&(e=0);var t=e.toString();-1===t.indexOf(".")&&(t+="."),t+="000000";var r=t.indexOf(".");return t.slice(0,r)+"."+t.slice(r+1,r+7)}function s(e){for(var t=[],r=0,a=e.length;r<a;r++)t.push(o(e[r]));return t.join(",")}if(!0!==r.isSkinnedMesh)return console.warn("THREE.MMDExporter: parseVpd() requires SkinnedMesh instance."),null;r.updateMatrixWorld(!0);var l=r.skeleton.bones,u=t(r),c=new i.Vector3,d=new i.Quaternion,f=new i.Quaternion,h=new i.Matrix4,p=[];p.push("Vocaloid Pose Data file"),p.push(""),p.push((""!==r.name?r.name.replace(/\s/g,"_"):"skin")+".osm;"),p.push(l.length+";"),p.push("");for(var m=0,v=l.length;m<v;m++){var g=l[m],y=u[m];!0===n&&void 0!==g.userData.ik&&void 0!==g.userData.ik.originalMatrix?h.fromArray(g.userData.ik.originalMatrix):h.copy(g.matrix),c.setFromMatrixPosition(h),d.setFromRotationMatrix(h);var x=c.sub(y.position).toArray(),b=f.copy(y.quaternion).conjugate().multiply(d).toArray();x[2]=-x[2],b[0]=-b[0],b[1]=-b[1],p.push("Bone"+m+"{"+g.name),p.push("  "+s(x)+";"),p.push("  "+s(b)+";"),p.push("}"),p.push("")}p.push("");var A=p.join("\n");return!0===a?e(A):A}};t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(){};i.prototype={constructor:i,parse:function(e){var t,r,a,i,o,s="",l=0,u=0,c=0,d=new n.Vector3,f=new n.Vector3,h=new n.Vector2,p=[],m=function(e){var a=0,m=0,v=0,g=e.geometry,y=new n.Matrix3;if(g instanceof n.Geometry&&(g=(new n.BufferGeometry).setFromObject(e)),g instanceof n.BufferGeometry){var x=g.getAttribute("position"),b=g.getAttribute("normal"),A=g.getAttribute("uv"),w=g.getIndex();if(s+="o "+e.name+"\n",e.material&&e.material.name&&(s+="usemtl "+e.material.name+"\n"),void 0!==x)for(t=0,i=x.count;t<i;t++,a++)d.x=x.getX(t),d.y=x.getY(t),d.z=x.getZ(t),d.applyMatrix4(e.matrixWorld),s+="v "+d.x+" "+d.y+" "+d.z+"\n";if(void 0!==A)for(t=0,i=A.count;t<i;t++,v++)h.x=A.getX(t),h.y=A.getY(t),s+="vt "+h.x+" "+h.y+"\n";if(void 0!==b)for(y.getNormalMatrix(e.matrixWorld),t=0,i=b.count;t<i;t++,m++)f.x=b.getX(t),f.y=b.getY(t),f.z=b.getZ(t),f.applyMatrix3(y),s+="vn "+f.x+" "+f.y+" "+f.z+"\n";if(null!==w)for(t=0,i=w.count;t<i;t+=3){for(o=0;o<3;o++)r=w.getX(t+o)+1,p[o]=l+r+(b||A?"/"+(A?u+r:"")+(b?"/"+(c+r):""):"");s+="f "+p.join(" ")+"\n"}else for(t=0,i=x.count;t<i;t+=3){for(o=0;o<3;o++)r=t+o+1,p[o]=l+r+(b||A?"/"+(A?u+r:"")+(b?"/"+(c+r):""):"");s+="f "+p.join(" ")+"\n"}}else console.warn("THREE.OBJExporter.parseMesh(): geometry type unsupported",g);l+=a,u+=v,c+=m},v=function(e){var o=0,u=e.geometry,c=e.type;if(u instanceof n.Geometry&&(u=(new n.BufferGeometry).setFromObject(e)),u instanceof n.BufferGeometry){var f=u.getAttribute("position");if(s+="o "+e.name+"\n",void 0!==f)for(t=0,i=f.count;t<i;t++,o++)d.x=f.getX(t),d.y=f.getY(t),d.z=f.getZ(t),d.applyMatrix4(e.matrixWorld),s+="v "+d.x+" "+d.y+" "+d.z+"\n";if("Line"===c){for(s+="l ",r=1,i=f.count;r<=i;r++)s+=l+r+" ";s+="\n"}if("LineSegments"===c)for(r=1,a=r+1,i=f.count;r<i;r+=2,a=r+1)s+="l "+(l+r)+" "+(l+a)+"\n"}else console.warn("THREE.OBJExporter.parseLine(): geometry type unsupported",u);l+=o};return e.traverse(function(e){e instanceof n.Mesh&&m(e),e instanceof n.Line&&v(e)}),s}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(){};i.prototype={constructor:i,parse:function(e,t){!0!==Array.isArray(t)&&(t=[]);var r=-1===t.indexOf("normal"),a=-1===t.indexOf("color"),i=-1===t.indexOf("uv"),o=0,s=0,l="",u="",c=new n.Vector3,d=new n.Matrix3;e.traverse(function(e){if(e instanceof n.Mesh){var t=e,f=t.geometry;if(f instanceof n.Geometry&&(f=(new n.BufferGeometry).setFromObject(t)),f instanceof n.BufferGeometry){var h=f.getAttribute("position"),p=f.getAttribute("normal"),m=f.getAttribute("uv"),v=f.getAttribute("color"),g=f.getIndex();if(d.getNormalMatrix(t.matrixWorld),void 0===h)return;for(var y=0,x=h.count;y<x;y++){c.x=h.getX(y),c.y=h.getY(y),c.z=h.getZ(y),c.applyMatrix4(t.matrixWorld);var b=c.x+" "+c.y+" "+c.z;!0===r&&(void 0!==p?(c.x=p.getX(y),c.y=p.getY(y),c.z=p.getZ(y),c.applyMatrix3(d),b+=" "+c.x+" "+c.y+" "+c.z):b+=" 0 0 0"),!0===i&&(void 0!==m?b+=" "+m.getX(y)+" "+m.getY(y):!1!==i&&(b+=" 0 0")),!0===a&&(b+=void 0!==v?" "+Math.floor(v.getX(y))+" "+Math.floor(v.getY(y))+" "+Math.floor(v.getZ(y)):" 255 255 255"),l+=b+"\n"}if(null!==g)for(y=0,x=g.count;y<x;y+=3)u+="3 "+(g.getX(y+0)+o),u+=" "+(g.getX(y+1)+o),u+=" "+(g.getX(y+2)+o)+"\n";else for(var y=0,x=h.count;y<x;y+=3)u+="3 "+(o+y)+" "+(o+y+1)+" "+(o+y+2)+"\n";o+=h.count,s+=g?g.count/3:h.count/3}}});var f="ply\nformat ascii 1.0\nelement vertex "+o+"\nproperty float x\nproperty float y\nproperty float z\n";return!0===r&&(f+="property float nx\nproperty float ny\nproperty float nz\n"),!0===i&&(f+="property float s\nproperty float t\n"),!0===a&&(f+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),f+="element face "+s+"\nproperty list uchar int vertex_index\nend_header\n"+l+"\n"+u+"\n"}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(){};i.prototype={constructor:i,parse:function(){var e=new n.Vector3,t=new n.Matrix3;return function(r){var a=[],i=0;r.traverse(function(e){if(e instanceof n.Mesh){var t=e.geometry;t instanceof n.BufferGeometry&&(t=(new n.Geometry).fromBufferGeometry(t)),t instanceof n.Geometry&&(i+=t.faces.length,a.push({geometry:t,matrix:e.matrixWorld}))}});var o=80,s=2*i+3*i*4*4+80+4,l=new ArrayBuffer(s),u=new DataView(l);return u.setUint32(o,i,!0),o+=4,a.forEach(function(r){var a=r.geometry.vertices,n=r.geometry.faces;t.getNormalMatrix(r.matrix);for(var i=0,s=n.length;i<s;i++){var l=n[i];e.copy(l.normal).applyMatrix3(t).normalize(),u.setFloat32(o,e.x,!0),o+=4,u.setFloat32(o,e.y,!0),o+=4,u.setFloat32(o,e.z,!0),o+=4;for(var c=[l.a,l.b,l.c],d=0;d<3;d++)e.copy(a[c[d]]).applyMatrix4(r.matrix),u.setFloat32(o,e.x,!0),o+=4,u.setFloat32(o,e.y,!0),o+=4,u.setFloat32(o,e.z,!0),o+=4;u.setUint16(o,0,!0),o+=2}}),u}}()},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(){};i.prototype={constructor:i,parse:function(){var e=new n.Vector3,t=new n.Matrix3;return function(r){var a="";return a+="solid exported\n",r.traverse(function(r){if(r instanceof n.Mesh){var i=r.geometry,o=r.matrixWorld;if(i instanceof n.BufferGeometry&&(i=(new n.Geometry).fromBufferGeometry(i)),i instanceof n.Geometry){var s=i.vertices,l=i.faces;t.getNormalMatrix(o);for(var u=0,c=l.length;u<c;u++){var d=l[u];e.copy(d.normal).applyMatrix3(t).normalize(),a+="\tfacet normal "+e.x+" "+e.y+" "+e.z+"\n",a+="\t\touter loop\n";for(var f=[d.a,d.b,d.c],h=0;h<3;h++)e.copy(s[f[h]]).applyMatrix4(o),a+="\t\t\tvertex "+e.x+" "+e.y+" "+e.z+"\n";a+="\t\tendloop\n",a+="\tendfacet\n"}}}}),a+="endsolid exported\n"}}()},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){};a.prototype={constructor:a,parse:function(e){var t={metadata:{version:4,type:"TypedGeometry",generator:"TypedGeometryExporter"}},r=["vertices","normals","uvs"];for(var a in r){for(var n=r[a],i=e[n],o=[],s=0,l=i.length;s<l;s++)o[s]=i[s];t[n]=o}var u=e.boundingSphere;return null!==u&&(t.boundingSphere={center:u.center.toArray(),radius:u.radius}),t}},t.default=a},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.XLoader=t.VTKLoader=t.UTF8Loader=t.VRMLoader=t.VRMLLoader=t.TTFLoader=t.TGALoader=t.TDSLoader=t.SVGLoader=t.STLLoader=t.RGBELoader=t.PVRLoader=t.PRWMLoader=t.PLYLoader=t.PlayCanvasLoader=t.PDBLoader=t.PCDLoader=t.OBJLoader2=t.OBJLoader=t.NRRDLoader=t.NodeMaterialLoader=t.MTLLoader=t.MMDLoader=t.MD2Loader=t.LoaderSupport=t.KTXLoader=t.KMZLoader=t.HDRCubeTextureLoader=t.GLTFLoader=t.GCodeLoader=t.FBXLoader=t.EXRLoader=t.EquiangularToCubeGenerator=t.DRACOLoader=t.DDSLoader=t.ColladaLoader=t.BVHLoader=t.BinaryLoader=t.BabylonLoader=t.AWDLoader=t.AssimpLoader=t.AssimpJSONLoader=t.AMFLoader=t.ThreeMFLoader=void 0;var n=r(49),i=a(n),o=r(50),s=a(o),l=r(51),u=a(l),c=r(52),d=a(c),f=r(53),h=a(f),p=r(54),m=a(p),v=r(55),g=a(v),y=r(56),x=a(y),b=r(57),A=a(b),w=r(58),M=a(w),T=r(59),S=a(T),F=r(60),E=a(F),_=r(61),P=a(_),L=r(62),C=a(L),N=r(63),O=a(N),I=r(5),U=a(I),D=r(64),R=a(D),k=r(65),B=a(k),j=r(66),V=a(j),G=r(7),z=a(G),H=r(68),X=a(H),Y=r(69),W=a(Y),Q=r(9),q=a(Q),K=r(70),Z=a(K),J=r(71),$=a(J),ee=r(72),te=a(ee),re=r(73),ae=a(re),ne=r(74),ie=a(ne),oe=r(75),se=a(oe),le=r(76),ue=a(le),ce=r(77),de=a(ce),fe=r(78),he=a(fe),pe=r(79),me=a(pe),ve=r(6),ge=a(ve),ye=r(80),xe=a(ye),be=r(81),Ae=a(be),we=r(82),Me=a(we),Te=r(83),Se=a(Te),Fe=r(84),Ee=a(Fe),_e=r(85),Pe=a(_e),Le=r(86),Ce=a(Le),Ne=r(87),Oe=a(Ne),Ie=r(88),Ue=a(Ie),De=r(89),Re=a(De);t.ThreeMFLoader=i.default,t.AMFLoader=s.default,t.AssimpJSONLoader=u.default,t.AssimpLoader=d.default,t.AWDLoader=h.default,t.BabylonLoader=m.default,t.BinaryLoader=g.default,t.BVHLoader=x.default,t.ColladaLoader=A.default,t.DDSLoader=M.default,t.DRACOLoader=S.default,t.EquiangularToCubeGenerator=E.default,t.EXRLoader=P.default,t.FBXLoader=C.default,t.GCodeLoader=O.default,t.GLTFLoader=U.default,t.HDRCubeTextureLoader=R.default,t.KMZLoader=B.default,t.KTXLoader=V.default,t.LoaderSupport=z.default,t.MD2Loader=X.default,t.MMDLoader=W.default,t.MTLLoader=q.default,t.NodeMaterialLoader=Z.default,t.NRRDLoader=$.default,t.OBJLoader=te.default,t.OBJLoader2=ae.default,t.PCDLoader=ie.default,t.PDBLoader=se.default,t.PlayCanvasLoader=ue.default,t.PLYLoader=de.default,t.PRWMLoader=he.default,t.PVRLoader=me.default,t.RGBELoader=ge.default,t.STLLoader=xe.default,t.SVGLoader=Ae.default,t.TDSLoader=Me.default,t.TGALoader=Se.default,t.TTFLoader=Ee.default,t.VRMLLoader=Pe.default,t.VRMLoader=Ce.default,t.UTF8Loader=Oe.default,t.VTKLoader=Ue.default,t.XLoader=Re.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.availableExtensions=[]};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e){var t=(new DOMParser).parseFromString(e,"application/xml"),r=t.querySelector("Relationship");return{target:r.getAttribute("Target"),id:r.getAttribute("Id"),type:r.getAttribute("Type")}}function r(e){for(var t={},r=0;r<e.length;r++){var a=e[r],n=a.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(n)&&(t[n]=a.textContent)}return t}function a(e){}function i(e,t){for(var r={},a=[],n=e.querySelectorAll("vertices vertex"),i=0;i<n.length;i++){var o=n[i],s=o.getAttribute("x"),l=o.getAttribute("y"),u=o.getAttribute("z");a.push(parseFloat(s),parseFloat(l),parseFloat(u))}r.vertices=new Float32Array(a.length);for(var i=0;i<a.length;i++)r.vertices[i]=a[i];for(var c=[],d=[],f=e.querySelectorAll("triangles triangle"),i=0;i<f.length;i++){var h=f[i],p=h.getAttribute("v1"),m=h.getAttribute("v2"),v=h.getAttribute("v3"),g=h.getAttribute("p1"),y=h.getAttribute("p2"),x=h.getAttribute("p3"),b=h.getAttribute("pid");d.push(parseInt(p,10),parseInt(m,10),parseInt(v,10));var A={};g&&(A.p1=parseInt(g,10)),y&&(A.p2=parseInt(y,10)),x&&(A.p3=parseInt(x,10)),b&&(A.pid=b),0<Object.keys(A).length&&c.push(A)}r.triangleProperties=c,r.triangles=new Uint32Array(d.length);for(var i=0;i<d.length;i++)r.triangles[i]=d[i];return r}function o(e){}function s(e){var t={type:e.getAttribute("type")},r=e.getAttribute("id");r&&(t.id=r);var a=e.getAttribute("pid");a&&(t.pid=a);var n=e.getAttribute("pindex");n&&(t.pindex=n);var s=e.getAttribute("thumbnail");s&&(t.thumbnail=s);var l=e.getAttribute("partnumber");l&&(t.partnumber=l);var u=e.getAttribute("name");u&&(t.name=u);var c=e.querySelector("mesh");c&&(t.mesh=i(c));var d=e.querySelector("components");return d&&(t.components=o(d)),t}function l(e){var t={},r=e.querySelector("basematerials");r&&(t.basematerial=a(r)),t.object={};for(var n=e.querySelectorAll("object"),i=0;i<n.length;i++){var o=n[i],l=s(o);t.object[l.id]=l}return t}function u(e){for(var t=[],r=e.querySelectorAll("item"),a=0;a<r.length;a++){var i=r[a],o={objectid:i.getAttribute("objectid")},s=i.getAttribute("transform");if(s){var l=[];s.split(" ").forEach(function(e){l.push(parseFloat(e))});var u=new n.Matrix4;o.transform=u.set(l[0],l[3],l[6],l[9],l[1],l[4],l[7],l[10],l[2],l[5],l[8],l[11],0,0,0,1)}t.push(o)}return t}function c(e){var t={unit:e.getAttribute("unit")||"millimeter"},a=e.querySelectorAll("metadata");a&&(t.metadata=r(a));var n=e.querySelector("resources");n&&(t.resources=l(n));var i=e.querySelector("build");return i&&(t.build=u(i)),t}function d(e,t){var r=new n.BufferGeometry;r.setIndex(new n.BufferAttribute(e.triangles,1)),r.addAttribute("position",new n.BufferAttribute(e.vertices,3)),e.colors&&r.addAttribute("color",new n.BufferAttribute(e.colors,3)),r.computeBoundingSphere();var a={flatShading:!0};e.colors&&0<e.colors.length?a.vertexColors=n.VertexColors:a.color=11184895;var i=new n.MeshPhongMaterial(a);return new n.Mesh(r,i)}function f(e,t,r,a){if(e){for(var n=[],i=Object.keys(e),o=0;o<i.length;o++)for(var s=i[o],l=0;l<h.availableExtensions.length;l++){var u=h.availableExtensions[l];u.ns===s&&n.push(u)}for(var o=0;o<n.length;o++){var u=n[o];u.apply(r,e[u.ns],t)}}}var h=this,p=function(e){var r,a,i=null,o=null,s=[],l=[],u=[],d=[],f={},h={},p={},m={};try{i=new JSZip(e)}catch(e){if(e instanceof ReferenceError)return console.error("THREE.ThreeMFLoader: jszip missing and file is compressed."),null}for(o in i.files)o.match(/\.rels$/)?r=o:o.match(/^3D\/.*\.model$/)?s.push(o):o.match(/^3D\/Metadata\/.*\.xml$/)?l.push(o):o.match(/^3D\/Textures\/.*/)?u.push(o):o.match(/^3D\/Other\/.*/)&&d.push(o);var v=new Uint8Array(i.file(r).asArrayBuffer());a=t(n.LoaderUtils.decodeText(v));for(var g=0;g<s.length;g++){var y=s[g],x=new Uint8Array(i.file(y).asArrayBuffer()),b=n.LoaderUtils.decodeText(x),A=(new DOMParser).parseFromString(b,"application/xml");"model"!==A.documentElement.nodeName.toLowerCase()&&console.error("THREE.ThreeMFLoader: Error loading 3MF - no 3MF document found: ",y);for(var w=A.querySelector("model"),M={},g=0;g<w.attributes.length;g++){var T=w.attributes[g];T.name.match(/^xmlns:(.+)$/)&&(M[T.value]=RegExp.$1)}var S=c(w);S.xml=w,0<Object.keys(M).length&&(S.extensions=M),f[y]=S}for(var g=0;g<u.length;g++){var F=u[g];p[F]=i.file(F).asBinary()}return{rels:a,model:f,printTicket:h,texture:p,other:m}}(e),m=function(e){for(var t=e.model,r={},a=Object.keys(t),n=0;n<a.length;n++)for(var i=a[n],o=t[i],s=o.xml,l=o.extensions,u=Object.keys(o.resources.object),c=0;c<u.length;c++){var h=u[c],p=o.resources.object[h],m=p.mesh;f(l,m,s,e),r[h]=d(m,e)}return r}(p);return function(e,t,r){for(var a=new n.Group,i=r.model[t.target.substring(1)].build,o=0;o<i.length;o++){var s=i[o],l=e[s.objectid];s.transform&&l.geometry.applyMatrix(s.transform),a.add(l)}return a}(m,p.rels,p)},addExtension:function(e){this.availableExtensions.push(e)}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e){for(var t={r:1,g:1,b:1,a:1},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];"r"===a.nodeName?t.r=a.textContent:"g"===a.nodeName?t.g=a.textContent:"b"===a.nodeName?t.b=a.textContent:"a"===a.nodeName&&(t.a=a.textContent)}return t}function r(e){var t={name:"",triangles:[],materialid:null},r=e.firstElementChild;for(void 0!==e.attributes.materialid&&(t.materialId=e.attributes.materialid.nodeValue);r;){if("metadata"===r.nodeName)void 0!==r.attributes.type&&"name"===r.attributes.type.value&&(t.name=r.textContent);else if("triangle"===r.nodeName){var a=r.getElementsByTagName("v1")[0].textContent,n=r.getElementsByTagName("v2")[0].textContent,i=r.getElementsByTagName("v3")[0].textContent;t.triangles.push(a,n,i)}r=r.nextElementSibling}return t}function a(e){for(var t=[],r=[],a=e.firstElementChild;a;){if("vertex"===a.nodeName)for(var n=a.firstElementChild;n;){if("coordinates"===n.nodeName){var i=n.getElementsByTagName("x")[0].textContent,o=n.getElementsByTagName("y")[0].textContent,s=n.getElementsByTagName("z")[0].textContent;t.push(i,o,s)}else if("normal"===n.nodeName){var l=n.getElementsByTagName("nx")[0].textContent,u=n.getElementsByTagName("ny")[0].textContent,c=n.getElementsByTagName("nz")[0].textContent;r.push(l,u,c)}n=n.nextElementSibling}a=a.nextElementSibling}return{vertices:t,normals:r}}var i,o,s=function(e){var t=new DataView(e);if("PK"===String.fromCharCode(t.getUint8(0),t.getUint8(1))){var r=null,a=null;console.log("THREE.AMFLoader: Loading Zip");try{r=new JSZip(e)}catch(e){if(e instanceof ReferenceError)return console.log("THREE.AMFLoader: jszip missing and file is compressed."),null}for(a in r.files)if(".amf"===a.toLowerCase().substr(-4))break;console.log("THREE.AMFLoader: Trying to load file asset: "+a),t=new DataView(r.file(a).asArrayBuffer())}var i=n.LoaderUtils.decodeText(t),o=(new DOMParser).parseFromString(i,"application/xml");return"amf"!==o.documentElement.nodeName.toLowerCase()?(console.log("THREE.AMFLoader: Error loading AMF - no AMF document found."),null):o}(e),l="",u="",c=function(e){var t=1,r="millimeter";void 0!==e.documentElement.attributes.unit&&(r=e.documentElement.attributes.unit.value.toLowerCase());var a={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return void 0!==a[r]&&(t=a[r]),console.log("THREE.AMFLoader: Unit scale: "+t),t}(s),d={},f={},h=s.documentElement.childNodes;for(i=0;i<h.length;i++){var p=h[i];if("metadata"===p.nodeName)void 0!==p.attributes.type&&("name"===p.attributes.type.value?l=p.textContent:"author"===p.attributes.type.value&&(u=p.textContent));else if("material"===p.nodeName){var m=function(e){for(var r="AMF Material",a=e.attributes.id.textContent,i={r:1,g:1,b:1,a:1},o=null,s=0;s<e.childNodes.length;s++){var l=e.childNodes[s];"metadata"===l.nodeName&&void 0!==l.attributes.type?"name"===l.attributes.type.value&&(r=l.textContent):"color"===l.nodeName&&(i=t(l))}return o=new n.MeshPhongMaterial({flatShading:!0,color:new n.Color(i.r,i.g,i.b),name:r}),1!==i.a&&(o.transparent=!0,o.opacity=i.a),{id:a,material:o}}(p);d[m.id]=m.material}else if("object"===p.nodeName){var v=function(e){for(var n=e.attributes.id.textContent,i={name:"amfobject",meshes:[]},o=null,s=e.firstElementChild;s;){if("metadata"===s.nodeName)void 0!==s.attributes.type&&"name"===s.attributes.type.value&&(i.name=s.textContent);else if("color"===s.nodeName)o=t(s);else if("mesh"===s.nodeName){for(var l=s.firstElementChild,u={vertices:[],normals:[],volumes:[],color:o};l;){if("vertices"===l.nodeName){var c=a(l);u.normals=u.normals.concat(c.normals),u.vertices=u.vertices.concat(c.vertices)}else"volume"===l.nodeName&&u.volumes.push(r(l));l=l.nextElementSibling}i.meshes.push(u)}s=s.nextElementSibling}return{id:n,obj:i}}(p);f[v.id]=v.obj}}var g=new n.Group,y=new n.MeshPhongMaterial({color:11184895,flatShading:!0});g.name=l,g.userData.author=u,g.userData.loader="AMF";for(var x in f){var b=f[x],A=b.meshes,w=new n.Group;for(w.name=b.name||"",i=0;i<A.length;i++){var M=y,T=A[i],S=new n.Float32BufferAttribute(T.vertices,3),F=null;if(T.normals.length&&(F=new n.Float32BufferAttribute(T.normals,3)),T.color){var E=T.color;M=y.clone(),M.color=new n.Color(E.r,E.g,E.b),1!==E.a&&(M.transparent=!0,M.opacity=E.a)}var _=T.volumes;for(o=0;o<_.length;o++){var P=_[o],L=new n.BufferGeometry,C=M;L.setIndex(P.triangles),L.addAttribute("position",S.clone()),F&&L.addAttribute("normal",F.clone()),void 0!==d[P.materialId]&&(C=d[P.materialId]),L.scale(c,c,c),w.add(new n.Mesh(L,C.clone()))}}g.add(w)}return g}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,crossOrigin:"Anonymous",load:function(e,t,r,a){var i=this,o=n.LoaderUtils.extractUrlBase(e);new n.FileLoader(this.manager).load(e,function(e){var r=JSON.parse(e),n=r.__metadata__;if(void 0!==n){if("assimp2json"!==n.format)return void a("THREE.AssimpJSONLoader: Not an assimp2json scene.");if(n.version<100&&n.version>=200)return void a("THREE.AssimpJSONLoader: Unsupported assimp2json file format version.")}t(i.parse(r,o))},r,a)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){function r(e,t){for(var r=new Array(e.length),a=0;a<e.length;++a)r[a]=t.call(this,e[a]);return r}function a(e){var t,r,a,i=new n.BufferGeometry,o=[],s=e.vertices||[],l=e.normals||[],u=e.texturecoords||[],c=e.colors||[];for(u=u[0]||[],t=0,r=e.faces.length;t<r;t++)a=e.faces[t],o.push(a[0],a[1],a[2]);return i.setIndex(o),i.addAttribute("position",new n.Float32BufferAttribute(s,3)),l.length>0&&i.addAttribute("normal",new n.Float32BufferAttribute(l,3)),u.length>0&&i.addAttribute("uv",new n.Float32BufferAttribute(u,2)),c.length>0&&i.addAttribute("color",new n.Float32BufferAttribute(c,3)),i.computeBoundingSphere(),i}function i(e){var t=new n.MeshPhongMaterial;for(var r in e.properties){var a=e.properties[r],i=a.key,o=a.value;switch(i){case"$tex.file":var l=a.semantic;if(1===l||2===l||5===l||6===l){var u;switch(l){case 1:u="map";break;case 2:u="specularMap";break;case 5:u="bumpMap";break;case 6:u="normalMap"}var c=s.load(o);c.wrapS=c.wrapT=n.RepeatWrapping,t[u]=c}break;case"?mat.name":t.name=o;break;case"$clr.diffuse":t.color.fromArray(o);break;case"$clr.specular":t.specular.fromArray(o);break;case"$clr.emissive":t.emissive.fromArray(o);break;case"$mat.shininess":t.shininess=o;break;case"$mat.shadingm":t.flatShading=1===o;break;case"$mat.opacity":o<1&&(t.opacity=o,t.transparent=!0)}}return t}function o(e,t,r,a){var i,s,l=new n.Object3D;for(l.name=t.name||"",l.matrix=(new n.Matrix4).fromArray(t.transformation).transpose(),l.matrix.decompose(l.position,l.quaternion,l.scale),i=0;t.meshes&&i<t.meshes.length;i++)s=t.meshes[i],l.add(new n.Mesh(r[s],a[e.meshes[s].materialindex]));for(i=0;t.children&&i<t.children.length;i++)l.add(o(e,t.children[i],r,a));return l}var s=new n.TextureLoader(this.manager);s.setPath(t).setCrossOrigin(this.crossOrigin);var l=r(e.meshes,a),u=r(e.materials,i);return o(e,e.rootnode,l,u)}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,crossOrigin:"Anonymous",load:function(e,t,r,a){var i=this,o=n.LoaderUtils.extractUrlBase(e),s=new n.FileLoader(this.manager);s.setResponseType("arraybuffer"),s.load(e,function(e){t(i.parse(e,o))},r,a)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){function r(e){return Ee<<e}function a(e){return _e<<e}function i(e){for(var t in e.mMeshes){var r=e.mMeshes[t];for(var a in r.mBones){var n=e.findNode(r.mBones[a].mName);n&&(n.isBone=!0)}}}function o(e,t){var r=new n.Bone;r.matrix.copy(e.matrix),r.matrixWorld.copy(e.matrixWorld),r.position.copy(e.position),r.quaternion.copy(e.quaternion),r.scale.copy(e.scale),t.nodeCount++,r.name="bone_"+e.name+t.nodeCount.toString(),t.nodeToBoneMap[e.name]||(t.nodeToBoneMap[e.name]=[]),t.nodeToBoneMap[e.name].push(r);for(var a in e.children){var i=o(e.children[a],t);i&&r.add(i)}return r}function s(e,t){for(var r=[],a=0;a<e.length;a++)r.push({i:e[a],w:t[a]});for(r.sort(function(e,t){return t.w-e.w});r.length<4;)r.push({i:0,w:0});r.length>4&&(r.length=4);for(var n=0,a=0;a<4;a++)n+=r[a].w*r[a].w;n=Math.sqrt(n);for(var a=0;a<4;a++)r[a].w=r[a].w/n,e[a]=r[a].i,t[a]=r[a].w}function l(e,t){if(0==e.name.indexOf("bone_"+t))return e;for(var r in e.children){var a=l(e.children[r],t);if(a)return a}}function u(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(e,t){if(0!=this.mBones.length){for(var r=[],a=[],i=e.findNode(this.mBones[0].mName);i.mParent&&i.mParent.isBone;)i=i.mParent;var s=i.toTHREE(e),u=o(s,e);this.threeNode.add(u);for(var c=0;c<this.mBones.length;c++){var d=l(u,this.mBones[c].mName);if(d){var f=d;r.push(f),a.push(this.mBones[c].mOffsetMatrix.toTHREE())}else{var i=e.findNode(this.mBones[c].mName);if(!i)return;var s=i.toTHREE(e),u=(s.parent,o(s,e));this.threeNode.add(u);var d=l(u,this.mBones[c].mName),f=d;r.push(f),a.push(this.mBones[c].mOffsetMatrix.toTHREE())}}var h=new n.Skeleton(r,a);this.threeNode.bind(h,new n.Matrix4),this.threeNode.material.skinning=!0}},this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t,r=new n.BufferGeometry;if(t=e.mMaterials[this.mMaterialIndex]?e.mMaterials[this.mMaterialIndex].toTHREE(e):new n.MeshLambertMaterial,r.setIndex(new n.BufferAttribute(new Uint32Array(this.mIndexArray),1)),r.addAttribute("position",new n.BufferAttribute(this.mVertexBuffer,3)),this.mNormalBuffer&&this.mNormalBuffer.length>0&&r.addAttribute("normal",new n.BufferAttribute(this.mNormalBuffer,3)),this.mColorBuffer&&this.mColorBuffer.length>0&&r.addAttribute("color",new n.BufferAttribute(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&this.mTexCoordsBuffers[0].length>0&&r.addAttribute("uv",new n.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&this.mTexCoordsBuffers[1].length>0&&r.addAttribute("uv1",new n.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&this.mTangentBuffer.length>0&&r.addAttribute("tangents",new n.BufferAttribute(this.mTangentBuffer,3)),this.mBitangentBuffer&&this.mBitangentBuffer.length>0&&r.addAttribute("bitangents",new n.BufferAttribute(this.mBitangentBuffer,3)),this.mBones.length>0){for(var a=[],i=[],o=0;o<this.mBones.length;o++)for(var l=0;l<this.mBones[o].mWeights.length;l++){var u=this.mBones[o].mWeights[l];u&&(a[u.mVertexId]||(a[u.mVertexId]=[]),i[u.mVertexId]||(i[u.mVertexId]=[]),a[u.mVertexId].push(u.mWeight),i[u.mVertexId].push(parseInt(o)))}for(var o in i)s(i[o],a[o]);for(var c=[],d=[],o=0;o<a.length;o++)for(var l=0;l<4;l++)a[o]&&i[o]?(c.push(a[o][l]),d.push(i[o][l])):(c.push(0),d.push(0));r.addAttribute("skinWeight",new n.BufferAttribute(new Float32Array(c),Re)),r.addAttribute("skinIndex",new n.BufferAttribute(new Float32Array(d),Re))}var f;return 0==this.mBones.length&&(f=new n.Mesh(r,t)),this.mBones.length>0&&(f=new n.SkinnedMesh(r,t)),this.threeNode=f,f}}function c(){this.mNumIndices=0,this.mIndices=[]}function d(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new n.Vector3(this.x,this.y,this.z)}}function f(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new n.Color(this.r,this.g,this.b,1)}}function h(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new n.Quaternion(this.x,this.y,this.z,this.w)}}function p(){this.mVertexId=0,this.mWeight=0}function m(){this.data=[],this.toString=function(){var e="";return this.data.forEach(function(t){e+=String.fromCharCode(t)}),e.replace(/[^\x20-\x7E]+/g,"")}}function v(){this.mTime=0,this.mValue=null}function g(){this.mTime=0,this.mValue=null}function y(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t=new n.Object3D;t.name=this.mName,t.matrix=this.mTransformation.toTHREE();for(var r=0;r<this.mChildren.length;r++)t.add(this.mChildren[r].toTHREE(e));for(var r=0;r<this.mMeshes.length;r++)t.add(e.mMeshes[this.mMeshes[r]].toTHREE(e));return this.threeNode=t,t.matrix.decompose(t.position,t.quaternion,t.scale),t}}function x(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}function b(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var e=new Uint8Array(this.mData).buffer,t=new DataView(e),r=t.getFloat32(0,!0),a=t.getFloat32(4,!0),i=t.getFloat32(8,!0);return new n.Color(r,a,i)},this.dataAsFloat=function(){var e=new Uint8Array(this.mData).buffer;return new DataView(e).getFloat32(0,!0)},this.dataAsBool=function(){var e=new Uint8Array(this.mData).buffer;return!!new DataView(e).getFloat32(0,!0)},this.dataAsString=function(){var e=new m;return e.data=this.mData,e.toString()},this.dataAsMap=function(){var e=new m;e.data=this.mData;var t=e.toString();return t=t.replace(/\\/g,"/"),-1!=t.indexOf("/")&&(t=t.substr(t.lastIndexOf("/")+1)),ue.load(t)}}function A(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(e){for(var t=(this.mProperties[0].dataAsString(),new n.MeshPhongMaterial),r=0;r<this.mProperties.length;r++)if("float"==Be[this.mProperties[r].mKey]&&(t[ke[this.mProperties[r].mKey]]=this.mProperties[r].dataAsFloat()),"color"==Be[this.mProperties[r].mKey]&&(t[ke[this.mProperties[r].mKey]]=this.mProperties[r].dataAsColor()),"bool"==Be[this.mProperties[r].mKey]&&(t[ke[this.mProperties[r].mKey]]=this.mProperties[r].dataAsBool()),"string"==Be[this.mProperties[r].mKey]&&(t[ke[this.mProperties[r].mKey]]=this.mProperties[r].dataAsString()),"map"==Be[this.mProperties[r].mKey]){var a=this.mProperties[r];a.mSemantic==Oe&&(t.map=this.mProperties[r].dataAsMap()),a.mSemantic==Ie&&(t.normalMap=this.mProperties[r].dataAsMap()),a.mSemantic==De&&(t.lightMap=this.mProperties[r].dataAsMap()),a.mSemantic==Ue&&(t.alphaMap=this.mProperties[r].dataAsMap())}return t.ambient.r=.53,t.ambient.g=.53,t.ambient.b=.53,t.color.r=1,t.color.g=1,t.color.b=1,t}}function w(e,t,r){var a=new n.Vector3,i=1-r;return a.x=e.x*r+t.x*i,a.y=e.y*r+t.y*i,a.z=e.z*r+t.z*i,a}function M(e,t,r){return e.clone().slerp(t,1-r)}function T(e,t,r,a){if(1==e.length)return e[0].mValue.toTHREE();for(var n=1/0,i=null,o=null,s=0;s<e.length;s++){var l=Math.abs(e[s].mTime-t);l<n&&e[s].mTime<=t&&(n=l,i=e[s],o=e[s+1])}if(i){if(o){var u=o.mTime-i.mTime,c=i.mTime-t,d=c/u;return a(i.mValue.toTHREE(),o.mValue.toTHREE(),d)}o=e[0].clone(),o.mTime+=r;var u=o.mTime-i.mTime,c=i.mTime-t,d=c/u;return a(i.mValue.toTHREE(),o.mValue.toTHREE(),d)}return null}function S(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(e){function t(t){t.mTime/=e}e||(e=1),this.mPositionKeys.forEach(t),this.mRotationKeys.forEach(t),this.mScalingKeys.forEach(t)},this.sortKeys=function(){function e(e,t){return e.mTime-t.mTime}this.mPositionKeys.sort(e),this.mRotationKeys.sort(e),this.mScalingKeys.sort(e)},this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map(function(e){return e.mTime})),Math.max.apply(null,this.mRotationKeys.map(function(e){return e.mTime})),Math.max.apply(null,this.mScalingKeys.map(function(e){return e.mTime})))},this.toTHREE=function(e,t){this.sortKeys();for(var r=this.getLength(),a=new ce.KeyFrameTrack,i=0;i<r;i+=.05){var o=new n.Matrix4,s=i,l=T(this.mPositionKeys,s,r,w),u=T(this.mScalingKeys,s,r,w),c=T(this.mRotationKeys,s,r,M);o.compose(l,c,u);var d=new ce.KeyFrame(s,o);a.addKey(d)}a.target=e.findNode(this.mNodeName).toTHREE();var f=[a];if(e.nodeToBoneMap[this.mNodeName])for(var i=0;i<e.nodeToBoneMap[this.mNodeName].length;i++){var h=a.clone();h.target=e.nodeToBoneMap[this.mNodeName][i],f.push(h)}return f}}function F(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(e){var t=new ce.Animation;for(var r in this.mChannels){this.mChannels[r].init(this.mTicksPerSecond);var a=this.mChannels[r].toTHREE(e);for(var n in a)a[n].init(),t.addTrack(a[n])}return t.length=Math.max.apply(null,t.tracks.map(function(e){return e.length})),t}}function E(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}function _(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}function P(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}function L(){this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(e,t){if(t||(t=this.mRootNode),t.mName==e)return t;for(var r=0;r<t.mChildren.length;r++){var a=this.findNode(e,t.mChildren[r]);if(a)return a}return null},this.toTHREE=function(){this.nodeCount=0,i(this);var e=this.mRootNode.toTHREE(this);for(var t in this.mMeshes)this.mMeshes[t].hookupSkeletons(this,e);if(this.mAnimations.length>0)var r=this.mAnimations[0].toTHREE(this);return{object:e,animation:r}}}function C(){this.elements=[[],[],[],[]],this.toTHREE=function(){for(var e=new n.Matrix4,t=0;t<4;++t)for(var r=0;r<4;++r)e.elements[4*t+r]=this.elements[r][t];return e}}function N(e){var t=e.getFloat32(e.readOffset,je);return e.readOffset+=4,t}function O(e){var t=e.getFloat64(e.readOffset,je);return e.readOffset+=8,t}function I(e){var t=e.getUint8(e.readOffset);return e.readOffset+=1,t}function U(e){var t=e.getUint16(e.readOffset,je);return e.readOffset+=2,t}function D(e){var t=e.getUint32(e.readOffset,je);return e.readOffset+=4,t}function R(e){var t=e.getUint32(e.readOffset,je);return e.readOffset+=4,t}function k(e){var t=new d;return t.x=N(e),t.y=N(e),t.z=N(e),t}function B(e){var t=new f;return t.r=N(e),t.g=N(e),t.b=N(e),t}function j(e){var t=new h;return t.w=N(e),t.x=N(e),t.y=N(e),t.z=N(e),t}function V(e){var t=new m,r=D(e);return e.ReadBytes(t.data,1,r),t.toString()}function G(e){var t=new p;return t.mVertexId=D(e),t.mWeight=N(e),t}function z(e){for(var t=new C,r=0;r<4;++r)for(var a=0;a<4;++a)t.elements[r][a]=N(e);return t}function H(e){var t=new v;return t.mTime=O(e),t.mValue=k(e),t}function X(e){var t=new g;return t.mTime=O(e),t.mValue=j(e),t}function Y(e,t,r){for(var a=0;a<r;a++)t[a]=G(e)}function W(e,t,r){for(var a=0;a<r;a++)t[a]=H(e)}function Q(e,t,r){for(var a=0;a<r;a++)t[a]=X(e)}function q(e,t,r){return e.Seek(sizeof(t)*r,Ve)}function K(e){if(!e)throw"asset failed"}function Z(e,t,r){K(R(e)==Ae),R(e);var a=new y;if(a.mParent=t,a.mDepth=r,a.mName=V(e),a.mTransformation=z(e),a.mNumChildren=D(e),a.mNumMeshes=D(e),a.mNumMeshes){a.mMeshes=[];for(var n=0;n<a.mNumMeshes;++n)a.mMeshes[n]=D(e)}if(a.mNumChildren){a.mChildren=[];for(var n=0;n<a.mNumChildren;++n){var i=Z(e,a,r++);a.mChildren[n]=i}}return a}function J(e,t){return K(R(e)==xe),R(e),t.mName=V(e),t.mNumWeights=D(e),t.mOffsetMatrix=z(e),de?q(e,t.mWeights,t.mNumWeights):(t.mWeights=[],Y(e,t.mWeights,t.mNumWeights)),t}function $(e,t){K(R(e)==ve),R(e),t.mPrimitiveTypes=D(e),t.mNumVertices=D(e),t.mNumFaces=D(e),t.mNumBones=D(e),t.mMaterialIndex=D(e),t.mNumUVComponents=[];var n=D(e);n&Te&&(de?q(e,t.mVertices,t.mNumVertices):(t.mVertices=[],t.mVertexBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ve))),n&Se&&(de?q(e,t.mNormals,t.mNumVertices):(t.mNormals=[],t.mNormalBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ve))),n&Fe&&(de?(q(e,t.mTangents,t.mNumVertices),q(e,t.mBitangents,t.mNumVertices)):(t.mTangents=[],t.mTangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ve),t.mBitangents=[],t.mBitangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,Ve)));for(var i=0;i<Pe&&n&a(i);++i)de?q(e,t.mColors[i],t.mNumVertices):(t.mColors[i]=[],t.mColorBuffer=e.subArray32(e.readOffset,e.readOffset+4*t.mNumVertices*4),e.Seek(4*t.mNumVertices*4,Ve));t.mTexCoordsBuffers=[];for(var i=0;i<Le&&n&r(i);++i)if(t.mNumUVComponents[i]=D(e),de)q(e,t.mTextureCoords[i],t.mNumVertices);else{t.mTextureCoords[i]=[],t.mTexCoordsBuffers[i]=[];for(var o=0;o<t.mNumVertices;o++)t.mTexCoordsBuffers[i].push(N(e)),t.mTexCoordsBuffers[i].push(N(e)),N(e)}if(de)D(e);else{t.mFaces=[];t.mIndexArray=[];for(var s=0;s<t.mNumFaces;++s){var l=t.mFaces[s]=new c;l.mNumIndices=U(e),l.mIndices=[];for(var u=0;u<l.mNumIndices;++u)t.mNumVertices<65536?l.mIndices[u]=U(e):l.mIndices[u]=D(e);if(3===l.mNumIndices)t.mIndexArray.push(l.mIndices[0]),t.mIndexArray.push(l.mIndices[1]),t.mIndexArray.push(l.mIndices[2]);else{if(4!==l.mNumIndices)throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");t.mIndexArray.push(l.mIndices[0]),t.mIndexArray.push(l.mIndices[1]),t.mIndexArray.push(l.mIndices[2]),t.mIndexArray.push(l.mIndices[2]),t.mIndexArray.push(l.mIndices[3]),t.mIndexArray.push(l.mIndices[0])}}}if(t.mNumBones){t.mBones=[];for(var u=0;u<t.mNumBones;++u)t.mBones[u]=new x,J(e,t.mBones[u])}}function ee(e,t){K(R(e)==Me),R(e),t.mKey=V(e),t.mSemantic=D(e),t.mIndex=D(e),t.mDataLength=D(e),t.mType=D(e),t.mData=[],e.ReadBytes(t.mData,1,t.mDataLength)}function te(e,t){if(K(R(e)==we),R(e),t.mNumAllocated=t.mNumProperties=D(e),t.mNumProperties){t.mProperties&&delete t.mProperties,t.mProperties=[];for(var r=0;r<t.mNumProperties;++r)t.mProperties[r]=new b,ee(e,t.mProperties[r])}}function re(e,t){K(R(e)==ge),R(e),t.mNodeName=V(e),t.mNumPositionKeys=D(e),t.mNumRotationKeys=D(e),t.mNumScalingKeys=D(e),t.mPreState=D(e),t.mPostState=D(e),t.mNumPositionKeys&&(de?q(e,t.mPositionKeys,t.mNumPositionKeys):(t.mPositionKeys=[],W(e,t.mPositionKeys,t.mNumPositionKeys))),t.mNumRotationKeys&&(de?q(e,t.mRotationKeys,t.mNumRotationKeys):(t.mRotationKeys=[],Q(e,t.mRotationKeys,t.mNumRotationKeys))),t.mNumScalingKeys&&(de?q(e,t.mScalingKeys,t.mNumScalingKeys):(t.mScalingKeys=[],W(e,t.mScalingKeys,t.mNumScalingKeys)))}function ae(e,t){if(K(R(e)==be),R(e),t.mName=V(e),t.mDuration=O(e),t.mTicksPerSecond=O(e),t.mNumChannels=D(e),t.mNumChannels){t.mChannels=[];for(var r=0;r<t.mNumChannels;++r)t.mChannels[r]=new S,re(e,t.mChannels[r])}}function ne(e,t){K(R(e)==me),R(e),t.mWidth=D(e),t.mHeight=D(e),e.ReadBytes(t.achFormatHint,1,4),de||(t.mHeight?(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth*t.mHeight*4)):(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth)))}function ie(e,t){K(R(e)==pe),R(e),t.mName=V(e),t.mType=D(e),t.mType!=Ce&&(t.mAttenuationConstant=N(e),t.mAttenuationLinear=N(e),t.mAttenuationQuadratic=N(e)),t.mColorDiffuse=B(e),t.mColorSpecular=B(e),t.mColorAmbient=B(e),t.mType==Ne&&(t.mAngleInnerCone=N(e),t.mAngleOuterCone=N(e))}function oe(e,t){K(R(e)==he),R(e),t.mName=V(e),t.mPosition=k(e),t.mLookAt=k(e),t.mUp=k(e),t.mHorizontalFOV=N(e),t.mClipPlaneNear=N(e),t.mClipPlaneFar=N(e),t.mAspect=N(e)}function se(e,t){if(K(R(e)==ye),R(e),t.mFlags=D(e),t.mNumMeshes=D(e),t.mNumMaterials=D(e),t.mNumAnimations=D(e),t.mNumTextures=D(e),t.mNumLights=D(e),t.mNumCameras=D(e),t.mRootNode=new y,t.mRootNode=Z(e,null,0),t.mNumMeshes){t.mMeshes=[];for(var r=0;r<t.mNumMeshes;++r)t.mMeshes[r]=new u,$(e,t.mMeshes[r])}if(t.mNumMaterials){t.mMaterials=[];for(var r=0;r<t.mNumMaterials;++r)t.mMaterials[r]=new A,te(e,t.mMaterials[r])}if(t.mNumAnimations){t.mAnimations=[];for(var r=0;r<t.mNumAnimations;++r)t.mAnimations[r]=new F,ae(e,t.mAnimations[r])}if(t.mNumTextures){t.mTextures=[];for(var r=0;r<t.mNumTextures;++r)t.mTextures[r]=new E,ne(e,t.mTextures[r])}if(t.mNumLights){t.mLights=[];for(var r=0;r<t.mNumLights;++r)t.mLights[r]=new _,ie(e,t.mLights[r])}if(t.mNumCameras){t.mCameras=[];for(var r=0;r<t.mNumCameras;++r)t.mCameras[r]=new P,oe(e,t.mCameras[r])}}function le(e){e.readOffset=0,e.Seek=function(t,r){r==Ve&&(e.readOffset+=t),r==Ge&&(e.readOffset=t)},e.ReadBytes=function(e,t,r){for(var a=t*r,n=0;n<a;n++)e[n]=I(this)},e.subArray32=function(e,t){var r=this.buffer,a=r.slice(e,t);return new Float32Array(a)},e.subArrayUint16=function(e,t){var r=this.buffer,a=r.slice(e,t);return new Uint16Array(a)},e.subArrayUint8=function(e,t){var r=this.buffer,a=r.slice(e,t);return new Uint8Array(a)},e.subArrayUint32=function(e,t){var r=this.buffer,a=r.slice(e,t);return new Uint32Array(a)}}var ue=new n.TextureLoader(this.manager);ue.setPath(t).setCrossOrigin(this.crossOrigin);var ce={};ce.KeyFrame=function(e,t){this.time=e,this.matrix=t.clone(),this.position=new n.Vector3,this.quaternion=new n.Quaternion,this.scale=new n.Vector3(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){return new ce.KeyFrame(this.time,this.matrix)},this.lerp=function(e,t){t-=this.time;var r=e.time-this.time,a=t/r,n=1-a,i=this.position,o=this.quaternion,s=e.position,l=e.quaternion;return ce.KeyFrame.tempAniPos.x=i.x*n+s.x*a,ce.KeyFrame.tempAniPos.y=i.y*n+s.y*a,ce.KeyFrame.tempAniPos.z=i.z*n+s.z*a,ce.KeyFrame.tempAniQuat.set(o.x,o.y,o.z,o.w),ce.KeyFrame.tempAniQuat.slerp(l,a),ce.KeyFrame.tempAniMatrix.compose(ce.KeyFrame.tempAniPos,ce.KeyFrame.tempAniQuat,ce.KeyFrame.tempAniScale)}},ce.KeyFrame.tempAniPos=new n.Vector3,ce.KeyFrame.tempAniQuat=new n.Quaternion,ce.KeyFrame.tempAniScale=new n.Vector3(1,1,1),ce.KeyFrame.tempAniMatrix=new n.Matrix4,ce.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(e){this.keys.push(e)},this.init=function(){if(this.sortKeys(),this.keys.length>0?this.length=this.keys[this.keys.length-1].time:this.length=0,this.fps)for(var e=0;e<this.length*this.fps;e++)for(var t=0;t<this.keys.length;t++){if(this.keys[t].time==e){this._accelTable[e]=t;break}if(this.keys[t].time<e/this.fps&&this.keys[t+1]&&this.keys[t+1].time>=e/this.fps){this._accelTable[e]=t;break}}},this.parseFromThree=function(e){var t=e.fps;this.target=e.node;for(var r=e.hierarchy[0].keys,a=0;a<r.length;a++)this.addKey(new ce.KeyFrame(a/t||r[a].time,r[a].targets[0].data));this.init()},this.parseFromCollada=function(e){for(var t=e.keys,r=this.fps,a=0;a<t.length;a++)this.addKey(new ce.KeyFrame(a/r||t[a].time,t[a].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(e,t){return e.time-t.time},this.clone=function(){var e=new ce.KeyFrameTrack;e.target=this.target,e.time=this.time,e.length=this.length;for(var t=0;t<this.keys.length;t++)e.addKey(this.keys[t].clone());return e.init(),e},this.reTarget=function(e,t){t||(t=ce.TrackTargetNodeNameCompare),this.target=t(e,this.target)},this.keySearchAccel=function(e){return e*=this.fps,e=Math.floor(e),this._accelTable[e]||0},this.setTime=function(e){e=Math.abs(e),this.length&&(e=e%this.length+.05);for(var t=null,r=null,a=this.keySearchAccel(e);a<this.keys.length;a++){if(this.keys[a].time==e){t=this.keys[a],r=this.keys[a];break}if(this.keys[a].time<e&&this.keys[a+1]&&this.keys[a+1].time>e){t=this.keys[a],r=this.keys[a+1];break}if(this.keys[a].time<e&&a==this.keys.length-1){t=this.keys[a],r=this.keys[0].clone(),r.time+=this.length+.05;break}}return t&&r&&t!==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.lerp(r,e)),void(this.target.matrixWorldNeedsUpdate=!0)):t&&r&&t==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.matrix),void(this.target.matrixWorldNeedsUpdate=!0)):void 0}},ce.TrackTargetNodeNameCompare=function(e,t){function r(e,t){if(e.name==t)return e;for(var a=0;a<e.children.length;a++){var n=r(e.children[a],t);if(n)return n}return null}return r(e,t.name)},ce.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(e){this.tracks.push(e),this.length=Math.max(e.length,this.length)},this.setTime=function(e){this.time=e;for(var t=0;t<this.tracks.length;t++)this.tracks[t].setTime(e)},this.clone=function(e,t){t||(t=ce.TrackTargetNodeNameCompare);var r=new ce.Animation;r.target=e;for(var a=0;a<this.tracks.length;a++){var n=this.tracks[a].clone();n.reTarget(e,t),r.addTrack(n)}return r}};var de,fe,he=4660,pe=4661,me=4662,ve=4663,ge=4664,ye=4665,xe=4666,be=4667,Ae=4668,we=4669,Me=4670,Te=1,Se=2,Fe=4,Ee=256,_e=65536,Pe=1,Le=4,Ce=1,Ne=3,Oe=1,Ie=6,Ue=8,De=10,Re=4,ke={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},Be={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"},je=!0,Ve=0,Ge=1;return function(e){var t=new L,r=new DataView(e);le(r),r.Seek(44,Ve);D(r),D(r),D(r),D(r);if(de=U(r)>0,fe=U(r)>0,de)throw"Shortened binaries are not supported!";if(r.Seek(256,Ve),r.Seek(128,Ve),r.Seek(64,Ve),!fe)return se(r,t),t.toTHREE();var a=R(r),n=r.FileSize()-r.Tell(),i=[];r.Read(i,1,n);var o=[];uncompress(o,a,i,n),se(new ArrayBuffer(o),t)}(e)}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a);t.default=function(){function e(){this.id=0,this.data=null}function t(){}t.prototype={set:function(e,t){this[e]=t},get:function(e,t){return this.hasOwnProperty(e)?this[e]:t}};var r=function(t){this.manager=void 0!==t?t:n.DefaultLoadingManager,this.trunk=new n.Object3D,this.materialFactory=void 0,this._url="",this._baseDir="",this._data=void 0,this._ptr=0,this._version=[],this._streaming=!1,this._optimized_for_accuracy=!1,this._compression=0,this._bodylen=4294967295,this._blocks=[new e],this._accuracyMatrix=!1,this._accuracyGeo=!1,this._accuracyProps=!1};return r.prototype={constructor:r,load:function(e,t,r,a){var i=this;this._url=e,this._baseDir=e.substr(0,e.lastIndexOf("/")+1);var o=new n.FileLoader(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){var t=e.byteLength;for(this._ptr=0,this._data=new DataView(e),this._parseHeader(),0!=this._compression&&console.error("compressed AWD not supported"),this._streaming||this._bodylen==e.byteLength-this._ptr||console.error("AWDLoader: body len does not match file length",this._bodylen,t-this._ptr);this._ptr<t;)this.parseNextBlock();return this.trunk},parseNextBlock:function(){var t,r,a,n,i=this.readU32(),r=(this.readU8(),this.readU8()),a=(this.readU8(),this.readU32());switch(r){case 1:t=this.parseMeshData(a);break;case 22:t=this.parseContainer(a);break;case 23:t=this.parseMeshInstance(a);break;case 81:t=this.parseMaterial(a);break;case 82:t=this.parseTexture(a);break;case 101:t=this.parseSkeleton(a);break;case 112:t=this.parseMeshPoseAnimation(a,!1);break;case 113:t=this.parseVertexAnimationSet(a);break;case 102:t=this.parseSkeletonPose(a);break;case 103:t=this.parseSkeletonAnimation(a);break;case 122:t=this.parseAnimatorSet(a);break;default:this._ptr+=a}this._blocks[i]=n=new e,n.data=t,n.id=i},_parseHeader:function(){var e=this._version;if(4282180!=(this.readU8()<<16|this.readU8()<<8|this.readU8()))throw new Error("AWDLoader - bad magic");e[0]=this.readU8(),e[1]=this.readU8();var t=this.readU16();this._streaming=1==(1&t),2===e[0]&&1===e[1]&&(this._accuracyMatrix=2==(2&t),this._accuracyGeo=4==(4&t),this._accuracyProps=8==(8&t)),this._geoNrType=this._accuracyGeo?8:7,this._matrixNrType=this._accuracyMatrix?8:7,this._propsNrType=this._accuracyProps?8:7,this._optimized_for_accuracy=2==(2&t),this._compression=this.readU8(),this._bodylen=this.readU32()},parseContainer:function(e){var t,r=new n.Object3D,a=this.readU32(),i=this.parseMatrix4();return r.name=this.readUTF(),r.applyMatrix(i),t=this._blocks[a].data||this.trunk,t.add(r),this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:4}),r.extra=this.parseUserAttributes(),r},parseMeshInstance:function(e){var t,r,a,i,o,s,l,u,c,d,f,h,p,m;for(s=this.readU32(),u=this.parseMatrix4(),t=this.readUTF(),l=this.readU32(),h=this.readU16(),a=this.getBlock(l),c=[],m=0;m<h;m++)f=this.readU32(),d=this.getBlock(f),c.push(d);if(i=a.length,o=[],i>1)for(r=new n.Object3D,m=0;m<i;m++){var v=new n.Mesh(a[m]);o.push(v),r.add(v)}else r=new n.Mesh(a[0]),o.push(r);r.applyMatrix(u),r.name=t,p=this.getBlock(s)||this.trunk,p.add(r);var g=c.length,y=Math.max(i,g);for(m=0;m<y;m++)o[m%i].material=c[m%g];return this.parseProperties(null),r.extra=this.parseUserAttributes(),r},parseMaterial:function(e){var t,r,a,i,o,s,l;for(t=this.readUTF(),r=this.readU8(),s=this.readU8(),a=this.parseProperties({1:3,2:23,11:21,12:7,13:21}),l=0;l<s;){this.readU16();this.parseProperties(null),this.parseUserAttributes()}if(o=this.parseUserAttributes(),void 0!==this.materialFactory&&(i=this.materialFactory(t)))return i;if(i=new n.MeshPhongMaterial,1===r)i.color.setHex(a.get(1,13421772));else if(2===r){var u=a.get(2,0);i.map=this.getBlock(u)}return i.extra=o,i.alphaThreshold=a.get(12,0),i.repeat=a.get(13,!1),i},parseTexture:function(e){var t,r,a=(this.readUTF(),this.readU8());if(0===a){r=this.readU32();var n=this.readUTFBytes(r);console.log(n),t=this.loadTexture(n)}return this.parseProperties(null),this.parseUserAttributes(),t},loadTexture:function(e){var t=new n.Texture;return new n.ImageLoader(this.manager).load(this._baseDir+e,function(e){t.image=e,t.needsUpdate=!0}),t},parseSkeleton:function(e){var t=(this.readUTF(),this.readU16()),r=[],a=0;for(this.parseProperties(null);a<t;){var i,o;this.readU16(),i=new n.Bone,i.parent=this.readU16()-1,i.name=this.readUTF(),o=this.parseMatrix4(),i.skinMatrix=o,this.parseProperties(null),this.parseUserAttributes(),r.push(i),a++}return this.parseUserAttributes(),r},parseSkeletonPose:function(e){var t=(this.readUTF(),this.readU16());this.parseProperties(null);for(var r=[],a=0;a<t;){var i,o;i=this.readU8(),o=1===i?this.parseMatrix4():new n.Matrix4,r[a]=o,a++}return this.parseUserAttributes(),r},parseSkeletonAnimation:function(e){var t,r,a,n=(this.readUTF(),[]),i=this.readU16();this.parseProperties(null);for(var o=0;o<i;)r=this.readU32(),t=this.readU16(),a=this._blocks[r].data,n.push({pose:a,duration:t}),o++;if(0!==n.length)return this.parseUserAttributes(),n},parseVertexAnimationSet:function(e){for(var t,r=(this.readUTF(),this.readU16()),a=(this.parseProperties({1:5}),0),n=[];a<r;)t=this.readU32(),n.push(this._blocks[t].data),a++;return this.parseUserAttributes(),n},parseAnimatorSet:function(e){var t,r,a=(this.readUTF(),this.readU16()),n=this.parseProperties({1:23});t=this.readU32();for(var i=this.readU16(),o=[],s=0;s<i;s++)o.push(this.readU32());this.readU16(),Boolean(this.readU8());this.parseUserAttributes(),this.parseUserAttributes();var l=[];for(s=0;s<o.length;s++)l.push(this._blocks[o[s]].data);r=this._blocks[t].data;var u;for(1==a&&(u={animationSet:r,skeleton:this._blocks[n.get(1,0)].data}),s=0;s<l.length;s++)l[s].animator=u;return u},parseMeshData:function(e){var t,r,a=this.readUTF(),i=this.readU16(),o=0,s=[];for(this.parseProperties({1:this._geoNrType,2:this._geoNrType});o<i;){var l,u,c;for(t=new n.BufferGeometry,t.name=a,s.push(t),l=this.readU32(),u=this._ptr+l,this.parseProperties({1:this._geoNrType,2:this._geoNrType});this._ptr<u;){var d=0,f=this.readU8(),h=(this.readU8(),this.readU32()),p=h+this._ptr;if(1===f)for(r=new Float32Array(h/12*3),c=new n.BufferAttribute(r,3),t.addAttribute("position",c),d=0;this._ptr<p;)r[d]=-this.readF32(),r[d+1]=this.readF32(),r[d+2]=this.readF32(),d+=3;else if(2===f)for(r=new Uint16Array(h/2),c=new n.BufferAttribute(r,1),t.setIndex(c),d=0;this._ptr<p;)r[d+1]=this.readU16(),r[d]=this.readU16(),r[d+2]=this.readU16(),d+=3;else if(3===f)for(r=new Float32Array(h/8*2),c=new n.BufferAttribute(r,2),t.addAttribute("uv",c),d=0;this._ptr<p;)r[d]=this.readF32(),r[d+1]=1-this.readF32(),d+=2;else if(4===f)for(r=new Float32Array(h/12*3),c=new n.BufferAttribute(r,3),t.addAttribute("normal",c),d=0;this._ptr<p;)r[d]=-this.readF32(),r[d+1]=this.readF32(),r[d+2]=this.readF32(),d+=3;else this._ptr=p}this.parseUserAttributes(),t.computeBoundingSphere(),o++}return this.parseUserAttributes(),s},parseMeshPoseAnimation:function(e,t){var r,a,n,i,o,s,l,u,c,d=1,f=0,h={},p=[],m=(this.readUTF(),this.readU32()),v=this.getBlock(m);if(null===v)return void console.log("parseMeshPoseAnimation target mesh not found at:",m);for(s=v.geometry,s.morphTargets=[],t||(d=this.readU16()),r=this.readU16(),l=this.readU16(),u=0;u<l;)p.push(this.readU16()),u++;for(c=this.parseProperties({1:21,2:21}),h.looping=c.get(1,!0),h.stitchFinalFrame=c.get(2,!1),a=0;a<d;){for(this.readU16(),n=0;n<r;)for(u=0,i=this.readU32(),o=this._ptr+i;u<l;){if(1===p[u]){var g=new Float32Array(i/4);for(s.morphTargets.push({array:g}),f=0;this._ptr<o;)g[f]=this.readF32(),g[f+1]=this.readF32(),g[f+2]=this.readF32(),f+=3;n++}else this._ptr=o;u++}a++}return this.parseUserAttributes(),null},getBlock:function(e){return this._blocks[e].data},parseMatrix4:function(){var e=new n.Matrix4,t=e.elements;return t[0]=this.readF32(),t[1]=this.readF32(),t[2]=this.readF32(),t[3]=0,t[4]=this.readF32(),t[5]=this.readF32(),t[6]=this.readF32(),t[7]=0,t[8]=this.readF32(),t[9]=this.readF32(),t[10]=this.readF32(),t[11]=0,t[12]=-this.readF32(),t[13]=this.readF32(),t[14]=this.readF32(),t[15]=1,e},parseProperties:function(e){var r=this.readU32(),a=this._ptr+r,n=new t;if(e)for(;this._ptr<a;){var i,o=this.readU16(),s=this.readU32();e.hasOwnProperty(o)?(i=e[o],n.set(o,this.parseAttrValue(i,s))):this._ptr+=s}return n},parseUserAttributes:function(){return this._ptr=this.readU32()+this._ptr,null},parseAttrValue:function(e,t){var r,a;switch(e){case 1:r=1,a=this.readI8;break;case 2:r=2,a=this.readI16;break;case 3:r=4,a=this.readI32;break;case 21:case 4:r=1,a=this.readU8;break;case 5:r=2,a=this.readU16;break;case 6:case 23:r=4,a=this.readU32;break;case 7:r=4,a=this.readF32;break;case 8:r=8,a=this.readF64;break;case 41:case 42:case 43:case 44:case 45:case 46:case 47:r=8,a=this.readF64}if(r<t){var n,i,o;for(n=[],i=0,o=t/r;i<o;)n.push(a.call(this)),i++;return n}return a.call(this)},readU8:function(){return this._data.getUint8(this._ptr++)},readI8:function(){return this._data.getInt8(this._ptr++)},readU16:function(){var e=this._data.getUint16(this._ptr,!0);return this._ptr+=2,e},readI16:function(){var e=this._data.getInt16(this._ptr,!0);return this._ptr+=2,e},readU32:function(){var e=this._data.getUint32(this._ptr,!0);return this._ptr+=4,e},readI32:function(){var e=this._data.getInt32(this._ptr,!0);return this._ptr+=4,e},readF32:function(){var e=this._data.getFloat32(this._ptr,!0);return this._ptr+=4,e},readF64:function(){var e=this._data.getFloat64(this._ptr,!0);return this._ptr+=8,e},readUTF:function(){var e=this.readU16();return this.readUTFBytes(e)},readUTFBytes:function(e){for(var t=[],r=0;t.length<e;){var a=this._data.getUint8(this._ptr++,!0);if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){var n=this._data.getUint8(this._ptr++,!0);t[r++]=String.fromCharCode((31&a)<<6|63&n)}else{var n=this._data.getUint8(this._ptr++,!0),i=this._data.getUint8(this._ptr++,!0);t[r++]=String.fromCharCode((15&a)<<12|(63&n)<<6|63&i)}}return t.join("")}},r}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this;new n.FileLoader(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,a)},parse:function(e){function t(e){var t=new n.BufferGeometry,r=e.indices,a=e.positions,i=e.normals,o=e.uvs;t.setIndex(r);for(var s=2,l=a.length;s<l;s+=3)a[s]=-a[s];if(t.addAttribute("position",new n.Float32BufferAttribute(a,3)),i){for(var s=2,l=i.length;s<l;s+=3)i[s]=-i[s];t.addAttribute("normal",new n.Float32BufferAttribute(i,3))}o&&t.addAttribute("uv",new n.Float32BufferAttribute(o,2));var u=e.subMeshes;if(u)for(var s=0,l=u.length;s<l;s++){var c=u[s];t.addGroup(c.indexStart,c.indexCount)}return t}var r=function(e){for(var t={},r=0,a=e.materials.length;r<a;r++){var i=e.materials[r],o=new n.MeshPhongMaterial;o.name=i.name,o.color.fromArray(i.diffuse),o.emissive.fromArray(i.emissive),o.specular.fromArray(i.specular),o.shininess=i.specularPower,o.opacity=i.alpha,t[i.id]=o}if(e.multiMaterials)for(var r=0,a=e.multiMaterials.length;r<a;r++){var i=e.multiMaterials[r];console.warn("THREE.BabylonLoader: Multi materials not yet supported."),t[i.id]=new n.MeshPhongMaterial}return t}(e);return function(e,r){for(var a={},i=new n.Scene,o=e.cameras,s=0,l=o.length;s<l;s++){var u=o[s],c=new n.PerspectiveCamera(u.fov/Math.PI*180,1.33,u.minZ,u.maxZ);c.name=u.name,c.position.fromArray(u.position),u.rotation&&c.rotation.fromArray(u.rotation),a[u.id]=c}for(var d=e.lights,s=0,l=d.length;s<l;s++){var f,u=d[s];switch(u.type){case 0:f=new n.PointLight;break;case 1:f=new n.DirectionalLight;break;case 2:f=new n.SpotLight;break;case 3:f=new n.HemisphereLight}f.name=u.name,u.position&&f.position.set(u.position[0],u.position[1],-u.position[2]),f.color.fromArray(u.diffuse),u.groundColor&&f.groundColor.fromArray(u.groundColor),u.intensity&&(f.intensity=u.intensity),a[u.id]=f,i.add(f)}for(var h=e.meshes,s=0,l=h.length;s<l;s++){var p,u=h[s];if(u.indices){var m=t(u);p=new n.Mesh(m,r[u.materialId])}else p=new n.Group;p.name=u.name,p.position.set(u.position[0],u.position[1],-u.position[2]),p.rotation.fromArray(u.rotation),u.rotationQuaternion&&p.quaternion.fromArray(u.rotationQuaternion),p.scale.fromArray(u.scaling),u.parentId?a[u.parentId].add(p):i.add(p),a[u.id]=p}return i}(e,r)}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){"boolean"==typeof e&&(console.warn("THREE.BinaryLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,crossOrigin:"Anonymous",load:function(e,t,r,a){var i=this.texturePath||n.LoaderUtils.extractUrlBase(e),o=this.binaryPath||n.LoaderUtils.extractUrlBase(e),s=this;new n.FileLoader(this.manager).load(e,function(e){var l=JSON.parse(e),u=o+l.buffers,c=new n.FileLoader(s.manager);c.setResponseType("arraybuffer"),c.load(u,function(e){s.parse(e,t,i,l.materials)},r,a)},r,a)},setBinaryPath:function(e){this.binaryPath=e},setCrossOrigin:function(e){this.crossOrigin=e},setTexturePath:function(e){this.texturePath=e},parse:function(e,t,r,a){var i=function(){function t(e){return e%4?4-e%4:0}function r(e,t,r){return n.LoaderUtils.decodeText(new Uint8Array(e,t,r))}function a(e,t){return new Uint8Array(e,t,1)[0]}function i(e,t){return new Uint32Array(e,t,1)[0]}function o(t,r){var a,i,o,s,l,u,c,d,f,h,p=new Uint32Array(e,r,3*t);for(a=0;a<t;a++)i=p[3*a],o=p[3*a+1],s=p[3*a+2],l=O[2*i],d=O[2*i+1],u=O[2*o],f=O[2*o+1],c=O[2*s],h=O[2*s+1],L.faceVertexUvs[0].push([new n.Vector2(l,d),new n.Vector2(u,f),new n.Vector2(c,h)])}function s(t,r){var a,i,o,s,l,u,c,d,f,h,p,m,v,g=new Uint32Array(e,r,4*t);for(a=0;a<t;a++)i=g[4*a],o=g[4*a+1],s=g[4*a+2],l=g[4*a+3],u=O[2*i],h=O[2*i+1],c=O[2*o],p=O[2*o+1],d=O[2*s],m=O[2*s+1],f=O[2*l],v=O[2*l+1],L.faceVertexUvs[0].push([new n.Vector2(u,h),new n.Vector2(c,p),new n.Vector2(f,v)]),L.faceVertexUvs[0].push([new n.Vector2(c,p),new n.Vector2(d,m),new n.Vector2(f,v)])}function l(t,r,a){var i,o,s,l,u,c=new Uint32Array(e,r,3*t),d=new Uint16Array(e,a,t);for(i=0;i<t;i++)o=c[3*i],s=c[3*i+1],l=c[3*i+2],u=d[i],L.faces.push(new n.Face3(o,s,l,null,null,u))}function u(t,r,a){var i,o,s,l,u,c,d=new Uint32Array(e,r,4*t),f=new Uint16Array(e,a,t);for(i=0;i<t;i++)o=d[4*i],s=d[4*i+1],l=d[4*i+2],u=d[4*i+3],c=f[i],L.faces.push(new n.Face3(o,s,u,null,null,c)),L.faces.push(new n.Face3(s,l,u,null,null,c))}function c(t,r,a,i){var o,s,l,u,c,d,f,h,p=new Uint32Array(e,r,3*t),m=new Uint32Array(e,a,3*t),v=new Uint16Array(e,i,t);for(o=0;o<t;o++){s=p[3*o],l=p[3*o+1],u=p[3*o+2],d=m[3*o],f=m[3*o+1],h=m[3*o+2],c=v[o];var g=N[3*d],y=N[3*d+1],x=N[3*d+2],b=N[3*f],A=N[3*f+1],w=N[3*f+2],M=N[3*h],T=N[3*h+1],S=N[3*h+2];L.faces.push(new n.Face3(s,l,u,[new n.Vector3(g,y,x),new n.Vector3(b,A,w),new n.Vector3(M,T,S)],null,c))}}function d(t,r,a,i){var o,s,l,u,c,d,f,h,p,m,v=new Uint32Array(e,r,4*t),g=new Uint32Array(e,a,4*t),y=new Uint16Array(e,i,t);for(o=0;o<t;o++){s=v[4*o],l=v[4*o+1],u=v[4*o+2],c=v[4*o+3],f=g[4*o],h=g[4*o+1],p=g[4*o+2],m=g[4*o+3],d=y[o];var x=N[3*f],b=N[3*f+1],A=N[3*f+2],w=N[3*h],M=N[3*h+1],T=N[3*h+2],S=N[3*p],F=N[3*p+1],E=N[3*p+2],_=N[3*m],P=N[3*m+1],C=N[3*m+2];L.faces.push(new n.Face3(s,l,c,[new n.Vector3(x,b,A),new n.Vector3(w,M,T),new n.Vector3(_,P,C)],null,d)),L.faces.push(new n.Face3(l,u,c,[new n.Vector3(w,M,T),new n.Vector3(S,F,E),new n.Vector3(_,P,C)],null,d))}}var f,h,p,m,v,g,y,x,b,A,w,M,T,S,F,E,_,P,L=this,C=0,N=[],O=[];n.Geometry.call(this),f=function(e,t){return{signature:r(e,t,12),header_bytes:a(e,t+12),vertex_coordinate_bytes:a(e,t+13),normal_coordinate_bytes:a(e,t+14),uv_coordinate_bytes:a(e,t+15),vertex_index_bytes:a(e,t+16),normal_index_bytes:a(e,t+17),uv_index_bytes:a(e,t+18),material_index_bytes:a(e,t+19),nvertices:i(e,t+20),nnormals:i(e,t+20+4),nuvs:i(e,t+20+8),ntri_flat:i(e,t+20+12),ntri_smooth:i(e,t+20+16),ntri_flat_uv:i(e,t+20+20),ntri_smooth_uv:i(e,t+20+24),nquad_flat:i(e,t+20+28),nquad_smooth:i(e,t+20+32),nquad_flat_uv:i(e,t+20+36),nquad_smooth_uv:i(e,t+20+40)}}(e,C),C+=f.header_bytes,A=3*f.vertex_index_bytes+f.material_index_bytes,w=4*f.vertex_index_bytes+f.material_index_bytes,M=f.ntri_flat*A,T=f.ntri_smooth*(A+3*f.normal_index_bytes),S=f.ntri_flat_uv*(A+3*f.uv_index_bytes),F=f.ntri_smooth_uv*(A+3*f.normal_index_bytes+3*f.uv_index_bytes),E=f.nquad_flat*w,_=f.nquad_smooth*(w+4*f.normal_index_bytes),P=f.nquad_flat_uv*(w+4*f.uv_index_bytes),C+=function(t){var r,a,i,o,s=f.nvertices,l=new Float32Array(e,t,3*s);for(r=0;r<s;r++)a=l[3*r],i=l[3*r+1],o=l[3*r+2],L.vertices.push(new n.Vector3(a,i,o));return 3*s*Float32Array.BYTES_PER_ELEMENT}(C),C+=function(t){var r=f.nnormals;if(r){var a,n,i,o,s=new Int8Array(e,t,3*r);for(a=0;a<r;a++)n=s[3*a],i=s[3*a+1],o=s[3*a+2],N.push(n/127,i/127,o/127)}return 3*r*Int8Array.BYTES_PER_ELEMENT}(C),C+=t(3*f.nnormals),C+=function(t){var r=f.nuvs;if(r){var a,n,i,o=new Float32Array(e,t,2*r);for(a=0;a<r;a++)n=o[2*a],i=o[2*a+1],O.push(n,i)}return 2*r*Float32Array.BYTES_PER_ELEMENT}(C),h=C,p=h+M+t(2*f.ntri_flat),m=p+T+t(2*f.ntri_smooth),v=m+S+t(2*f.ntri_flat_uv),g=v+F+t(2*f.ntri_smooth_uv),y=g+E+t(2*f.nquad_flat),x=y+_+t(2*f.nquad_smooth),b=x+P+t(2*f.nquad_flat_uv),function(e){var t=f.ntri_flat_uv;if(t){var r=e+t*Uint32Array.BYTES_PER_ELEMENT*3;l(t,e,r+t*Uint32Array.BYTES_PER_ELEMENT*3),o(t,r)}}(m),function(e){var t=f.ntri_smooth_uv;if(t){var r=e+t*Uint32Array.BYTES_PER_ELEMENT*3,a=r+t*Uint32Array.BYTES_PER_ELEMENT*3;c(t,e,r,a+t*Uint32Array.BYTES_PER_ELEMENT*3),o(t,a)}}(v),function(e){var t=f.nquad_flat_uv;if(t){var r=e+t*Uint32Array.BYTES_PER_ELEMENT*4;u(t,e,r+t*Uint32Array.BYTES_PER_ELEMENT*4),s(t,r)}}(x),function(e){var t=f.nquad_smooth_uv;if(t){var r=e+t*Uint32Array.BYTES_PER_ELEMENT*4,a=r+t*Uint32Array.BYTES_PER_ELEMENT*4;d(t,e,r,a+t*Uint32Array.BYTES_PER_ELEMENT*4),s(t,a)}}(b),function(e){var t=f.ntri_flat;t&&l(t,e,e+t*Uint32Array.BYTES_PER_ELEMENT*3)}(h),function(e){var t=f.ntri_smooth;if(t){var r=e+t*Uint32Array.BYTES_PER_ELEMENT*3;c(t,e,r,r+t*Uint32Array.BYTES_PER_ELEMENT*3)}}(p),function(e){var t=f.nquad_flat;t&&u(t,e,e+t*Uint32Array.BYTES_PER_ELEMENT*4)}(g),function(e){var t=f.nquad_smooth;if(t){var r=e+t*Uint32Array.BYTES_PER_ELEMENT*4;d(t,e,r,r+t*Uint32Array.BYTES_PER_ELEMENT*4)}}(y),this.computeFaceNormals()};i.prototype=Object.create(n.Geometry.prototype),i.prototype.constructor=i,t(new i,n.Loader.prototype.initMaterials(a,r,this.crossOrigin))}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.animateBonePositions=!0,this.animateBoneRotations=!0};i.prototype={constructor:i,load:function(e,t,r,a){var i=this;new n.FileLoader(i.manager).load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e,r,a){if("ENDSITE"!==a.type){var i={time:r,position:new n.Vector3,rotation:new n.Quaternion};a.frames.push(i);for(var o=new n.Quaternion,s=new n.Vector3(1,0,0),l=new n.Vector3(0,1,0),u=new n.Vector3(0,0,1),c=0;c<a.channels.length;c++)switch(a.channels[c]){case"Xposition":i.position.x=parseFloat(e.shift().trim());break;case"Yposition":i.position.y=parseFloat(e.shift().trim());break;case"Zposition":i.position.z=parseFloat(e.shift().trim());break;case"Xrotation":o.setFromAxisAngle(s,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;case"Yrotation":o.setFromAxisAngle(l,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;case"Zrotation":o.setFromAxisAngle(u,parseFloat(e.shift().trim())*Math.PI/180),i.rotation.multiply(o);break;default:console.warn("THREE.BVHLoader: Invalid channel type.")}for(var c=0;c<a.children.length;c++)t(e,r,a.children[c])}}function r(e,t,a){var o={name:"",type:"",frames:[]};a.push(o);var s=t.split(/[\s]+/);"END"===s[0].toUpperCase()&&"SITE"===s[1].toUpperCase()?(o.type="ENDSITE",o.name="ENDSITE"):(o.name=s[1],o.type=s[0].toUpperCase()),"{"!==i(e)&&console.error("THREE.BVHLoader: Expected opening { after type & name"),s=i(e).split(/[\s]+/),"OFFSET"!==s[0]&&console.error("THREE.BVHLoader: Expected OFFSET but got: "+s[0]),4!==s.length&&console.error("THREE.BVHLoader: Invalid number of values for OFFSET.");var l=new n.Vector3(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));if((isNaN(l.x)||isNaN(l.y)||isNaN(l.z))&&console.error("THREE.BVHLoader: Invalid values of OFFSET."),o.offset=l,"ENDSITE"!==o.type){s=i(e).split(/[\s]+/),"CHANNELS"!==s[0]&&console.error("THREE.BVHLoader: Expected CHANNELS definition.");var u=parseInt(s[1]);o.channels=s.splice(2,u),o.children=[]}for(;;){var c=i(e);if("}"===c)return o;o.children.push(r(e,c,a))}}function a(e,t){var r=new n.Bone;if(t.push(r),r.position.add(e.offset),r.name=e.name,"ENDSITE"!==e.type)for(var i=0;i<e.children.length;i++)r.add(a(e.children[i],t));return r}function i(e){for(var t;0===(t=e.shift().trim()).length;);return t}var o=this,s=e.split(/[\r\n]+/g),l=function(e){"HIERARCHY"!==i(e)&&console.error("THREE.BVHLoader: HIERARCHY expected.");var a=[],n=r(e,i(e),a);"MOTION"!==i(e)&&console.error("THREE.BVHLoader: MOTION expected.");var o=i(e).split(/[\s]+/),s=parseInt(o[1]);isNaN(s)&&console.error("THREE.BVHLoader: Failed to read number of frames."),o=i(e).split(/[\s]+/);var l=parseFloat(o[2]);isNaN(l)&&console.error("THREE.BVHLoader: Failed to read frame time.");for(var u=0;u<s;u++)o=i(e).split(/[\s]+/),t(o,u*l,n);return a}(s),u=[];a(l[0],u);var c=function(e){for(var t=[],r=0;r<e.length;r++){var a=e[r];if("ENDSITE"!==a.type){for(var i=[],s=[],l=[],u=0;u<a.frames.length;u++){var c=a.frames[u];i.push(c.time),s.push(c.position.x+a.offset.x),s.push(c.position.y+a.offset.y),s.push(c.position.z+a.offset.z),l.push(c.rotation.x),l.push(c.rotation.y),l.push(c.rotation.z),l.push(c.rotation.w)}o.animateBonePositions&&t.push(new n.VectorKeyframeTrack(".bones["+a.name+"].position",i,s)),o.animateBoneRotations&&t.push(new n.QuaternionKeyframeTrack(".bones["+a.name+"].quaternion",i,l))}}return new n.AnimationClip("animation",-1,t)}(l);return{skeleton:new n.Skeleton(u),clip:c}}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,crossOrigin:"Anonymous",load:function(e,t,r,a){var i=this,o=void 0===i.path?n.LoaderUtils.extractUrlBase(e):i.path;new n.FileLoader(i.manager).load(e,function(e){t(i.parse(e,o))},r,a)},setPath:function(e){this.path=e},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){function r(e,t){for(var r=[],a=e.childNodes,n=0,i=a.length;n<i;n++){var o=a[n];o.nodeName===t&&r.push(o)}return r}function a(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,n=t.length;a<n;a++)r[a]=t[a];return r}function i(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,n=t.length;a<n;a++)r[a]=parseFloat(t[a]);return r}function o(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,n=t.length;a<n;a++)r[a]=parseInt(t[a]);return r}function s(e){return e.substring(1)}function l(){return"three_default_"+ft++}function u(e){return 0===Object.keys(e).length}function c(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function d(e){return void 0!==e?e.textContent:"Y_UP"}function f(e,t,a,n){var i=r(e,t)[0];if(void 0!==i)for(var o=r(i,a),s=0;s<o.length;s++)n(o[s])}function h(e,t){for(var r in e){e[r].build=t(e[r])}}function p(e,t){return void 0!==e.build?e.build:(e.build=t(e),e.build)}function m(e){for(var t={sources:{},samplers:{},channels:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType){var i;switch(n.nodeName){case"source":i=n.getAttribute("id"),t.sources[i]=ge(n);break;case"sampler":i=n.getAttribute("id"),t.samplers[i]=v(n);break;case"channel":i=n.getAttribute("target"),t.channels[i]=g(n);break;default:console.log(n)}}}ht.animations[e.getAttribute("id")]=t}function v(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var i=s(n.getAttribute("source")),o=n.getAttribute("semantic");t.inputs[o]=i}}return t}function g(e){var t={},r=e.getAttribute("target"),a=r.split("/"),n=a.shift(),i=a.shift(),o=-1!==i.indexOf("("),l=-1!==i.indexOf(".");if(l)a=i.split("."),i=a.shift(),t.member=a.shift();else if(o){var u=i.split("(");i=u.shift();for(var c=0;c<u.length;c++)u[c]=parseInt(u[c].replace(/\)/,""));t.indices=u}return t.id=n,t.sid=i,t.arraySyntax=o,t.memberSyntax=l,t.sampler=s(e.getAttribute("source")),t}function y(e){var t=[],r=e.channels,a=e.samplers,n=e.sources;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i],s=a[o.sampler],l=s.inputs.INPUT,u=s.inputs.OUTPUT,c=n[l],d=n[u],f=b(o,c,d);w(f,t)}return t}function x(e){return p(ht.animations[e],y)}function b(e,t,r){var a,n,i,o,s,l,u=ht.nodes[e.id],c=qe(u.id),d=u.transforms[e.sid],f=u.matrix.clone().transpose(),h={};switch(d){case"matrix":for(i=0,o=t.array.length;i<o;i++)if(a=t.array[i],n=i*r.stride,void 0===h[a]&&(h[a]={}),!0===e.arraySyntax){var p=r.array[n],m=e.indices[0]+4*e.indices[1];h[a][m]=p}else for(s=0,l=r.stride;s<l;s++)h[a][s]=r.array[n+s];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',d)}var v=A(h,f);return{name:c.uuid,keyframes:v}}function A(e,t){function r(e,t){return e.time-t.time}var a=[];for(var n in e)a.push({time:parseFloat(n),value:e[n]});a.sort(r);for(var i=0;i<16;i++)M(a,i,t.elements[i]);return a}function w(e,t){for(var r=e.keyframes,a=e.name,i=[],o=[],s=[],l=[],u=0,c=r.length;u<c;u++){var d=r[u],f=d.time,h=d.value;at.fromArray(h).transpose(),at.decompose(et,rt,tt),i.push(f),o.push(et.x,et.y,et.z),s.push(rt.x,rt.y,rt.z,rt.w),l.push(tt.x,tt.y,tt.z)}return o.length>0&&t.push(new n.VectorKeyframeTrack(a+".position",i,o)),s.length>0&&t.push(new n.QuaternionKeyframeTrack(a+".quaternion",i,s)),l.length>0&&t.push(new n.VectorKeyframeTrack(a+".scale",i,l)),t}function M(e,t,r){var a,n,i,o=!0;for(n=0,i=e.length;n<i;n++)a=e[n],void 0===a.value[t]?a.value[t]=null:o=!1;if(!0===o)for(n=0,i=e.length;n<i;n++)a=e[n],a.value[t]=r;else T(e,t)}function T(e,t){for(var r,a,n=0,i=e.length;n<i;n++){var o=e[n];if(null===o.value[t]){if(r=S(e,n,t),a=F(e,n,t),null===r){o.value[t]=a.value[t];continue}if(null===a){o.value[t]=r.value[t];continue}E(o,r,a,t)}}}function S(e,t,r){for(;t>=0;){var a=e[t];if(null!==a.value[r])return a;t--}return null}function F(e,t,r){for(;t<e.length;){var a=e[t];if(null!==a.value[r])return a;t++}return null}function E(e,t,r,a){if(r.time-t.time==0)return void(e.value[a]=t.value[a]);e.value[a]=(e.time-t.time)*(r.value[a]-t.value[a])/(r.time-t.time)+t.value[a]}function _(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"instance_animation":t.animations.push(s(n.getAttribute("url")))}}ht.clips[e.getAttribute("id")]=t}function P(e){for(var t=[],r=e.name,a=e.end-e.start||-1,i=e.animations,o=0,s=i.length;o<s;o++)for(var l=x(i[o]),u=0,c=l.length;u<c;u++)t.push(l[u]);return new n.AnimationClip(r,a,t)}function L(e){return p(ht.clips[e],P)}function C(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"skin":t.id=s(n.getAttribute("source")),t.skin=N(n);break;case"morph":t.id=s(n.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}ht.controllers[e.getAttribute("id")]=t}function N(e){for(var t={sources:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=i(n.textContent);break;case"source":var o=n.getAttribute("id");t.sources[o]=ge(n);break;case"joints":t.joints=O(n);break;case"vertex_weights":t.vertexWeights=I(n)}}return t}function O(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var i=n.getAttribute("semantic"),o=s(n.getAttribute("source"));t.inputs[i]=o}}return t}function I(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var i=n.getAttribute("semantic"),l=s(n.getAttribute("source")),u=parseInt(n.getAttribute("offset"));t.inputs[i]={id:l,offset:u};break;case"vcount":t.vcount=o(n.textContent);break;case"v":t.v=o(n.textContent)}}return t}function U(e){var t={id:e.id},r=ht.geometries[t.id];return void 0!==e.skin&&(t.skin=D(e.skin),r.sources.skinIndices=t.skin.indices,r.sources.skinWeights=t.skin.weights),t}function D(e){function t(e,t){return t.weight-e.weight}var r,a,i,o={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},s=e.sources,l=e.vertexWeights,u=l.vcount,c=l.v,d=l.inputs.JOINT.offset,f=l.inputs.WEIGHT.offset,h=e.sources[e.joints.inputs.JOINT],p=e.sources[e.joints.inputs.INV_BIND_MATRIX],m=s[l.inputs.WEIGHT.id].array,v=0;for(r=0,i=u.length;r<i;r++){var g=u[r],y=[];for(a=0;a<g;a++){var x=c[v+d],b=c[v+f],A=m[b];y.push({index:x,weight:A}),v+=2}for(y.sort(t),a=0;a<4;a++){var w=y[a];void 0!==w?(o.indices.array.push(w.index),o.weights.array.push(w.weight)):(o.indices.array.push(0),o.weights.array.push(0))}}for(o.bindMatrix=(new n.Matrix4).fromArray(e.bindShapeMatrix).transpose(),r=0,i=h.array.length;r<i;r++){var M=h.array[r],T=(new n.Matrix4).fromArray(p.array,r*p.stride).transpose();o.joints.push({name:M,boneInverse:T})}return o}function R(e){return p(ht.controllers[e],U)}function k(e){var t={init_from:r(e,"init_from")[0].textContent};ht.images[e.getAttribute("id")]=t}function B(e){return void 0!==e.build?e.build:e.init_from}function j(e){var t=ht.images[e];return void 0!==t?p(t,B):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function V(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"profile_COMMON":t.profile=G(n)}}ht.effects[e.getAttribute("id")]=t}function G(e){for(var t={surfaces:{},samplers:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"newparam":z(n,t);break;case"technique":t.technique=Y(n);break;case"extra":t.extra=J(n)}}return t}function z(e,t){for(var r=e.getAttribute("sid"),a=0,n=e.childNodes.length;a<n;a++){var i=e.childNodes[a];if(1===i.nodeType)switch(i.nodeName){case"surface":t.surfaces[r]=H(i);break;case"sampler2D":t.samplers[r]=X(i)}}}function H(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"init_from":t.init_from=n.textContent}}return t}function X(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"source":t.source=n.textContent}}return t}function Y(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=n.nodeName,t.parameters=W(n)}}return t}function W(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"emission":case"diffuse":case"specular":case"shininess":case"transparency":t[n.nodeName]=Q(n);break;case"transparent":t[n.nodeName]={opaque:n.getAttribute("opaque"),data:Q(n)}}}return t}function Q(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"color":t[n.nodeName]=i(n.textContent);break;case"float":t[n.nodeName]=parseFloat(n.textContent);break;case"texture":t[n.nodeName]={id:n.getAttribute("texture"),extra:q(n)}}}return t}function q(e){for(var t={technique:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"extra":K(n,t)}}return t}function K(e,t){for(var r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique":Z(n,t)}}}function Z(e,t){for(var r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[n.nodeName]=parseFloat(n.textContent);break;case"wrapU":case"wrapV":"TRUE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=1:"FALSE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=0:t.technique[n.nodeName]=parseInt(n.textContent)}}}function J(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique":t.technique=$(n)}}return t}function $(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"double_sided":t[n.nodeName]=parseInt(n.textContent)}}return t}function ee(e){return e}function te(e){return p(ht.effects[e],ee)}function re(e){for(var t={name:e.getAttribute("name")},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"instance_effect":t.url=s(n.getAttribute("url"))}}ht.materials[e.getAttribute("id")]=t}function ae(e){function t(e){var t=a.profile.samplers[e.id],r=null;if(void 0!==t){r=j(a.profile.surfaces[t.source].init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),r=j(e.id);if(null!==r){var i=ut.load(r),o=e.extra;if(void 0!==o&&void 0!==o.technique&&!1===u(o.technique)){var s=o.technique;i.wrapS=s.wrapU?n.RepeatWrapping:n.ClampToEdgeWrapping,i.wrapT=s.wrapV?n.RepeatWrapping:n.ClampToEdgeWrapping,i.offset.set(s.offsetU||0,s.offsetV||0),i.repeat.set(s.repeatU||1,s.repeatV||1)}else i.wrapS=n.RepeatWrapping,i.wrapT=n.RepeatWrapping;return i}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",e.id),null}var r,a=te(e.url),i=a.profile.technique,o=a.profile.extra;switch(i.type){case"phong":case"blinn":r=new n.MeshPhongMaterial;break;case"lambert":r=new n.MeshLambertMaterial;break;default:r=new n.MeshBasicMaterial}r.name=e.name;var s=i.parameters;for(var l in s){var c=s[l];switch(l){case"diffuse":c.color&&r.color.fromArray(c.color),c.texture&&(r.map=t(c.texture));break;case"specular":c.color&&r.specular&&r.specular.fromArray(c.color),c.texture&&(r.specularMap=t(c.texture));break;case"shininess":c.float&&r.shininess&&(r.shininess=c.float);break;case"emission":c.color&&r.emissive&&r.emissive.fromArray(c.color),c.texture&&(r.emissiveMap=t(c.texture))}}var d=s.transparent,f=s.transparency;if(void 0===f&&d&&(f={float:1}),void 0===d&&f&&(d={opaque:"A_ONE",data:{color:[1,1,1,1]}}),d&&f)if(d.data.texture)r.transparent=!0;else{var h=d.data.color;switch(d.opaque){case"A_ONE":r.opacity=h[3]*f.float;break;case"RGB_ZERO":r.opacity=1-h[0]*f.float;break;case"A_ZERO":r.opacity=1-h[3]*f.float;break;case"RGB_ONE":r.opacity=h[0]*f.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',d.opaque)}r.opacity<1&&(r.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(r.side=n.DoubleSide),r}function ne(e){return p(ht.materials[e],ae)}function ie(e){for(var t={name:e.getAttribute("name")},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"optics":t.optics=oe(n)}}ht.cameras[e.getAttribute("id")]=t}function oe(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return se(r)}}return{}}function se(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"perspective":case"orthographic":t.technique=a.nodeName,t.parameters=le(a)}}return t}function le(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[a.nodeName]=parseFloat(a.textContent)}}return t}function ue(e){var t;switch(e.optics.technique){case"perspective":t=new n.PerspectiveCamera(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var r=e.optics.parameters.ymag,a=e.optics.parameters.xmag,i=e.optics.parameters.aspect_ratio;a=void 0===a?r*i:a,r=void 0===r?a/i:r,a*=.5,r*=.5,t=new n.OrthographicCamera(-a,a,r,-r,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new n.PerspectiveCamera}return t.name=e.name,t}function ce(e){var t=ht.cameras[e];return void 0!==t?p(t,ue):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function de(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":t=fe(n)}}ht.lights[e.getAttribute("id")]=t}function fe(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=n.nodeName,t.parameters=he(n)}}return t}function he(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"color":var s=i(o.textContent);t.color=(new n.Color).fromArray(s);break;case"falloff_angle":t.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":var l=parseFloat(o.textContent);t.distance=l?Math.sqrt(1/l):0}}return t}function pe(e){var t;switch(e.technique){case"directional":t=new n.DirectionalLight;break;case"point":t=new n.PointLight;break;case"spot":t=new n.SpotLight;break;case"ambient":t=new n.AmbientLight}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function me(e){var t=ht.lights[e];return void 0!==t?p(t,pe):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function ve(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},a=r(e,"mesh")[0];if(void 0!==a){for(var n=0;n<a.childNodes.length;n++){var i=a.childNodes[n];if(1===i.nodeType){var o=i.getAttribute("id");switch(i.nodeName){case"source":t.sources[o]=ge(i);break;case"vertices":t.vertices=ye(i);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",i.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(xe(i));break;default:console.log(i)}}}ht.geometries[e.getAttribute("id")]=t}}function ge(e){for(var t={array:[],stride:3},n=0;n<e.childNodes.length;n++){var o=e.childNodes[n];if(1===o.nodeType)switch(o.nodeName){case"float_array":t.array=i(o.textContent);break;case"Name_array":t.array=a(o.textContent);break;case"technique_common":var s=r(o,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")))}}return t}function ye(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];1===a.nodeType&&(t[a.getAttribute("semantic")]=s(a.getAttribute("source")))}return t}function xe(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var i=s(n.getAttribute("source")),l=n.getAttribute("semantic"),u=parseInt(n.getAttribute("offset"));t.inputs[l]={id:i,offset:u},t.stride=Math.max(t.stride,u+1),"TEXCOORD"===l&&(t.hasUV=!0);break;case"vcount":t.vcount=o(n.textContent);break;case"p":t.p=o(n.textContent)}}return t}function be(e){for(var t={},r=0;r<e.length;r++){var a=e[r];void 0===t[a.type]&&(t[a.type]=[]),t[a.type].push(a)}return t}function Ae(e){for(var t=0,r=0,a=e.length;r<a;r++){!0===e[r].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function we(e){var t={},r=e.sources,a=e.vertices,n=e.primitives;if(0===n.length)return{};var i=be(n);for(var o in i){var s=i[o];Ae(s),t[o]=Me(s,r,a)}return t}function Me(e,t,r){for(var a={},i={array:[],stride:0},o={array:[],stride:0},s={array:[],stride:0},l={array:[],stride:0},u={array:[],stride:4},c={array:[],stride:4},d=new n.BufferGeometry,f=[],h=0,p=0;p<e.length;p++){var m=e[p],v=m.inputs,g=0;switch(m.type){case"lines":case"linestrips":g=2*m.count;break;case"triangles":g=3*m.count;break;case"polylist":for(var y=0;y<m.count;y++){var x=m.vcount[y];switch(x){case 3:g+=3;break;case 4:g+=6;break;default:g+=3*(x-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",m.type)}d.addGroup(h,g,p),h+=g,m.material&&f.push(m.material);for(var b in v){var A=v[b];switch(b){case"VERTEX":for(var w in r){var M=r[w];switch(w){case"POSITION":var T=i.array.length;if(Te(m,t[M],A.offset,i.array),i.stride=t[M].stride,t.skinWeights&&t.skinIndices&&(Te(m,t.skinIndices,A.offset,u.array),Te(m,t.skinWeights,A.offset,c.array)),!1===m.hasUV&&!0===e.uvsNeedsFix)for(var g=(i.array.length-T)/i.stride,S=0;S<g;S++)s.array.push(0,0);break;case"NORMAL":Te(m,t[M],A.offset,o.array),o.stride=t[M].stride;break;case"COLOR":Te(m,t[M],A.offset,l.array),l.stride=t[M].stride;break;case"TEXCOORD":Te(m,t[M],A.offset,s.array),s.stride=t[M].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',w)}}break;case"NORMAL":Te(m,t[A.id],A.offset,o.array),o.stride=t[A.id].stride;break;case"COLOR":Te(m,t[A.id],A.offset,l.array),l.stride=t[A.id].stride;break;case"TEXCOORD":Te(m,t[A.id],A.offset,s.array),s.stride=t[A.id].stride}}}return i.array.length>0&&d.addAttribute("position",new n.Float32BufferAttribute(i.array,i.stride)),o.array.length>0&&d.addAttribute("normal",new n.Float32BufferAttribute(o.array,o.stride)),l.array.length>0&&d.addAttribute("color",new n.Float32BufferAttribute(l.array,l.stride)),s.array.length>0&&d.addAttribute("uv",new n.Float32BufferAttribute(s.array,s.stride)),u.array.length>0&&d.addAttribute("skinIndex",new n.Float32BufferAttribute(u.array,u.stride)),c.array.length>0&&d.addAttribute("skinWeight",new n.Float32BufferAttribute(c.array,c.stride)),a.data=d,a.type=e[0].type,a.materialKeys=f,a}function Te(e,t,r,a){function n(e){for(var t=i[e+r]*u,n=t+u;t<n;t++)a.push(l[t])}var i=e.p,o=e.stride,s=e.vcount,l=t.array,u=t.stride;if(void 0!==e.vcount)for(var c=0,d=0,f=s.length;d<f;d++){var h=s[d];if(4===h){var p=c+0*o,m=c+1*o,v=c+2*o,g=c+3*o;n(p),n(m),n(g),n(m),n(v),n(g)}else if(3===h){var p=c+0*o,m=c+1*o,v=c+2*o;n(p),n(m),n(v)}else if(h>4)for(var y=1,x=h-2;y<=x;y++){var p=c+0*o,m=c+o*y,v=c+o*(y+1);n(p),n(m),n(v)}c+=o*h}else for(var d=0,f=i.length;d<f;d+=o)n(d)}function Se(e){return p(ht.geometries[e],we)}function Fe(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"technique_common":Pe(a,t)}}ht.kinematicsModels[e.getAttribute("id")]=t}function Ee(e){return void 0!==e.build?e.build:e}function _e(e){return p(ht.kinematicsModels[e],Ee)}function Pe(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"joint":t.joints[a.getAttribute("sid")]=Le(a);break;case"link":t.links.push(Ne(a))}}}function Le(e){for(var t,r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"prismatic":case"revolute":t=Ce(a)}}return t}function Ce(e,t){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new n.Vector3,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"axis":var o=i(a.textContent);t.axis.fromArray(o);break;case"limits":var s=a.getElementsByTagName("max")[0],l=a.getElementsByTagName("min")[0];t.limits.max=parseFloat(s.textContent),t.limits.min=parseFloat(l.textContent)}}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function Ne(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"attachment_full":t.attachments.push(Oe(a));break;case"matrix":case"translate":case"rotate":t.transforms.push(Ie(a))}}return t}function Oe(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"link":t.links.push(Ne(a));break;case"matrix":case"translate":case"rotate":t.transforms.push(Ie(a))}}return t}function Ie(e){var t={type:e.nodeName},r=i(e.textContent);switch(t.type){case"matrix":t.obj=new n.Matrix4,t.obj.fromArray(r).transpose();break;case"translate":t.obj=new n.Vector3,t.obj.fromArray(r);break;case"rotate":t.obj=new n.Vector3,t.obj.fromArray(r),t.angle=n.Math.degToRad(r[3])}return t}function Ue(e){for(var t={bindJointAxis:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"bind_joint_axis":t.bindJointAxis.push(De(a))}}ht.kinematicsScenes[s(e.getAttribute("url"))]=t}function De(e){for(var t={target:e.getAttribute("target").split("/").pop()},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"axis":var n=a.getElementsByTagName("param")[0];t.axis=n.textContent;var i=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=i.substr(0,i.length-1)}}return t}function Re(e){return void 0!==e.build?e.build:e}function ke(e){return p(ht.kinematicsScenes[e],Re)}function Be(e){for(var t=[],r=ot.querySelector('[id="'+e.id+'"]'),a=0;a<r.childNodes.length;a++){var o=r.childNodes[a];if(1===o.nodeType)switch(o.nodeName){case"matrix":var s=i(o.textContent),l=(new n.Matrix4).fromArray(s).transpose();t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l});break;case"translate":case"scale":var s=i(o.textContent),u=(new n.Vector3).fromArray(s);t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:u});break;case"rotate":var s=i(o.textContent),u=(new n.Vector3).fromArray(s),c=n.Math.degToRad(s[3]);t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:u,angle:c})}}return t}function je(e){for(var t=e.getElementsByTagName("node"),r=0;r<t.length;r++){var a=t[r];!1===a.hasAttribute("id")&&a.setAttribute("id",l())}}function Ve(e){for(var t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new n.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"node":t.nodes.push(a.getAttribute("id")),Ve(a);break;case"instance_camera":t.instanceCameras.push(s(a.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(Ge(a));break;case"instance_light":t.instanceLights.push(s(a.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(Ge(a));break;case"instance_node":t.instanceNodes.push(s(a.getAttribute("url")));break;case"matrix":var o=i(a.textContent);t.matrix.multiply(at.fromArray(o).transpose()),t.transforms[a.getAttribute("sid")]=a.nodeName;break;case"translate":var o=i(a.textContent);nt.fromArray(o),t.matrix.multiply(at.makeTranslation(nt.x,nt.y,nt.z)),t.transforms[a.getAttribute("sid")]=a.nodeName;break;case"rotate":var o=i(a.textContent),l=n.Math.degToRad(o[3]);t.matrix.multiply(at.makeRotationAxis(nt.fromArray(o),l)),t.transforms[a.getAttribute("sid")]=a.nodeName;break;case"scale":var o=i(a.textContent);t.matrix.scale(nt.fromArray(o)),t.transforms[a.getAttribute("sid")]=a.nodeName;break;case"extra":break;default:console.log(a)}}return ht.nodes[t.id]=t,t}function Ge(e){for(var t={id:s(e.getAttribute("url")),materials:{},skeletons:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"bind_material":for(var n=a.getElementsByTagName("instance_material"),i=0;i<n.length;i++){var o=n[i],l=o.getAttribute("symbol"),u=o.getAttribute("target");t.materials[l]=s(u)}break;case"skeleton":t.skeletons.push(s(a.textContent))}}return t}function ze(e,t){var r,a,i,o=[],s=[];for(r=0;r<e.length;r++){var l,u=e[r];if(Qe(u))l=qe(u),He(l,t,o);else if(Je(u))for(var c=ht.visualScenes[u],d=c.children,a=0;a<d.length;a++){var f=d[a];if("JOINT"===f.type){var l=qe(f.id);He(l,t,o)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",u)}for(r=0;r<t.length;r++)for(a=0;a<o.length;a++)if(i=o[a],i.bone.name===t[r].name){s[r]=i,i.processed=!0;break}for(r=0;r<o.length;r++)i=o[r],!1===i.processed&&(s.push(i),i.processed=!0);var h=[],p=[];for(r=0;r<s.length;r++)i=s[r],h.push(i.bone),p.push(i.boneInverse);return new n.Skeleton(h,p)}function He(e,t,r){e.traverse(function(e){if(!0===e.isBone){for(var a,i=0;i<t.length;i++){var o=t[i];if(o.name===e.name){a=o.boneInverse;break}}void 0===a&&(a=new n.Matrix4),r.push({bone:e,boneInverse:a,processed:!1})}})}function Xe(e){for(var t=[],r=e.matrix,a=e.nodes,i=e.type,o=e.instanceCameras,s=e.instanceControllers,l=e.instanceLights,u=e.instanceGeometries,c=e.instanceNodes,d=0,f=a.length;d<f;d++)t.push(qe(a[d]));for(var d=0,f=o.length;d<f;d++){var h=ce(o[d]);null!==h&&t.push(h.clone())}for(var d=0,f=s.length;d<f;d++)for(var p=s[d],m=R(p.id),v=Se(m.id),g=We(v,p.materials),y=p.skeletons,x=m.skin.joints,b=ze(y,x),A=0,w=g.length;A<w;A++){var M=g[A];M.isSkinnedMesh&&(M.bind(b,m.skin.bindMatrix),M.normalizeSkinWeights()),t.push(M)}for(var d=0,f=l.length;d<f;d++){var T=me(l[d]);null!==T&&t.push(T.clone())}for(var d=0,f=u.length;d<f;d++)for(var p=u[d],v=Se(p.id),g=We(v,p.materials),A=0,w=g.length;A<w;A++)t.push(g[A]);for(var d=0,f=c.length;d<f;d++)t.push(qe(c[d]).clone());var M;if(0===a.length&&1===t.length)M=t[0];else{M="JOINT"===i?new n.Bone:new n.Group;for(var d=0;d<t.length;d++)M.add(t[d])}return""===M.name&&(M.name="JOINT"===i?e.sid:e.name),M.matrix.copy(r),M.matrix.decompose(M.position,M.quaternion,M.scale),M}function Ye(e,t){for(var r=[],a=0,n=e.length;a<n;a++){var i=t[e[a]];r.push(ne(i))}return r}function We(e,t){var r=[];for(var a in e){var i=e[a],o=Ye(i.materialKeys,t);0===o.length&&("lines"===a||"linestrips"===a?o.push(new n.LineBasicMaterial):o.push(new n.MeshPhongMaterial));var s=void 0!==i.data.attributes.skinIndex;if(s)for(var l=0,u=o.length;l<u;l++)o[l].skinning=!0;var c,d=1===o.length?o[0]:o;switch(a){case"lines":c=new n.LineSegments(i.data,d);break;case"linestrips":c=new n.Line(i.data,d);break;case"triangles":case"polylist":c=s?new n.SkinnedMesh(i.data,d):new n.Mesh(i.data,d)}r.push(c)}return r}function Qe(e){return void 0!==ht.nodes[e]}function qe(e){return p(ht.nodes[e],Xe)}function Ke(e){var t={name:e.getAttribute("name"),children:[]};je(e);for(var a=r(e,"node"),n=0;n<a.length;n++)t.children.push(Ve(a[n]));ht.visualScenes[e.getAttribute("id")]=t}function Ze(e){var t=new n.Group;t.name=e.name;for(var r=e.children,a=0;a<r.length;a++){var i=r[a];t.add(qe(i.id))}return t}function Je(e){return void 0!==ht.visualScenes[e]}function $e(e){return p(ht.visualScenes[e],Ze)}var et=new n.Vector3,tt=new n.Vector3,rt=new n.Quaternion,at=new n.Matrix4,nt=new n.Vector3;if(0===e.length)return{scene:new n.Scene};var it=(new DOMParser).parseFromString(e,"application/xml"),ot=r(it,"COLLADA")[0],st=ot.getAttribute("version");console.log("THREE.ColladaLoader: File version",st);var lt=function(e){return{unit:c(r(e,"unit")[0]),upAxis:d(r(e,"up_axis")[0])}}(r(ot,"asset")[0]),ut=new n.TextureLoader(this.manager);ut.setPath(t).setCrossOrigin(this.crossOrigin);var ct=[],dt={},ft=0,ht={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},kinematicsScenes:{}};f(ot,"library_animations","animation",m),f(ot,"library_animation_clips","animation_clip",_),f(ot,"library_controllers","controller",C),f(ot,"library_images","image",k),f(ot,"library_effects","effect",V),f(ot,"library_materials","material",re),f(ot,"library_cameras","camera",ie),f(ot,"library_lights","light",de),f(ot,"library_geometries","geometry",ve),f(ot,"library_nodes","node",Ve),f(ot,"library_visual_scenes","visual_scene",Ke),f(ot,"library_kinematics_models","kinematics_model",Fe),f(ot,"scene","instance_kinematics_scene",Ue),h(ht.animations,y),h(ht.clips,P),h(ht.controllers,U),h(ht.images,B),h(ht.effects,ee),h(ht.materials,ae),h(ht.cameras,ue),h(ht.lights,pe),h(ht.geometries,we),h(ht.visualScenes,Ze),function(){var e=ht.clips;if(!0===u(e)){if(!1===u(ht.animations)){var t=[];for(var r in ht.animations)for(var a=x(r),i=0,o=a.length;i<o;i++)t.push(a[i]);ct.push(new n.AnimationClip("default",-1,t))}}else for(var r in e)ct.push(L(r))}(),function(){var e=Object.keys(ht.kinematicsModels)[0],t=Object.keys(ht.kinematicsScenes)[0],r=Object.keys(ht.visualScenes)[0];if(void 0!==e&&void 0!==t){for(var a=_e(e),i=ke(t),o=$e(r),s=i.bindJointAxis,l={},u=0,c=s.length;u<c;u++){var d=s[u],f=ot.querySelector('[sid="'+d.target+'"]');if(f){var h=f.parentElement;!function(e,t){var r=t.getAttribute("name"),n=a.joints[e];o.traverse(function(a){a.name===r&&(l[e]={object:a,transforms:Be(t),joint:n,position:n.zeroPosition})})}(d.jointIndex,h)}}var p=new n.Matrix4;dt={joints:a&&a.joints,getJointValue:function(e){var t=l[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=l[e];if(r){var a=r.joint;if(t>a.limits.max||t<a.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+a.limits.min+", max: "+a.limits.max+").");else if(a.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{var i=r.object,o=a.axis,s=r.transforms;at.identity();for(var u=0;u<s.length;u++){var c=s[u];if(c.sid&&-1!==c.sid.indexOf(e))switch(a.type){case"revolute":at.multiply(p.makeRotationAxis(o,n.Math.degToRad(t)));break;case"prismatic":at.multiply(p.makeTranslation(o.x*t,o.y*t,o.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+a.type)}else switch(c.type){case"matrix":at.multiply(c.obj);break;case"translate":at.multiply(p.makeTranslation(c.obj.x,c.obj.y,c.obj.z));break;case"scale":at.scale(c.obj);break;case"rotate":at.multiply(p.makeRotationAxis(c.obj,c.angle))}}i.matrix.copy(at),i.matrix.decompose(i.position,i.quaternion,i.scale),l[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}}();var pt=function(e){return $e(s(r(e,"instance_visual_scene")[0].getAttribute("url")))}(r(ot,"scene")[0]);return"Z_UP"===lt.upAxis&&pt.quaternion.setFromEuler(new n.Euler(-Math.PI/2,0,0)),pt.scale.multiplyScalar(lt.unit),{animations:ct,kinematics:dt,library:ht,scene:pt}}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function e(){this._parser=e.parse};i.prototype=Object.create(n.CompressedTextureLoader.prototype),i.prototype.constructor=i,i.parse=function(e,t){function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var a={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},i=r("DXT1"),o=r("DXT3"),s=r("DXT5"),l=r("ETC1"),u=new Int32Array(e,0,31);if(542327876!==u[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),a;if(4&!u[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),a;var c,d=u[21],f=!1;switch(d){case i:c=8,a.format=n.RGB_S3TC_DXT1_Format;break;case o:c=16,a.format=n.RGBA_S3TC_DXT3_Format;break;case s:c=16,a.format=n.RGBA_S3TC_DXT5_Format;break;case l:c=8,a.format=n.RGB_ETC1_Format;break;default:if(!(32===u[22]&&16711680&u[23]&&65280&u[24]&&255&u[25]&&4278190080&u[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(d)),a;f=!0,c=64,a.format=n.RGBAFormat}a.mipmapCount=1,131072&u[2]&&!1!==t&&(a.mipmapCount=Math.max(1,u[7]));var h=u[28];if(a.isCubemap=!!(512&h),a.isCubemap&&(!(1024&h)||!(2048&h)||!(4096&h)||!(8192&h)||!(16384&h)||!(32768&h)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),a;a.width=u[4],a.height=u[3];for(var p=u[1]+4,m=a.isCubemap?6:1,v=0;v<m;v++)for(var g=a.width,y=a.height,x=0;x<a.mipmapCount;x++){if(f)var b=function(e,t,r,a){for(var n=r*a*4,i=new Uint8Array(e,t,n),o=new Uint8Array(n),s=0,l=0,u=0;u<a;u++)for(var c=0;c<r;c++){var d=i[l];l++;var f=i[l];l++;var h=i[l];l++;var p=i[l];l++,o[s]=h,s++,o[s]=f,s++,o[s]=d,s++,o[s]=p,s++}return o}(e,p,g,y),A=b.length;else var A=Math.max(4,g)/4*Math.max(4,y)/4*c,b=new Uint8Array(e,p,A);var w={data:b,width:g,height:y};a.mipmaps.push(w),p+=A,g=Math.max(g>>1,1),y=Math.max(y>>1,1)}return a},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=function(e){this.timeLoaded=0,this.manager=e||i.DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=i.TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}};o.prototype={constructor:o,load:function(e,t,r,a){var n=this,o=new i.FileLoader(n.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.load(e,function(e){n.decodeDracoFile(e,t)},r,a)},setPath:function(e){this.path=e},setCrossOrigin:function(e){this.crossOrigin=e},setVerbosity:function(e){this.verbosity=e},setDrawMode:function(e){this.drawMode=e},setSkipDequantization:function(e,t){var r=!0;void 0!==t&&(r=t),this.getAttributeOptions(e).skipDequantization=r},decodeDracoFile:function(e,t,r){var a=this;o.getDecoderModule().then(function(n){a.decodeDracoFileInternal(e,n.decoder,t,r||{})})},decodeDracoFileInternal:function(e,t,r,a){var n=new t.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength);var i=new t.Decoder,o=i.GetEncodedGeometryType(n);if(o==t.TRIANGULAR_MESH)this.verbosity>0&&console.log("Loaded a mesh.");else{if(o!=t.POINT_CLOUD){var s="THREE.DRACOLoader: Unknown geometry type.";throw console.error(s),new Error(s)}this.verbosity>0&&console.log("Loaded a point cloud.")}r(this.convertDracoGeometryTo3JS(t,i,o,n,a))},addAttributeToGeometry:function(e,t,r,a,n,o,s){if(0===n.ptr){var l="THREE.DRACOLoader: No attribute "+a;throw console.error(l),new Error(l)}var u=n.num_components(),c=new e.DracoFloat32Array;t.GetAttributeFloatForAllPoints(r,n,c);var d=r.num_points(),f=d*u;s[a]=new Float32Array(f);for(var h=0;h<f;h++)s[a][h]=c.GetValue(h);o.addAttribute(a,new i.Float32BufferAttribute(s[a],u)),e.destroy(c)},convertDracoGeometryTo3JS:function(e,t,r,a,n){!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);var o,s,l=performance.now();if(r===e.TRIANGULAR_MESH?(o=new e.Mesh,s=t.DecodeBufferToMesh(a,o)):(o=new e.PointCloud,s=t.DecodeBufferToPointCloud(a,o)),!s.ok()||0==o.ptr){var u="THREE.DRACOLoader: Decoding failed: ";throw u+=s.error_msg(),console.error(u),e.destroy(t),e.destroy(o),new Error(u)}var c=performance.now();e.destroy(a);var d;r==e.TRIANGULAR_MESH?(d=o.num_faces(),this.verbosity>0&&console.log("Number of faces loaded: "+d.toString())):d=0;var f=o.num_points(),h=o.num_attributes();this.verbosity>0&&(console.log("Number of points loaded: "+f.toString()),console.log("Number of attributes loaded: "+h.toString()));var p=t.GetAttributeId(o,e.POSITION);if(-1==p){var u="THREE.DRACOLoader: No position attribute found.";throw console.error(u),e.destroy(t),e.destroy(o),new Error(u)}var m=t.GetAttribute(o,p),v={},g=new i.BufferGeometry;for(var y in this.nativeAttributeMap)if(void 0===n[y]){var x=t.GetAttributeId(o,e[this.nativeAttributeMap[y]]);if(-1!==x){this.verbosity>0&&console.log("Loaded "+y+" attribute.");var b=t.GetAttribute(o,x);this.addAttributeToGeometry(e,t,o,y,b,g,v)}}for(var y in n){var A=n[y],b=t.GetAttributeByUniqueId(o,A);this.addAttributeToGeometry(e,t,o,y,b,g,v)}if(r==e.TRIANGULAR_MESH)if(this.drawMode===i.TriangleStripDrawMode){var w=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(o,w);v.indices=new Uint32Array(w.size());for(var M=0;M<w.size();++M)v.indices[M]=w.GetValue(M);e.destroy(w)}else{var T=3*d;v.indices=new Uint32Array(T);for(var S=new e.DracoInt32Array,M=0;M<d;++M){t.GetFaceFromMesh(o,M,S);var F=3*M;v.indices[F]=S.GetValue(0),v.indices[F+1]=S.GetValue(1),v.indices[F+2]=S.GetValue(2)}e.destroy(S)}g.drawMode=this.drawMode,r==e.TRIANGULAR_MESH&&g.setIndex(new(v.indices.length>65535?i.Uint32BufferAttribute:i.Uint16BufferAttribute)(v.indices,1));var E=new e.AttributeQuantizationTransform;if(E.InitFromAttribute(m)){g.attributes.position.isQuantized=!0,g.attributes.position.maxRange=E.range(),g.attributes.position.numQuantizationBits=E.quantization_bits(),g.attributes.position.minValues=new Float32Array(3);for(var M=0;M<3;++M)g.attributes.position.minValues[M]=E.min_value(M)}return e.destroy(E),e.destroy(t),e.destroy(o),this.decode_time=c-l,this.import_time=performance.now()-c,this.verbosity>0&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),g},isVersionSupported:function(e,t){o.getDecoderModule().then(function(r){t(r.decoder.isVersionSupported(e))})},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},o.decoderPath="./",o.decoderConfig={},o.decoderModulePromise=null,o.setDecoderPath=function(e){o.decoderPath=e},o.setDecoderConfig=function(e){var t=o.decoderConfig.wasmBinary;o.decoderConfig=e||{},o.releaseDecoderModule(),t&&(o.decoderConfig.wasmBinary=t)},o.releaseDecoderModule=function(){o.decoderModulePromise=null},o.getDecoderModule=function(){var e=this,t=o.decoderPath,r=o.decoderConfig,n=o.decoderModulePromise;return n||("undefined"!=typeof DracoDecoderModule?n=Promise.resolve():"object"!==("undefined"==typeof WebAssembly?"undefined":a(WebAssembly))||"js"===r.type?n=o._loadScript(t+"draco_decoder.js"):(r.wasmBinaryFile=t+"draco_decoder.wasm",n=o._loadScript(t+"draco_wasm_wrapper.js").then(function(){return o._loadArrayBuffer(r.wasmBinaryFile)}).then(function(e){r.wasmBinary=e})),n=n.then(function(){return new Promise(function(t){r.onModuleLoaded=function(r){e.timeLoaded=performance.now(),t({decoder:r})},DracoDecoderModule(r)})}),o.decoderModulePromise=n,n)},o._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var r=document.getElementsByTagName("head")[0],a=document.createElement("script");return a.id="decoder_script",a.type="text/javascript",a.src=e,new Promise(function(e){a.onload=e,r.appendChild(a)})},o._loadArrayBuffer=function(e){var t=new i.FileLoader;return t.setResponseType("arraybuffer"),new Promise(function(r,a){t.load(e,r,void 0,a)})},t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){this.sourceTexture=e,this.resolution=t,this.views=[{t:[1,0,0],u:[0,-1,0]},{t:[-1,0,0],u:[0,-1,0]},{t:[0,1,0],u:[0,0,1]},{t:[0,-1,0],u:[0,0,-1]},{t:[0,0,1],u:[0,-1,0]},{t:[0,0,-1],u:[0,-1,0]}],this.camera=new n.PerspectiveCamera(90,1,.1,10),this.boxMesh=new n.Mesh(new n.BoxBufferGeometry(1,1,1),this.getShader()),this.boxMesh.material.side=n.BackSide,this.scene=new n.Scene,this.scene.add(this.boxMesh);var r={format:n.RGBAFormat,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.renderTarget=new n.WebGLRenderTargetCube(this.resolution,this.resolution,r)};i.prototype={constructor:i,update:function(e){for(var t=0;t<6;t++){this.renderTarget.activeCubeFace=t;var r=this.views[t];this.camera.position.set(0,0,0),this.camera.up.set(r.u[0],r.u[1],r.u[2]),this.camera.lookAt(r.t[0],r.t[1],r.t[2]),e.render(this.scene,this.camera,this.renderTarget,!0)}return this.renderTarget.texture},getShader:function(){var e=new n.ShaderMaterial({uniforms:{equirectangularMap:{value:this.sourceTexture}},vertexShader:"varying vec3 localPosition;\n\t\t\t\t\n\t\t\t\tvoid main() {\n\t\t\t\t\tlocalPosition = position;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec3 localPosition;\n\t\t\t\tuniform sampler2D equirectangularMap;\n\t\t\t\t\n\t\t\t\tvec2 EquiangularSampleUV(vec3 v) {\n\t\t\t    vec2 uv = vec2(atan(v.z, v.x), asin(v.y));\n\t\t\t    uv *= vec2(0.1591, 0.3183); // inverse atan\n\t\t\t    uv += 0.5;\n\t\t\t    return uv;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 uv = EquiangularSampleUV(normalize(localPosition));\n    \t\t\tvec3 color = texture2D(equirectangularMap, uv).rgb;\n    \t\t\t\n\t\t\t\t\tgl_FragColor = vec4( color, 1.0 );\n\t\t\t\t}",blending:n.CustomBlending,premultipliedAlpha:!1,blendSrc:n.OneFactor,blendDst:n.ZeroFactor,blendSrcAlpha:n.OneFactor,blendDstAlpha:n.ZeroFactor,blendEquation:n.AddEquation});return e.type="EquiangularToCubeGenerator",e},dispose:function(){this.boxMesh.geometry.dispose(),this.boxMesh.material.dispose(),this.renderTarget.dispose()}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype=Object.create(n.DataTextureLoader.prototype),i.prototype._parser=function(e){function t(e,t){for(var r=0,a=0;a<O;++a)(0==a||e[a>>3]&1<<(7&a))&&(t[r++]=a);for(var n=r-1;r<O;)t[r++]=0;return n}function r(e){for(var t=0;t<R;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}function a(e,t,r,a,n){for(;r<e;)t=t<<8|w(a,n),r+=8;r-=e,W.l=t>>r&(1<<e)-1,W.c=t,W.lc=r}function i(e){for(var t=0;t<=58;++t)Q[t]=0;for(var t=0;t<D;++t)Q[e[t]]+=1;for(var r=0,t=58;t>0;--t){var a=r+Q[t]>>1;Q[t]=r,r=a}for(var t=0;t<D;++t){var n=e[t];n>0&&(e[t]=n|Q[n]++<<6)}}function o(e,t,r,n,o,s,l){for(var u=r,c=0,d=0;o<=s;o++){if(u.value-r.value>n)return!1;a(6,c,d,e,u);var f=W.l;if(c=W.c,d=W.lc,l[o]=f,f==j){if(u.value-r.value>n)throw"Something wrong with hufUnpackEncTable";a(8,c,d,e,u);var h=W.l+V;if(c=W.c,d=W.lc,o+h>s+1)throw"Something wrong with hufUnpackEncTable";for(;h--;)l[o++]=0;o--}else if(f>=B){var h=f-B+2;if(o+h>s+1)throw"Something wrong with hufUnpackEncTable";for(;h--;)l[o++]=0;o--}}i(l)}function s(e){return 63&e}function l(e){return e>>6}function u(e,t,r,a){for(;t<=r;t++){var n=l(e[t]),i=s(e[t]);if(n>>i)throw"Invalid table entry";if(i>U){var o=a[n>>i-U];if(o.len)throw"Invalid table entry";if(o.lit++,o.p){var u=o.p;o.p=new Array(o.lit);for(var c=0;c<o.lit-1;++c)o.p[c]=u[c]}else o.p=new Array(1);o.p[o.lit-1]=t}else if(i)for(var d=0,c=1<<U-i;c>0;c--){var o=a[(n<<U-i)+d];if(o.len||o.p)throw"Invalid table entry";o.len=i,o.lit=t,d++}}return!0}function c(e,t,r,a){e=e<<8|w(r,a),t+=8,q.c=e,q.lc=t}function d(e,t,r,a,n,i,o,s,l,u){if(e==t){a<8&&(c(r,a,n,o),r=q.c,a=q.lc),a-=8;var d=r>>a;if(out+d>oe)throw"Issue with getCode";for(var f=out[-1];d-- >0;)s[l.value++]=f}else{if(!(l.value<u))throw"Issue with getCode";s[l.value++]=e}K.c=r,K.lc=a}function f(e){return 65535&e}function h(e){var t=f(e);return t>32767?t-65536:t}function p(e,t){var r=h(e),a=h(t),n=a,i=r+(1&n)+(n>>1),o=i,s=i-n;Z.a=o,Z.b=s}function m(e,t,r,a,n,i,o){for(var s,l=r>n?n:r,u=1;u<=l;)u<<=1;for(u>>=1,s=u,u>>=1;u>=1;){for(var c,d,f,h,m=0,v=m+i*(n-s),g=i*u,y=i*s,x=a*u,b=a*s;m<=v;m+=y){for(var A=m,w=m+a*(r-s);A<=w;A+=b){var M=A+x,T=A+g,S=T+x;p(t[A+e],t[T+e]),c=Z.a,f=Z.b,p(t[M+e],t[S+e]),d=Z.a,h=Z.b,p(c,d),t[A+e]=Z.a,t[M+e]=Z.b,p(f,h),t[T+e]=Z.a,t[S+e]=Z.b}if(r&u){var T=A+g;p(t[A+e],t[T+e]),c=Z.a,t[T+e]=Z.b,t[A+e]=c}}if(n&u)for(var A=m,w=m+a*(r-s);A<=w;A+=b){var M=A+x;p(t[A+e],t[M+e]),c=Z.a,t[M+e]=Z.b,t[A+e]=c}s=u,u>>=1}return m}function v(e,t,r,a,n,i,o,u,f,h){for(var p=0,m=0,v=u,g=Math.trunc(n.value+(i+7)/8);n.value<g;)for(c(p,m,r,n),p=q.c,m=q.lc;m>=U;){var y=p>>m-U&k,x=t[y];if(x.len)m-=x.len,d(x.lit,o,p,m,r,a,n,f,h,v),p=K.c,m=K.lc;else{if(!x.p)throw"hufDecode issues";var b;for(b=0;b<x.lit;b++){for(var A=s(e[x.p[b]]);m<A&&n.value<g;)c(p,m,r,n),p=q.c,m=q.lc;if(m>=A&&l(e[x.p[b]])==(p>>m-A&(1<<A)-1)){m-=A,d(x.p[b],o,p,m,r,a,n,f,h,v),p=K.c,m=K.lc;break}}if(b==x.lit)throw"hufDecode issues"}}var w=8-i&7;for(p>>=w,m-=w;m>0;){var x=t[p<<U-m&k];if(!x.len)throw"hufDecode issues";m-=x.len,d(x.lit,o,p,m,r,a,n,f,h,v),p=K.c,m=K.lc}return!0}function g(e,t,a,n,i,s,l){var c=a.value,d=A(t,a),f=A(t,a);a.value+=4;var h=A(t,a);if(a.value+=4,d<0||d>=D||f<0||f>=D)throw"Something wrong with HUF_ENCSIZE";var p=new Array(D),m=new Array(R);if(r(m),o(e,t,a,n-(a.value-c),d,f,p),h>8*(n-(a.value-c)))throw"Something wrong with hufUncompress";u(p,d,f,m),v(p,m,e,t,a,h,f,l,i,s)}function y(e,t,r){for(var a=0;a<r;++a)t[a]=e[t[a]]}function x(e,t){for(var r=new Uint8Array(e),a=0;0!=r[t.value+a];)a+=1;var n=(new TextDecoder).decode(r.slice(t.value,t.value+a));return t.value=t.value+a+1,n}function b(e,t,r){var a=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,a}function A(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+H,r}function w(e,t){var r=e[t.value];return t.value=t.value+Y,r}function M(e,t){var r=e.getUint8(t.value);return t.value=t.value+Y,r}function T(e,t){var r=e.getFloat32(t.value,!0);return t.value+=z,r}function S(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function F(e,t){var r=e.getUint16(t.value,!0);return t.value+=X,r}function E(e,t,r,a){for(var n=r.value,i=[];r.value<n+a-1;){var o=x(t,r),s=A(e,r),l=M(e,r);r.value+=3;var u=A(e,r),c=A(e,r);i.push({name:o,pixelType:s,pLinear:l,xSampling:u,ySampling:c})}return r.value+=1,i}function _(e,t){return{redX:T(e,t),redY:T(e,t),greenX:T(e,t),greenY:T(e,t),blueX:T(e,t),blueY:T(e,t),whiteX:T(e,t),whiteY:T(e,t)}}function P(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION"][M(e,t)]}function L(e,t){return{xMin:A(e,t),yMin:A(e,t),xMax:A(e,t),yMax:A(e,t)}}function C(e,t){return["INCREASING_Y"][M(e,t)]}function N(e,t){return[T(e,t),T(e,t)]}for(var O=65536,I=O>>3,U=14,D=65537,R=1<<U,k=R-1,B=59,j=63,V=2+j-B,G=8,z=4,H=4,X=2,Y=1,W={l:0,c:0,lc:0},Q=new Array(59),q={c:0,lc:0},K={c:0,lc:0},Z={a:0,b:0},J=new DataView(e),$=new Uint8Array(e),ee={},te=(J.getUint32(0,!0),J.getUint8(4,!0),J.getUint8(5,!0),{value:8}),re=!0;re;){var ae=x(e,te);if(0==ae)re=!1;else{var ne=x(e,te),ie=A(J,te),se=function(e,t,r,a,n){if("string"===a||"iccProfile"===a)return b(t,r,n);if("chlist"===a)return E(e,t,r,n);if("chromaticities"===a)return _(e,r);if("compression"===a)return P(e,r);if("box2i"===a)return L(e,r);if("lineOrder"===a)return C(e,r);if("float"===a)return T(e,r);if("v2f"===a)return N(e,r);if("int"===a)return A(e,r);throw"Cannot parse value for unsupported type: "+a}(J,e,te,ne,ie);ee[ae]=se}}var le=ee.dataWindow.yMax+1,ue=1;"PIZ_COMPRESSION"===ee.compression&&(ue=32);for(var ce=le/ue,de=0;de<ce;de++){(function(e,t){var r=e.getUint32(0,!0);t.value=t.value+G})(J,te)}var fe=ee.dataWindow.xMax-ee.dataWindow.xMin+1,he=ee.dataWindow.yMax-ee.dataWindow.yMin+1,pe=ee.channels.length,me=new Float32Array(fe*he*pe),ve={R:0,G:1,B:2,A:3};if("NO_COMPRESSION"===ee.compression)for(var ge=0;ge<he;ge++)for(var ye=A(J,te),xe=(A(J,te),0);xe<ee.channels.length;xe++){var be=ve[ee.channels[xe].name];if(1!==ee.channels[xe].pixelType)throw"Only supported pixel format is HALF";for(var Ae=0;Ae<fe;Ae++){var we=function(e,t){return S(F(e,t))}(J,te);me[fe*pe*(he-ye)+Ae*pe+be]=we}}else{if("PIZ_COMPRESSION"!==ee.compression)throw"Cannot decompress unsupported compression";for(var Me=0;Me<he/ue;Me++){var Te=(A(J,te),A(J,te),fe*ue*(2*ee.channels.length)),Se=new Uint16Array(Te),Fe={value:0};!function(e,r,a,n,i,o,s,l,u,c){var d=new Uint8Array(I),f=F(n,i),h=F(n,i);if(h>=I)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(f<=h)for(var p=0;p<h-f+1;p++)d[p+f]=M(n,i);var v=new Uint16Array(O),x=t(d,v);g(a,n,i,A(n,i),e,r,o);for(var b=new Array(s),w=0,p=0;p<s;p++)l[p],b[p]={},b[p].start=w,b[p].end=b[p].start,b[p].nx=u,b[p].ny=c,b[p].size=1,w+=b[p].nx*b[p].ny*b[p].size;for(var T=0,p=0;p<s;p++)for(var S=0;S<b[p].size;++S)T+=m(S+T,e,b[p].nx,b[p].size,b[p].ny,b[p].nx*b[p].size,x);y(v,e,w)}(Se,Fe,$,J,te,Te,pe,ee.channels,fe,ue);for(var Ee=0;Ee<ue;Ee++)for(var xe=0;xe<ee.channels.length;xe++){var be=ve[ee.channels[xe].name];if(1!==ee.channels[xe].pixelType)throw"Only supported pixel format is HALF";for(var Ae=0;Ae<fe;Ae++){var we=S(Se[xe*(ue*fe)+Ee*fe+Ae]),_e=Ee+Me*ue;me[fe*pe*(he-_e)+Ae*pe+be]=we}}}}return{header:ee,width:fe,height:he,data:me,format:n.RGBFormat,type:n.FloatType}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.default=function(){function e(e){var t=new Map;if("Connections"in e){e.Connections.connections.forEach(function(e){var r=e[0],a=e[1],n=e[2];t.has(r)||t.set(r,{parents:[],children:[]});var i={ID:a,relationship:n};t.get(r).parents.push(i),t.has(a)||t.set(a,{parents:[],children:[]});var o={ID:r,relationship:n};t.get(a).children.push(o)})}return t}function t(e){var t={},a={};if("Video"in e.Objects){var n=e.Objects.Video;for(var i in n){var o=n[i],s=parseInt(i);if(t[s]=o.RelativeFilename||o.Filename,"Content"in o){var l=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,u="string"==typeof o.Content&&""!==o.Content;if(l||u){var c=r(n[i]);a[o.RelativeFilename||o.Filename]=c}}}}for(var s in t){var d=t[s];void 0!==a[d]?t[s]=a[d]:t[s]=t[s].split("\\").pop()}return t}function r(e){var t,r=e.Content,a=e.RelativeFilename||e.Filename,n=a.slice(a.lastIndexOf(".")+1).toLowerCase();switch(n){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":if("function"!=typeof i.TGALoader)return void console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");null===i.Loader.Handlers.get(".tga")&&i.Loader.Handlers.add(/\.tga$/i,new i.TGALoader),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+n+'" is not supported.')}if("string"==typeof r)return"data:"+t+";base64,"+r;var o=new Uint8Array(r);return window.URL.createObjectURL(new Blob([o],{type:t}))}function n(e,t,r,a){var n=new Map;if("Texture"in e.Objects){var i=e.Objects.Texture;for(var s in i){var l=o(i[s],t,r,a);n.set(parseInt(s),l)}}return n}function o(e,t,r,a){var n=s(e,t,r,a);n.ID=e.id,n.name=e.attrName;var o=e.WrapModeU,l=e.WrapModeV,u=void 0!==o?o.value:0,c=void 0!==l?l.value:0;if(n.wrapS=0===u?i.RepeatWrapping:i.ClampToEdgeWrapping,n.wrapT=0===c?i.RepeatWrapping:i.ClampToEdgeWrapping,"Scaling"in e){var d=e.Scaling.value;n.repeat.x=d[0],n.repeat.y=d[1]}return n}function s(e,t,r,a){var n,o=t.path,s=a.get(e.id).children;void 0!==s&&s.length>0&&void 0!==r[s[0].ID]&&(n=r[s[0].ID],0!==n.indexOf("blob:")&&0!==n.indexOf("data:")||t.setPath(void 0));var l;return l="tga"===e.FileName.slice(-3).toLowerCase()?i.Loader.Handlers.get(".tga").load(n):t.load(n),t.setPath(o),l}function l(e,t,r){var a=new Map;if("Material"in e.Objects){var n=e.Objects.Material;for(var i in n){var o=u(e,n[i],t,r);null!==o&&a.set(parseInt(i),o)}}return a}function u(e,t,r,n){var o=t.id,s=t.attrName,l=t.ShadingModel;if("object"===(void 0===l?"undefined":a(l))&&(l=l.value),!n.has(o))return null;var u,d=c(e,t,r,o,n);switch(l.toLowerCase()){case"phong":u=new i.MeshPhongMaterial;break;case"lambert":u=new i.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',l),u=new i.MeshPhongMaterial({color:3342591})}return u.setValues(d),u.name=s,u}function c(e,t,r,a,n){var o={};return t.BumpFactor&&(o.bumpScale=t.BumpFactor.value),t.Diffuse?o.color=(new i.Color).fromArray(t.Diffuse.value):t.DiffuseColor&&"Color"===t.DiffuseColor.type&&(o.color=(new i.Color).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(o.displacementScale=t.DisplacementFactor.value),t.Emissive?o.emissive=(new i.Color).fromArray(t.Emissive.value):t.EmissiveColor&&"Color"===t.EmissiveColor.type&&(o.emissive=(new i.Color).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(o.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(o.opacity=parseFloat(t.Opacity.value)),o.opacity<1&&(o.transparent=!0),t.ReflectionFactor&&(o.reflectivity=t.ReflectionFactor.value),t.Shininess&&(o.shininess=t.Shininess.value),t.Specular?o.specular=(new i.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(o.specular=(new i.Color).fromArray(t.SpecularColor.value)),n.get(a).children.forEach(function(t){var a=t.relationship;switch(a){case"Bump":o.bumpMap=r.get(t.ID);break;case"DiffuseColor":o.map=d(e,r,t.ID,n);break;case"DisplacementColor":o.displacementMap=d(e,r,t.ID,n);break;case"EmissiveColor":o.emissiveMap=d(e,r,t.ID,n);break;case"NormalMap":o.normalMap=d(e,r,t.ID,n);break;case"ReflectionColor":o.envMap=d(e,r,t.ID,n),o.envMap.mapping=i.EquirectangularReflectionMapping;break;case"SpecularColor":o.specularMap=d(e,r,t.ID,n);break;case"TransparentColor":o.alphaMap=d(e,r,t.ID,n),o.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a)}}),o}function d(e,t,r,a){return"LayeredTexture"in e.Objects&&r in e.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),r=a.get(r).children[0].ID),t.get(r)}function f(e,t){var r={},a={};if("Deformer"in e.Objects){var n=e.Objects.Deformer;for(var i in n){var o=n[i],s=t.get(parseInt(i));if("Skin"===o.attrType){var l=h(s,n);l.ID=i,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=s.parents[0].ID,r[i]=l}else if("BlendShape"===o.attrType){var u={id:i};u.rawTargets=p(s,o,n,t),u.id=i,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),u.parentGeoID=s.parents[0].ID,a[i]=u}}}return{skeletons:r,morphTargets:a}}function h(e,t){var r=[];return e.children.forEach(function(e){var a=t[e.ID];if("Cluster"===a.attrType){var n={ID:e.ID,indices:[],weights:[],transform:(new i.Matrix4).fromArray(a.Transform.a),transformLink:(new i.Matrix4).fromArray(a.TransformLink.a),linkMode:a.Mode};"Indexes"in a&&(n.indices=a.Indexes.a,n.weights=a.Weights.a),r.push(n)}}),{rawBones:r,bones:[]}}function p(e,t,r,a){for(var n=[],i=0;i<e.children.length;i++){if(8===i){console.warn("FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.");break}var o=e.children[i],s=r[o.ID],l={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if("BlendShapeChannel"!==s.attrType)return;a.get(parseInt(o.ID)).children.forEach(function(e){"DeformPercent"===e.relationship?l.weightCurveID=e.ID:l.geoID=e.ID}),n.push(l)}return n}function m(e,t,r){var a=new Map;if("Geometry"in e.Objects){var n=e.Objects.Geometry;for(var i in n){var o=t.get(parseInt(i)),s=v(e,o,n[i],r);a.set(parseInt(i),s)}}return a}function v(e,t,r,a){switch(r.attrType){case"Mesh":return g(e,t,r,a);case"NurbsCurve":return P(r)}}function g(e,t,r,a){var n=a.skeletons,o=a.morphTargets,s=t.parents.map(function(t){return e.Objects.Model[t.ID]});if(0!==s.length){var l=t.children.reduce(function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e},null),u=t.children.reduce(function(e,t){return void 0!==o[t.ID]&&(e=o[t.ID]),e},null),c=new i.Matrix4,d=s[0];if("GeometricRotation"in d){var f=d.GeometricRotation.value.map(i.Math.degToRad);f[3]="ZYX",c.makeRotationFromEuler((new i.Euler).fromArray(f))}return"GeometricTranslation"in d&&c.setPosition((new i.Vector3).fromArray(d.GeometricTranslation.value)),"GeometricScaling"in d&&c.scale((new i.Vector3).fromArray(d.GeometricScaling.value)),y(e,r,l,u,c)}}function y(e,t,r,a,n){var o=new i.BufferGeometry;t.attrName&&(o.name=t.attrName);var s=x(t,r),l=b(s),u=new i.Float32BufferAttribute(l.vertex,3);if(n.applyToBufferAttribute(u),o.addAttribute("position",u),l.colors.length>0&&o.addAttribute("color",new i.Float32BufferAttribute(l.colors,3)),r&&(o.addAttribute("skinIndex",new i.Uint16BufferAttribute(l.weightsIndices,4)),o.addAttribute("skinWeight",new i.Float32BufferAttribute(l.vertexWeights,4)),o.FBX_Deformer=r),l.normal.length>0){var c=new i.Float32BufferAttribute(l.normal,3);(new i.Matrix3).getNormalMatrix(n).applyToBufferAttribute(c),o.addAttribute("normal",c)}if(l.uvs.forEach(function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),o.addAttribute(r,new i.Float32BufferAttribute(l.uvs[t],2))}),s.material&&"AllSame"!==s.material.mappingType){var d=l.materialIndex[0],f=0;if(l.materialIndex.forEach(function(e,t){e!==d&&(o.addGroup(f,t-f,d),d=e,f=t)}),o.groups.length>0){var h=o.groups[o.groups.length-1],p=h.start+h.count;p!==l.materialIndex.length&&o.addGroup(p,l.materialIndex.length-p,d)}0===o.groups.length&&o.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return w(e,o,t,a,n),o}function x(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=F(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=E(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=T(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var a=0;e.LayerElementUV[a];)r.uv.push(S(e.LayerElementUV[a])),a++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(a,n){void 0===r.weightTable[a]&&(r.weightTable[a]=[]),r.weightTable[a].push({id:t,weight:e.weights[n]})})})),r}function b(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,a=0,n=!1,i=[],o=[],s=[],l=[],u=[],c=[];return e.vertexIndices.forEach(function(d,f){var h=!1;d<0&&(d^=-1,h=!0);var p=[],m=[];if(i.push(3*d,3*d+1,3*d+2),e.color){var v=_(f,r,d,e.color);s.push(v[0],v[1],v[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach(function(e){m.push(e.weight),p.push(e.id)}),m.length>4){n||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),n=!0);var g=[0,0,0,0],y=[0,0,0,0];m.forEach(function(e,t){var r=e,a=p[t];y.forEach(function(e,t,n){if(r>e){n[t]=r,r=e;var i=g[t];g[t]=a,a=i}})}),p=g,m=y}for(;m.length<4;)m.push(0),p.push(0);for(var x=0;x<4;++x)u.push(m[x]),c.push(p[x])}if(e.normal){var v=_(f,r,d,e.normal);o.push(v[0],v[1],v[2])}if(e.material&&"AllSame"!==e.material.mappingType)var b=_(f,r,d,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var a=_(f,r,d,e);void 0===l[t]&&(l[t]=[]),l[t].push(a[0]),l[t].push(a[1])}),a++,h&&(A(t,e,i,b,o,s,l,u,c,a),r++,a=0,i=[],o=[],s=[],l=[],u=[],c=[])}),t}function A(e,t,r,a,n,i,o,s,l,u){for(var c=2;c<u;c++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(c-1)]]),e.vertex.push(t.vertexPositions[r[3*(c-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(c-1)+2]]),e.vertex.push(t.vertexPositions[r[3*c]]),e.vertex.push(t.vertexPositions[r[3*c+1]]),e.vertex.push(t.vertexPositions[r[3*c+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(c-1)]),e.vertexWeights.push(s[4*(c-1)+1]),e.vertexWeights.push(s[4*(c-1)+2]),e.vertexWeights.push(s[4*(c-1)+3]),e.vertexWeights.push(s[4*c]),e.vertexWeights.push(s[4*c+1]),e.vertexWeights.push(s[4*c+2]),e.vertexWeights.push(s[4*c+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(c-1)]),e.weightsIndices.push(l[4*(c-1)+1]),e.weightsIndices.push(l[4*(c-1)+2]),e.weightsIndices.push(l[4*(c-1)+3]),e.weightsIndices.push(l[4*c]),e.weightsIndices.push(l[4*c+1]),e.weightsIndices.push(l[4*c+2]),e.weightsIndices.push(l[4*c+3])),t.color&&(e.colors.push(i[0]),e.colors.push(i[1]),e.colors.push(i[2]),e.colors.push(i[3*(c-1)]),e.colors.push(i[3*(c-1)+1]),e.colors.push(i[3*(c-1)+2]),e.colors.push(i[3*c]),e.colors.push(i[3*c+1]),e.colors.push(i[3*c+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(a),e.materialIndex.push(a),e.materialIndex.push(a)),t.normal&&(e.normal.push(n[0]),e.normal.push(n[1]),e.normal.push(n[2]),e.normal.push(n[3*(c-1)]),e.normal.push(n[3*(c-1)+1]),e.normal.push(n[3*(c-1)+2]),e.normal.push(n[3*c]),e.normal.push(n[3*c+1]),e.normal.push(n[3*c+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(o[r][0]),e.uvs[r].push(o[r][1]),e.uvs[r].push(o[r][2*(c-1)]),e.uvs[r].push(o[r][2*(c-1)+1]),e.uvs[r].push(o[r][2*c]),e.uvs[r].push(o[r][2*c+1])})}function w(e,t,r,a,n){null!==a&&(t.morphAttributes.position=[],t.morphAttributes.normal=[],a.rawTargets.forEach(function(a){var i=e.Objects.Geometry[a.geoID];void 0!==i&&M(t,r,i,n)}))}function M(e,t,r,a){var n=new i.BufferGeometry;r.attrName&&(n.name=r.attrName);for(var o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],s=void 0!==t.Vertices?t.Vertices.a.slice():[],l=void 0!==r.Vertices?r.Vertices.a:[],u=void 0!==r.Indexes?r.Indexes.a:[],c=0;c<u.length;c++){var d=3*u[c];s[d]+=l[3*c],s[d+1]+=l[3*c+1],s[d+2]+=l[3*c+2]}var f={vertexIndices:o,vertexPositions:s},h=b(f),p=new i.Float32BufferAttribute(h.vertex,3);p.name=r.attrName,a.applyToBufferAttribute(p),e.morphAttributes.position.push(p)}function T(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.Normals.a,n=[];return"IndexToDirect"===r&&("NormalIndex"in e?n=e.NormalIndex.a:"NormalsIndex"in e&&(n=e.NormalsIndex.a)),{dataSize:3,buffer:a,indices:n,mappingType:t,referenceType:r}}function S(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.UV.a,n=[];return"IndexToDirect"===r&&(n=e.UVIndex.a),{dataSize:2,buffer:a,indices:n,mappingType:t,referenceType:r}}function F(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.Colors.a,n=[];return"IndexToDirect"===r&&(n=e.ColorIndex.a),{dataSize:4,buffer:a,indices:n,mappingType:t,referenceType:r}}function E(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var a=e.Materials.a,n=[],i=0;i<a.length;++i)n.push(i);return{dataSize:1,buffer:a,indices:n,mappingType:t,referenceType:r}}function _(e,t,r,a){var n;switch(a.mappingType){case"ByPolygonVertex":n=e;break;case"ByPolygon":n=t;break;case"ByVertice":n=r;break;case"AllSame":n=a.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+a.mappingType)}"IndexToDirect"===a.referenceType&&(n=a.indices[n]);var i=n*a.dataSize,o=i+a.dataSize;return fe(me,a.buffer,i,o)}function P(e){if(void 0===i.NURBSCurve)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new i.BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new i.BufferGeometry;for(var r=t-1,a=e.KnotVector.a,n=[],o=e.Points.a,s=0,l=o.length;s<l;s+=4)n.push((new i.Vector4).fromArray(o,s));var u,c;if("Closed"===e.Form)n.push(n[0]);else if("Periodic"===e.Form){u=r,c=a.length-1-u;for(var s=0;s<r;++s)n.push(n[s])}var d=new i.NURBSCurve(r,a,n,u,c),f=d.getPoints(7*n.length),h=new Float32Array(3*f.length);f.forEach(function(e,t){e.toArray(h,3*t)});var p=new i.BufferGeometry;return p.addAttribute("position",new i.BufferAttribute(h,3)),p}function L(e,t,r,a,n){var o=new i.Group,s=C(e,r,a,n,t),l=e.Objects.Model;return s.forEach(function(r){var a=l[r.ID];k(e,r,a,t,o),t.get(r.ID).parents.forEach(function(e){var t=s.get(e.ID);void 0!==t&&t.add(r)}),null===r.parent&&o.add(r)}),j(e,r,a,s,t),W(e,t,o),R(e,o),o}function C(e,t,r,a,n){var o=new Map,s=e.Objects.Model;for(var l in s){var u=parseInt(l),c=s[l],d=n.get(u),f=N(d,t,u,c.attrName);if(!f){switch(c.attrType){case"Camera":f=O(e,d);break;case"Light":f=I(e,d);break;case"Mesh":f=U(e,d,r,a);break;case"NurbsCurve":f=D(d,r);break;case"LimbNode":case"Null":default:f=new i.Group}f.name=i.PropertyBinding.sanitizeNodeName(c.attrName),f.ID=u}B(e,f,c),o.set(u,f)}return o}function N(e,t,r,a){var n=null;return e.parents.forEach(function(e){for(var o in t){var s=t[o];s.rawBones.forEach(function(t,o){if(t.ID===e.ID){var l=n;n=new i.Bone,n.matrixWorld.copy(t.transformLink),n.name=i.PropertyBinding.sanitizeNodeName(a),n.ID=r,s.bones[o]=n,null!==l&&n.add(l)}})}}),n}function O(e,t){var r,a;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(a=r)}),void 0===a)r=new i.Object3D;else{var n=0;void 0!==a.CameraProjectionType&&1===a.CameraProjectionType.value&&(n=1);var o=1;void 0!==a.NearPlane&&(o=a.NearPlane.value/1e3);var s=1e3;void 0!==a.FarPlane&&(s=a.FarPlane.value/1e3);var l=window.innerWidth,u=window.innerHeight;void 0!==a.AspectWidth&&void 0!==a.AspectHeight&&(l=a.AspectWidth.value,u=a.AspectHeight.value);var c=l/u,d=45;void 0!==a.FieldOfView&&(d=a.FieldOfView.value);var f=a.FocalLength?a.FocalLength.value:null;switch(n){case 0:r=new i.PerspectiveCamera(d,c,o,s),null!==f&&r.setFocalLength(f);break;case 1:r=new i.OrthographicCamera(-l/2,l/2,u/2,-u/2,o,s);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+n+"."),r=new i.Object3D}}return r}function I(e,t){var r,a;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(a=r)}),void 0===a)r=new i.Object3D;else{var n;n=void 0===a.LightType?0:a.LightType.value;var o=16777215;void 0!==a.Color&&(o=(new i.Color).fromArray(a.Color.value));var s=void 0===a.Intensity?1:a.Intensity.value/100;void 0!==a.CastLightOnObject&&0===a.CastLightOnObject.value&&(s=0);var l=0;void 0!==a.FarAttenuationEnd&&(l=void 0!==a.EnableFarAttenuation&&0===a.EnableFarAttenuation.value?0:a.FarAttenuationEnd.value);switch(n){case 0:r=new i.PointLight(o,s,l,1);break;case 1:r=new i.DirectionalLight(o,s);break;case 2:var u=Math.PI/3;void 0!==a.InnerAngle&&(u=i.Math.degToRad(a.InnerAngle.value));var c=0;void 0!==a.OuterAngle&&(c=i.Math.degToRad(a.OuterAngle.value),c=Math.max(c,1)),r=new i.SpotLight(o,s,l,u,c,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+a.LightType.value+", defaulting to a THREE.PointLight."),r=new i.PointLight(o,s)}void 0!==a.CastShadows&&1===a.CastShadows.value&&(r.castShadow=!0)}return r}function U(e,t,r,a){var n,o=null,s=null,l=[];return t.children.forEach(function(e){r.has(e.ID)&&(o=r.get(e.ID)),a.has(e.ID)&&l.push(a.get(e.ID))}),l.length>1?s=l:l.length>0?s=l[0]:(s=new i.MeshPhongMaterial({color:13421772}),l.push(s)),"color"in o.attributes&&l.forEach(function(e){e.vertexColors=i.VertexColors}),o.FBX_Deformer?(l.forEach(function(e){e.skinning=!0}),n=new i.SkinnedMesh(o,s)):n=new i.Mesh(o,s),n}function D(e,t){var r=e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),a=new i.LineBasicMaterial({color:3342591,linewidth:1});return new i.Line(r,a)}function R(e,t){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var r=e.GlobalSettings.AmbientColor.value,a=r[0],n=r[1],o=r[2];if(0!==a||0!==n||0!==o){var s=new i.Color(a,n,o);t.add(new i.AmbientLight(s,1))}}}function k(e,t,r,a,n){if("LookAtProperty"in r){a.get(t.ID).children.forEach(function(r){if("LookAtProperty"===r.relationship){var a=e.Objects.Model[r.ID];if("Lcl_Translation"in a){var o=a.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(o),n.add(t.target)):t.lookAt((new i.Vector3).fromArray(o))}}})}}function B(e,t,r){if("RotationOrder"in r){var a=["XYZ","XZY","YZX","ZXY","YXZ","ZYX","SphericXYZ"],n=parseInt(r.RotationOrder.value,10);n>0&&n<6?console.warn("THREE.FBXLoader: unsupported Euler Order: %s. Currently only XYZ order is supported. Animations and rotations may be incorrect.",a[n]):6===n&&console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.")}if("Lcl_Translation"in r&&t.position.fromArray(r.Lcl_Translation.value),"Lcl_Rotation"in r){var o=r.Lcl_Rotation.value.map(i.Math.degToRad);o.push("ZYX"),t.quaternion.setFromEuler((new i.Euler).fromArray(o))}if("Lcl_Scaling"in r&&t.scale.fromArray(r.Lcl_Scaling.value),"PreRotation"in r){var s=r.PreRotation.value.map(i.Math.degToRad);s[3]="ZYX";var l=(new i.Euler).fromArray(s);l=(new i.Quaternion).setFromEuler(l),t.quaternion.premultiply(l)}}function j(e,t,r,a,n){var o=V(e);for(var s in t){var l=t[s];n.get(parseInt(l.ID)).parents.forEach(function(e){if(r.has(e.ID)){var t=e.ID;n.get(t).parents.forEach(function(e){if(a.has(e.ID)){a.get(e.ID).bind(new i.Skeleton(l.bones),o[e.ID])}})}})}}function V(e){var t={};if("Pose"in e.Objects){var r=e.Objects.Pose;for(var a in r)if("BindPose"===r[a].attrType){var n=r[a].PoseNode;Array.isArray(n)?n.forEach(function(e){t[e.Node]=(new i.Matrix4).fromArray(e.Matrix.a)}):t[n.Node]=(new i.Matrix4).fromArray(n.Matrix.a)}}return t}function G(e,t){if(void 0!==e.Objects.AnimationCurve){var r=z(e);H(e,t,r);return Y(e,t,X(e,t,r))}}function z(e){var t=e.Objects.AnimationCurveNode,r=new Map;for(var a in t){var n=t[a];if(null!==n.attrName.match(/S|R|T/)){var i={id:n.id,attr:n.attrName,curves:{}};r.set(i.id,i)}}return r}function H(e,t,r){var a=e.Objects.AnimationCurve;for(var n in a){var i={id:a[n].id,times:a[n].KeyTime.a.map(le),values:a[n].KeyValueFloat.a},o=t.get(i.id);if(void 0!==o){var s=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?r.get(s).curves.x=i:l.match(/Y/)?r.get(s).curves.y=i:l.match(/Z/)&&(r.get(s).curves.z=i)}}}function X(e,t,r){var a=e.Objects.AnimationLayer,n=new Map;for(var o in a){var s=[],l=t.get(parseInt(o));if(void 0!==l){l.children.forEach(function(a,n){if(r.has(a.ID)){var o=r.get(a.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===s[n]){var l;t.get(a.ID).parents.forEach(function(e){void 0!==e.relationship&&(l=e.ID)});var u=e.Objects.Model[l.toString()],c={modelName:i.PropertyBinding.sanitizeNodeName(u.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};"Lcl_Translation"in u&&(c.initialPosition=u.Lcl_Translation.value),"Lcl_Rotation"in u&&(c.initialRotation=u.Lcl_Rotation.value),"Lcl_Scaling"in u&&(c.initialScale=u.Lcl_Scaling.value),"PreRotation"in u&&(c.preRotations=u.PreRotation.value),s[n]=c}s[n][o.attr]=o}}}),n.set(parseInt(o),s)}}return n}function Y(e,t,r){var a=e.Objects.AnimationStack,n={};for(var i in a){var o=t.get(parseInt(i)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=r.get(o[0].ID);n[i]={name:a[i].attrName,layer:s}}return n}function W(e,t,r){r.animations=[];var a=G(e,t);if(void 0!==a)for(var n in a){var i=a[n],o=Q(i);r.animations.push(o)}}function Q(e){var t=[];return e.layer.forEach(function(e){t=t.concat(q(e))}),new i.AnimationClip(e.name,-1,t)}function q(e){var t=[];if(void 0!==e.T&&Object.keys(e.T.curves).length>0){var r=K(e.modelName,e.T.curves,e.initialPosition,"position");void 0!==r&&t.push(r)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var a=Z(e.modelName,e.R.curves,e.initialRotation,e.preRotations);void 0!==a&&t.push(a)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var n=K(e.modelName,e.S.curves,e.initialScale,"scale");void 0!==n&&t.push(n)}return t}function K(e,t,r,a){var n=$(t),o=J(n,t,r);return new i.VectorKeyframeTrack(e+"."+a,n,o)}function Z(e,t,r,a){void 0!==t.x&&(ee(t.x),t.x.values=t.x.values.map(i.Math.degToRad)),void 0!==t.y&&(ee(t.y),t.y.values=t.y.values.map(i.Math.degToRad)),void 0!==t.z&&(ee(t.z),t.z.values=t.z.values.map(i.Math.degToRad));var n=$(t),o=J(n,t,r);void 0!==a&&(a=a.map(i.Math.degToRad),a.push("ZYX"),a=(new i.Euler).fromArray(a),a=(new i.Quaternion).setFromEuler(a));for(var s=new i.Quaternion,l=new i.Euler,u=[],c=0;c<o.length;c+=3)l.set(o[c],o[c+1],o[c+2],"ZYX"),s.setFromEuler(l),void 0!==a&&s.premultiply(a),s.toArray(u,c/3*4);return new i.QuaternionKeyframeTrack(e+".quaternion",n,u)}function J(e,t,r){var a=r,n=[],i=-1,o=-1,s=-1;return e.forEach(function(e){if(t.x&&(i=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==i){var r=t.x.values[i];n.push(r),a[0]=r}else n.push(a[0]);if(-1!==o){var l=t.y.values[o];n.push(l),a[1]=l}else n.push(a[1]);if(-1!==s){var u=t.z.values[s];n.push(u),a[2]=u}else n.push(a[2])}),n}function $(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,r){return r.indexOf(e)==t})}function ee(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],a=e.values[t]-r,n=Math.abs(a);if(n>=180){for(var i=n/180,o=a/i,s=r+o,l=e.times[t-1],u=e.times[t]-l,c=u/i,d=l+c,f=[],h=[];d<e.times[t];)f.push(d),d+=c,h.push(s),s+=o;e.times=he(e.times,t,f),e.values=he(e.values,t,h)}}}function te(){}function re(){}function ae(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function ne(){}function ie(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===ce(e,0,t.length)}function oe(e){for(var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0,a=0;a<t.length;++a){if(function(t){var a=e[t-1];return e=e.slice(r+t),r++,a}(1)===t[a])return!1}return!0}function se(e){var t=/FBXVersion: (\d+)/,r=e.match(t);if(r){return parseInt(r[1])}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function le(e){return e/46186158e3}function ue(e){return e.split(",").map(function(e){return parseFloat(e)})}function ce(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),i.LoaderUtils.decodeText(new Uint8Array(e,t,r))}function de(e,t){for(var r=0,a=e.length,n=t.length;r<n;r++,a++)e[a]=t[r]}function fe(e,t,r,a){for(var n=r,i=0;n<a;n++,i++)e[i]=t[n];return e}function he(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}var pe=function(e){this.manager=void 0!==e?e:i.DefaultLoadingManager};Object.assign(pe.prototype,{load:function(e,t,r,a){var n=this,o=i.LoaderUtils.extractUrlBase(e),s=new i.FileLoader(this.manager);s.setResponseType("arraybuffer"),s.load(e,function(r){try{var i=n.parse(r,o);t(i)}catch(t){window.setTimeout(function(){a&&a(t),n.manager.itemError(e)},0)}},r,a)},parse:function(r,a){var o;if(ie(r))o=(new re).parse(r);else{var s=ce(r);if(!oe(s))throw new Error("THREE.FBXLoader: Unknown format.");if(se(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+se(s));o=(new te).parse(s)}var u=e(o),c=t(o),d=n(o,new i.TextureLoader(this.manager).setPath(a),c,u),h=l(o,d,u),p=f(o,u),v=m(o,u,p);return L(o,u,p.skeletons,v,h)}});var me=[];return Object.assign(te.prototype,{getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new ne,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split("\n");return r.forEach(function(e,a){var n=e.match(/^[\s\t]*;/),i=e.match(/^[\s\t]*$/);if(!n&&!i){var o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,r[++a]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),a=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),n={name:r},i=this.parseNodeAttr(a),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,n):r in o?("PoseNode"===r?o.PoseNode.push(n):void 0!==o[r].id&&(o[r]={},o[r][o[r].id]=o[r]),""!==i.id&&(o[r][i.id]=n)):"number"==typeof i.id?(o[r]={},o[r][i.id]=n):"Properties70"!==r&&(o[r]="PoseNode"===r?[n]:n),"number"==typeof i.id&&(n.id=i.id),""!==i.name&&(n.attrName=i.name),""!==i.type&&(n.attrType=i.type),this.pushStack(n)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",a="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),a=e[2]),{id:t,name:r,type:a}},parseNodeProperty:function(e,t,r){var a=t[1].replace(/^"/,"").replace(/"$/,"").trim(),n=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===a&&","===n&&(n=r.replace(/"/g,"").replace(/,$/,"").trim());var i=this.getCurrentNode();if("Properties70"===i.name)return void this.parseNodeSpecialProperty(e,a,n);if("C"===a){var o=n.split(",").slice(1),s=parseInt(o[0]),l=parseInt(o[1]),u=n.split(",").slice(3);u=u.map(function(e){return e.trim().replace(/^"/,"")}),a="connections",n=[s,l],de(n,u),void 0===i[a]&&(i[a]=[])}"Node"===a&&(i.id=n),a in i&&Array.isArray(i[a])?i[a].push(n):"a"!==a?i[a]=n:i.a=n,this.setCurrentProp(i,a),"a"===a&&","!==n.slice(-1)&&(i.a=ue(n))},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=ue(t.a))},parseNodeSpecialProperty:function(e,t,r){var a=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),n=a[0],i=a[1],o=a[2],s=a[3],l=a[4];switch(i){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=ue(l)}this.getPrevNode()[n]={type:i,type2:o,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),n)}}),Object.assign(re.prototype,{parse:function(e){var t=new ae(e);t.skip(23);var r=t.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+r);for(var a=new ne;!this.endOfContent(t);){var n=this.parseNode(t,r);null!==n&&a.add(n.name,n)}return a},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},a=t>=7500?e.getUint64():e.getUint32(),n=t>=7500?e.getUint64():e.getUint32(),i=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),o=e.getString(i);if(0===a)return null;for(var s=[],l=0;l<n;l++)s.push(this.parseProperty(e));var u=s.length>0?s[0]:"",c=s.length>1?s[1]:"",d=s.length>2?s[2]:"";for(r.singleProperty=1===n&&e.getOffset()===a;a>e.getOffset();){var f=this.parseNode(e,t);null!==f&&this.parseSubNode(o,r,f)}return r.propertyList=s,"number"==typeof u&&(r.id=u),""!==c&&(r.attrName=c),""!==d&&(r.attrType=d),""!==o&&(r.name=o),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var a=r.propertyList[0];Array.isArray(a)?(t[r.name]=r,r.a=a):t[r.name]=a}else if("Connections"===e&&"C"===r.name){var n=[];r.propertyList.forEach(function(e,t){0!==t&&n.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(n)}else if("Properties70"===r.name){var i=Object.keys(r);i.forEach(function(e){t[e]=r[e]})}else if("Properties70"===e&&"P"===r.name){var o,s=r.propertyList[0],l=r.propertyList[1],u=r.propertyList[2],c=r.propertyList[3];0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),0===l.indexOf("Lcl ")&&(l=l.replace("Lcl ","Lcl_")),o="Color"===l||"ColorRGB"===l||"Vector"===l||"Vector3D"===l||0===l.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[s]={type:l,type2:u,flag:c,value:o}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":var r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var a=e.getUint32(),n=e.getUint32(),i=e.getUint32();if(0===n)switch(t){case"b":case"c":return e.getBooleanArray(a);case"d":return e.getFloat64Array(a);case"f":return e.getFloat32Array(a);case"i":return e.getInt32Array(a);case"l":return e.getInt64Array(a)}void 0===window.Zlib&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var o=new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(i))),s=new ae(o.decompress().buffer);switch(t){case"b":case"c":return s.getBooleanArray(a);case"d":return s.getFloat64Array(a);case"f":return s.getFloat32Array(a);case"i":return s.getInt32Array(a);case"l":return s.getInt64Array(a)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}),Object.assign(ae.prototype,{getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=new Uint8Array(e),r=0;r<e;r++)t[r]=this.getUint8();var a=t.indexOf(0);return a>=0&&(t=t.slice(0,a)),i.LoaderUtils.decodeText(t)}}),Object.assign(ne.prototype,{add:function(e,t){this[e]=t}}),pe}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.splitLayer=!1};i.prototype.load=function(e,t,r,a){var i=this;new n.FileLoader(i.manager).load(e,function(e){t(i.parse(e))},r,a)},i.prototype.parse=function(e){function t(e){l={vertex:[],pathVertex:[],z:e.z},s.push(l)}function r(e,t){return o.relative?t:t-e}function a(e,t){return o.relative?e+t:t}function i(e,t){var r=new n.BufferGeometry;r.addAttribute("position",new n.Float32BufferAttribute(e,3));var a=new n.LineSegments(r,t?c:u);a.name="layer"+f,g.add(a)}var o={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},s=[],l=void 0,u=new n.LineBasicMaterial({color:16711680});u.name="path";var c=new n.LineBasicMaterial({color:65280});c.name="extruded";for(var d=e.replace(/;.+/g,"").split("\n"),f=0;f<d.length;f++){var h=d[f].split(" "),p=h[0].toUpperCase(),m={};if(h.splice(1).forEach(function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));m[t]=r}}),"G0"===p||"G1"===p){var v={x:void 0!==m.x?a(o.x,m.x):o.x,y:void 0!==m.y?a(o.y,m.y):o.y,z:void 0!==m.z?a(o.z,m.z):o.z,e:void 0!==m.e?a(o.e,m.e):o.e,f:void 0!==m.f?a(o.f,m.f):o.f};r(o.e,v.e)>0&&(v.extruding=r(o.e,v.e)>0,void 0!=l&&v.z==l.z||t(v)),function(e,r){void 0===l&&t(e),v.extruding?(l.vertex.push(e.x,e.y,e.z),l.vertex.push(r.x,r.y,r.z)):(l.pathVertex.push(e.x,e.y,e.z),l.pathVertex.push(r.x,r.y,r.z))}(o,v),o=v}else if("G2"===p||"G3"===p)console.warn("THREE.GCodeLoader: Arc command not supported");else if("G90"===p)o.relative=!1;else if("G91"===p)o.relative=!0;else if("G92"===p){var v=o;v.x=void 0!==m.x?m.x:v.x,v.y=void 0!==m.y?m.y:v.y,v.z=void 0!==m.z?m.z:v.z,v.e=void 0!==m.e?m.e:v.e,o=v}else console.warn("THREE.GCodeLoader: Command not supported:"+p)}var g=new n.Group;if(g.name="gcode",this.splitLayer)for(var f=0;f<s.length;f++){var y=s[f];i(y.vertex,!0),i(y.pathVertex,!1)}else{for(var x=[],b=[],f=0;f<s.length;f++){var y=s[f];x=x.concat(y.vertex),b=b.concat(y.pathVertex)}i(x,!0),i(b,!1)}return g.quaternion.setFromEuler(new n.Euler(-Math.PI/2,0,0)),g},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.hdrLoader=new o.default};s.prototype.load=function(e,t,r,a,i){var o=function(e,t,r,a){var n=e[t+3],i=Math.pow(2,n-128)/255;r[a+0]=e[t+0]*i,r[a+1]=e[t+1]*i,r[a+2]=e[t+2]*i},s=function(){function e(e){t[0]=e;var a=r[0],n=a>>16&32768,i=a>>12&2047,o=a>>23&255;return o<103?n:o>142?(n|=31744,n|=(255==o?0:1)&&8388607&a):o<113?(i|=2048,n|=(i>>114-o)+(i>>113-o&1)):(n|=o-112<<10|i>>1,n+=1&i)}var t=new Float32Array(1),r=new Int32Array(t.buffer);return function(t,r,a,n){var i=t[r+3],o=Math.pow(2,i-128)/255;a[n+0]=e(t[r+0]*o),a[n+1]=e(t[r+1]*o),a[n+2]=e(t[r+2]*o)}}(),l=new n.CubeTexture;l.type=e,l.encoding=e===n.UnsignedByteType?n.RGBEEncoding:n.LinearEncoding,l.format=e===n.UnsignedByteType?n.RGBAFormat:n.RGBFormat,l.minFilter=l.encoding===n.RGBEEncoding?n.NearestFilter:n.LinearFilter,l.magFilter=l.encoding===n.RGBEEncoding?n.NearestFilter:n.LinearFilter,l.generateMipmaps=l.encoding!==n.RGBEEncoding,l.anisotropy=0;for(var u=this.hdrLoader,c=0,d=0;d<t.length;d++)!function(r,a,i,d){var f=new n.FileLoader(this.manager);f.setResponseType("arraybuffer"),f.load(t[r],function(t){c++;var i=u._parser(t);if(i){if(e===n.FloatType){for(var d=i.data.length/4*3,f=new Float32Array(d),h=0;h<d;h++)o(i.data,4*h,f,3*h);i.data=f}else if(e===n.HalfFloatType){for(var d=i.data.length/4*3,p=new Uint16Array(d),h=0;h<d;h++)s(i.data,4*h,p,3*h);i.data=p}if(void 0!==i.image)l[r].images=i.image;else if(void 0!==i.data){var m=new n.DataTexture(i.data,i.width,i.height);m.format=l.format,m.type=l.type,m.encoding=l.encoding,m.minFilter=l.minFilter,m.magFilter=l.magFilter,m.generateMipmaps=l.generateMipmaps,l.images[r]=m}6===c&&(l.needsUpdate=!0,a&&a(l))}},i,d)}(d,r,a,i);return l},t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){var t=new JSZip(e),r=t.file(/dae$/i);if(r.length){var a=r[0],i=(new n.ColladaLoader).parse(a.asText()),o=i.library.images;for(var s in o)!function(e){var r=decodeURI(e.init_from);r=r.replace("../","");var a=new RegExp(r+"$"),n=t.file(a);if(n.length){var i=n[0],o=new Blob([i.asArrayBuffer()],{type:"application/octet-binary"});e.build.src=URL.createObjectURL(o)}}(o[s]);return i}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new n.Group}}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function e(){this._parser=e.parse};i.prototype=Object.create(n.CompressedTextureLoader.prototype),i.prototype.constructor=i,i.parse=function(e,t){var r=new o(e,1);return{mipmaps:r.mipmaps(t),width:r.pixelWidth,height:r.pixelHeight,format:r.glInternalFormat,isCubemap:6===r.numberOfFaces,mipmapCount:r.numberOfMipmapLevels}};var o=function(){function e(t,r,a,n){this.arrayBuffer=t;var i=new Uint8Array(this.arrayBuffer,0,12);if(171!==i[0]||75!==i[1]||84!==i[2]||88!==i[3]||32!==i[4]||49!==i[5]||49!==i[6]||187!==i[7]||13!==i[8]||10!==i[9]||26!==i[10]||10!==i[11])return void console.error("texture missing KTX identifier");var o=new Int32Array(this.arrayBuffer,12,13),s=16909060===o[0];return this.glType=s?this.switchEndainness(o[1]):o[1],this.glTypeSize=s?this.switchEndainness(o[2]):o[2],this.glFormat=s?this.switchEndainness(o[3]):o[3],this.glInternalFormat=s?this.switchEndainness(o[4]):o[4],this.glBaseInternalFormat=s?this.switchEndainness(o[5]):o[5],this.pixelWidth=s?this.switchEndainness(o[6]):o[6],this.pixelHeight=s?this.switchEndainness(o[7]):o[7],this.pixelDepth=s?this.switchEndainness(o[8]):o[8],this.numberOfArrayElements=s?this.switchEndainness(o[9]):o[9],this.numberOfFaces=s?this.switchEndainness(o[10]):o[10],this.numberOfMipmapLevels=s?this.switchEndainness(o[11]):o[11],this.bytesOfKeyValueData=s?this.switchEndainness(o[12]):o[12],0!==this.glType?void console.warn("only compressed formats currently supported"):(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0===this.pixelHeight||0!==this.pixelDepth?void console.warn("only 2D textures currently supported"):0!==this.numberOfArrayElements?void console.warn("texture arrays not currently supported"):this.numberOfFaces!==r?void console.warn("number of faces expected"+r+", but found "+this.numberOfFaces):void(this.loadType=e.COMPRESSED_2D))}return e.prototype.switchEndainness=function(e){return(255&e)<<24|(65280&e)<<8|e>>8&65280|e>>24&255},e.prototype.mipmaps=function(t){for(var r=[],a=e.HEADER_LEN+this.bytesOfKeyValueData,n=this.pixelWidth,i=this.pixelHeight,o=t?this.numberOfMipmapLevels:1,s=0;s<o;s++){for(var l=new Int32Array(this.arrayBuffer,a,1)[0],u=0;u<this.numberOfFaces;u++){var c=new Uint8Array(this.arrayBuffer,a+4,l);r.push({data:c,width:n,height:i}),a+=l+4,a+=3-(l+3)%4}n=Math.max(1,.5*n),i=Math.max(1,.5*i)}return r},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}();t.default=i},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(){var e=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]];return function(t){console.time("MD2Loader");for(var r=new DataView(t),a={},i=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],o=0;o<i.length;o++)a[i[o]]=r.getInt32(4*o,!0);if(844121161!==a.ident||8!==a.version)return void console.error("Not a valid MD2 file");if(a.offset_end!==r.byteLength)return void console.error("Corrupted MD2 file");for(var s=new n.Geometry,l=[],u=a.offset_st,o=0,c=a.num_st;o<c;o++){var d=r.getInt16(u+0,!0),f=r.getInt16(u+2,!0);l.push(new n.Vector2(d/a.skinwidth,1-f/a.skinheight)),u+=4}for(var u=a.offset_tris,o=0,c=a.num_tris;o<c;o++){var h=r.getUint16(u+0,!0),p=r.getUint16(u+2,!0),m=r.getUint16(u+4,!0);s.faces.push(new n.Face3(h,p,m)),s.faceVertexUvs[0].push([l[r.getUint16(u+6,!0)],l[r.getUint16(u+8,!0)],l[r.getUint16(u+10,!0)]]),u+=12}for(var v=new n.Vector3,g=new n.Vector3,y=[],u=a.offset_frames,o=0,c=a.num_frames;o<c;o++){g.set(r.getFloat32(u+0,!0),r.getFloat32(u+4,!0),r.getFloat32(u+8,!0)),v.set(r.getFloat32(u+12,!0),r.getFloat32(u+16,!0),r.getFloat32(u+20,!0)),u+=24;for(var x=0;x<16;x++){var b=r.getUint8(u+x,!0);if(0===b)break;y[x]=b}var A={name:String.fromCharCode.apply(null,y),vertices:[],normals:[]};u+=16;for(var x=0;x<a.num_vertices;x++){var w=r.getUint8(u++,!0),M=r.getUint8(u++,!0),T=r.getUint8(u++,!0),S=e[r.getUint8(u++,!0)],F=new n.Vector3(w*g.x+v.x,T*g.z+v.z,M*g.y+v.y),E=new n.Vector3(S[0],S[2],S[1]);A.vertices.push(F),A.normals.push(E)}s.morphTargets.push(A)}s.vertices=s.morphTargets[0].vertices;for(var _=s.morphTargets[0],x=0,P=s.faces.length;x<P;x++){var L=s.faces[x];L.vertexNormals=[_.normals[L.a],_.normals[L.b],_.normals[L.c]]}for(var o=0,c=s.morphTargets.length;o<c;o++){for(var _=s.morphTargets[o],C=[],x=0,P=s.faces.length;x<P;x++){var L=s.faces[x];C.push({a:_.normals[L.a],b:_.normals[L.b],c:_.normals[L.c]})}s.morphNormals.push({vertexNormals:C})}return s.animations=n.AnimationClip.CreateClipsFromMorphTargetSequences(s.morphTargets,10),console.timeEnd("MD2Loader"),s}}()},t.default=i},function(e,t,r){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=a(n),o=r(4),s=a(o),l=function(e){i.Loader.call(this),this.manager=void 0!==e?e:i.DefaultLoadingManager,this.parser=new s.Parser,this.textureCrossOrigin=null};l.prototype=Object.create(i.Loader.prototype),l.prototype.constructor=l,l.prototype.defaultToonTextures=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="],l.prototype.setTextureCrossOrigin=function(e){this.textureCrossOrigin=e},l.prototype.load=function(e,t,r,a,n){var i=this;this.loadModel(e,function(e){i.loadVmds(t,function(t){i.pourVmdIntoModel(e,t),r(e)},a,n)},a,n)},l.prototype.loadModel=function(e,t,r,a){var n=this,o=i.LoaderUtils.extractUrlBase(e),s=this.extractExtension(e);this.loadFileAsBuffer(e,function(e){t(n.createModel(e,s,o,r,a))},r,a)},l.prototype.createModel=function(e,t,r,a,n){return this.createMesh(this.parseModel(e,t),r,a,n)},l.prototype.loadVmd=function(e,t,r,a){var n=this;this.loadFileAsBuffer(e,function(e){t(n.parseVmd(e))},r,a)},l.prototype.loadVmds=function(e,t,r,a){function n(){var s=e.shift();i.loadVmd(s,function(r){o.push(r),e.length>0?n():t(i.mergeVmds(o))},r,a)}var i=this,o=[];e=e.slice(),n()},l.prototype.loadAudio=function(e,t,r,a){var n=new i.AudioListener,o=new i.Audio(n);new i.AudioLoader(this.manager).load(e,function(e){o.setBuffer(e),t(o,n)},r,a)},l.prototype.loadVpd=function(e,t,r,a,n){var i=this;(n&&"unicode"===n.charcode?this.loadFileAsText:this.loadFileAsShiftJISText).bind(this)(e,function(e){t(i.parseVpd(e))},r,a)},l.prototype.parseModel=function(e,t){switch(t.toLowerCase()){case"pmd":return this.parsePmd(e);case"pmx":return this.parsePmx(e);default:throw"extension "+t+" is not supported."}},l.prototype.parsePmd=function(e){return this.parser.parsePmd(e,!0)},l.prototype.parsePmx=function(e){return this.parser.parsePmx(e,!0)},l.prototype.parseVmd=function(e){return this.parser.parseVmd(e,!0)},l.prototype.parseVpd=function(e){return this.parser.parseVpd(e,!0)},l.prototype.mergeVmds=function(e){return this.parser.mergeVmds(e)},l.prototype.pourVmdIntoModel=function(e,t,r){this.createAnimation(e,t,r)},l.prototype.pourVmdIntoCamera=function(e,t,r){var a=new l.DataCreationHelper;!function(){for(var n=a.createOrderedMotionArray(t.cameras),o=[],s=[],u=[],c=[],d=[],f=[],h=[],p=[],m=[],v=new i.Quaternion,g=new i.Euler,y=new i.Vector3,x=new i.Vector3,b=function(e,t){e.push(t.x),e.push(t.y),e.push(t.z)},A=function(e,t,r){e.push(t[4*r+0]/127),e.push(t[4*r+1]/127),e.push(t[4*r+2]/127),e.push(t[4*r+3]/127)},w=function(e,t,r,a,n){if(r.length>2){r=r.slice(),a=a.slice(),n=n.slice();for(var o=a.length/r.length,s=3===o?12:4,u=1,c=2,d=r.length;c<d;c++){for(var f=0;f<o;f++)if(a[u*o+f]!==a[(u-1)*o+f]||a[u*o+f]!==a[c*o+f]){u++;break}if(c>u){r[u]=r[c];for(var f=0;f<o;f++)a[u*o+f]=a[c*o+f];for(var f=0;f<s;f++)n[u*s+f]=n[c*s+f]}}r.length=u+1,a.length=(u+1)*o,n.length=(u+1)*s}var h=new i[t](e,r,a);return h.createInterpolant=function(e){return new l.CubicBezierInterpolation(this.times,this.values,this.getValueSize(),e,new Float32Array(n))},h},M=0;M<n.length;M++){var T=n[M],S=T.frameNum/30,F=T.position,E=T.rotation,_=T.distance,P=T.fov,L=T.interpolation;y.set(0,0,-_),x.set(F[0],F[1],F[2]),g.set(-E[0],-E[1],-E[2]),v.setFromEuler(g),y.add(x),y.applyQuaternion(v),o.push(S),b(s,x),function(e,t){e.push(t.x),e.push(t.y),e.push(t.z),e.push(t.w)}(u,v),b(c,y),d.push(P);for(var C=0;C<3;C++)A(f,L,C);A(h,L,3);for(var C=0;C<3;C++)A(p,L,4);A(m,L,5)}if(0!==o.length){var N=[];N.push(w(".center","VectorKeyframeTrack",o,s,f)),N.push(w(".quaternion","QuaternionKeyframeTrack",o,u,h)),N.push(w(".position","VectorKeyframeTrack",o,c,p)),N.push(w(".fov","NumberKeyframeTrack",o,d,m));var O=new i.AnimationClip(void 0===r?i.Math.generateUUID():r,-1,N);void 0===e.center&&(e.center=new i.Vector3(0,0,0)),void 0===e.animations&&(e.animations=[]),e.animations.push(O)}}()},l.prototype.extractExtension=function(e){var t=e.lastIndexOf(".");return t<0?null:e.slice(t+1)},l.prototype.loadFile=function(e,t,r,a,n,o){var s=new i.FileLoader(this.manager);return void 0!==o&&s.setMimeType(o),s.setResponseType(n),s.load(e,function(e){t(e)},r,a)},l.prototype.loadFileAsBuffer=function(e,t,r,a){this.loadFile(e,t,r,a,"arraybuffer")},l.prototype.loadFileAsText=function(e,t,r,a){this.loadFile(e,t,r,a,"text")},l.prototype.loadFileAsShiftJISText=function(e,t,r,a){this.loadFile(e,t,r,a,"text","text/plain; charset=shift_jis")},l.prototype.createMesh=function(e,t,r,a){var n=this,o=new i.BufferGeometry,s=[],l={};l.vertices=[],l.uvs=[],l.normals=[],l.skinIndices=[],l.skinWeights=[],l.indices=[];return function(){for(var t=0;t<e.metadata.vertexCount;t++){for(var r=e.vertices[t],a=0,n=r.position.length;a<n;a++)l.vertices.push(r.position[a]);for(var a=0,n=r.normal.length;a<n;a++)l.normals.push(r.normal[a]);for(var a=0,n=r.uv.length;a<n;a++)l.uvs.push(r.uv[a]);for(var a=0;a<4;a++)l.skinIndices.push(r.skinIndices.length-1>=a?r.skinIndices[a]:0);for(var a=0;a<4;a++)l.skinWeights.push(r.skinWeights.length-1>=a?r.skinWeights[a]:0)}}(),function(){for(var t=0;t<e.metadata.faceCount;t++)for(var r=e.faces[t],a=0,n=r.indices.length;a<n;a++)l.indices.push(r.indices[a])}(),function(){for(var t=[],r=e.rigidBodies,a={},n=0,i=r.length;n<i;n++){var s=r[n],l=a[s.boneIndex];l=void 0===l?s.type:Math.max(s.type,l),a[s.boneIndex]=l}for(var n=0;n<e.metadata.boneCount;n++){var u={},c=e.bones[n];u.parent=c.parentIndex,u.name=c.name,u.pos=[c.position[0],c.position[1],c.position[2]],u.rotq=[0,0,0,1],u.scl=[1,1,1],-1!==u.parent&&(u.pos[0]-=e.bones[u.parent].position[0],u.pos[1]-=e.bones[u.parent].position[1],u.pos[2]-=e.bones[u.parent].position[2]),u.rigidBodyType=void 0!==a[n]?a[n]:-1,t.push(u)}o.bones=t}(),function(){var t=[];if("pmd"===e.metadata.format)for(var r=0;r<e.metadata.ikCount;r++){var a=e.iks[r],n={};n.target=a.target,n.effector=a.effector,n.iteration=a.iteration,n.maxAngle=4*a.maxAngle,n.links=[];for(var s=0;s<a.links.length;s++){var l={};l.index=a.links[s].index,e.bones[l.index].name.indexOf("ひざ")>=0&&(l.limitation=new i.Vector3(1,0,0)),n.links.push(l)}t.push(n)}else for(var r=0;r<e.metadata.boneCount;r++){var u=e.bones[r],a=u.ik;if(void 0!==a){var n={};n.target=r,n.effector=a.effector,n.iteration=a.iteration,n.maxAngle=a.maxAngle,n.links=[];for(var s=0;s<a.links.length;s++){var l={};l.index=a.links[s].index,l.enabled=!0,1===a.links[s].angleLimitation&&(l.limitation=new i.Vector3(1,0,0)),n.links.push(l)}t.push(n)}}o.iks=t}(),function(){if("pmd"!==e.metadata.format){for(var t=[],r=0;r<e.metadata.boneCount;r++){var a=e.bones[r],n=a.grant;if(void 0!==n){var i={};i.index=r,i.parentIndex=n.parentIndex,i.ratio=n.ratio,i.isLocal=n.isLocal,i.affectRotation=n.affectRotation,i.affectPosition=n.affectPosition,i.transformationClass=a.transformationClass,t.push(i)}}t.sort(function(e,t){return e.transformationClass-t.transformationClass}),o.grants=t}}(),function(){function t(e,t,r,a){e.array[3*t+0]+=r.position[0]*a,e.array[3*t+1]+=r.position[1]*a,e.array[3*t+2]+=r.position[2]*a}function r(r,a,n){for(var i=0;i<a.elementCount;i++){var o,s=a.elements[i];o="pmd"===e.metadata.format?e.morphs[0].elements[s.index].index:s.index,t(r,o,s,n)}}for(var a=[],n=[],s=0;s<e.metadata.morphCount;s++){var u=e.morphs[s],c={name:u.name},d=new i.Float32BufferAttribute(3*e.metadata.vertexCount,3);d.name=u.name;for(var f=0;f<3*e.metadata.vertexCount;f++)d.array[f]=l.vertices[f];if("pmd"===e.metadata.format)0!==s&&r(d,u,1);else if(0===u.type)for(var f=0;f<u.elementCount;f++){var h=e.morphs[u.elements[f].index],p=u.elements[f].ratio;1===h.type&&r(d,h,p)}else 1===u.type?r(d,u,1):2===u.type||3===u.type||4===u.type||5===u.type||6===u.type||7===u.type||u.type;a.push(c),n.push(d)}o.morphTargets=a,o.morphAttributes.position=n}(),function(){function l(e,o){void 0===o&&(o={});var s;if(!0===o.defaultTexturePath)try{s=n.defaultToonTextures[parseInt(e.match("toon([0-9]{2}).bmp$")[1])]}catch(t){console.warn("THREE.MMDLoader: "+e+" seems like not right default texture path. Using toon00.bmp instead."),s=n.defaultToonTextures[0]}else s=t+e;if(void 0!==c[s])return s;var l=i.Loader.Handlers.get(s);null===l&&(l=e.indexOf(".tga")>=0?f:d);var u=l.load(s,function(e){if(!0===o.isToonTexture){var t=e.image,r=t.width,a=t.height;h.width=r,h.height=a,p.clearRect(0,0,r,a),p.translate(r/2,a/2),p.rotate(.5*Math.PI),p.translate(-r/2,-a/2),p.drawImage(t,0,0),e.image=p.getImageData(0,0,r,a)}e.flipY=!1,e.wrapS=i.RepeatWrapping,e.wrapT=i.RepeatWrapping;for(var n=0;n<u.readyCallbacks.length;n++)u.readyCallbacks[n](u);delete u.readyCallbacks},r,a);return!0===o.sphericalReflectionMapping&&(u.mapping=i.SphericalReflectionMapping),u.readyCallbacks=[],c[s]=u,s}function u(e,t){return void 0===t[e]&&console.warn("THREE.MMDLoader: Undefined texture",e),t[e]}var c={},d=new i.TextureLoader(n.manager),f=new i.TGALoader(n.manager),h=document.createElement("canvas"),p=h.getContext("2d"),m=0,v=[];null!==n.textureCrossOrigin&&d.setCrossOrigin(n.textureCrossOrigin);for(var g=0;g<e.metadata.materialCount;g++){var y=e.materials[g],x={};if(x.faceOffset=m,x.faceNum=y.faceCount,m+=y.faceCount,x.name=y.name,x.color=new i.Color(y.diffuse[0],y.diffuse[1],y.diffuse[2]),x.opacity=y.diffuse[3],x.specular=new i.Color(y.specular[0],y.specular[1],y.specular[2]),x.shininess=y.shininess,1===x.opacity?(x.side=i.FrontSide,x.transparent=!1):(x.side=i.DoubleSide,x.transparent=!0),"pmd"===e.metadata.format){if(y.fileName){var b=y.fileName,A=[],w=b.lastIndexOf("*");w>=0?(A.push(b.slice(0,w)),A.push(b.slice(w+1))):A.push(b);for(var M=0;M<A.length;M++){var T=A[M];T.indexOf(".sph")>=0||T.indexOf(".spa")>=0?(x.envMap=l(T,{sphericalReflectionMapping:!0}),T.indexOf(".sph")>=0?x.envMapType=i.MultiplyOperation:x.envMapType=i.AddOperation):x.map=l(T)}}}else{if(-1!==y.textureIndex){var T=e.textures[y.textureIndex];x.map=l(T)}if(-1!==y.envTextureIndex&&(1===y.envFlag||2==y.envFlag)){var T=e.textures[y.envTextureIndex];x.envMap=l(T,{sphericalReflectionMapping:!0}),1===y.envFlag?x.envMapType=i.MultiplyOperation:x.envMapType=i.AddOperation}}var S=void 0===x.map?1:.2;x.emissive=new i.Color(y.ambient[0]*S,y.ambient[1]*S,y.ambient[2]*S),v.push(x)}for(var g=0;g<v.length;g++){var F=v[g],E=e.materials[g],y=new i.MeshToonMaterial;if(o.addGroup(3*F.faceOffset,3*F.faceNum,g),void 0!==F.name&&(y.name=F.name),y.skinning=o.bones.length>0,y.morphTargets=o.morphTargets.length>0,y.lights=!0,y.side="pmx"===e.metadata.format&&1==(1&E.flag)?i.DoubleSide:F.side,y.transparent=F.transparent,y.fog=!0,y.blending=i.CustomBlending,y.blendSrc=i.SrcAlphaFactor,y.blendDst=i.OneMinusSrcAlphaFactor,y.blendSrcAlpha=i.SrcAlphaFactor,y.blendDstAlpha=i.DstAlphaFactor,void 0!==F.map){y.faceOffset=F.faceOffset,y.faceNum=F.faceNum,y.map=u(F.map,c),function(e){e.map.readyCallbacks.push(function(t){function r(e,t){var r=e.width,a=e.height,n=Math.round(t.x*r)%r,i=Math.round(t.y*a)%a;n<0&&(n+=r),i<0&&(i+=a);var o=i*r+n;return e.data[4*o+3]}var a=void 0!==t.image.data?t.image:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return r.drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)}(t.image),n=o.index.array.slice(3*e.faceOffset,3*e.faceOffset+3*e.faceNum);(function(e,t,a){var n=e.width,i=e.height,o=e.data;if(o.length/(n*i)!=4)return!1;for(var s=0;s<a.length;s+=3){for(var l={x:0,y:0},u=0;u<3;u++){var c=a[3*s+u],d={x:t[2*c+0],y:t[2*c+1]};if(r(e,d)<253)return!0;l.x+=d.x,l.y+=d.y}if(l.x/=3,l.y/=3,r(e,l)<253)return!0}return!1})(a,o.attributes.uv.array,n)&&(e.transparent=!0),delete e.faceOffset,delete e.faceNum})}(y)}if(void 0!==F.envMap&&(y.envMap=u(F.envMap,c),y.combine=F.envMapType),y.opacity=F.opacity,y.color=F.color,void 0!==F.emissive&&(y.emissive=F.emissive),y.specular=F.specular,y.shininess=Math.max(F.shininess,1e-4),"pmd"===e.metadata.format){y.outlineParameters={thickness:1===E.edgeFlag?.003:0,color:new i.Color(0,0,0),alpha:1},0===y.outlineParameters.thickness&&(y.outlineParameters.visible=!1);var _=-1===E.toonIndex?"toon00.bmp":e.toonTextures[E.toonIndex].fileName,P=l(_,{isToonTexture:!0,defaultTexturePath:function(e){return 10===e.length&&null!==e.match(/toon(10|0[0-9]).bmp/)}(_)});y.gradientMap=u(P,c)}else{y.outlineParameters={thickness:E.edgeSize/300,color:new i.Color(E.edgeColor[0],E.edgeColor[1],E.edgeColor[2]),alpha:E.edgeColor[3]},0!=(16&E.flag)&&0!==y.outlineParameters.thickness||(y.outlineParameters.visible=!1);var _,L;if(-1===E.toonIndex||0!==E.toonFlag){var C=E.toonIndex+1;_="toon"+(C<10?"0"+C:C)+".bmp",L=!0}else _=e.textures[E.toonIndex],L=!1;var P=l(_,{isToonTexture:!0,defaultTexturePath:L});y.gradientMap=u(P,c)}s.push(y)}if("pmx"===e.metadata.format)for(var N=function(e,t){if(8===e.type)for(var r=0;r<t.length;r++){var a=t[r];if(-1!==a.index){var n=s[a.index];n.opacity!==a.diffuse[3]&&(n.transparent=!0)}}},g=0;g<e.morphs.length;g++){var O=e.morphs[g],I=O.elements;if(0===O.type)for(var M=0;M<I.length;M++){var U=e.morphs[I[M].index],D=U.elements;N(U,D)}else N(O,I)}}(),function(){for(var t=[],r=[],a=0;a<e.metadata.rigidBodyCount;a++){for(var n=e.rigidBodies[a],i=Object.keys(n),s={},l=0;l<i.length;l++){var u=i[l];s[u]=n[u]}if("pmx"===e.metadata.format&&-1!==s.boneIndex){var c=e.bones[s.boneIndex];s.position[0]-=c.position[0],s.position[1]-=c.position[1],s.position[2]-=c.position[2]}t.push(s)}for(var a=0;a<e.metadata.constraintCount;a++){for(var d=e.constraints[a],i=Object.keys(d),s={},l=0;l<i.length;l++){var u=i[l];s[u]=d[u]}var f=t[s.rigidBodyIndex1],h=t[s.rigidBodyIndex2];0!==f.type&&2===h.type&&-1!==f.boneIndex&&-1!==h.boneIndex&&e.bones[h.boneIndex].parentIndex===f.boneIndex&&(h.type=1),r.push(s)}o.rigidBodies=t,o.constraints=r}(),function(){o.setIndex(l.indices),o.addAttribute("position",new i.Float32BufferAttribute(l.vertices,3)),o.addAttribute("normal",new i.Float32BufferAttribute(l.normals,3)),o.addAttribute("uv",new i.Float32BufferAttribute(l.uvs,2)),o.addAttribute("skinIndex",new i.Uint16BufferAttribute(l.skinIndices,4)),o.addAttribute("skinWeight",new i.Float32BufferAttribute(l.skinWeights,4)),o.computeBoundingSphere(),o.mmdFormat=e.metadata.format}(),new i.SkinnedMesh(o,s)},l.prototype.createAnimation=function(e,t,r){var a=new l.DataCreationHelper;!function(){if(0!==t.metadata.motionCount){for(var n=e.geometry.bones,o=a.createOrderedMotionArrays(n,t.motions,"boneName"),s=[],u=function(e,t,r){e.push(t[r+0]/127),e.push(t[r+8]/127),e.push(t[r+4]/127),e.push(t[r+12]/127)},c=function(e,t,r,a,n){var o=new i[t](e,r,a);return o.createInterpolant=function(e){return new l.CubicBezierInterpolation(this.times,this.values,this.getValueSize(),e,new Float32Array(n))},o},d=0;d<o.length;d++){for(var f=[],h=[],p=[],m=[],v=[],g=n[d],y=o[d],x=0;x<y.length;x++){var b=y[x].frameNum/30,A=y[x].position,w=y[x].rotation,M=y[x].interpolation;f.push(b);for(var T=0;T<3;T++)h.push(g.pos[T]+A[T]);for(var T=0;T<4;T++)p.push(w[T]);for(var T=0;T<3;T++)u(m,M,T);u(v,M,3)}if(0!==f.length){var S=".bones["+g.name+"]";s.push(c(S+".position","VectorKeyframeTrack",f,h,m)),s.push(c(S+".quaternion","QuaternionKeyframeTrack",f,p,v))}}var F=new i.AnimationClip(void 0===r?i.Math.generateUUID():r,-1,s);void 0===e.geometry.animations&&(e.geometry.animations=[]),e.geometry.animations.push(F)}}(),function(){if(0!==t.metadata.morphCount){for(var n=a.createOrderedMotionArrays(e.geometry.morphTargets,t.morphs,"morphName"),o=[],s=0;s<n.length;s++){for(var l=[],u=[],c=n[s],d=0;d<c.length;d++)l.push(c[d].frameNum/30),u.push(c[d].weight);0!==l.length&&o.push(new i.NumberKeyframeTrack(".morphTargetInfluences["+s+"]",l,u))}var f=new i.AnimationClip(void 0===r?i.Math.generateUUID():r+"Morph",-1,o);void 0===e.geometry.animations&&(e.geometry.animations=[]),e.geometry.animations.push(f)}}()},l.DataCreationHelper=function(){},l.DataCreationHelper.prototype={constructor:l.DataCreationHelper,toCharcodeStrings:function(e){for(var t="",r=0;r<e.length;r++)t+="0x"+("0000"+e[r].charCodeAt().toString(16)).substr(-4);return t},createDictionary:function(e){for(var t={},r=0;r<e.length;r++)t[e[r].name]=r;return t},initializeMotionArrays:function(e){for(var t=[],r=0;r<e.length;r++)t[r]=[];return t},sortMotionArray:function(e){e.sort(function(e,t){return e.frameNum-t.frameNum})},sortMotionArrays:function(e){for(var t=0;t<e.length;t++)this.sortMotionArray(e[t])},createMotionArray:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},createMotionArrays:function(e,t,r,a){for(var n=0;n<e.length;n++){var i=e[n],o=r[i[a]];void 0!==o&&t[o].push(i)}},createOrderedMotionArray:function(e){var t=this.createMotionArray(e);return this.sortMotionArray(t),t},createOrderedMotionArrays:function(e,t,r){var a=this.createDictionary(e),n=this.initializeMotionArrays(e);return this.createMotionArrays(t,n,a,r),this.sortMotionArrays(n),n}},l.CubicBezierInterpolation=function(e,t,r,a,n){i.Interpolant.call(this,e,t,r,a),this.params=n},l.CubicBezierInterpolation.prototype=Object.create(i.LinearInterpolant.prototype),l.CubicBezierInterpolation.prototype.constructor=l.CubicBezierInterpolation,l.CubicBezierInterpolation.prototype.interpolate_=function(e,t,r,a){var n=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s,u=l-s,c=a-t<.05?0:(r-t)/(a-t);if(4===s){var d=this.params[4*e+0],f=this.params[4*e+1],h=this.params[4*e+2],p=this.params[4*e+3],m=this._calculate(d,f,h,p,c);i.Quaternion.slerpFlat(n,0,o,u,o,l,m)}else if(3===s)for(var v=0;v!==s;++v){var d=this.params[12*e+4*v+0],f=this.params[12*e+4*v+1],h=this.params[12*e+4*v+2],p=this.params[12*e+4*v+3],m=this._calculate(d,f,h,p,c);n[v]=o[u+v]*(1-m)+o[l+v]*m}else{var d=this.params[4*e+0],f=this.params[4*e+1],h=this.params[4*e+2],p=this.params[4*e+3],m=this._calculate(d,f,h,p,c);n[0]=o[u]*(1-m)+o[l]*m}return n},l.CubicBezierInterpolation.prototype._calculate=function(e,t,r,a,n){for(var i,o,s,l=.5,u=l,c=1-u,d=Math,f=0;f<15;f++){i=3*c*c*u,o=3*c*u*u,s=u*u*u;var h=i*e+o*t+s-n;if(d.abs(h)<1e-5)break;l/=2,u+=h<0?l:-l,c=1-u}return i*r+o*a+s},i.MMDAudioManager=function(e,t,r){var a=null===r||void 0===r?{}:r;this.audio=e,this.listener=t,this.elapsedTime=0,this.currentTime=0,this.delayTime=void 0!==a.delayTime?a.delayTime:0,this.audioDuration=this.audio.buffer.duration,this.duration=this.audioDuration+this.delayTime},i.MMDAudioManager.prototype={constructor:i.MMDAudioManager,control:function(e){this.elapsed+=e,this.currentTime+=e,this.checkIfStopAudio()&&this.audio.stop(),this.checkIfStartAudio()&&this.audio.play()},checkIfStartAudio:function(){if(this.audio.isPlaying)return!1;for(;this.currentTime>=this.duration;)this.currentTime-=this.duration;return!(this.currentTime<this.delayTime)&&(this.audio.startTime=this.currentTime-this.delayTime,!0)},checkIfStopAudio:function(){return!!this.audio.isPlaying&&this.currentTime>=this.duration}},i.MMDGrantSolver=function(e){this.mesh=e},i.MMDGrantSolver.prototype={constructor:i.MMDGrantSolver,update:function(){var e=new i.Quaternion;return function(){for(var t=0;t<this.mesh.geometry.grants.length;t++){var r=this.mesh.geometry.grants[t],a=this.mesh.skeleton.bones[r.index],n=this.mesh.skeleton.bones[r.parentIndex];r.isLocal?(r.affectPosition,r.affectRotation):(r.affectPosition,r.affectRotation&&(e.set(0,0,0,1),e.slerp(n.quaternion,r.ratio),a.quaternion.multiply(e)))}}}()},i.MMDHelper=function(){this.meshes=[],this.doAnimation=!0,this.doIk=!0,this.doGrant=!0,this.doPhysics=!0,this.doCameraAnimation=!0,this.sharedPhysics=!1,this.masterPhysics=null,this.audioManager=null,this.camera=null},i.MMDHelper.prototype={constructor:i.MMDHelper,add:function(e){if(!(e instanceof i.SkinnedMesh))throw new Error("THREE.MMDHelper.add() accepts only THREE.SkinnedMesh instance.");void 0===e.mixer&&(e.mixer=null),void 0===e.ikSolver&&(e.ikSolver=null),void 0===e.grantSolver&&(e.grantSolver=null),void 0===e.physics&&(e.physics=null),void 0===e.looped&&(e.looped=!1),this.meshes.push(e),this.initBackupBones(e)},setAudio:function(e,t,r){this.audioManager=new i.MMDAudioManager(e,t,r)},setCamera:function(e){e.mixer=null,this.camera=e},setPhysicses:function(e){for(var t=0;t<this.meshes.length;t++)this.setPhysics(this.meshes[t],e)},setPhysics:function(e,t){if(t=void 0===t?{}:Object.assign({},t),void 0===t.world&&this.sharedPhysics){var r=this.getMasterPhysics();null!==r&&(t.world=r.world)}var a=void 0!==t.warmup?t.warmup:60,n=new i.MMDPhysics(e,t);null!==e.mixer&&void 0!==e.mixer&&!0!==t.preventAnimationWarmup&&(this.animateOneMesh(0,e),n.reset()),n.warmup(a),this.updateIKParametersDependingOnPhysicsEnabled(e,!0),e.physics=n},getMasterPhysics:function(){if(null!==this.masterPhysics)return this.masterPhysics;for(var e=0,t=this.meshes.length;e<t;e++){var r=this.meshes[e].physics;if(void 0!==r&&null!==r)return this.masterPhysics=r,this.masterPhysics}return null},enablePhysics:function(e){this.doPhysics=!0===e;for(var t=0,r=this.meshes.length;t<r;t++)this.updateIKParametersDependingOnPhysicsEnabled(this.meshes[t],e)},updateIKParametersDependingOnPhysicsEnabled:function(e,t){for(var r=e.geometry.iks,a=e.geometry.bones,n=0,i=r.length;n<i;n++)for(var o=r[n],s=o.links,l=0,u=s.length;l<u;l++){var c=s[l];c.enabled=!0!==t||!(a[c.index].rigidBodyType>0)}},setAnimations:function(){for(var e=0;e<this.meshes.length;e++)this.setAnimation(this.meshes[e])},setAnimation:function(e){if(void 0!==e.geometry.animations){e.mixer=new i.AnimationMixer(e),e.mixer.addEventListener("loop",function(e){if(!(e.action._clip.tracks.length>0&&0!==e.action._clip.tracks[0].name.indexOf(".bones"))){e.target._root.looped=!0}});for(var t=!1,r=!1,a=0;a<e.geometry.animations.length;a++){var n=e.geometry.animations[a],o=e.mixer.clipAction(n);n.tracks.length>0&&0===n.tracks[0].name.indexOf(".morphTargetInfluences")?r||(o.play(),r=!0):t||(o.play(),t=!0)}t&&(e.ikSolver=new i.CCDIKSolver(e),void 0!==e.geometry.grants&&(e.grantSolver=new i.MMDGrantSolver(e)))}},setCameraAnimation:function(e){void 0!==e.animations&&(e.mixer=new i.AnimationMixer(e),e.mixer.clipAction(e.animations[0]).play())},unifyAnimationDuration:function(e){e=void 0===e?{}:e;for(var t=0,r=this.camera,a=this.audioManager,n=0;n<this.meshes.length;n++){var i=this.meshes[n],o=i.mixer;if(null!==o)for(var s=0;s<o._actions.length;s++){var l=o._actions[s];t=Math.max(t,l._clip.duration)}}if(null!==r&&null!==r.mixer)for(var o=r.mixer,n=0;n<o._actions.length;n++){var l=o._actions[n];t=Math.max(t,l._clip.duration)}null!==a&&(t=Math.max(t,a.duration)),void 0!==e.afterglow&&(t+=e.afterglow);for(var n=0;n<this.meshes.length;n++){var i=this.meshes[n],o=i.mixer;if(null!==o)for(var s=0;s<o._actions.length;s++){var l=o._actions[s];l._clip.duration=t}}if(null!==r&&null!==r.mixer)for(var o=r.mixer,n=0;n<o._actions.length;n++){var l=o._actions[n];l._clip.duration=t}null!==a&&(a.duration=t)},controlAudio:function(e){null!==this.audioManager&&this.audioManager.control(e)},animate:function(e){this.controlAudio(e);for(var t=0;t<this.meshes.length;t++)this.animateOneMesh(e,this.meshes[t]);this.sharedPhysics&&this.updateSharedPhysics(e),this.animateCamera(e)},animateOneMesh:function(e,t){var r=t.mixer,a=t.ikSolver,n=t.grantSolver,i=t.physics;null!==r&&!0===this.doAnimation&&(this.restoreBones(t),r.update(e),this.backupBones(t)),null!==a&&!0===this.doIk&&a.update(),null!==n&&!0===this.doGrant&&n.update(),!0===t.looped&&(null!==i&&i.reset(),t.looped=!1),null!==i&&this.doPhysics&&!this.sharedPhysics&&i.update(e)},updateSharedPhysics:function(e){if(0!==this.meshes.length&&this.doPhysics&&this.sharedPhysics){var t=this.getMasterPhysics();if(null!==t){for(var r=0,a=this.meshes.length;r<a;r++){var n=this.meshes[r].physics;null!==n&&void 0!==n&&n.updateRigidBodies()}t.stepSimulation(e);for(var r=0,a=this.meshes.length;r<a;r++){var n=this.meshes[r].physics;null!==n&&void 0!==n&&n.updateBones()}}}},animateCamera:function(e){if(null!==this.camera){var t=this.camera.mixer;null!==t&&void 0!==this.camera.center&&!0===this.doCameraAnimation&&(t.update(e),this.camera.updateProjectionMatrix(),this.camera.up.set(0,1,0),this.camera.up.applyQuaternion(this.camera.quaternion),this.camera.lookAt(this.camera.center))}},poseAsVpd:function(e,t,r){void 0===r&&(r={}),!0!==r.preventResetPose&&e.pose();for(var a=e.skeleton.bones,n=t.bones,o={},s=0;s<a.length;s++)o[a[s].name]=s;for(var l=new i.Vector3,u=new i.Quaternion,s=0;s<n.length;s++){var c=n[s],d=o[c.name];if(void 0!==d){var f=a[d],h=c.translation,p=c.quaternion;l.set(h[0],h[1],h[2]),u.set(p[0],p[1],p[2],p[3]),f.position.add(l),f.quaternion.multiply(u)}}if(e.updateMatrixWorld(!0),!0!==r.preventIk){var m=new i.CCDIKSolver(e);m.update(r.saveOriginalBonesBeforeIK)}if(!0!==r.preventGrant&&void 0!==e.geometry.grants){var m=new i.MMDGrantSolver(e);m.update()}},initBackupBones:function(e){e.skeleton.backupBones=[];for(var t=0;t<e.skeleton.bones.length;t++)e.skeleton.backupBones.push(e.skeleton.bones[t].clone())},backupBones:function(e){e.skeleton.backupBoneIsSaved=!0;for(var t=0;t<e.skeleton.bones.length;t++){var r=e.skeleton.backupBones[t],a=e.skeleton.bones[t];r.position.copy(a.position),r.quaternion.copy(a.quaternion)}},restoreBones:function(e){if(!0===e.skeleton.backupBoneIsSaved){e.skeleton.backupBoneIsSaved=!1;for(var t=0;t<e.skeleton.bones.length;t++){var r=e.skeleton.bones[t],a=e.skeleton.backupBones[t];r.position.copy(a.position),r.quaternion.copy(a.quaternion)}}}},t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=("function"==typeof Symbol&&Symbol.iterator,r(0)),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.nodes={},this.materials={},this.passes={},this.names={},this.library=t||{}};Object.assign(i.prototype,{load:function(e,t,r,a){var i=this;return new n.FileLoader(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,a),this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.names[e]},getNode:function(e){var t=this.getObjectById(e);return t||console.warn('Node "'+e+'" not found.'),t},parse:function(e){var t,r,a,i,o;for(t in e.nodes)r=e.nodes[t],a=new n[r.type],r.name?(a.name=r.name,this.names[a.name]=a):a.readonly=!0,void 0!==r.readonly&&(a.readonly=r.readonly),this.nodes[t]=a;for(t in e.materials)r=e.materials[t],a=new n[r.type],r.name&&(a.name=r.name,this.names[a.name]=a),this.materials[t]=a;for(t in e.passes)r=e.passes[t],a=new n[r.type],r.name&&(a.name=r.name,this.names[a.name]=a),this.passes[t]=a;e.material&&(this.material=this.materials[t]),e.pass&&(this.pass=this.passes[t]);for(t in e.nodes)switch(r=e.nodes[t],a=this.nodes[t],r.type){case"FloatNode":a.number=r.number;break;case"ColorNode":a.value.copy(r);break;case"Vector2Node":a.x=r.x,a.y=r.y;break;case"Vector3Node":a.x=r.x,a.y=r.y,a.z=r.z;break;case"Vector4Node":a.x=r.x,a.y=r.y,a.z=r.z,a.w=r.w;break;case"Matrix3Node":case"Matrix4Node":a.value.fromArray(r.elements);break;case"OperatorNode":a.a=this.getNode(r.a),a.b=this.getNode(r.b),a.op=r.op;break;case"Math1Node":a.a=this.getNode(r.a),a.method=r.method;break;case"Math2Node":a.a=this.getNode(r.a),a.b=this.getNode(r.b),a.method=r.method;break;case"Math3Node":a.a=this.getNode(r.a),a.b=this.getNode(r.b),a.c=this.getNode(r.c),a.method=r.method;break;case"UVNode":case"ColorsNode":a.index=r.index;break;case"LuminanceNode":a.rgb=this.getNode(r.rgb);break;case"PositionNode":case"NormalNode":case"ReflectNode":case"LightNode":a.scope=r.scope;break;case"SwitchNode":a.node=this.getNode(r.node),a.components=r.components;break;case"JoinNode":for(i in r.inputs)a[i]=this.getNode(r.inputs[i]);break;case"CameraNode":switch(a.setScope(r.scope),r.camera&&a.setCamera(this.getNode(r.camera)),r.scope){case n.CameraNode.DEPTH:a.near.number=r.near,a.far.number=r.far}break;case"ColorAdjustmentNode":a.rgb=this.getNode(r.rgb),a.adjustment=this.getNode(r.adjustment),a.method=r.method;break;case"UVTransformNode":a.uv=this.getNode(r.uv),a.transform=this.getNode(r.transform);break;case"BumpNode":a.value=this.getNode(r.value),a.coord=this.getNode(r.coord),a.scale=this.getNode(r.scale);break;case"BlurNode":a.value=this.getNode(r.value),a.coord=this.getNode(r.coord),a.scale=this.getNode(r.scale),a.value=this.getNode(r.value),a.coord=this.getNode(r.coord),a.radius=this.getNode(r.radius),void 0!==r.size&&(a.size=new n.Vector2(r.size.x,r.size.y)),a.blurX=r.blurX,a.blurY=r.blurY;break;case"ResolutionNode":a.renderer=this.getNode(r.renderer);break;case"ScreenUVNode":a.resolution=this.getNode(r.resolution);break;case"VelocityNode":r.target&&a.setTarget(this.getNode(r.target)),a.setParams(r.params);break;case"TimerNode":a.scope=r.scope,a.scale=r.scale;break;case"ConstNode":a.name=r.name,a.type=r.out,a.value=r.value,a.useDefine=!0===r.useDefine;break;case"AttributeNode":case"VarNode":a.type=r.out;break;case"ReflectorNode":a.setMirror(this.getNode(r.mirror)),r.offset&&(a.offset=this.getNode(r.offset));break;case"NoiseNode":a.coord=this.getNode(r.coord);break;case"FunctionNode":a.isMethod=r.isMethod,a.useKeywords=r.useKeywords,a.extensions=r.extensions,a.keywords={};for(i in r.keywords)a.keywords[i]=this.getNode(r.keywords[i]);if(r.includes)for(o=0;o<r.includes.length;o++)a.includes.push(this.getNode(r.includes[o]));a.eval(r.src,a.includes,a.extensions,a.keywords),a.isMethod||(a.type=r.out);break;case"FunctionCallNode":for(i in r.inputs)a.inputs[i]=this.getNode(r.inputs[i]);a.value=this.getNode(r.value);break;case"TextureNode":case"CubeTextureNode":case"ScreenNode":r.value&&(a.value=this.getNode(r.value)),a.coord=this.getNode(r.coord),r.bias&&(a.bias=this.getNode(r.bias)),void 0!==a.project&&(a.project=r.project);break;case"RoughnessToBlinnExponentNode":break;case"RawNode":a.value=this.getNode(r.value);break;case"StandardNode":case"PhongNode":case"SpriteNode":a.color=this.getNode(r.color),r.alpha&&(a.alpha=this.getNode(r.alpha)),r.specular&&(a.specular=this.getNode(r.specular)),r.shininess&&(a.shininess=this.getNode(r.shininess)),r.roughness&&(a.roughness=this.getNode(r.roughness)),r.metalness&&(a.metalness=this.getNode(r.metalness)),r.reflectivity&&(a.reflectivity=this.getNode(r.reflectivity)),r.clearCoat&&(a.clearCoat=this.getNode(r.clearCoat)),r.clearCoatRoughness&&(a.clearCoatRoughness=this.getNode(r.clearCoatRoughness)),r.normal&&(a.normal=this.getNode(r.normal)),r.normalScale&&(a.normalScale=this.getNode(r.normalScale)),r.emissive&&(a.emissive=this.getNode(r.emissive)),r.ambient&&(a.ambient=this.getNode(r.ambient)),r.shadow&&(a.shadow=this.getNode(r.shadow)),r.light&&(a.light=this.getNode(r.light)),r.ao&&(a.ao=this.getNode(r.ao)),r.environment&&(a.environment=this.getNode(r.environment)),r.environmentAlpha&&(a.environmentAlpha=this.getNode(r.environmentAlpha)),r.transform&&(a.transform=this.getNode(r.transform)),!1===r.spherical&&(a.spherical=!1);break;default:console.warn(r.type,"not supported.")}for(t in e.materials)r=e.materials[t],a=this.materials[t],void 0!==r.name&&(a.name=r.name),void 0!==r.blending&&(a.blending=r.blending),void 0!==r.flatShading&&(a.flatShading=r.flatShading),void 0!==r.side&&(a.side=r.side),a.depthFunc=r.depthFunc,a.depthTest=r.depthTest,a.depthWrite=r.depthWrite,void 0!==r.wireframe&&(a.wireframe=r.wireframe),void 0!==r.wireframeLinewidth&&(a.wireframeLinewidth=r.wireframeLinewidth),void 0!==r.wireframeLinecap&&(a.wireframeLinecap=r.wireframeLinecap),void 0!==r.wireframeLinejoin&&(a.wireframeLinejoin=r.wireframeLinejoin),void 0!==r.skinning&&(a.skinning=r.skinning),void 0!==r.morphTargets&&(a.morphTargets=r.morphTargets),void 0!==r.visible&&(a.visible=r.visible),void 0!==r.userData&&(a.userData=r.userData),a.vertex=this.getNode(r.vertex),a.fragment=this.getNode(r.fragment),a.vertex===a.fragment&&(a.node=a.vertex),a.build(),void 0!==r.fog&&(a.fog=r.fog),void 0!==r.lights&&(a.lights=r.lights),void 0!==r.transparent&&(a.transparent=r.transparent);for(t in e.passes)r=e.passes[t],a=this.passes[t],a.value=this.getNode(r.value),a.build();return this.material||this.pass||this}}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=r(10),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};s.prototype={constructor:s,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e,t){for(var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=0;a<e.byteLength;a+=t)for(var n=a+t-1,i=a;n>i;n--,i++){var o=r[i];r[i]=r[n],r[n]=o}return e}var r,a=e,i=0,s=new Int8Array(new Int16Array([1]).buffer)[0]>0,l=!0,u={},c=function(e,r){void 0!==r&&null!==r||(r=1);var n=1,o=Uint8Array;switch(e){case"uchar":break;case"schar":o=Int8Array;break;case"ushort":o=Uint16Array,n=2;break;case"sshort":o=Int16Array,n=2;break;case"uint":o=Uint32Array,n=4;break;case"sint":o=Int32Array,n=4;break;case"float":o=Float32Array,n=4;break;case"complex":case"double":o=Float64Array,n=8}var u=new o(a.slice(i,i+=r*n));return s!=l&&(u=t(u,n)),1==r?u[0]:u}("uchar",e.byteLength),d=c.length,f=null,h=0;for(r=1;r<d;r++)if(10==c[r-1]&&10==c[r]){f=this.parseChars(c,0,r-2),h=r+1;break}!function(e){var t,r,a,i,o,s,l,c,d;for(s=e.split(/\r?\n/),c=0,d=s.length;c<d;c++)o=s[c],o.match(/NRRD\d+/)?u.isNrrd=!0:o.match(/^#/)||(l=o.match(/(.*):(.*)/))&&(r=l[1].trim(),t=l[2].trim(),a=n.NRRDLoader.prototype.fieldFunctions[r],a?a.call(u,t):u[r]=t);if(!u.isNrrd)throw new Error("Not an NRRD file");if("bz2"===u.encoding||"bzip2"===u.encoding)throw new Error("Bzip is not supported");if(!u.vectors&&(u.vectors=[new n.Vector3(1,0,0),new n.Vector3(0,1,0),new n.Vector3(0,0,1)],u.spacings))for(i=0;i<=2;i++)isNaN(u.spacings[i])||u.vectors[i].multiplyScalar(u.spacings[i])}(f);var a=c.subarray(h);if("gzip"===u.encoding||"gz"===u.encoding){var p=new Zlib.Gunzip(new Uint8Array(a));a=p.decompress()}else if("ascii"===u.encoding||"text"===u.encoding||"txt"===u.encoding||"hex"===u.encoding)a=function(e,t,r){var a="";t=t||0,r=r||e.length;var n,i=u.sizes.reduce(function(e,t){return e*t},1),o=10;"hex"===u.encoding&&(o=16);var s=new u.__array(i),l=0,c=parseInt;u.__array!==Float32Array&&u.__array!==Float64Array||(c=parseFloat);for(var d=t;d<r;d++)n=e[d],(n<9||n>13)&&32!==n?a+=String.fromCharCode(n):(""!==a&&(s[l]=c(a,o),l++),a="");return""!==a&&(s[l]=c(a,o),l++),s}(a);else if("raw"===u.encoding){for(var m=new Uint8Array(a.length),r=0;r<a.length;r++)m[r]=a[r];a=m}a=a.buffer;var v=new o.default;v.header=u,v.data=new u.__array(a);var g=v.computeMinMax(),y=g[0],x=g[1];v.windowLow=y,v.windowHigh=x,v.dimensions=[u.sizes[0],u.sizes[1],u.sizes[2]],v.xLength=v.dimensions[0],v.yLength=v.dimensions[1],v.zLength=v.dimensions[2];var b=new n.Vector3(u.vectors[0][0],u.vectors[0][1],u.vectors[0][2]).length(),A=new n.Vector3(u.vectors[1][0],u.vectors[1][1],u.vectors[1][2]).length(),w=new n.Vector3(u.vectors[2][0],u.vectors[2][1],u.vectors[2][2]).length();v.spacing=[b,A,w],v.matrix=new n.Matrix4;var M=1,T=1;if("left-posterior-superior"==u.space?(M=-1,T=-1):"left-anterior-superior"===u.space&&(M=-1),u.vectors){var S=u.vectors;v.matrix.set(M*S[0][0],M*S[1][0],M*S[2][0],0,T*S[0][1],T*S[1][1],T*S[2][1],0,1*S[0][2],1*S[1][2],1*S[2][2],0,0,0,0,1)}else v.matrix.set(M,0,0,0,0,T,0,0,0,0,1,0,0,0,0,1);return v.inverseMatrix=new n.Matrix4,v.inverseMatrix.getInverse(v.matrix),v.RASDimensions=new n.Vector3(v.xLength,v.yLength,v.zLength).applyMatrix4(v.matrix).round().toArray().map(Math.abs),v.lowerThreshold===-1/0&&(v.lowerThreshold=y),v.upperThreshold===1/0&&(v.upperThreshold=x),v},parseChars:function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);var a="",n=0;for(n=t;n<r;++n)a+=String.fromCharCode(e[n]);return a},fieldFunctions:{type:function(e){switch(e){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.__array=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.__array=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.__array=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.__array=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.__array=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.__array=Uint32Array;break;case"float":this.__array=Float32Array;break;case"double":this.__array=Float64Array;break;default:throw new Error("Unsupported NRRD data type: "+e)}return this.type=e},endian:function(e){return this.endian=e},encoding:function(e){return this.encoding=e},dimension:function(e){return this.dim=parseInt(e,10)},sizes:function(e){var t;return this.sizes=function(){var r,a,n,i;for(n=e.split(/\s+/),i=[],r=0,a=n.length;r<a;r++)t=n[r],i.push(parseInt(t,10));return i}()},space:function(e){return this.space=e},"space origin":function(e){return this.space_origin=e.split("(")[1].split(")")[0].split(",")},"space directions":function(e){var t,r,a;return r=e.match(/\(.*?\)/g),this.vectors=function(){var e,n,i;for(i=[],e=0,n=r.length;e<n;e++)a=r[e],i.push(function(){var e,r,n,i;for(n=a.slice(1,-1).split(/,/),i=[],e=0,r=n.length;e<r;e++)t=n[e],i.push(parseFloat(t));return i}());return i}()},spacings:function(e){var t,r;return r=e.split(/\s+/),this.spacings=function(){var e,a,n=[];for(e=0,a=r.length;e<a;e++)t=r[e],n.push(parseFloat(t));return n}()}}},t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(){function e(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var a={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){var a=r.clone(0);a.inherited=!0,this.object.materials.push(a)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var a=this.vertices,n=this.object.geometry.vertices;n.push(a[e+0],a[e+1],a[e+2]),n.push(a[t+0],a[t+1],a[t+2]),n.push(a[r+0],a[r+1],a[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var a=this.normals,n=this.object.geometry.normals;n.push(a[e+0],a[e+1],a[e+2]),n.push(a[t+0],a[t+1],a[t+2]),n.push(a[r+0],a[r+1],a[r+2])},addColor:function(e,t,r){var a=this.colors,n=this.object.geometry.colors;n.push(a[e+0],a[e+1],a[e+2]),n.push(a[t+0],a[t+1],a[t+2]),n.push(a[r+0],a[r+1],a[r+2])},addUV:function(e,t,r){var a=this.uvs,n=this.object.geometry.uvs;n.push(a[e+0],a[e+1]),n.push(a[t+0],a[t+1]),n.push(a[r+0],a[r+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,a,n,i,o,s,l){var u=this.vertices.length,c=this.parseVertexIndex(e,u),d=this.parseVertexIndex(t,u),f=this.parseVertexIndex(r,u);if(this.addVertex(c,d,f),void 0!==a&&""!==a){var h=this.uvs.length;c=this.parseUVIndex(a,h),d=this.parseUVIndex(n,h),f=this.parseUVIndex(i,h),this.addUV(c,d,f)}if(void 0!==o&&""!==o){var p=this.normals.length;c=this.parseNormalIndex(o,p),d=o===s?c:this.parseNormalIndex(s,p),f=o===l?c:this.parseNormalIndex(l,p),this.addNormal(c,d,f)}this.colors.length>0&&this.addColor(c,d,f)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,a=e.length;r<a;r++)this.addVertexPoint(this.parseVertexIndex(e[r],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,a=this.uvs.length,n=0,i=e.length;n<i;n++)this.addVertexLine(this.parseVertexIndex(e[n],r));for(var o=0,i=t.length;o<i;o++)this.addUVLine(this.parseUVIndex(t[o],a))}};return e.startObject("",!1),e}function t(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.materials=null}var r=/^[og]\s*(.+)?/,a=/^mtllib /,i=/^usemtl /;return t.prototype={constructor:t,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setPath(this.path),o.load(e,function(e){t(i.parse(e))},r,a)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(t){console.time("OBJLoader");var o=new e;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var s=t.split("\n"),l="",u="",c=[],d="function"==typeof"".trimLeft,f=0,h=s.length;f<h;f++)if(l=s[f],l=d?l.trimLeft():l.trim(),0!==l.length&&"#"!==(u=l.charAt(0)))if("v"===u){var p=l.split(/\s+/);switch(p[0]){case"v":o.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),8===p.length&&o.colors.push(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6]));break;case"vn":o.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":o.uvs.push(parseFloat(p[1]),parseFloat(p[2]))}}else if("f"===u){for(var m=l.substr(1).trim(),v=m.split(/\s+/),g=[],y=0,x=v.length;y<x;y++){var b=v[y];if(b.length>0){var A=b.split("/");g.push(A)}}for(var w=g[0],y=1,x=g.length-1;y<x;y++){var M=g[y],T=g[y+1];o.addFace(w[0],M[0],T[0],w[1],M[1],T[1],w[2],M[2],T[2])}}else if("l"===u){var S=l.substring(1).trim().split(" "),F=[],E=[];if(-1===l.indexOf("/"))F=S;else for(var _=0,P=S.length;_<P;_++){var L=S[_].split("/");""!==L[0]&&F.push(L[0]),""!==L[1]&&E.push(L[1])}o.addLineGeometry(F,E)}else if("p"===u){var m=l.substr(1).trim(),C=m.split(" ");o.addPointGeometry(C)}else if(null!==(c=r.exec(l))){var N=(" "+c[0].substr(1).trim()).substr(1);o.startObject(N)}else if(i.test(l))o.object.startMaterial(l.substring(7).trim(),o.materialLibraries);else if(a.test(l))o.materialLibraries.push(l.substring(7).trim());else{if("s"!==u){if("\0"===l)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+l+'"')}if(c=l.split(" "),c.length>1){var O=c[1].trim().toLowerCase();o.object.smooth="0"!==O&&"off"!==O}else o.object.smooth=!0;var I=o.object.currentMaterial();I&&(I.smooth=o.object.smooth)}o.finalize();var U=new n.Group;U.materialLibraries=[].concat(o.materialLibraries);for(var f=0,h=o.objects.length;f<h;f++){var D=o.objects[f],R=D.geometry,k=D.materials,B="Line"===R.type,j="Points"===R.type,V=!1;if(0!==R.vertices.length){var G=new n.BufferGeometry;G.addAttribute("position",new n.Float32BufferAttribute(R.vertices,3)),R.normals.length>0?G.addAttribute("normal",new n.Float32BufferAttribute(R.normals,3)):G.computeVertexNormals(),R.colors.length>0&&(V=!0,G.addAttribute("color",new n.Float32BufferAttribute(R.colors,3))),R.uvs.length>0&&G.addAttribute("uv",new n.Float32BufferAttribute(R.uvs,2));for(var z=[],H=0,X=k.length;H<X;H++){var Y=k[H],I=void 0;if(null!==this.materials)if(I=this.materials.create(Y.name),!B||!I||I instanceof n.LineBasicMaterial){if(j&&I&&!(I instanceof n.PointsMaterial)){var W=new n.PointsMaterial({size:10,sizeAttenuation:!1});Q.copy(I),I=W}}else{var Q=new n.LineBasicMaterial;Q.copy(I),Q.lights=!1,I=Q}I||(I=B?new n.LineBasicMaterial:j?new n.PointsMaterial({size:1,sizeAttenuation:!1}):new n.MeshPhongMaterial,I.name=Y.name),I.flatShading=!Y.smooth,I.vertexColors=V?n.VertexColors:n.NoColors,z.push(I)}var q;if(z.length>1){for(var H=0,X=k.length;H<X;H++){var Y=k[H];G.addGroup(Y.groupStart,Y.groupCount,H)}q=B?new n.LineSegments(G,z):j?new n.Points(G,z):new n.Mesh(G,z)}else q=B?new n.LineSegments(G,z[0]):j?new n.Points(G,z[0]):new n.Mesh(G,z[0]);q.name=D.name,U.add(q)}}return console.timeEnd("OBJLoader"),U}},t}();t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(7),s=a(o),l=r(9),u=a(l),c=function(){function e(e){console.info("Using THREE.OBJLoader2 version: "+t),this.manager=r.verifyInput(e,i.DefaultLoadingManager),this.logging={enabled:!0,debug:!1},this.modelName="",this.instanceNo=0,this.path="",this.useIndices=!1,this.disregardNormals=!1,this.materialPerSmoothingGroup=!1,this.loaderRootNode=new i.Group,this.meshBuilder=new s.default.MeshBuilder,this.callbacks=new s.default.Callbacks,this.workerSupport=new s.default.WorkerSupport,this.terminateWorkerOnLoad=!0}var t="2.4.0",r=s.default.Validator;e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t,this.meshBuilder.setLogging(this.logging.enabled,this.logging.debug)},e.prototype.setModelName=function(e){this.modelName=r.verifyInput(e,this.modelName)},e.prototype.setPath=function(e){this.path=r.verifyInput(e,this.path)},e.prototype.setStreamMeshesTo=function(e){this.loaderRootNode=r.verifyInput(e,this.loaderRootNode)},e.prototype.setMaterials=function(e){this.meshBuilder.setMaterials(e)},e.prototype.setUseIndices=function(e){this.useIndices=!0===e},e.prototype.setDisregardNormals=function(e){this.disregardNormals=!0===e},e.prototype.setMaterialPerSmoothingGroup=function(e){this.materialPerSmoothingGroup=!0===e},e.prototype._setCallbacks=function(e){r.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),r.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),r.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),r.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials),this.meshBuilder._setCallbacks(this.callbacks)},e.prototype.onProgress=function(e,t,a){var n=r.isValid(t)?t:"",i={detail:{type:e,modelName:this.modelName,instanceNo:this.instanceNo,text:n,numericalValue:a}};r.isValid(this.callbacks.onProgress)&&this.callbacks.onProgress(i),this.logging.enabled&&this.logging.debug&&console.debug(n)},e.prototype._onError=function(e){var t="Error occurred while downloading!";throw e.currentTarget&&null!==e.currentTarget.statusText&&(t+="\nurl: "+e.currentTarget.responseURL+"\nstatus: "+e.currentTarget.statusText),this.onProgress("error",t,-1),t},e.prototype.load=function(e,t,r,a,n,i){var o=new s.default.ResourceDescriptor(e,"OBJ");this._loadObj(o,t,r,a,n,i)},e.prototype._loadObj=function(e,t,a,n,o,l){r.isValid(n)||(n=this._onError),r.isValid(e)||n("An invalid ResourceDescriptor was provided. Unable to continue!");var u=this,c=function(r){if(e.content=r,l)u.parseAsync(r,t);else{var a=new s.default.Callbacks;a.setCallbackOnMeshAlter(o),u._setCallbacks(a),t({detail:{loaderRootNode:u.parse(r),modelName:u.modelName,instanceNo:u.instanceNo}})}};if(!r.isValid(e.url)||r.isValid(e.content))c(r.isValid(e.content)?e.content:null);else{if(!r.isValid(a)){var d=0,f=0;a=function(t){if(t.lengthComputable&&(f=t.loaded/t.total)>d){d=f;var r='Download of "'+e.url+'": '+(100*f).toFixed(2)+"%";u.onProgress("progressLoad",r,f)}}}var h=new i.FileLoader(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.load(e.url,c,a,n)}},e.prototype.run=function(e,t){this._applyPrepData(e);var a=e.checkResourceDescriptorFiles(e.resources,[{ext:"obj",type:"ArrayBuffer",ignore:!1},{ext:"mtl",type:"String",ignore:!1},{ext:"zip",type:"String",ignore:!0}]);r.isValid(t)&&(this.terminateWorkerOnLoad=!1,this.workerSupport=t,this.logging.enabled=this.workerSupport.logging.enabled,this.logging.debug=this.workerSupport.logging.debug);var n=this,i=function(t){null!==t&&n.meshBuilder.setMaterials(t),n._loadObj(a.obj,n.callbacks.onLoad,null,null,n.callbacks.onMeshAlter,e.useAsync)};this._loadMtl(a.mtl,i,e.crossOrigin,e.materialOptions)},e.prototype._applyPrepData=function(e){r.isValid(e)&&(this.setLogging(e.logging.enabled,e.logging.debug),this.setModelName(e.modelName),this.setStreamMeshesTo(e.streamMeshesTo),this.meshBuilder.setMaterials(e.materials),this.setUseIndices(e.useIndices),this.setDisregardNormals(e.disregardNormals),this.setMaterialPerSmoothingGroup(e.materialPerSmoothingGroup),this._setCallbacks(e.getCallbacks()))},e.prototype.parse=function(e){if(!r.isValid(e))return console.warn("Provided content is not a valid ArrayBuffer or String."),this.loaderRootNode;this.logging.enabled&&console.time("OBJLoader2 parse: "+this.modelName),this.meshBuilder.init();var t=new a;t.setLogging(this.logging.enabled,this.logging.debug),t.setMaterialPerSmoothingGroup(this.materialPerSmoothingGroup),t.setUseIndices(this.useIndices),t.setDisregardNormals(this.disregardNormals),t.setMaterials(this.meshBuilder.getMaterials());var n=this,i=function(e){var t,r=n.meshBuilder.processPayload(e);for(var a in r)t=r[a],n.loaderRootNode.add(t)};t.setCallbackMeshBuilder(i);var o=function(e,t){n.onProgress("progressParse",e,t)};if(t.setCallbackProgress(o),e instanceof ArrayBuffer||e instanceof Uint8Array)this.logging.enabled&&console.info("Parsing arrayBuffer..."),t.parse(e);else{if(!("string"==typeof e||e instanceof String))throw"Provided content was neither of type String nor Uint8Array! Aborting...";this.logging.enabled&&console.info("Parsing text..."),t.parseText(e)}return this.logging.enabled&&console.timeEnd("OBJLoader2 parse: "+this.modelName),this.loaderRootNode},e.prototype.parseAsync=function(e,t){var n=this,i=!1,o=function(){t({detail:{loaderRootNode:n.loaderRootNode,modelName:n.modelName,instanceNo:n.instanceNo}}),i&&n.logging.enabled&&console.timeEnd("OBJLoader2 parseAsync: "+n.modelName)};r.isValid(e)?i=!0:(console.warn("Provided content is not a valid ArrayBuffer."),o()),i&&this.logging.enabled&&console.time("OBJLoader2 parseAsync: "+this.modelName),this.meshBuilder.init();var s=function(e){var t,r=n.meshBuilder.processPayload(e);for(var a in r)t=r[a],n.loaderRootNode.add(t)},l=function(e,t){var n="";return n+="/**\n",n+="  * This code was constructed by OBJLoader2 buildCode.\n",n+="  */\n\n",n+="THREE = { LoaderSupport: {} };\n\n",n+=e("LoaderSupport.Validator",r),n+=t("Parser",a)};this.workerSupport.validate(l,"Parser"),this.workerSupport.setCallbacks(s,o),n.terminateWorkerOnLoad&&this.workerSupport.setTerminateRequested(!0);var u={},c=this.meshBuilder.getMaterials();for(var d in c)u[d]=d;this.workerSupport.run({params:{useAsync:!0,materialPerSmoothingGroup:this.materialPerSmoothingGroup,useIndices:this.useIndices,disregardNormals:this.disregardNormals},logging:{enabled:this.logging.enabled,debug:this.logging.debug},materials:{materials:u},data:{input:e,options:null}})};var a=function(){function e(){this.callbackProgress=null,this.callbackMeshBuilder=null,this.contentRef=null,this.legacyMode=!1,this.materials={},this.useAsync=!1,this.materialPerSmoothingGroup=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0},this.logging={enabled:!0,debug:!1}}return e.prototype.resetRawMesh=function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this.pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},e.prototype.setUseAsync=function(e){this.useAsync=e},e.prototype.setMaterialPerSmoothingGroup=function(e){this.materialPerSmoothingGroup=e},e.prototype.setUseIndices=function(e){this.useIndices=e},e.prototype.setDisregardNormals=function(e){this.disregardNormals=e},e.prototype.setMaterials=function(e){this.materials=s.default.Validator.verifyInput(e,this.materials),this.materials=s.default.Validator.verifyInput(this.materials,{})},e.prototype.setCallbackMeshBuilder=function(e){if(!s.default.Validator.isValid(e))throw'Unable to run as no "MeshBuilder" callback is set.';this.callbackMeshBuilder=e},e.prototype.setCallbackProgress=function(e){this.callbackProgress=e},e.prototype.setLogging=function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},e.prototype.configure=function(){if(this.pushSmoothingGroup(1),this.logging.enabled){var e=Object.keys(this.materials),t=e.length>0?"\n\tmaterialNames:\n\t\t- "+e.join("\n\t\t- "):"\n\tmaterialNames: None",r="OBJLoader2.Parser configuration:"+t+"\n\tuseAsync: "+this.useAsync+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals+"\n\tcallbackMeshBuilderName: "+this.callbackMeshBuilder.name+"\n\tcallbackProgressName: "+this.callbackProgress.name;console.info(r)}},e.prototype.parse=function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parse"),this.configure();var t=new Uint8Array(e);this.contentRef=t;var r=t.byteLength;this.globalCounts.totalBytes=r;for(var a,n=new Array(128),i="",o=0,s=0,l=0;l<r;l++)switch(a=t[l]){case 32:i.length>0&&(n[o++]=i),i="";break;case 47:i.length>0&&(n[o++]=i),s++,i="";break;case 10:i.length>0&&(n[o++]=i),i="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=l,this.processLine(n,o,s),o=0,s=0;break;case 13:break;default:i+=String.fromCharCode(a)}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parse")},e.prototype.parseText=function(e){this.logging.enabled&&console.time("OBJLoader2.Parser.parseText"),this.configure(),this.legacyMode=!0,this.contentRef=e;var t=e.length;this.globalCounts.totalBytes=t;for(var r,a=new Array(128),n="",i=0,o=0,s=0;s<t;s++)switch(r=e[s]){case" ":n.length>0&&(a[i++]=n),n="";break;case"/":n.length>0&&(a[i++]=n),o++,n="";break;case"\n":n.length>0&&(a[i++]=n),n="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=s,this.processLine(a,i,o),i=0,o=0;break;case"\r":break;default:n+=r}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parseText")},e.prototype.processLine=function(e,t,r){if(!(t<1)){var a,n,i,o,s=function(e,t,r,a){var n="";if(a>r){var i;if(t)for(i=r;i<a;i++)n+=e[i];else for(i=r;i<a;i++)n+=String.fromCharCode(e[i]);n=n.trim()}return n};switch(o=e[0]){case"v":this.vertices.push(parseFloat(e[1])),this.vertices.push(parseFloat(e[2])),this.vertices.push(parseFloat(e[3])),t>4&&(this.colors.push(parseFloat(e[4])),this.colors.push(parseFloat(e[5])),this.colors.push(parseFloat(e[6])));break;case"vt":this.uvs.push(parseFloat(e[1])),this.uvs.push(parseFloat(e[2]));break;case"vn":this.normals.push(parseFloat(e[1])),this.normals.push(parseFloat(e[2])),this.normals.push(parseFloat(e[3]));break;case"f":if(a=t-1,0===r)for(this.checkFaceType(0),i=2,n=a;i<n;i++)this.buildFace(e[1]),this.buildFace(e[i]),this.buildFace(e[i+1]);else if(a===2*r)for(this.checkFaceType(1),i=3,n=a-2;i<n;i+=2)this.buildFace(e[1],e[2]),this.buildFace(e[i],e[i+1]),this.buildFace(e[i+2],e[i+3]);else if(2*a==3*r)for(this.checkFaceType(2),i=4,n=a-3;i<n;i+=3)this.buildFace(e[1],e[2],e[3]),this.buildFace(e[i],e[i+1],e[i+2]),this.buildFace(e[i+3],e[i+4],e[i+5]);else for(this.checkFaceType(3),i=3,n=a-2;i<n;i+=2)this.buildFace(e[1],void 0,e[2]),this.buildFace(e[i],void 0,e[i+1]),this.buildFace(e[i+2],void 0,e[i+3]);break;case"l":case"p":if((a=t-1)===2*r)for(this.checkFaceType(4),i=1,n=a+1;i<n;i+=2)this.buildFace(e[i],e[i+1]);else for(this.checkFaceType("l"===o?5:6),i=1,n=a+1;i<n;i++)this.buildFace(e[i]);break;case"s":this.pushSmoothingGroup(e[1]);break;case"g":this.processCompletedMesh(),this.rawMesh.groupName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.rawMesh.objectName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":var l=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==l&&this.rawMesh.activeMtlName!==l&&(this.rawMesh.activeMtlName=l,this.rawMesh.counts.mtlCount++,this.checkSubGroup())}}},e.prototype.pushSmoothingGroup=function(e){var t=parseInt(e);isNaN(t)&&(t="off"===e?0:1);var r=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?t:0===t?0:1,this.rawMesh.smoothingGroup.real=t,r!==t&&(this.rawMesh.counts.smoothingGroupCount++,this.checkSubGroup())},e.prototype.checkFaceType=function(e){this.rawMesh.faceType!==e&&(this.processCompletedMesh(),this.rawMesh.faceType=e,this.checkSubGroup())},e.prototype.checkSubGroup=function(){var e=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[e],s.default.Validator.isValid(this.rawMesh.subGroupInUse)||(this.rawMesh.subGroupInUse={index:e,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[e]=this.rawMesh.subGroupInUse)},e.prototype.buildFace=function(e,t,r){this.disregardNormals&&(r=void 0);var a=this,n=function(){var n=parseInt(e),i=3*(n>0?n-1:n+a.vertices.length/3),o=a.rawMesh.subGroupInUse.vertices;o.push(a.vertices[i++]),o.push(a.vertices[i++]),o.push(a.vertices[i]);var s=a.colors.length>0?i:null;if(null!==s){var l=a.rawMesh.subGroupInUse.colors;l.push(a.colors[s++]),l.push(a.colors[s++]),l.push(a.colors[s])}if(t){var u=parseInt(t),c=2*(u>0?u-1:u+a.uvs.length/2),d=a.rawMesh.subGroupInUse.uvs;d.push(a.uvs[c++]),d.push(a.uvs[c])}if(r){var f=parseInt(r),h=3*(f>0?f-1:f+a.normals.length/3),p=a.rawMesh.subGroupInUse.normals;p.push(a.normals[h++]),p.push(a.normals[h++]),p.push(a.normals[h])}};if(this.useIndices){var i=e+(t?"_"+t:"_n")+(r?"_"+r:"_n"),o=this.rawMesh.subGroupInUse.indexMappings[i];s.default.Validator.isValid(o)?this.rawMesh.counts.doubleIndicesCount++:(o=this.rawMesh.subGroupInUse.vertices.length/3,n(),this.rawMesh.subGroupInUse.indexMappings[i]=o,this.rawMesh.subGroupInUse.indexMappingsCount++),this.rawMesh.subGroupInUse.indices.push(o)}else n();this.rawMesh.counts.faceCount++},e.prototype.createRawMeshReport=function(e){return"Input Object number: "+e+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},e.prototype.finalizeRawMesh=function(){var e,t,r=[],a=0,n=0,i=0,o=0,s=0,l=0;for(var u in this.rawMesh.subGroups)if(e=this.rawMesh.subGroups[u],e.vertices.length>0){if(t=e.indices,t.length>0&&n>0)for(var c in t)t[c]=t[c]+n;r.push(e),a+=e.vertices.length,n+=e.indexMappingsCount,i+=e.indices.length,o+=e.colors.length,l+=e.uvs.length,s+=e.normals.length}var d=null;return r.length>0&&(d={name:""!==this.rawMesh.groupName?this.rawMesh.groupName:this.rawMesh.objectName,subGroups:r,absoluteVertexCount:a,absoluteIndexCount:i,absoluteColorCount:o,absoluteNormalCount:s,absoluteUvCount:l,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),d},e.prototype.processCompletedMesh=function(){var e=this.finalizeRawMesh();if(s.default.Validator.isValid(e)){if(this.colors.length>0&&this.colors.length!==this.vertices.length)throw"Vertex Colors were detected, but vertex count and color count do not match!";this.logging.enabled&&this.logging.debug&&console.debug(this.createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this.buildMesh(e);var t=this.globalCounts.currentByte/this.globalCounts.totalBytes;return this.callbackProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(100*t).toFixed(2)+"%",t),this.resetRawMesh(),!0}return!1},e.prototype.buildMesh=function(e){var t=e.subGroups,r=new Float32Array(e.absoluteVertexCount);this.globalCounts.vertices+=e.absoluteVertexCount/3,this.globalCounts.faces+=e.faceCount,this.globalCounts.doubleIndicesCount+=e.doubleIndicesCount;var a,n,i,o,l,u,c,d=e.absoluteIndexCount>0?new Uint32Array(e.absoluteIndexCount):null,f=e.absoluteColorCount>0?new Float32Array(e.absoluteColorCount):null,h=e.absoluteNormalCount>0?new Float32Array(e.absoluteNormalCount):null,p=e.absoluteUvCount>0?new Float32Array(e.absoluteUvCount):null,m=s.default.Validator.isValid(f),v=[],g=t.length>1,y=0,x=[],b=[],A=0,w=0,M=0,T=0,S=0,F=0,E=0;for(var _ in t)if(t.hasOwnProperty(_)){if(a=t[_],c=a.materialName,u=this.rawMesh.faceType<4?c+(m?"_vertexColor":"")+(0===a.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial",o=this.materials[c],l=this.materials[u],!s.default.Validator.isValid(o)&&!s.default.Validator.isValid(l)){var P=m?"defaultVertexColorMaterial":"defaultMaterial";o=this.materials[P],this.logging.enabled&&console.warn('object_group "'+a.objectName+"_"+a.groupName+'" was defined with unresolvable material "'+c+'"! Assigning "'+P+'".'),c=P,c===u&&(l=o,u=P)}if(!s.default.Validator.isValid(l)){var L={materialNameOrg:c,materialName:u,materialProperties:{vertexColors:m?2:0,flatShading:0===a.smoothingGroup}},C={cmd:"materialData",materials:{materialCloneInstructions:L}};this.callbackMeshBuilder(C),this.useAsync&&(this.materials[u]=L)}if(g?(n=x[u],n||(n=y,x[u]=y,v.push(u),y++),E=this.useIndices?a.indices.length:a.vertices.length/3,i={start:F,count:E,index:n},b.push(i),F+=E):v.push(u),r.set(a.vertices,A),A+=a.vertices.length,d&&(d.set(a.indices,w),w+=a.indices.length),f&&(f.set(a.colors,M),M+=a.colors.length),h&&(h.set(a.normals,T),T+=a.normals.length),p&&(p.set(a.uvs,S),S+=a.uvs.length),this.logging.enabled&&this.logging.debug){var N=s.default.Validator.isValid(n)?"\n\t\tmaterialIndex: "+n:"",O="\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+a.groupName+"\n\t\tIndex: "+a.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+a.materialName+"\n\t\tsmoothingGroup: "+a.smoothingGroup+N+"\n\t\tobjectName: "+a.objectName+"\n\t\t#vertices: "+a.vertices.length/3+"\n\t\t#indices: "+a.indices.length+"\n\t\t#colors: "+a.colors.length/3+"\n\t\t#uvs: "+a.uvs.length/2+"\n\t\t#normals: "+a.normals.length/3;console.debug(O)}}this.outputObjectCount++,this.callbackMeshBuilder({cmd:"meshData",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:e.name},materials:{multiMaterial:g,materialNames:v,materialGroups:b},buffers:{vertices:r,indices:d,colors:f,normals:h,uvs:p},geometryType:this.rawMesh.faceType<4?0:6===this.rawMesh.faceType?2:1},[r.buffer],s.default.Validator.isValid(d)?[d.buffer]:null,s.default.Validator.isValid(f)?[f.buffer]:null,s.default.Validator.isValid(h)?[h.buffer]:null,s.default.Validator.isValid(p)?[p.buffer]:null)},e.prototype.finalizeParsing=function(){if(this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this.processCompletedMesh()&&this.logging.enabled){var e="Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount;console.info(e)}},e}();return e.prototype.loadMtl=function(e,t,r,a,n){var i=new s.default.ResourceDescriptor(e,"MTL");i.setContent(t),this._loadMtl(i,r,a,n)},e.prototype._loadMtl=function(e,t,a,n){void 0===u.default&&console.error('"THREE.MTLLoader" is not available. "THREE.OBJLoader2" requires it for loading MTL files.'),r.isValid(e)&&this.logging.enabled&&console.time("Loading MTL: "+e.name);var o=[],s=this,l=function(a){var n=[];if(r.isValid(a)){a.preload(),n=a.materials;for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i])}r.isValid(e)&&s.logging.enabled&&console.timeEnd("Loading MTL: "+e.name),t(o,a)};if(r.isValid(e)&&(r.isValid(e.content)||r.isValid(e.url))){var c=new u.default(this.manager);if(a=r.verifyInput(a,"anonymous"),c.setCrossOrigin(a),c.setPath(e.path),r.isValid(n)&&c.setMaterialOptions(n),r.isValid(e.content))l(r.isValid(e.content)?c.parse(e.content):null);else if(r.isValid(e.url)){var d=new i.FileLoader(this.manager);d.load(e.url,function(t){e.content=t,l(c.parse(t))},this._onProgress,this._onError)}}else l()},e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.littleEndian=!0};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(r){t(i.parse(r,e))},r,a)},parse:function(e,t){var r=n.LoaderUtils.decodeText(e),a=function(e){var t={},r=e.search(/[\r\n]DATA\s(\S*)\s/i),a=/[\r\n]DATA\s(\S*)\s/i.exec(e.substr(r-1));if(t.data=a[1],t.headerLen=a[0].length+r,t.str=e.substr(0,t.headerLen),t.str=t.str.replace(/\#.*/gi,""),t.version=/VERSION (.*)/i.exec(t.str),t.fields=/FIELDS (.*)/i.exec(t.str),t.size=/SIZE (.*)/i.exec(t.str),t.type=/TYPE (.*)/i.exec(t.str),t.count=/COUNT (.*)/i.exec(t.str),t.width=/WIDTH (.*)/i.exec(t.str),t.height=/HEIGHT (.*)/i.exec(t.str),t.viewpoint=/VIEWPOINT (.*)/i.exec(t.str),t.points=/POINTS (.*)/i.exec(t.str),null!==t.version&&(t.version=parseFloat(t.version[1])),null!==t.fields&&(t.fields=t.fields[1].split(" ")),null!==t.type&&(t.type=t.type[1].split(" ")),null!==t.width&&(t.width=parseInt(t.width[1])),null!==t.height&&(t.height=parseInt(t.height[1])),null!==t.viewpoint&&(t.viewpoint=t.viewpoint[1]),null!==t.points&&(t.points=parseInt(t.points[1],10)),null===t.points&&(t.points=t.width*t.height),null!==t.size&&(t.size=t.size[1].split(" ").map(function(e){return parseInt(e,10)})),null!==t.count)t.count=t.count[1].split(" ").map(function(e){return parseInt(e,10)});else{t.count=[];for(var n=0,i=t.fields.length;n<i;n++)t.count.push(1)}t.offset={};for(var o=0,n=0,i=t.fields.length;n<i;n++)"ascii"===t.data?t.offset[t.fields[n]]=n:(t.offset[t.fields[n]]=o,o+=t.size[n]);return t.rowSize=o,t}(r),i=[],o=[],s=[];if("ascii"===a.data)for(var l=a.offset,u=r.substr(a.headerLen),c=u.split("\n"),d=0,f=c.length;d<f;d++)if(""!==c[d]){var h=c[d].split(" ");if(void 0!==l.x&&(i.push(parseFloat(h[l.x])),i.push(parseFloat(h[l.y])),i.push(parseFloat(h[l.z]))),void 0!==l.rgb){var p=new Float32Array([parseFloat(h[l.rgb])]),m=new DataView(p.buffer,0);s.push(m.getUint8(0)/255),s.push(m.getUint8(1)/255),s.push(m.getUint8(2)/255)}void 0!==l.normal_x&&(o.push(parseFloat(h[l.normal_x])),o.push(parseFloat(h[l.normal_y])),o.push(parseFloat(h[l.normal_z])))}if("binary_compressed"===a.data)return void console.error("THREE.PCDLoader: binary_compressed files are not supported");if("binary"===a.data)for(var m=new DataView(e,a.headerLen),l=a.offset,d=0,v=0;d<a.points;d++,v+=a.rowSize)void 0!==l.x&&(i.push(m.getFloat32(v+l.x,this.littleEndian)),i.push(m.getFloat32(v+l.y,this.littleEndian)),i.push(m.getFloat32(v+l.z,this.littleEndian))),void 0!==l.rgb&&(s.push(m.getUint8(v+l.rgb+0)/255),s.push(m.getUint8(v+l.rgb+1)/255),s.push(m.getUint8(v+l.rgb+2)/255)),void 0!==l.normal_x&&(o.push(m.getFloat32(v+l.normal_x,this.littleEndian)),o.push(m.getFloat32(v+l.normal_y,this.littleEndian)),o.push(m.getFloat32(v+l.normal_z,this.littleEndian)));var g=new n.BufferGeometry;i.length>0&&g.addAttribute("position",new n.Float32BufferAttribute(i,3)),o.length>0&&g.addAttribute("normal",new n.Float32BufferAttribute(o,3)),s.length>0&&g.addAttribute("color",new n.Float32BufferAttribute(s,3)),g.computeBoundingSphere();var y=new n.PointsMaterial({size:.005});s.length>0?y.vertexColors=!0:y.color.setHex(16777215*Math.random());var x=new n.Points(g,y),b=t.split("").reverse().join("");return b=/([^\/]*)/.exec(b),b=b[1].split("").reverse().join(""),x.name=b,x}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this;new n.FileLoader(i.manager).load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(e,t){return"s"+Math.min(e,t)+"e"+Math.max(e,t)}function a(e,t){var a=parseInt(m[v].substr(e,t));if(a){var n=r(y,a);void 0===p[n]&&(f.push([y-1,a-1,1]),p[n]=f.length-1)}}for(var i,o,s,l,u,c={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},d=[],f=[],h={},p={},m=e.split("\n"),v=0,g=m.length;v<g;v++)if("ATOM"===m[v].substr(0,4)||"HETATM"===m[v].substr(0,6))i=parseFloat(m[v].substr(30,7)),o=parseFloat(m[v].substr(38,7)),s=parseFloat(m[v].substr(46,7)),l=parseInt(m[v].substr(6,5))-1,u=t(m[v].substr(76,2)).toLowerCase(),""===u&&(u=t(m[v].substr(12,2)).toLowerCase()),d[l]=[i,o,s,c[u],function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}(u)],void 0===h[u]?h[u]=1:h[u]+=1;else if("CONECT"===m[v].substr(0,6)){var y=parseInt(m[v].substr(6,5));a(11,5),a(16,5),a(21,5),a(26,5)}return function(){var e,t,r={geometryAtoms:new n.BufferGeometry,geometryBonds:new n.BufferGeometry,json:{atoms:d,bonds:f}},a=r.geometryAtoms,i=r.geometryBonds,o=[],s=[],l=[];for(e=0,t=d.length;e<t;e++){var u=d[e],c=u[0],h=u[1],p=u[2];o.push(c,h,p);var m=u[3][0]/255,v=u[3][1]/255,g=u[3][2]/255;s.push(m,v,g)}for(e=0,t=f.length;e<t;e++){var y=f[e],x=y[0],b=y[1];l.push(o[3*x+0]),l.push(o[3*x+1]),l.push(o[3*x+2]),l.push(o[3*b+0]),l.push(o[3*b+1]),l.push(o[3*b+2])}return a.addAttribute("position",new n.Float32BufferAttribute(o,3)),a.addAttribute("color",new n.Float32BufferAttribute(s,3)),i.addAttribute("position",new n.Float32BufferAttribute(l,3)),r}()}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this;new n.FileLoader(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,a)},parse:function(e){for(var t=e.model,r=0,a=t.vertices.length;r<a;r++)!function(e){var t={};for(var r in e){var a,i=e[r],o=i.type,s=i.components;switch(o){case"float32":a=new n.Float32BufferAttribute(i.data,s);break;case"uint8":a=new n.Uint8BufferAttribute(i.data,s);break;case"uint16":a=new n.Uint16BufferAttribute(i.data,s);break;default:console.log('THREE.PlayCanvasLoader: Array type "%s" not yet supported.',o)}t[r]=a}e._attributes=t}(t.vertices[r]);for(var r=0,a=t.meshes.length;r<a;r++)!function(e){var r=new n.BufferGeometry;r.setIndex(e.indices);var a=t.vertices[e.vertices]._attributes;for(var i in a){var o=a[i];"texCoord0"===i&&(i="uv"),r.addAttribute(i,o)}e._geometry=r}(t.meshes[r]);for(var r=0,a=t.meshInstances.length;r<a;r++)!function(e){var r=t.nodes[e.node],a=t.meshes[e.mesh];void 0===r._geometries&&(r._geometries=[]),r._geometries.push(a._geometry)}(t.meshInstances[r]);for(var r=0,a=t.nodes.length;r<a;r++)!function(e){var t=new n.Group,r=e._geometries;if(void 0!==r)for(var a=new n.MeshPhongMaterial,i=0,o=r.length;i<o;i++){var s=r[i];t.add(new n.Mesh(s,a))}for(var i=0,o=e.rotation.length;i<o;i++)e.rotation[i]*=Math.PI/180;t.name=e.name,t.position.fromArray(e.position),t.quaternion.setFromEuler((new n.Euler).fromArray(e.rotation)),t.scale.fromArray(e.scale),e._object=t}(t.nodes[r]);for(var r=0,a=t.parents.length;r<a;r++){var i=t.parents[r];-1!==i&&t.nodes[i]._object.add(t.nodes[r]._object)}return t.nodes[0]._object}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.propertyNameMapping={}};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(e){function t(e){var t=/ply([\s\S]*)end_header\s/,r="",a=0,n=t.exec(e);null!==n&&(r=n[1],a=n[0].length);for(var i,o,s,l={comments:[],elements:[],headerLength:a},u=r.split("\n"),c=0;c<u.length;c++){var f=u[c];if(""!==(f=f.trim()))switch(s=f.split(/\s+/),o=s.shift(),f=s.join(" "),o){case"format":l.format=s[0],l.version=s[1];break;case"comment":l.comments.push(f);break;case"element":void 0!==i&&l.elements.push(i),i={},i.name=s[0],i.count=parseInt(s[1]),i.properties=[];break;case"property":i.properties.push(function(e,t){var r={type:e[0]};return"list"===r.type?(r.name=e[3],r.countType=e[1],r.itemType=e[2]):r.name=e[1],r.name in t&&(r.name=t[r.name]),r}(s,d.propertyNameMapping));break;default:console.log("unhandled",o,s)}}return void 0!==i&&l.elements.push(i),l}function r(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function a(e,t){for(var a=t.split(/\s+/),n={},i=0;i<e.length;i++)if("list"===e[i].type){for(var o=[],s=r(a.shift(),e[i].countType),l=0;l<s;l++)o.push(r(a.shift(),e[i].itemType));n[e[i].name]=o}else n[e[i].name]=r(a.shift(),e[i].type);return n}function i(e,t){var r,n={indices:[],vertices:[],normals:[],uvs:[],colors:[]},i=/end_header\s([\s\S]*)$/,l="";null!==(r=i.exec(e))&&(l=r[1]);for(var u=l.split("\n"),c=0,d=0,f=0;f<u.length;f++){var h=u[f];if(""!==(h=h.trim())){d>=t.elements[c].count&&(c++,d=0);var p=a(t.elements[c].properties,h);s(n,t.elements[c].name,p),d++}}return o(n)}function o(e){var t=new n.BufferGeometry;return e.indices.length>0&&t.setIndex(e.indices),t.addAttribute("position",new n.Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.addAttribute("normal",new n.Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.addAttribute("uv",new n.Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.addAttribute("color",new n.Float32BufferAttribute(e.colors,3)),t.computeBoundingSphere(),t}function s(e,t,r){if("vertex"===t)e.vertices.push(r.x,r.y,r.z),"nx"in r&&"ny"in r&&"nz"in r&&e.normals.push(r.nx,r.ny,r.nz),"s"in r&&"t"in r&&e.uvs.push(r.s,r.t),"red"in r&&"green"in r&&"blue"in r&&e.colors.push(r.red/255,r.green/255,r.blue/255);else if("face"===t){var a=r.vertex_indices||r.vertex_index;3===a.length?e.indices.push(a[0],a[1],a[2]):4===a.length&&(e.indices.push(a[0],a[1],a[3]),e.indices.push(a[1],a[2],a[3]))}}function l(e,t,r,a){switch(r){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,a),2];case"uint16":case"ushort":return[e.getUint16(t,a),2];case"int32":case"int":return[e.getInt32(t,a),4];case"uint32":case"uint":return[e.getUint32(t,a),4];case"float32":case"float":return[e.getFloat32(t,a),4];case"float64":case"double":return[e.getFloat64(t,a),8]}}function u(e,t,r,a){for(var n,i={},o=0,s=0;s<r.length;s++)if("list"===r[s].type){var u=[];n=l(e,t+o,r[s].countType,a);var c=n[0];o+=n[1];for(var d=0;d<c;d++)n=l(e,t+o,r[s].itemType,a),u.push(n[0]),o+=n[1];i[r[s].name]=u}else n=l(e,t+o,r[s].type,a),i[r[s].name]=n[0],o+=n[1];return[i,o]}var c,d=this;if(e instanceof ArrayBuffer){var f=n.LoaderUtils.decodeText(new Uint8Array(e)),h=t(f);c="ascii"===h.format?i(f,h):function(e,t){for(var r,a={indices:[],vertices:[],normals:[],uvs:[],colors:[]},n="binary_little_endian"===t.format,i=new DataView(e,t.headerLength),l=0,c=0;c<t.elements.length;c++)for(var d=0;d<t.elements[c].count;d++){r=u(i,l,t.elements[c].properties,n),l+=r[1];var f=r[0];s(a,t.elements[c].name,f)}return o(a)}(e,h)}else c=i(e,t(e));return c}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a);t.default=function(){function e(){if(null===a){var e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);t[0]=170,t[1]=187,a=43707===r[0]}return a}function t(t,r,a,n,i){var s,l=r.BYTES_PER_ELEMENT;if(i===e()||1===l)s=new r(t,a,n);else{var u=new DataView(t,a,n*l),c=o[r.name],d=!i,f=0;for(s=new r(n);f<n;f++)s[f]=u[c](f*l,d)}return s}function r(e){var r=new Uint8Array(e),a=r[0],n=r[1],o=!!(n>>7&1),s=n>>6&1,l=1==(n>>5&1),u=31&n,c=0,d=0;if(l?(c=(r[2]<<16)+(r[3]<<8)+r[4],d=(r[5]<<16)+(r[6]<<8)+r[7]):(c=r[2]+(r[3]<<8)+(r[4]<<16),d=r[5]+(r[6]<<8)+(r[7]<<16)),0===a)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==a)throw new Error("PRWM decoder: Unsupported format version: "+a);if(!o){if(0!==s)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!==d)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}var f,h,p,m,v,g,y,x,b,A=8,w={};for(b=0;b<u;b++){for(f="";A<r.length&&(h=r[A],A++,0!==h);)f+=String.fromCharCode(h);n=r[A],p=n>>7&1,m=1+(n>>4&3),v=15&n,g=i[v],A++,A=4*Math.ceil(A/4),y=t(e,g,A,m*c,l),A+=g.BYTES_PER_ELEMENT*m*c,w[f]={type:p,cardinality:m,values:y}}return A=4*Math.ceil(A/4),x=null,o&&(x=t(e,1===s?Uint32Array:Uint16Array,A,d,l)),{version:a,attributes:w,indices:x}}var a=null,i=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],o={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"},s=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};return s.prototype={constructor:s,load:function(t,r,a,i){var o=this,s=new n.FileLoader(o.manager);s.setResponseType("arraybuffer"),t=t.replace(/\*/g,e()?"be":"le"),s.load(t,function(e){r(o.parse(e))},a,i)},parse:function(e){console.time("PRWMLoader");var t,a,i=r(e),o=Object.keys(i.attributes),s=new n.BufferGeometry;for(a=0;a<o.length;a++)t=i.attributes[o[a]],s.addAttribute(o[a],new n.BufferAttribute(t.values,t.cardinality,t.normalized));return null!==i.indices&&s.setIndex(new n.BufferAttribute(i.indices,1)),console.timeEnd("PRWMLoader"),s}},s.isBigEndianPlatform=function(){return e()},s}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function e(t){this.manager=void 0!==t?t:n.DefaultLoadingManager,this._parser=e.parse};i.prototype=Object.create(n.CompressedTextureLoader.prototype),i.prototype.constructor=i,i.parse=function(e,t){var r=new Uint32Array(e,0,13),a={buffer:e,header:r,loadMipmaps:t};return 55727696===r[0]?i._parseV3(a):559044176===r[11]?i._parseV2(a):void console.error("THREE.PVRLoader: Unknown PVR format.")},i._parseV3=function(e){var t,r,a=e.header,o=a[12],s=a[2],l=a[6],u=a[7],c=a[10],d=a[11];switch(s){case 0:t=2,r=n.RGB_PVRTC_2BPPV1_Format;break;case 1:t=2,r=n.RGBA_PVRTC_2BPPV1_Format;break;case 2:t=4,r=n.RGB_PVRTC_4BPPV1_Format;break;case 3:t=4,r=n.RGBA_PVRTC_4BPPV1_Format;break;default:console.error("THREE.PVRLoader: Unsupported PVR format:",s)}return e.dataPtr=52+o,e.bpp=t,e.format=r,e.width=u,e.height=l,e.numSurfaces=c,e.numMipmaps=d,e.isCubemap=6===c,i._extract(e)},i._parseV2=function(e){var t,r,a=e.header,o=a[0],s=a[1],l=a[2],u=a[3],c=a[4],d=a[10],f=a[12],h=255&c,p=d>0;return 25===h?(r=p?n.RGBA_PVRTC_4BPPV1_Format:n.RGB_PVRTC_4BPPV1_Format,t=4):24===h?(r=p?n.RGBA_PVRTC_2BPPV1_Format:n.RGB_PVRTC_2BPPV1_Format,t=2):console.error("THREE.PVRLoader: Unknown PVR format:",h),e.dataPtr=o,e.bpp=t,e.format=r,e.width=l,e.height=s,e.numSurfaces=f,e.numMipmaps=u+1,e.isCubemap=6===f,i._extract(e)},i._extract=function(e){var t={mipmaps:[],width:e.width,height:e.height,format:e.format,mipmapCount:e.numMipmaps,isCubemap:e.isCubemap},r=e.buffer,a=e.dataPtr,n=e.bpp,i=e.numSurfaces,o=0,s=0,l=0,u=0,c=0,d=0;2===n?(l=8,u=4):(l=4,u=4),s=l*u*n/8,t.mipmaps.length=e.numMipmaps*i;for(var f=0;f<e.numMipmaps;){var h=e.width>>f,p=e.height>>f;c=h/l,d=p/u,c<2&&(c=2),d<2&&(d=2),o=c*d*s;for(var m=0;m<i;m++){var v=new Uint8Array(r,a,o),g={data:v,width:h,height:p};t.mipmaps[m*e.numMipmaps+f]=g,a+=o}f++}return t},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){try{t(i.parse(e))}catch(e){a&&a(e)}},r,a)},parse:function(e){var t=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(e);return function(e){var t,r,a;if(a=new DataView(e),t=50,r=a.getUint32(80,!0),84+r*t===a.byteLength)return!0;for(var n=[115,111,108,105,100],i=0;i<5;i++)if(n[i]!=a.getUint8(i,!1))return!0;return!1}(t)?function(e){for(var t,r,a,i,o,s,l,u,c=new DataView(e),d=c.getUint32(80,!0),f=!1,h=0;h<70;h++)1129270351==c.getUint32(h,!1)&&82==c.getUint8(h+4)&&61==c.getUint8(h+5)&&(f=!0,i=[],o=c.getUint8(h+6)/255,s=c.getUint8(h+7)/255,l=c.getUint8(h+8)/255,u=c.getUint8(h+9)/255);for(var p=new n.BufferGeometry,m=[],v=[],g=0;g<d;g++){var y=84+50*g,x=c.getFloat32(y,!0),b=c.getFloat32(y+4,!0),A=c.getFloat32(y+8,!0);if(f){var w=c.getUint16(y+48,!0);0==(32768&w)?(t=(31&w)/31,r=(w>>5&31)/31,a=(w>>10&31)/31):(t=o,r=s,a=l)}for(var M=1;M<=3;M++){var T=y+12*M;m.push(c.getFloat32(T,!0)),m.push(c.getFloat32(T+4,!0)),m.push(c.getFloat32(T+8,!0)),v.push(x,b,A),f&&i.push(t,r,a)}}return p.addAttribute("position",new n.BufferAttribute(new Float32Array(m),3)),p.addAttribute("normal",new n.BufferAttribute(new Float32Array(v),3)),f&&(p.addAttribute("color",new n.BufferAttribute(new Float32Array(i),3)),p.hasColors=!0,p.alpha=u),p}(t):function(e){for(var t,r=new n.BufferGeometry,a=/facet([\s\S]*?)endfacet/g,i=0,o=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,s=new RegExp("vertex"+o+o+o,"g"),l=new RegExp("normal"+o+o+o,"g"),u=[],c=[],d=new n.Vector3;null!==(t=a.exec(e));){for(var f=0,h=0,p=t[0];null!==(t=l.exec(p));)d.x=parseFloat(t[1]),d.y=parseFloat(t[2]),d.z=parseFloat(t[3]),h++;for(;null!==(t=s.exec(p));)u.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),c.push(d.x,d.y,d.z),f++;1!==h&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+i),3!==f&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+i),i++}return r.addAttribute("position",new n.Float32BufferAttribute(u,3)),r.addAttribute("normal",new n.Float32BufferAttribute(c,3)),r}(function(e){return"string"!=typeof e?n.LoaderUtils.decodeText(new Uint8Array(e)):e}(e))}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this;new n.FileLoader(i.manager).load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e,a){if(1===e.nodeType){switch(e.nodeName){case"svg":break;case"g":a=f(e,a);break;case"path":a=f(e,a),e.hasAttribute("d")&&h(a)&&v.push(r(e,a));break;case"rect":a=f(e,a),h(a)&&v.push(o(e,a));break;case"polygon":a=f(e,a),h(a)&&v.push(s(e,a));break;case"polyline":a=f(e,a),h(a)&&v.push(l(e,a));break;case"circle":a=f(e,a),h(a)&&v.push(u(e,a));break;case"ellipse":a=f(e,a),h(a)&&v.push(c(e,a));break;case"line":a=f(e,a),h(a)&&v.push(d(e,a));break;default:console.log(e)}for(var n=e.childNodes,i=0;i<n.length;i++)t(n[i],a)}}function r(e,t){var r=new n.ShapePath;r.color.setStyle(t.fill);for(var i=new n.Vector2,o=new n.Vector2,s=e.getAttribute("d"),l=s.match(/[a-df-z][^a-df-z]*/gi),u=0,c=l.length;u<c;u++){var d=l[u],f=d.charAt(0),h=d.substr(1).trim();switch(f){case"M":for(var v=m(h),g=0,y=v.length;g<y;g+=2)i.x=v[g+0],i.y=v[g+1],o.x=i.x,o.y=i.y,r.moveTo(i.x,i.y);break;case"H":for(var v=m(h),g=0,y=v.length;g<y;g++)i.x=v[g],o.x=i.x,o.y=i.y,r.lineTo(i.x,i.y);break;case"V":for(var v=m(h),g=0,y=v.length;g<y;g++)i.y=v[g],o.x=i.x,o.y=i.y,r.lineTo(i.x,i.y);break;case"L":for(var v=m(h),g=0,y=v.length;g<y;g+=2)i.x=v[g+0],i.y=v[g+1],o.x=i.x,o.y=i.y,r.lineTo(i.x,i.y);break;case"C":for(var v=m(h),g=0,y=v.length;g<y;g+=6)r.bezierCurveTo(v[g+0],v[g+1],v[g+2],v[g+3],v[g+4],v[g+5]),o.x=v[g+2],o.y=v[g+3],i.x=v[g+4],i.y=v[g+5];break;case"S":var v=m(h);r.bezierCurveTo(p(i.x,o.x),p(i.y,o.y),v[0],v[1],v[2],v[3]),o.x=v[0],o.y=v[1],i.x=v[2],i.y=v[3];break;case"Q":var v=m(h);r.quadraticCurveTo(v[0],v[1],v[2],v[3]),o.x=v[0],o.y=v[1],i.x=v[2],i.y=v[3];break;case"T":var v=m(h),x=p(i.x,o.x),b=p(i.y,o.y);r.quadraticCurveTo(x,b,v[0],v[1]),o.x=x,o.y=b,i.x=v[0],i.y=v[1];break;case"A":for(var v=m(h),g=0,y=v.length;g<y;g+=7){var A=i.clone();i.x=v[g+5],i.y=v[g+6],o.x=i.x,o.y=i.y,a(r,v[g],v[g+1],v[g+2],v[g+3],v[g+4],A,i)}break;case"m":for(var v=m(h),g=0,y=v.length;g<y;g+=2)i.x+=v[g+0],i.y+=v[g+1],o.x=i.x,o.y=i.y,r.moveTo(i.x,i.y);break;case"h":for(var v=m(h),g=0,y=v.length;g<y;g++)i.x+=v[g],o.x=i.x,o.y=i.y,r.lineTo(i.x,i.y);break;case"v":for(var v=m(h),g=0,y=v.length;g<y;g++)i.y+=v[g],o.x=i.x,o.y=i.y,r.lineTo(i.x,i.y);break;case"l":for(var v=m(h),g=0,y=v.length;g<y;g+=2)i.x+=v[g+0],i.y+=v[g+1],o.x=i.x,o.y=i.y,r.lineTo(i.x,i.y);break;case"c":for(var v=m(h),g=0,y=v.length;g<y;g+=6)r.bezierCurveTo(i.x+v[g+0],i.y+v[g+1],i.x+v[g+2],i.y+v[g+3],i.x+v[g+4],i.y+v[g+5]),i.x+=v[g+4],i.y+=v[g+5];break;case"s":var v=m(h);r.bezierCurveTo(p(i.x,o.x),p(i.y,o.y),i.x+v[0],i.y+v[1],i.x+v[2],i.y+v[3]),o.x=i.x+v[0],o.y=i.y+v[1],i.x+=v[2],i.y+=v[3];break;case"q":var v=m(h);r.quadraticCurveTo(i.x+v[0],i.y+v[1],i.x+v[2],i.y+v[3]),o.x=i.x+v[0],o.y=i.y+v[1],i.x+=v[2],i.y+=v[3];break;case"t":var v=m(h),x=p(i.x,o.x),b=p(i.y,o.y);r.quadraticCurveTo(x,b,i.x+v[0],i.y+v[1]),o.x=x,o.y=b,i.x=i.x+v[0],i.y=i.y+v[1];break;case"a":for(var v=m(h),g=0,y=v.length;g<y;g+=7){var A=i.clone();i.x+=v[g+5],i.y+=v[g+6],o.x=i.x,o.y=i.y,a(r,v[g],v[g+1],v[g+2],v[g+3],v[g+4],A,i)}break;case"Z":case"z":r.currentPath.autoClose=!0;break;default:console.warn(d)}}return r}function a(e,t,r,a,n,o,s,l){a=a*Math.PI/180,t=Math.abs(t),r=Math.abs(r);var u=(s.x-l.x)/2,c=(s.y-l.y)/2,d=Math.cos(a)*u+Math.sin(a)*c,f=-Math.sin(a)*u+Math.cos(a)*c,h=t*t,p=r*r,m=d*d,v=f*f,g=m/h+v/p;if(g>1){var y=Math.sqrt(g);t*=y,r*=y,h=t*t,p=r*r}var x=h*v+p*m,b=(h*p-x)/x,A=Math.sqrt(Math.max(0,b));n===o&&(A=-A);var w=A*t*f/r,M=-A*r*d/t,T=Math.cos(a)*w-Math.sin(a)*M+(s.x+l.x)/2,S=Math.sin(a)*w+Math.cos(a)*M+(s.y+l.y)/2,F=i(1,0,(d-w)/t,(f-M)/r),E=i((d-w)/t,(f-M)/r,(-d-w)/t,(-f-M)/r)%(2*Math.PI);e.currentPath.absellipse(T,S,t,r,F,F+E,0===o,a)}function i(e,t,r,a){var n=e*r+t*a,i=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+a*a),o=Math.acos(Math.max(-1,Math.min(1,n/i)));return e*a-t*r<0&&(o=-o),o}function o(e,t){var r=parseFloat(e.getAttribute("x")||0),a=parseFloat(e.getAttribute("y")||0),i=parseFloat(e.getAttribute("rx")||0),o=parseFloat(e.getAttribute("ry")||0),s=parseFloat(e.getAttribute("width")),l=parseFloat(e.getAttribute("height")),u=new n.ShapePath;return u.color.setStyle(t.fill),u.moveTo(r+2*i,a),u.lineTo(r+s-2*i,a),0===i&&0===o||u.bezierCurveTo(r+s,a,r+s,a,r+s,a+2*o),u.lineTo(r+s,a+l-2*o),0===i&&0===o||u.bezierCurveTo(r+s,a+l,r+s,a+l,r+s-2*i,a+l),u.lineTo(r+2*i,a+l),0===i&&0===o||(u.bezierCurveTo(r,a+l,r,a+l,r,a+l-2*o),u.lineTo(r,a+2*o),u.bezierCurveTo(r,a,r,a,r+2*i,a)),u}function s(e,t){function r(e,t,r){var a=parseFloat(t),n=parseFloat(r);0===o?i.moveTo(a,n):i.lineTo(a,n),o++}var a=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new n.ShapePath;i.color.setStyle(t.fill);var o=0;return e.getAttribute("points").replace(a,r),i.currentPath.autoClose=!0,i}function l(e,t){function r(e,t,r){var a=parseFloat(t),n=parseFloat(r);0===o?i.moveTo(a,n):i.lineTo(a,n),o++}var a=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new n.ShapePath;i.color.setStyle(t.fill);var o=0;return e.getAttribute("points").replace(a,r),i.currentPath.autoClose=!1,i}function u(e,t){var r=parseFloat(e.getAttribute("cx")),a=parseFloat(e.getAttribute("cy")),i=parseFloat(e.getAttribute("r")),o=new n.Path;o.absarc(r,a,i,0,2*Math.PI);var s=new n.ShapePath;return s.color.setStyle(t.fill),s.subPaths.push(o),s}function c(e,t){var r=parseFloat(e.getAttribute("cx")),a=parseFloat(e.getAttribute("cy")),i=parseFloat(e.getAttribute("rx")),o=parseFloat(e.getAttribute("ry")),s=new n.Path;s.absellipse(r,a,i,o,0,2*Math.PI);var l=new n.ShapePath;return l.color.setStyle(t.fill),l.subPaths.push(s),l}function d(e,t){var r=parseFloat(e.getAttribute("x1")),a=parseFloat(e.getAttribute("y1")),i=parseFloat(e.getAttribute("x2")),o=parseFloat(e.getAttribute("y2")),s=new n.ShapePath;return s.moveTo(r,a),s.lineTo(i,o),s.currentPath.autoClose=!1,s}function f(e,t){return t=Object.assign({},t),e.hasAttribute("fill")&&(t.fill=e.getAttribute("fill")),""!==e.style.fill&&(t.fill=e.style.fill),t}function h(e){return"none"!==e.fill&&"transparent"!==e.fill}function p(e,t){return 2*e-(t-e)}function m(e){for(var t=e.split(/[\s,]+|(?=\s?[+\-])/),r=0;r<t.length;r++)t[r]=parseFloat(t[r]);return t}console.log("THREE.SVGLoader");var v=[];console.time("THREE.SVGLoader: DOMParser");var g=(new DOMParser).parseFromString(e,"image/svg+xml");return console.timeEnd("THREE.SVGLoader: DOMParser"),console.time("THREE.SVGLoader: Parse"),t(g.documentElement,{fill:"#000"}),console.timeEnd("THREE.SVGLoader: Parse"),v}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=void 0!==this.path?this.path:n.LoaderUtils.extractUrlBase(e),s=new n.FileLoader(this.manager);s.setResponseType("arraybuffer"),s.load(e,function(e){t(i.parse(e,o))},r,a)},parse:function(e,t){this.group=new n.Group,this.position=0,this.materials=[],this.meshes=[],this.readFile(e,t);for(var r=0;r<this.meshes.length;r++)this.group.add(this.meshes[r]);return this.group},readFile:function(e,t){var r=new DataView(e),a=this.readChunk(r);if(a.id===s||a.id===l||a.id===o)for(var n=this.nextChunk(r,a);0!==n;){if(n===u){var i=this.readDWord(r);this.debugMessage("3DS file version: "+i)}else n===p?(this.resetPosition(r),this.readMeshData(r,t)):this.debugMessage("Unknown main chunk: "+n.toString(16));n=this.nextChunk(r,a)}this.debugMessage("Parsed "+this.meshes.length+" meshes")},readMeshData:function(e,t){for(var r=this.readChunk(e),a=this.nextChunk(e,r);0!==a;){if(a===m){var n=+this.readDWord(e);this.debugMessage("Mesh Version: "+n)}else if(a===v){var i=this.readFloat(e);this.debugMessage("Master scale: "+i),this.group.scale.set(i,i,i)}else a===D?(this.debugMessage("Named Object"),this.resetPosition(e),this.readNamedObject(e)):a===g?(this.debugMessage("Material"),this.resetPosition(e),this.readMaterialEntry(e,t)):this.debugMessage("Unknown MDATA chunk: "+a.toString(16));a=this.nextChunk(e,r)}},readNamedObject:function(e){var t=this.readChunk(e),r=this.readString(e,64);t.cur=this.position;for(var a=this.nextChunk(e,t);0!==a;){if(a===R){this.resetPosition(e);var n=this.readMesh(e);n.name=r,this.meshes.push(n)}else this.debugMessage("Unknown named object chunk: "+a.toString(16));a=this.nextChunk(e,t)}this.endChunk(t)},readMaterialEntry:function(e,t){for(var r=this.readChunk(e),a=this.nextChunk(e,r),i=new n.MeshPhongMaterial;0!==a;){if(a===y)i.name=this.readString(e,64),this.debugMessage("   Name: "+i.name);else if(a===S)this.debugMessage("   Wireframe"),i.wireframe=!0;else if(a===F){var o=this.readByte(e);i.wireframeLinewidth=o,this.debugMessage("   Wireframe Thickness: "+o)}else if(a===M)i.side=n.DoubleSide,this.debugMessage("   DoubleSided");else if(a===T)this.debugMessage("   Additive Blending"),i.blending=n.AdditiveBlending;else if(a===b)this.debugMessage("   Diffuse Color"),i.color=this.readColor(e);else if(a===A)this.debugMessage("   Specular Color"),i.specular=this.readColor(e);else if(a===x)this.debugMessage("   Ambient color"),i.color=this.readColor(e);else if(a===w){var s=this.readWord(e);i.shininess=s,this.debugMessage("   Shininess : "+s)}else a===E?(this.debugMessage("   ColorMap"),this.resetPosition(e),i.map=this.readMap(e,t)):a===P?(this.debugMessage("   BumpMap"),this.resetPosition(e),i.bumpMap=this.readMap(e,t)):a===_?(this.debugMessage("   OpacityMap"),this.resetPosition(e),i.alphaMap=this.readMap(e,t)):a===L?(this.debugMessage("   SpecularMap"),this.resetPosition(e),i.specularMap=this.readMap(e,t)):this.debugMessage("   Unknown material chunk: "+a.toString(16));a=this.nextChunk(e,r)}this.endChunk(r),this.materials[i.name]=i},readMesh:function(e){var t=this.readChunk(e),r=this.nextChunk(e,t),a=null,i=[];a=new n.Geometry;var o=new n.MeshPhongMaterial,s=new n.Mesh(a,o);for(s.name="mesh";0!==r;){if(r===k){var l=this.readWord(e);this.debugMessage("   Vertex: "+l);for(var u,u=0;u<l;u++)a.vertices.push(new n.Vector3(this.readFloat(e),this.readFloat(e),this.readFloat(e)))}else if(r===B)this.resetPosition(e),this.readFaceArray(e,s);else if(r===V){var c=this.readWord(e);this.debugMessage("   UV: "+c);var i,u;i=[];for(var u=0;u<c;u++)i.push(new n.Vector2(this.readFloat(e),this.readFloat(e)))}else if(r===G){this.debugMessage("   Tranformation Matrix (TODO)");for(var d=[],u=0;u<12;u++)d[u]=this.readFloat(e);var f=new n.Matrix4;f.elements[0]=d[0],f.elements[1]=d[6],f.elements[2]=d[3],f.elements[3]=d[9],f.elements[4]=d[2],f.elements[5]=d[8],f.elements[6]=d[5],f.elements[7]=d[11],f.elements[8]=d[1],f.elements[9]=d[7],f.elements[10]=d[4],f.elements[11]=d[10],f.elements[12]=0,f.elements[13]=0,f.elements[14]=0,f.elements[15]=1,f.transpose();var h=new n.Matrix4;h.getInverse(f,!0),a.applyMatrix(h),f.decompose(s.position,s.quaternion,s.scale)}else this.debugMessage("   Unknown mesh chunk: "+r.toString(16));r=this.nextChunk(e,t)}if(this.endChunk(t),i.length>0){for(var p=[],u=0;u<a.faces.length;u++)p.push([i[a.faces[u].a],i[a.faces[u].b],i[a.faces[u].c]]);a.faceVertexUvs[0]=p}return a.computeVertexNormals(),s},readFaceArray:function(e,t){var r=this.readChunk(e),a=this.readWord(e);this.debugMessage("   Faces: "+a);for(var i=0;i<a;++i){t.geometry.faces.push(new n.Face3(this.readWord(e),this.readWord(e),this.readWord(e)));this.readWord(e)}for(;this.position<r.end;){var r=this.readChunk(e);if(r.id===j){this.debugMessage("      Material Group"),this.resetPosition(e);var o=this.readMaterialGroup(e),s=this.materials[o.name];void 0!==s&&(t.material=s,""===s.name&&(s.name=t.name))}else this.debugMessage("      Unknown face array chunk: "+r.toString(16));this.endChunk(r)}this.endChunk(r)},readMap:function(e,t){var r=this.readChunk(e),a=this.nextChunk(e,r),i={},o=new n.TextureLoader(this.manager);for(o.setPath(t);0!==a;){if(a===C){var s=this.readString(e,128);i=o.load(s),this.debugMessage("      File: "+t+s)}else a===I?(i.offset.x=this.readFloat(e),this.debugMessage("      OffsetX: "+i.offset.x)):a===U?(i.offset.y=this.readFloat(e),this.debugMessage("      OffsetY: "+i.offset.y)):a===N?(i.repeat.x=this.readFloat(e),this.debugMessage("      RepeatX: "+i.repeat.x)):a===O?(i.repeat.y=this.readFloat(e),this.debugMessage("      RepeatY: "+i.repeat.y)):this.debugMessage("      Unknown map chunk: "+a.toString(16));a=this.nextChunk(e,r)}return this.endChunk(r),i},readMaterialGroup:function(e){var t=(this.readChunk(e),this.readString(e,64)),r=this.readWord(e);this.debugMessage("         Name: "+t),this.debugMessage("         Faces: "+r);for(var a=[],n=0;n<r;++n)a.push(this.readWord(e));return{name:t,index:a}},readColor:function(e){var t=this.readChunk(e),r=new n.Color;if(t.id===d||t.id===f){var a=this.readByte(e),i=this.readByte(e),o=this.readByte(e);r.setRGB(a/255,i/255,o/255),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else if(t.id===c||t.id===h){var a=this.readFloat(e),i=this.readFloat(e),o=this.readFloat(e);r.setRGB(a,i,o),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else this.debugMessage("      Unknown color chunk: "+t.toString(16));return this.endChunk(t),r},readChunk:function(e){var t={};return t.cur=this.position,t.id=this.readWord(e),t.size=this.readDWord(e),t.end=t.cur+t.size,t.cur+=6,t},endChunk:function(e){this.position=e.end},nextChunk:function(e,t){if(t.cur>=t.end)return 0;this.position=t.cur;try{var r=this.readChunk(e);return t.cur+=r.size,r.id}catch(e){return this.debugMessage("Unable to read chunk at "+this.position),0}},resetPosition:function(){this.position-=6},readByte:function(e){var t=e.getUint8(this.position,!0);return this.position+=1,t},readFloat:function(e){try{var t=e.getFloat32(this.position,!0);return this.position+=4,t}catch(t){this.debugMessage(t+" "+this.position+" "+e.byteLength)}},readInt:function(e){var t=e.getInt32(this.position,!0);return this.position+=4,t},readShort:function(e){var t=e.getInt16(this.position,!0);return this.position+=2,t},readDWord:function(e){var t=e.getUint32(this.position,!0);return this.position+=4,t},readWord:function(e){var t=e.getUint16(this.position,!0);return this.position+=2,t},readString:function(e,t){for(var r="",a=0;a<t;a++){var n=this.readByte(e);if(!n)break;r+=String.fromCharCode(n)}return r},setPath:function(e){return this.path=e,this},debugMessage:function(e){this.debug&&console.log(e)}};var o=19789,s=15786,l=49725,u=2,c=16,d=17,f=18,h=19,p=15677,m=15678,v=256,g=45055,y=40960,x=40976,b=40992,A=41008,w=41024,M=41089,T=41091,S=41093,F=41095,E=41472,_=41488,P=41520,L=41476,C=41728,N=41812,O=41814,I=41816,U=41818,D=16384,R=16640,k=16656,B=16672,j=16688,V=16704,G=16736;t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.Texture,s=new n.FileLoader(this.manager);return s.setResponseType("arraybuffer"),s.load(e,function(e){o.image=i.parse(e),o.needsUpdate=!0,void 0!==t&&t(o)},r,a),o},parse:function(e){function t(e,t,r,a,n,i,o,s,l){var u,c,d,f=l,h=0,p=w.width;for(d=t;d!==a;d+=r)for(c=n;c!==o;c+=i,h++)u=s[h],e[4*(c+p*d)+3]=255,e[4*(c+p*d)+2]=f[3*u+0],e[4*(c+p*d)+1]=f[3*u+1],e[4*(c+p*d)+0]=f[3*u+2];return e}function r(e,t,r,a,n,i,o,s){var l,u,c,d=0,f=w.width;for(c=t;c!==a;c+=r)for(u=n;u!==o;u+=i,d+=2)l=s[d+0]+(s[d+1]<<8),e[4*(u+f*c)+0]=(31744&l)>>7,e[4*(u+f*c)+1]=(992&l)>>2,e[4*(u+f*c)+2]=(31&l)>>3,e[4*(u+f*c)+3]=32768&l?0:255;return e}function a(e,t,r,a,n,i,o,s){var l,u,c=0,d=w.width;for(u=t;u!==a;u+=r)for(l=n;l!==o;l+=i,c+=3)e[4*(l+d*u)+3]=255,e[4*(l+d*u)+2]=s[c+0],e[4*(l+d*u)+1]=s[c+1],e[4*(l+d*u)+0]=s[c+2];return e}function n(e,t,r,a,n,i,o,s){var l,u,c=0,d=w.width;for(u=t;u!==a;u+=r)for(l=n;l!==o;l+=i,c+=4)e[4*(l+d*u)+2]=s[c+0],e[4*(l+d*u)+1]=s[c+1],e[4*(l+d*u)+0]=s[c+2],e[4*(l+d*u)+3]=s[c+3];return e}function i(e,t,r,a,n,i,o,s){var l,u,c,d=0,f=w.width;for(c=t;c!==a;c+=r)for(u=n;u!==o;u+=i,d++)l=s[d],e[4*(u+f*c)+0]=l,e[4*(u+f*c)+1]=l,e[4*(u+f*c)+2]=l,e[4*(u+f*c)+3]=255;return e}function o(e,t,r,a,n,i,o,s){var l,u,c=0,d=w.width;for(u=t;u!==a;u+=r)for(l=n;l!==o;l+=i,c+=2)e[4*(l+d*u)+0]=s[c+0],e[4*(l+d*u)+1]=s[c+0],e[4*(l+d*u)+2]=s[c+0],e[4*(l+d*u)+3]=s[c+1];return e}var s=0,l=1,u=2,c=3,d=9,f=10,h=11,p=48,m=4,v=0,g=1,y=2,x=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var b=new Uint8Array(e),A=0,w={id_length:b[A++],colormap_type:b[A++],image_type:b[A++],colormap_index:b[A++]|b[A++]<<8,colormap_length:b[A++]|b[A++]<<8,colormap_size:b[A++],origin:[b[A++]|b[A++]<<8,b[A++]|b[A++]<<8],width:b[A++]|b[A++]<<8,height:b[A++]|b[A++]<<8,pixel_size:b[A++],flags:b[A++]};!function(e){switch(e.image_type){case l:case d:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case u:case c:case f:case h:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case s:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(w),w.id_length+A>e.length&&console.error("THREE.TGALoader: No data."),A+=w.id_length;var M=!1,T=!1,S=!1;switch(w.image_type){case d:M=!0,T=!0;break;case l:T=!0;break;case f:M=!0;break;case u:break;case h:M=!0,S=!0;break;case c:S=!0}var F=document.createElement("canvas");F.width=w.width,F.height=w.height;var E=F.getContext("2d"),_=E.createImageData(w.width,w.height),P=function(e,t,r,a,n){var i,o,s,l;if(o=r.pixel_size>>3,s=r.width*r.height*o,t&&(l=n.subarray(a,a+=r.colormap_length*(r.colormap_size>>3))),e){i=new Uint8Array(s);for(var u,c,d,f=0,h=new Uint8Array(o);f<s;)if(u=n[a++],c=1+(127&u),128&u){for(d=0;d<o;++d)h[d]=n[a++];for(d=0;d<c;++d)i.set(h,f+d*o);f+=o*c}else{for(c*=o,d=0;d<c;++d)i[f+d]=n[a++];f+=c}}else i=n.subarray(a,a+=t?r.width*r.height:s);return{pixel_data:i,palettes:l}}(M,T,w,A,b);!function(e,s,l,u,c){var d,f,h,b,A,M;switch((w.flags&p)>>m){default:case y:d=0,h=1,A=s,f=0,b=1,M=l;break;case v:d=0,h=1,A=s,f=l-1,b=-1,M=-1;break;case x:d=s-1,h=-1,A=-1,f=0,b=1,M=l;break;case g:d=s-1,h=-1,A=-1,f=l-1,b=-1,M=-1}if(S)switch(w.pixel_size){case 8:i(e,f,b,M,d,h,A,u);break;case 16:o(e,f,b,M,d,h,A,u);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(w.pixel_size){case 8:t(e,f,b,M,d,h,A,u,c);break;case 16:r(e,f,b,M,d,h,A,u);break;case 24:a(e,f,b,M,d,h,A,u);break;case 32:n(e,f,b,M,d,h,A,u);break;default:console.error("THREE.TGALoader: Format not supported.")}}(_.data,w.width,w.height,P.pixel_data,P.palettes);return E.putImageData(_,0,0),F}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager,this.reversed=!1};i.prototype={constructor:i,load:function(e,t,r,a){var i=this,o=new n.FileLoader(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e){var t,r=[];e.forEach(function(e){"m"===e.type.toLowerCase()?(t=[e],r.push(t)):"z"!==e.type.toLowerCase()&&t.push(e)});var a=[];return r.forEach(function(e){var t={type:"m",x:e[e.length-1].x,y:e[e.length-1].y};a.push(t);for(var r=e.length-1;r>0;r--){var n=e[r],t={type:n.type};void 0!==n.x2&&void 0!==n.y2?(t.x1=n.x2,t.y1=n.y2,t.x2=n.x1,t.y2=n.y1):void 0!==n.x1&&void 0!==n.y1&&(t.x1=n.x1,t.y1=n.y1),t.x=e[r-1].x,t.y=e[r-1].y,a.push(t)}}),a}return"undefined"==typeof opentype?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(e,r){for(var a=Math.round,n={},i=1e5/(72*(e.unitsPerEm||2048)),o=0;o<e.glyphs.length;o++){var s=e.glyphs.glyphs[o];if(void 0!==s.unicode){var l={ha:a(s.advanceWidth*i),x_min:a(s.xMin*i),x_max:a(s.xMax*i),o:""};r&&(s.path.commands=t(s.path.commands)),s.path.commands.forEach(function(e,t){"c"===e.type.toLowerCase()&&(e.type="b"),l.o+=e.type.toLowerCase()+" ",void 0!==e.x&&void 0!==e.y&&(l.o+=a(e.x*i)+" "+a(e.y*i)+" "),void 0!==e.x1&&void 0!==e.y1&&(l.o+=a(e.x1*i)+" "+a(e.y1*i)+" "),void 0!==e.x2&&void 0!==e.y2&&(l.o+=a(e.x2*i)+" "+a(e.y2*i)+" ")}),n[String.fromCharCode(s.unicode)]=l}}return{glyphs:n,familyName:e.familyName,ascender:a(e.ascender*i),descender:a(e.descender*i),underlinePosition:e.tables.post.underlinePosition,underlineThickness:e.tables.post.underlineThickness,boundingBox:{xMin:e.tables.head.xMin,xMax:e.tables.head.xMax,yMin:e.tables.head.yMin,yMax:e.tables.head.yMax},resolution:1e3,original_font_information:e.tables.name}}(opentype.parse(e),this.reversed)}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};i.prototype={constructor:i,isRecordingPoints:!1,isRecordingFaces:!1,points:[],indexes:[],isRecordingAngles:!1,isRecordingColors:!1,angles:[],colors:[],recordingFieldname:null,crossOrigin:"Anonymous",load:function(e,t,r,a){var i=this;new n.FileLoader(this.manager).load(e,function(e){t(i.parse(e))},r,a)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=this.texturePath||"",r=new n.TextureLoader(this.manager);r.setCrossOrigin(this.crossOrigin);for(var a=new n.Scene,i=e.split("\n"),o=i.length-1;o>-1;o--){var s=i[o];if(/{.*[{\[]/.test(s)){var l=s.split("{").join("{\n").split("\n");l.unshift(1),l.unshift(o),i.splice.apply(i,l)}else if(/\].*}/.test(s)){var l=s.split("]").join("]\n").split("\n");l.unshift(1),l.unshift(o),i.splice.apply(i,l)}if(/}.*}/.test(s)){var l=s.split("}").join("}\n").split("\n");l.unshift(1),l.unshift(o),i.splice.apply(i,l)}/^\b[^\s]+\b$/.test(s.trim())?(i[o+1]=s+" "+i[o+1].trim(),i.splice(o,1)):s.indexOf("coord")>-1&&s.indexOf("[")<0&&s.indexOf("{")<0&&(i[o]+=" Coordinate {}")}var u=i.shift();return/V1.0/.exec(u)?console.warn("THREE.VRMLLoader: V1.0 not supported yet."):/V2.0/.exec(u)&&function(e,a){function i(e,t,r,a,i){for(var o=!0===i?1:-1,s=[],l={},u={},c=0;c<r.length;c++){var d={x:o*(Math.cos(r[c])*t),y:o*(Math.sin(r[c])*t)};s.push(d)}for(var f=e.index,h=e.attributes.position,p=new n.BufferAttribute(new Float32Array(3*e.attributes.position.count),3),m=new n.Vector3,v=new n.Color,g=0;g<f.count;g++){var y=f.getX(g);m.fromBufferAttribute(h,y);for(var x=0;x<a.length;x++)if(0===x?(l.x=0,l.y=!0===i?t:-1*t):(l.x=s[x-1].x,l.y=s[x-1].y),void 0!==(u=s[x]))if(!0==(!0===i?m.y<=l.y&&m.y>u.y:m.y>=l.y&&m.y<u.y)){var b=a[x],A=a[x+1],w=Math.abs(m.y-l.y)/(l.y-u.y);v.copy(b).lerp(A,w),p.setXYZ(y,v.r,v.g,v.b)}else{var M=!0===i?a.length-1:0,T=a[M];p.setXYZ(y,T.r,T.g,T.b)}}e.addAttribute("color",p)}function o(e,t){for(var r,a,n,i=[],o={},s=/[^\s,\[\]]+/g;null!==(r=s.exec(t));)i.push(r[0]);switch(a=i[0]){case"skyAngle":case"groundAngle":this.recordingFieldname=a,this.isRecordingAngles=!0,this.angles=[];break;case"skyColor":case"groundColor":this.recordingFieldname=a,this.isRecordingColors=!0,this.colors=[];break;case"point":this.recordingFieldname=a,this.isRecordingPoints=!0,this.points=[];break;case"coordIndex":case"texCoordIndex":this.recordingFieldname=a,this.isRecordingFaces=!0,this.indexes=[]}if(this.isRecordingFaces){if(i.length>0)for(var l=0;l<i.length;l++)/(-?\d+)/.test(i[l])&&("-1"===i[l]?(f.length>0&&this.indexes.push(f),f=[]):f.push(parseInt(i[l])));/]/.exec(t)&&(f.length>0&&this.indexes.push(f),f=[],this.isRecordingFaces=!1,e[this.recordingFieldname]=this.indexes)}else if(this.isRecordingPoints){if("Coordinate"==e.nodeType)for(;null!==(i=d.exec(t));)n={x:parseFloat(i[1]),y:parseFloat(i[2]),z:parseFloat(i[3])},this.points.push(n);if("TextureCoordinate"==e.nodeType)for(;null!==(i=c.exec(t));)n={x:parseFloat(i[1]),y:parseFloat(i[2])},this.points.push(n);/]/.exec(t)&&(this.isRecordingPoints=!1,e.points=this.points)}else if(this.isRecordingAngles){if(i.length>0)for(var l=0;l<i.length;l++)u.test(i[l])&&this.angles.push(parseFloat(i[l]));/]/.exec(t)&&(this.isRecordingAngles=!1,e[this.recordingFieldname]=this.angles)}else if(this.isRecordingColors){for(;null!==(i=d.exec(t));){var h={r:parseFloat(i[1]),g:parseFloat(i[2]),b:parseFloat(i[3])};this.colors.push(h)}/]/.exec(t)&&(this.isRecordingColors=!1,e[this.recordingFieldname]=this.colors)}else if("NULL"!==i[i.length-1]&&"children"!==a){switch(a){case"diffuseColor":case"emissiveColor":case"specularColor":case"color":if(4!==i.length){console.warn("THREE.VRMLLoader: Invalid color format detected for %s.",a);break}o={r:parseFloat(i[1]),g:parseFloat(i[2]),b:parseFloat(i[3])};break;case"location":case"direction":case"translation":case"scale":case"size":if(4!==i.length){console.warn("THREE.VRMLLoader: Invalid vector format detected for %s.",a);break}o={x:parseFloat(i[1]),y:parseFloat(i[2]),z:parseFloat(i[3])};break;case"intensity":case"cutOffAngle":case"radius":case"topRadius":case"bottomRadius":case"height":case"transparency":case"shininess":case"ambientIntensity":if(2!==i.length){console.warn("THREE.VRMLLoader: Invalid single float value specification detected for %s.",a);break}o=parseFloat(i[1]);break;case"rotation":if(5!==i.length){console.warn("THREE.VRMLLoader: Invalid quaternion format detected for %s.",a);break}o={x:parseFloat(i[1]),y:parseFloat(i[2]),z:parseFloat(i[3]),w:parseFloat(i[4])};break;case"on":case"ccw":case"solid":case"colorPerVertex":case"convex":if(2!==i.length){console.warn("THREE.VRMLLoader: Invalid format detected for %s.",a);break}o="TRUE"===i[1]}e[a]=o}return o}function s(e,o){var u;if("string"!=typeof e){u=o,e.string.indexOf("AmbientLight")>-1&&"PointLight"===e.nodeType&&(e.nodeType="AmbientLight");var c=void 0===e.on||e.on,d=void 0!==e.intensity?e.intensity:1,f=new n.Color;if(e.color&&f.copy(e.color),"AmbientLight"===e.nodeType)u=new n.AmbientLight(f,d),u.visible=c,o.add(u);else if("PointLight"===e.nodeType){var h=0;void 0!==e.radius&&e.radius<1e3&&(h=e.radius),u=new n.PointLight(f,d,h),u.visible=c,o.add(u)}else if("SpotLight"===e.nodeType){var d=1,h=0,p=Math.PI/3,c=!0;void 0!==e.radius&&e.radius<1e3&&(h=e.radius),void 0!==e.cutOffAngle&&(p=e.cutOffAngle),u=new n.SpotLight(f,d,h,p,0),u.visible=c,o.add(u)}else if("Transform"===e.nodeType||"Group"===e.nodeType){if(u=new n.Object3D,/DEF/.exec(e.string)&&(u.name=/DEF\s+([^\s]+)/.exec(e.string)[1],l[u.name]=u),void 0!==e.translation){var m=e.translation;u.position.set(m.x,m.y,m.z)}if(void 0!==e.rotation){var v=e.rotation;u.quaternion.setFromAxisAngle(new n.Vector3(v.x,v.y,v.z),v.w)}if(void 0!==e.scale){var g=e.scale;u.scale.set(g.x,g.y,g.z)}o.add(u)}else if("Shape"===e.nodeType)u=new n.Mesh,/DEF/.exec(e.string)&&(u.name=/DEF\s+([^\s]+)/.exec(e.string)[1],l[u.name]=u),o.add(u);else if("Background"===e.nodeType){var y=2e4,x=new n.SphereBufferGeometry(y,20,20),b=new n.MeshBasicMaterial({fog:!1,side:n.BackSide});if(e.skyColor.length>1)i(x,y,e.skyAngle,e.skyColor,!0),b.vertexColors=n.VertexColors;else{var A=e.skyColor[0];b.color.setRGB(A.r,A.b,A.g)}if(a.add(new n.Mesh(x,b)),void 0!==e.groundColor){y=12e3;var w=new n.SphereBufferGeometry(y,20,20,0,2*Math.PI,.5*Math.PI,1.5*Math.PI),M=new n.MeshBasicMaterial({fog:!1,side:n.BackSide,vertexColors:n.VertexColors});i(w,y,e.groundAngle,e.groundColor,!1),a.add(new n.Mesh(w,M))}}else{if(/geometry/.exec(e.string)){if("Box"===e.nodeType){var g=e.size;o.geometry=new n.BoxBufferGeometry(g.x,g.y,g.z)}else if("Cylinder"===e.nodeType)o.geometry=new n.CylinderBufferGeometry(e.radius,e.radius,e.height);else if("Cone"===e.nodeType)o.geometry=new n.CylinderBufferGeometry(e.topRadius,e.bottomRadius,e.height);else if("Sphere"===e.nodeType)o.geometry=new n.SphereBufferGeometry(e.radius);else if("IndexedFaceSet"===e.nodeType){var T,S,F,E,_,P,L=new n.BufferGeometry,C=[],N=[];for(F=0,E=e.children.length;F<E;F++){var O=e.children[F];if("TextureCoordinate"===O.nodeType&&O.points)for(_=0,P=O.points.length;_<P;_++)S=O.points[_],N.push(S.x,S.y);if("Coordinate"===O.nodeType){if(O.points)for(_=0,P=O.points.length;_<P;_++)T=O.points[_],C.push(T.x,T.y,T.z);if(O.string.indexOf("DEF")>-1){var I=/DEF\s+([^\s]+)/.exec(O.string)[1];l[I]=C.slice(0)}if(O.string.indexOf("USE")>-1){var U=/USE\s+([^\s]+)/.exec(O.string)[1];C=l[U]}}}var D=0;if(e.coordIndex){var R=[],k=[];for(T=new n.Vector3,S=new n.Vector2,F=0,E=e.coordIndex.length;F<E;F++){var B=e.coordIndex[F];for(D=0;B.length>=3&&D<B.length-2;){void 0===e.ccw&&(e.ccw=!0);var j=B[0],V=B[D+(e.ccw?1:2)],G=B[D+(e.ccw?2:1)];T.fromArray(C,3*j),S.fromArray(N,2*j),R.push(T.x,T.y,T.z),k.push(S.x,S.y),T.fromArray(C,3*V),S.fromArray(N,2*V),R.push(T.x,T.y,T.z),k.push(S.x,S.y),T.fromArray(C,3*G),S.fromArray(N,2*G),R.push(T.x,T.y,T.z),k.push(S.x,S.y),D++}}C=R,N=k}else o.parent.remove(o);!1===e.solid&&(o.material.side=n.DoubleSide),L.solid=e.solid,L.addAttribute("position",new n.Float32BufferAttribute(C,3)),N.length>0&&L.addAttribute("uv",new n.Float32BufferAttribute(N,2)),L.computeVertexNormals(),L.computeBoundingSphere(),/DEF/.exec(e.string)&&(L.name=/DEF ([^\s]+)/.exec(e.string)[1],l[L.name]=L),o.geometry=L}return}if(/appearance/.exec(e.string)){for(var F=0;F<e.children.length;F++){var O=e.children[F];if("Material"===O.nodeType){var z=new n.MeshPhongMaterial;if(void 0!==O.diffuseColor){var H=O.diffuseColor;z.color.setRGB(H.r,H.g,H.b)}if(void 0!==O.emissiveColor){var X=O.emissiveColor;z.emissive.setRGB(X.r,X.g,X.b)}if(void 0!==O.specularColor){var g=O.specularColor;z.specular.setRGB(g.r,g.g,g.b)}if(void 0!==O.transparency){var m=O.transparency;z.opacity=Math.abs(1-m),z.transparent=!0}/DEF/.exec(e.string)&&(z.name=/DEF ([^\s]+)/.exec(e.string)[1],l[z.name]=z),o.material=z}if("ImageTexture"===O.nodeType){var Y=/"([^"]+)"/.exec(O.children[0]);Y&&(o.material.name=Y[1],o.material.map=r.load(t+Y[1]))}}return}}for(var F=0,W=e.children.length;F<W;F++)s(e.children[F],u)}else if(/USE/.exec(e)){var U=/USE\s+?([^\s]+)/.exec(e)[1];void 0==l[U]?console.warn("THREE.VRMLLoader: %s is not defined.",U):/appearance/.exec(e)&&U?o.material=l[U].clone():/geometry/.exec(e)&&U?(o.geometry=l[U].clone(),void 0!==l[U].solid&&!1===l[U].solid&&(o.geometry.solid=!1,o.material.side=n.DoubleSide)):U&&(u=l[U].clone(),o.add(u))}}var l={},u=/(\b|\-|\+)([\d\.e]+)/,c=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g,d=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g,f=[];s(function(e){for(var t,r,a={string:"Scene",children:[]},n=a,i=0;i<e.length;i++){var s="",l=e[i];if(null===/^\s+?$/g.exec(l)&&""!==(l=l.trim())){if(/#/.exec(l)){var u=l.split("#");l=u[0],s=u[1]}if(t=/([^\s]*){1}(?:\s+)?{/.exec(l)){var c={nodeType:t[1],string:l,parent:n,children:[],comment:s};n.children.push(c),n=c,/}/.exec(l)&&(r=/{(.*)}/.exec(l)[1],c.children.push(r),o(n,r),n=n.parent)}else/}/.exec(l)?n=n.parent:""!==l&&(o(n,l),n.children.push(l))}}return a}(e),a)}(i,a),a}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=r(5),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(){function e(e){if(void 0===o.default)throw new Error("VRMLoader: Import GLTFLoader.");this.manager=void 0!==e?e:n.DefaultLoadingManager,this.gltfLoader=new o.default(this.manager)}return e.prototype={constructor:e,crossOrigin:"Anonymous",load:function(e,t,r,a){this.gltfLoader.load(e,t,r,a)},setCrossOrigin:function(e){return this.glTFLoader.setCrossOrigin(e),this},setPath:function(e){return this.glTFLoader.setPath(e),this},setDRACOLoader:function(e){return this.glTFLoader.setDRACOLoader(e),this}},e}();t.default=s},function(e,t,r){"use strict";function a(e,t,r){(new o.FileLoader).load(e,t,r)}function n(e,t){a(e,function(e){t(JSON.parse(e))},function(){})}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),s=function(){};s.prototype.load=function(e,t,r){this.downloadModelJson(e,t,r)},s.BufferGeometryCreator=function(){},s.BufferGeometryCreator.prototype.create=function(e,t){var r,a,n,i=t.length/3,s=new o.BufferGeometry,l=new Float32Array(3*i*3),u=new Float32Array(3*i*3),c=new Float32Array(3*i*2),d=e.length;for(a=0,n=0,r=n;r<d;r+=8)l[a++]=e[r],l[a++]=e[r+1],l[a++]=e[r+2];for(a=0,n=3,r=n;r<d;r+=8)c[a++]=e[r],c[a++]=e[r+1];for(a=0,n=5,r=n;r<d;r+=8)u[a++]=e[r],u[a++]=e[r+1],u[a++]=e[r+2];return s.setIndex(new o.BufferAttribute(t,1)),s.addAttribute("position",new o.BufferAttribute(l,3)),s.addAttribute("normal",new o.BufferAttribute(u,3)),s.addAttribute("uv",new o.BufferAttribute(c,2)),s.computeBoundingSphere(),s};var l={decodeOffsets:[-4095,-4095,-4095,0,0,-511,-511,-511],decodeScales:[1/8191,1/8191,1/8191,1/1023,1/1023,1/1023,1/1023,1/1023]};s.prototype.decompressAttribsInner_=function(e,t,r,a,n,i,o,s){for(var l=0,u=t;u<r;u++){var c=e.charCodeAt(u);l+=c>>1^-(1&c),a[n]=s*(l+o),n+=i}},s.prototype.decompressIndices_=function(e,t,r,a,n){for(var i=0,o=0;o<r;o++){var s=e.charCodeAt(t++);a[n++]=i-s,0===s&&i++}},s.prototype.decompressAABBs_=function(e,t,r,a,n){for(var i=6*r,o=t+i,s=0,l=new Float32Array(i),u=t;u<o;u+=6){var c=e.charCodeAt(u+0)+a[0],d=e.charCodeAt(u+1)+a[1],f=e.charCodeAt(u+2)+a[2],h=e.charCodeAt(u+3)+1>>1,p=e.charCodeAt(u+4)+1>>1,m=e.charCodeAt(u+5)+1>>1;l[s++]=n[0]*(c+h),l[s++]=n[1]*(d+p),l[s++]=n[2]*(f+m),l[s++]=n[0]*h,l[s++]=n[1]*p,l[s++]=n[2]*m}return l},s.prototype.decompressMesh=function(e,t,r,a,n,i){for(var o=r.decodeScales.length,s=r.decodeOffsets,l=r.decodeScales,u=t.attribRange[0],c=t.attribRange[1],d=u,f=new Float32Array(o*c),h=0;h<o;h++){var p=d+c,m=l[h];m&&this.decompressAttribsInner_(e,d,p,f,h,o,s[h],m),d=p}var v=3*t.indexRange[1],g=new Uint16Array(v);this.decompressIndices_(e,d,v,g,0);var y=void 0,x=t.bboxes;x&&(y=this.decompressAABBs_(e,x,t.names.length,s,l)),i(a,n,f,g,y,t)},s.prototype.copyAttrib=function(e,t,r,a){for(var n=0;n<e;n++)r[n]=t[e*a+n]},s.prototype.decodeAttrib2=function(e,t,r,a,n,i,o,s,l,u){for(var c=0;c<5;c++){var d=e.charCodeAt(n+i*c+u),f=d>>1^-(1&d);l[c]+=f,s[t*u+c]=l[c],o[t*u+c]=a[c]*(l[c]+r[c])}},s.prototype.accumulateNormal=function(e,t,r,a,n){var i=a[8*e],o=a[8*e+1],s=a[8*e+2],l=a[8*t],u=a[8*t+1],c=a[8*t+2],d=a[8*r],f=a[8*r+1],h=a[8*r+2];l-=i,u-=o,c-=s,d-=i,f-=o,h-=s,i=u*h-c*f,o=c*d-l*h,s=l*f-u*d,n[3*e]+=i,n[3*e+1]+=o,n[3*e+2]+=s,n[3*t]+=i,n[3*t+1]+=o,n[3*t+2]+=s,n[3*r]+=i,n[3*r+1]+=o,n[3*r+2]+=s},s.prototype.decompressMesh2=function(e,t,r,a,n,i){for(var o=r.decodeScales.length,s=r.decodeOffsets,l=r.decodeScales,u=t.attribRange[0],c=t.attribRange[1],d=t.codeRange[0],f=3*t.codeRange[2],h=new Uint16Array(f),p=new Int32Array(3*c),m=new Uint16Array(o),v=new Uint16Array(o*c),g=new Float32Array(o*c),y=0,x=0,b=0;b<f;b+=3){var A=e.charCodeAt(d++),w=Math.min(b,96);if(A<w){var M,T,S,F=A%3,E=b-(A-F);switch(F){case 0:M=h[E+2],T=h[E+1],S=h[E+0];break;case 1:M=h[E+0],T=h[E+2],S=h[E+1];break;case 2:M=h[E+1],T=h[E+0],S=h[E+2]}h[x++]=M,h[x++]=T,A=e.charCodeAt(d++);var _=y-A;if(h[x++]=_,0===A){for(var P=0;P<5;P++){var L=e.charCodeAt(u+c*P+y),C=(L>>1^-(1&L))+v[o*M+P]+v[o*T+P]-v[o*S+P];m[P]=C,v[o*y+P]=C,g[o*y+P]=l[P]*(C+s[P])}y++}else this.copyAttrib(o,v,m,_);this.accumulateNormal(M,T,_,v,p)}else{var N=y-(A-w);h[x++]=N,A===w?this.decodeAttrib2(e,o,s,l,u,c,g,v,m,y++):this.copyAttrib(o,v,m,N),A=e.charCodeAt(d++);var O=y-A;h[x++]=O,0===A?this.decodeAttrib2(e,o,s,l,u,c,g,v,m,y++):this.copyAttrib(o,v,m,O),A=e.charCodeAt(d++);var I=y-A;if(h[x++]=I,0===A){for(var P=0;P<5;P++)m[P]=(v[o*N+P]+v[o*O+P])/2;this.decodeAttrib2(e,o,s,l,u,c,g,v,m,y++)}else this.copyAttrib(o,v,m,I);this.accumulateNormal(N,O,I,v,p)}}for(var b=0;b<c;b++){var U=p[3*b],D=p[3*b+1],R=p[3*b+2],k=511/Math.sqrt(U*U+D*D+R*R),B=e.charCodeAt(u+5*c+b),j=e.charCodeAt(u+6*c+b),V=e.charCodeAt(u+7*c+b);g[o*b+5]=k*U+(B>>1^-(1&B)),g[o*b+6]=k*D+(j>>1^-(1&j)),g[o*b+7]=k*R+(V>>1^-(1&V))}i(a,n,g,h,void 0,t)},s.prototype.downloadMesh=function(e,t,r,n,i){function o(e){for(;l<r.length;){var a=r[l],o=a.indexRange;if(o){var u=o[0]+3*o[1];if(e.length<u)break;s.decompressMesh(e,a,n,t,l,i)}else{var c=a.codeRange,u=c[0]+c[1];if(e.length<u)break;s.decompressMesh2(e,a,n,t,l,i)}++l}}var s=this,l=0;a(e,function(e){o(e)})},s.prototype.downloadMeshes=function(e,t,r,a){for(var n in t){var i=t[n];this.downloadMesh(e+n,n,i,r,a)}},s.prototype.createMeshCallback=function(e,t,r){var a=0,n=0,i={},l={},u={},c=t.urls;for(var d in c)i[d]=c[d].length,l[d]=0,n++,u[d]=new o.Object3D;var f=new o.Object3D,h=new o.MTLLoader.MaterialCreator(e,t.options);h.setMaterials(t.materials),h.preload();var p=new s.BufferGeometryCreator;return function(e,t,s,c,d,m){var v=p.create(s,c),g=h.create(m.material),y=new o.Mesh(v,g);u[e].add(y),++l[e]===i[e]&&(a++,f.add(u[e]),a===n&&r(f))}},s.prototype.downloadModel=function(e,t,r,a){var n=this.createMeshCallback(t,r,a);this.downloadMeshes(e,r.urls,r.decodeParams,n)},s.prototype.downloadModelJson=function(e,t,r){n(e,function(a){a.decodeParams||(r&&r.decodeParams?a.decodeParams=r.decodeParams:a.decodeParams=l),a.options=r;var n=e.substr(0,e.lastIndexOf("/")+1),i=n;r&&r.geometryBase&&(n=r.geometryBase,"/"!==n.charAt(n.length-1)&&(n+="/")),r&&r.materialBase&&(i=r.materialBase,"/"!==i.charAt(i.length-1)&&(i+="/")),this.downloadModel(n,i,a,t)}.bind(this))},t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e){this.manager=void 0!==e?e:n.DefaultLoadingManager};Object.assign(i.prototype,n.EventDispatcher.prototype,{load:function(e,t,r,a){var i=this,o=new n.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,a)},parse:function(e){function t(e,t){var r=e.length,a=new Float32Array(r+t.length);return a.set(e),a.set(t,r),a}function r(e,t){var r=e.length,a=new Int32Array(r+t.length);return a.set(e),a.set(t,r),a}function a(e){for(var t="",r=new Uint8Array(e),a=0,n=r.length;n--;)t+=String.fromCharCode(r[a++]);return t}var i=n.LoaderUtils.decodeText(new Uint8Array(e,0,250)).split("\n");return-1!==i[0].indexOf("xml")?function(e){function a(e){var t={};if(1===e.nodeType){if(e.attributes&&e.attributes.length>0){t.attributes={};for(var r=0;r<e.attributes.length;r++){var n=e.attributes.item(r);t.attributes[n.nodeName]=n.nodeValue.trim()}}}else 3===e.nodeType&&(t=e.nodeValue.trim());if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes.item(i),s=o.nodeName;if(void 0===t[s]){var l=a(o);""!==l&&(t[s]=l)}else{if(void 0===t[s].push){var u=t[s];t[s]=[u]}var l=a(o);""!==l&&t[s].push(l)}}return t}function i(e){var t,r="undefined"!=typeof Uint8Array?Uint8Array:Array,a=[],n=[],i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=i.length;for(t=0;t<o;t++)a[t]=i[t];for(t=0;t<o;++t)n[i.charCodeAt(t)]=t;n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63;var s,l,u,c,d,o=e.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");c="="===e[o-2]?2:"="===e[o-1]?1:0,d=new r(3*o/4-c),l=c>0?o-4:o;var f=0;for(t=0,s=0;t<l;t+=4,s+=3)u=n[e.charCodeAt(t)]<<18|n[e.charCodeAt(t+1)]<<12|n[e.charCodeAt(t+2)]<<6|n[e.charCodeAt(t+3)],d[f++]=(16711680&u)>>16,d[f++]=(65280&u)>>8,d[f++]=255&u;return 2===c?(u=n[e.charCodeAt(t)]<<2|n[e.charCodeAt(t+1)]>>4,d[f++]=255&u):1===c&&(u=n[e.charCodeAt(t)]<<10|n[e.charCodeAt(t+1)]<<4|n[e.charCodeAt(t+2)]>>2,d[f++]=u>>8&255,d[f++]=255&u),d}var o=null;if(window.DOMParser)try{o=(new DOMParser).parseFromString(e,"text/xml")}catch(e){o=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if(o=new ActiveXObject("Microsoft.XMLDOM"),o.async=!1,!o.loadXML())throw new Error(o.parseError.reason+o.parseError.srcText)}catch(e){o=null}}var s=o.documentElement,l=a(s),u=[],c=[],d=[];if(l.PolyData){for(var f=l.PolyData.Piece,h=l.attributes.hasOwnProperty("compressor"),p=["PointData","Points","Strips","Polys"],m=0,v=p.length;m<v;){var g=f[p[m]];if(g&&g.DataArray){if("[object Array]"===Object.prototype.toString.call(g.DataArray))var y=g.DataArray;else var y=[g.DataArray];for(var x=0,b=y.length;x<b;)"#text"in y[x]&&y[x]["#text"].length>0&&(y[x].text=function(e,a){var n=0;if("UInt64"===l.attributes.header_type?n=8:"UInt32"===l.attributes.header_type&&(n=4),"binary"===e.attributes.format&&a){var o,s,u,c,d,f,h,p,m;if("Float32"===e.attributes.type)var v=new Float32Array;else if("Int64"===e.attributes.type)var v=new Int32Array;o=e["#text"],u=i(o),c=u[0];for(var g=1;g<n-1;g++)c|=u[g]<<g*n;f=(c+3)*n,h=f%3>0?3-f%3:0,f+=h,p=[],m=f,p.push(m),d=3*n;for(var g=0;g<c;g++){for(var y=u[g*n+d],x=1;x<n-1;x++)y|=u[g*n+d+x]<<8*x;m+=y,p.push(m)}for(var g=0;g<p.length-1;g++){s=new Zlib.Inflate(u.slice(p[g],p[g+1]),{resize:!0,verify:!0}).decompress(),s=s.buffer,"Float32"===e.attributes.type?(s=new Float32Array(s),v=t(v,s)):"Int64"===e.attributes.type&&(s=new Int32Array(s),v=r(v,s))}delete e["#text"],"Float32"===e.attributes.type?"binary"===e.attributes.format&&(a||(v=v.filter(function(e,t){if(0!==t)return!0}))):"Int64"===e.attributes.type&&"binary"===e.attributes.format&&(a||(v=v.filter(function(e,t){if(0!==t)return!0})),v=v.filter(function(e,t){if(t%2!=1)return!0}))}else{if("binary"!==e.attributes.format||a)if(e["#text"])var s=e["#text"].split(/\s+/).filter(function(e){if(""!==e)return e});else var s=new Int32Array(0).buffer;else{var s=i(e["#text"]);s=s.slice(n).buffer}if(delete e["#text"],"Float32"===e.attributes.type)var v=new Float32Array(s);else if("Int32"===e.attributes.type)var v=new Int32Array(s);else if("Int64"===e.attributes.type){var v=new Int32Array(s);"binary"===e.attributes.format&&(v=v.filter(function(e,t){if(t%2!=1)return!0}))}}return v}(y[x],h)),x++;switch(p[m]){case"PointData":var A=parseInt(f.attributes.NumberOfPoints),w=g.attributes.Normals;if(A>0)for(var M=0,T=y.length;M<T;M++)if(w===y[M].attributes.Name){var S=y[M].attributes.NumberOfComponents;c=new Float32Array(A*S),c.set(y[M].text,0)}break;case"Points":var A=parseInt(f.attributes.NumberOfPoints);if(A>0){var S=g.DataArray.attributes.NumberOfComponents;u=new Float32Array(A*S),u.set(g.DataArray.text,0)}break;case"Strips":var F=parseInt(f.attributes.NumberOfStrips);if(F>0){var E=new Int32Array(g.DataArray[0].text.length),_=new Int32Array(g.DataArray[1].text.length);E.set(g.DataArray[0].text,0),_.set(g.DataArray[1].text,0);var P=F+E.length;d=new Uint32Array(3*P-9*F);for(var L=0,M=0,T=F;M<T;M++){for(var C=[],N=0,O=_[M],I=0;N<O-I;N++)C.push(E[N]),M>0&&(I=_[M-1]);for(var U=0,O=_[M],I=0;U<O-I-2;U++)U%2?(d[L++]=C[U],d[L++]=C[U+2],d[L++]=C[U+1]):(d[L++]=C[U],d[L++]=C[U+1],d[L++]=C[U+2]),M>0&&(I=_[M-1])}}break;case"Polys":var D=parseInt(f.attributes.NumberOfPolys);if(D>0){var E=new Int32Array(g.DataArray[0].text.length),_=new Int32Array(g.DataArray[1].text.length);E.set(g.DataArray[0].text,0),_.set(g.DataArray[1].text,0);var P=D+E.length;d=new Uint32Array(3*P-9*D);for(var L=0,R=0,M=0,T=D,I=0;M<T;){for(var k=[],N=0,O=_[M];N<O-I;)k.push(E[R++]),N++;for(var U=1;U<O-I-1;)d[L++]=k[0],d[L++]=k[U],d[L++]=k[U+1],U++;M++,I=_[M-1]}}}}m++}var B=new n.BufferGeometry;return B.setIndex(new n.BufferAttribute(d,1)),B.addAttribute("position",new n.BufferAttribute(u,3)),c.length===u.length&&B.addAttribute("normal",new n.BufferAttribute(c,3)),B}}(a(e)):i[2].includes("ASCII")?function(e){var t,r=[],a=[],i=[],o=[],s=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,l=/^(\d+)\s+([\s\d]*)/,u=/^POINTS /,c=/^POLYGONS /,d=/^TRIANGLE_STRIPS /,f=/^POINT_DATA[ ]+(\d+)/,h=/^CELL_DATA[ ]+(\d+)/,p=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,m=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,v=!1,g=!1,y=!1,x=!1,b=!1,A=!1,w=!1,M=e.split("\n");for(var T in M){var S=M[T];if(v)for(;null!==(t=s.exec(S));){var F=parseFloat(t[1]),E=parseFloat(t[2]),_=parseFloat(t[3]);a.push(F,E,_)}else if(g){if(null!==(t=l.exec(S))){var P=parseInt(t[1]),L=t[2].split(/\s+/);if(P>=3)for(var C,N,O=parseInt(L[0]),I=1,U=0;U<P-2;++U)C=parseInt(L[I]),N=parseInt(L[I+1]),r.push(O,C,N),I++}}else if(y){if(null!==(t=l.exec(S))){var P=parseInt(t[1]),L=t[2].split(/\s+/);if(P>=3)for(var O,C,N,U=0;U<P-2;U++)U%2==1?(O=parseInt(L[U]),C=parseInt(L[U+2]),N=parseInt(L[U+1]),r.push(O,C,N)):(O=parseInt(L[U]),C=parseInt(L[U+1]),N=parseInt(L[U+2]),r.push(O,C,N))}}else if(x||b)if(A)for(;null!==(t=s.exec(S));){var D=parseFloat(t[1]),R=parseFloat(t[2]),k=parseFloat(t[3]);i.push(D,R,k)}else if(w)for(;null!==(t=s.exec(S));){var B=parseFloat(t[1]),j=parseFloat(t[2]),V=parseFloat(t[3]);o.push(B,j,V)}null!==c.exec(S)?(g=!0,v=!1,y=!1):null!==u.exec(S)?(g=!1,v=!0,y=!1):null!==d.exec(S)?(g=!1,v=!1,y=!0):null!==f.exec(S)?(x=!0,v=!1,g=!1,y=!1):null!==h.exec(S)?(b=!0,v=!1,g=!1,y=!1):null!==p.exec(S)?(A=!0,w=!1,v=!1,g=!1,y=!1):null!==m.exec(S)&&(w=!0,A=!1,v=!1,g=!1,y=!1)}var G,z="point";if(i.length===r.length&&(z="cell"),"point"===z)G=new n.BufferGeometry,G.setIndex(new n.BufferAttribute(new Uint32Array(r),1)),G.addAttribute("position",new n.BufferAttribute(new Float32Array(a),3)),i.length===a.length&&G.addAttribute("color",new n.BufferAttribute(new Float32Array(i),3)),o.length===a.length&&G.addAttribute("normal",new n.BufferAttribute(new Float32Array(o),3));else{G=new n.Geometry;for(var H,X,Y,W,F,E,_,D,R,k,Q=r.length/3,q=a.length/3,U=0;U<q;++U)F=a[3*U+0],E=a[3*U+1],_=a[3*U+2],G.vertices.push(new n.Vector3(F,E,_));for(var T=0;T<Q;++T)X=r[3*T+0],Y=r[3*T+1],W=r[3*T+2],G.faces.push(new n.Face3(X,Y,W));if(i.length===3*Q)for(var T=0;T<Q;++T)H=G.faces[T],D=i[3*T+0],R=i[3*T+1],k=i[3*T+2],H.color=(new n.Color).setRGB(D,R,k)}return G}(a(e)):function(e){function t(e,t){for(var r=t,a=e[r],n=[];10!==a;)n.push(String.fromCharCode(a)),r++,a=e[r];return{start:t,end:r,next:r+1,parsedString:n.join("")}}for(var r,a,i,o,s,l,u,c=new Uint8Array(e),d=new DataView(e),f=[],h=[],p=[],m=[],v=0;;){if(l=t(c,v),u=l.parsedString,0===u.indexOf("POINTS")){for(m.push(u),o=parseInt(u.split(" ")[1],10),r=4*o*3,f=new Float32Array(3*o),a=l.next,i=0;i<o;i++)f[3*i]=d.getFloat32(a,!1),f[3*i+1]=d.getFloat32(a+4,!1),f[3*i+2]=d.getFloat32(a+8,!1),a+=12;l.next=l.next+r+1}else if(0===u.indexOf("TRIANGLE_STRIPS")){var g=parseInt(u.split(" ")[1],10),y=parseInt(u.split(" ")[2],10);r=4*y,p=new Uint32Array(3*y-9*g);var x=0;for(a=l.next,i=0;i<g;i++){var b=d.getInt32(a,!1),A=[];for(a+=4,s=0;s<b;s++)A.push(d.getInt32(a,!1)),a+=4;for(var w=0;w<b-2;w++)w%2?(p[x++]=A[w],p[x++]=A[w+2],p[x++]=A[w+1]):(p[x++]=A[w],p[x++]=A[w+1],p[x++]=A[w+2])}l.next=l.next+r+1}else if(0===u.indexOf("POLYGONS")){var g=parseInt(u.split(" ")[1],10),y=parseInt(u.split(" ")[2],10);r=4*y,p=new Uint32Array(3*y-9*g);var x=0;for(a=l.next,i=0;i<g;i++){var b=d.getInt32(a,!1),A=[];for(a+=4,s=0;s<b;s++)A.push(d.getInt32(a,!1)),a+=4;for(var w=1;w<b-1;w++)p[x++]=A[0],p[x++]=A[w],p[x++]=A[w+1]}l.next=l.next+r+1}else if(0===u.indexOf("POINT_DATA")){for(o=parseInt(u.split(" ")[1],10),l=t(c,l.next),r=4*o*3,h=new Float32Array(3*o),a=l.next,i=0;i<o;i++)h[3*i]=d.getFloat32(a,!1),h[3*i+1]=d.getFloat32(a+4,!1),h[3*i+2]=d.getFloat32(a+8,!1),a+=12;l.next=l.next+r}if((v=l.next)>=c.byteLength)break}var M=new n.BufferGeometry;return M.setIndex(new n.BufferAttribute(p,1)),M.addAttribute("position",new n.BufferAttribute(f,3)),h.length===f.length&&M.addAttribute("normal",new n.BufferAttribute(h,3)),M}(e)}}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=function e(){i(this,e),this.boneName="",this.BoneIndex=0,this.Indeces=[],this.Weights=[],this.initMatrix=null,this.OffsetMatrix=null},l=function e(){i(this,e),this.animeName="",this.boneName="",this.targetBone=null,this.keyType=4,this.frameStartLv=0,this.keyFrames=[],this.InverseMx=null},u=function(){function e(t){i(this,e),this.fps=30,this.name="xanimation",this.length=0,this.hierarchy=[],this.putFlags=t,void 0===this.putFlags.putPos&&(this.putFlags.putPos=!0),void 0===this.putFlags.putRot&&(this.putFlags.putRot=!0),void 0===this.putFlags.putScl&&(this.putFlags.putScl=!0)}return o(e,[{key:"make",value:function(e){for(var t=0;t<e.length;t++)this.hierarchy.push(this.makeBonekeys(e[t]));this.length=this.hierarchy[0].keys[this.hierarchy[0].keys.length-1].time}},{key:"clone",value:function(){return Object.assign({},this)}},{key:"makeBonekeys",value:function(e){var t={};return t.name=e.boneName,t.parent="",t.keys=this.keyFrameRefactor(e),t.copy=function(){return Object.assign({},this)},t}},{key:"keyFrameRefactor",value:function(e){for(var t=[],r=0;r<e.keyFrames.length;r++){var a={};a.time=e.keyFrames[r].time*this.fps,e.keyFrames[r].pos&&this.putFlags.putPos&&(a.pos=e.keyFrames[r].pos),e.keyFrames[r].rot&&this.putFlags.putRot&&(a.rot=e.keyFrames[r].rot),e.keyFrames[r].scl&&this.putFlags.putScl&&(a.scl=e.keyFrames[r].scl),e.keyFrames[r].matrix&&(a.matrix=e.keyFrames[r].matrix,this.putFlags.putPos&&(a.pos=(new n.Vector3).setFromMatrixPosition(a.matrix)),this.putFlags.putRot&&(a.rot=(new n.Quaternion).setFromRotationMatrix(a.matrix)),this.putFlags.putScl&&(a.scl=(new n.Vector3).setFromMatrixScale(a.matrix))),t.push(a)}return t}}]),e}(),c=function e(){i(this,e),this.index=0,this.Frame=0,this.time=0,this.matrix=null},d=function(){function e(t,r){i(this,e),this.debug=!1,this.manager=void 0!==t?t:n.DefaultLoadingManager,this.texloader=void 0!==r?r:new n.TextureLoader,this.url="",this.baseDir="",this._putMatLength=0,this._nowMat=null,this._tmpUvArray=[],this._facesNormal=[],this._nowFrameName="",this.frameHierarchie=[],this.Hierarchies={},this.HieStack=[],this._currentObject={},this._currentFrame={},this._data=null,this.onLoad=null,this.IsUvYReverse=!0,this.Meshes=[],this.animations=[],this.animTicksPerSecond=30,this._currentGeo=null,this._currentAnime=null,this._currentAnimeFrames=null}return o(e,[{key:"_setArgOption",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e){for(var r=t;r<e.length;r++)switch(r){case 0:this.url=e[r];break;case 1:this.options=e[r]}void 0===this.options&&(this.options={})}}},{key:"load",value:function(e,t,r,a){var i=this;this._setArgOption(e);var o=new n.FileLoader(this.manager);o.setResponseType("arraybuffer"),o.load(this.url,function(e){i._parse(e,t)},r,a)}},{key:"fromResponsedData",value:function(e,t,r){this._setArgOption(t),this._parse(e,r)}},{key:"_readLine",value:function(e){for(var t=0;;){var r=-1;if(r=e.indexOf("//",t),-1===r&&(r=e.indexOf("#",t)),!(r>-1&&r<2))break;var a=-1;a=e.indexOf("\r\n",t),a>0?t=a+2:(a=e.indexOf("\r",t),t=a>0?a+1:e.indexOf("\n",t)+1)}return e.substr(t)}},{key:"_readLine",value:function(e){for(var t=0;;){var r=-1;if(r=e.indexOf("//",t),-1===r&&(r=e.indexOf("#",t)),!(r>-1&&r<2))break;var a=-1;a=e.indexOf("\r\n",t),a>0?t=a+2:(a=e.indexOf("\r",t),t=a>0?a+1:e.indexOf("\n",t)+1)}return e.substr(t)}},{key:"_isBinary",value:function(e){var t=new DataView(e);if(84+50*t.getUint32(80,!0)===t.byteLength)return!0;for(var r=t.byteLength,a=0;a<r;a++)if(t.getUint8(a,!1)>127)return!0;return!1}},{key:"ensureBinary",value:function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}},{key:"ensureString",value:function(e){return"string"!=typeof e?n.LoaderUtils.decodeText(new Uint8Array(e)):e}},{key:"_parse",value:function(e,t){var r=this.ensureBinary(e);return this._data=this.ensureString(e),this.onLoad=t,this._isBinary(r)?this._parseBinary(r):this._parseASCII()}},{key:"_parseBinary",value:function(e){return this._parseASCII(n.LoaderUtils.decodeText(new Uint8Array(e)))}},{key:"_parseASCII",value:function(){this.url.lastIndexOf("/")>0&&(this.baseDir=this.url.substr(0,this.url.lastIndexOf("/")+1));this.Hierarchies.children=[],this._hierarchieParse(this.Hierarchies,16),this._changeRoot(),this._currentObject=this.Hierarchies.children.shift(),this.mainloop()}},{key:"_hierarchieParse",value:function(e,t){for(var r=t;;){var a=this._data.indexOf("{",r)+1,n=this._data.indexOf("}",r),i=this._data.indexOf("{",a)+1;if(!(a>0&&n>a)){r=-1===a?this._data.length:n+1;break}var o={};o.children=[];var s=this._readLine(this._data.substr(r,a-r-1)).trim(),l=s.split(/ /g);if(l.length>0?(o.type=l[0],l.length>=2?o.name=l[1]:o.name=l[0]+this.Hierarchies.children.length):(o.name=s,o.type=""),"Animation"===o.type){o.data=this._data.substr(i,n-i).trim();var u=this._hierarchieParse(o,n+1);r=u.end,o.children=u.parent.children}else{var c=this._data.lastIndexOf(";",i>0?Math.min(i,n):n);if(o.data=this._data.substr(a,c-a).trim(),i<=0||n<i)r=n+1;else{var d=Math.max(c+1,a),f=this._hierarchieParse(o,d);r=f.end,o.children=f.parent.children}}o.parent=e,"template"!=o.type&&e.children.push(o)}return{parent:e,end:r}}},{key:"mainloop",value:function(){var e=this;this.mainProc(),this._currentObject.parent||this._currentObject.children.length>0||!this._currentObject.worked?setTimeout(function(){e.mainloop()},1):setTimeout(function(){e.onLoad({models:e.Meshes,animations:e.animations})},1)}},{key:"mainProc",value:function(){for(var e=!1;;){if(!this._currentObject.worked){switch(this._currentObject.type){case"template":break;case"AnimTicksPerSecond":this.animTicksPerSecond=parseInt(this._currentObject.data);break;case"Frame":this._setFrame();break;case"FrameTransformMatrix":this._setFrameTransformMatrix();break;case"Mesh":this._changeRoot(),this._currentGeo={},this._currentGeo.name=this._currentObject.name.trim(),this._currentGeo.parentName=this._getParentName(this._currentObject).trim(),this._currentGeo.VertexSetedBoneCount=[],this._currentGeo.Geometry=new n.Geometry,this._currentGeo.Materials=[],this._currentGeo.normalVectors=[],this._currentGeo.BoneInfs=[],this._currentGeo.baseFrame=this._currentFrame,this._makeBoneFrom_CurrentFrame(),this._readVertexDatas(),e=!0;break;case"MeshNormals":this._readVertexDatas();break;case"MeshTextureCoords":this._setMeshTextureCoords();break;case"VertexDuplicationIndices":break;case"MeshMaterialList":this._setMeshMaterialList();break;case"Material":this._setMaterial();break;case"SkinWeights":this._setSkinWeights();break;case"AnimationSet":this._changeRoot(),this._currentAnime={},this._currentAnime.name=this._currentObject.name.trim(),this._currentAnime.AnimeFrames=[];break;case"Animation":this._currentAnimeFrames&&this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=new l,this._currentAnimeFrames.boneName=this._currentObject.data.trim();break;case"AnimationKey":this._readAnimationKey(),e=!0}this._currentObject.worked=!0}if(this._currentObject.children.length>0){if(this._currentObject=this._currentObject.children.shift(),this.debug&&console.log("processing "+this._currentObject.name),e)break}else if(this._currentObject.worked&&this._currentObject.parent&&!this._currentObject.parent.parent&&this._changeRoot(),this._currentObject.parent?this._currentObject=this._currentObject.parent:e=!0,e)break}}},{key:"_changeRoot",value:function(){null!=this._currentGeo&&this._currentGeo.name&&this._makeOutputGeometry(),this._currentGeo={},null!=this._currentAnime&&this._currentAnime.name&&(this._currentAnimeFrames&&(this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=null),this._makeOutputAnimation()),this._currentAnime={}}},{key:"_getParentName",value:function(e){return e.parent?e.parent.name?e.parent.name:this._getParentName(e.parent):""}},{key:"_setFrame",value:function(){this._nowFrameName=this._currentObject.name.trim(),this._currentFrame={},this._currentFrame.name=this._nowFrameName,this._currentFrame.children=[],this._currentObject.parent&&this._currentObject.parent.name&&(this._currentFrame.parentName=this._currentObject.parent.name),this.frameHierarchie.push(this._nowFrameName),this.HieStack[this._nowFrameName]=this._currentFrame}},{key:"_setFrameTransformMatrix",value:function(){this._currentFrame.FrameTransformMatrix=new n.Matrix4;var e=this._currentObject.data.split(",");this._ParseMatrixData(this._currentFrame.FrameTransformMatrix,e),this._makeBoneFrom_CurrentFrame()}},{key:"_makeBoneFrom_CurrentFrame",value:function(){if(this._currentFrame.FrameTransformMatrix){var e=new n.Bone;if(e.name=this._currentFrame.name,e.applyMatrix(this._currentFrame.FrameTransformMatrix),e.matrixWorld=e.matrix,e.FrameTransformMatrix=this._currentFrame.FrameTransformMatrix,this._currentFrame.putBone=e,this._currentFrame.parentName)for(var t in this.HieStack)this.HieStack[t].name===this._currentFrame.parentName&&this.HieStack[t].putBone.add(this._currentFrame.putBone)}}},{key:"_readVertexDatas",value:function(){for(var e=0,t=0,r=0,a=0,n=0;;){var i=!1;if(0===r){e=this._readInt1(e).endRead,r=1,n=0,a=this._currentObject.data.indexOf(";;",e)+1,a<=0&&(a=this._currentObject.data.length)}else{var o=0;switch(t){case 0:o=this._currentObject.data.indexOf(",",e)+1;break;case 1:o=this._currentObject.data.indexOf(";,",e)+1}switch((0===o||o>a)&&(o=a,r=0,i=!0),this._currentObject.type){case"Mesh":switch(t){case 0:this._readVertex1(this._currentObject.data.substr(e,o-e));break;case 1:this._readFace1(this._currentObject.data.substr(e,o-e))}break;case"MeshNormals":switch(t){case 0:this._readNormalVector1(this._currentObject.data.substr(e,o-e));break;case 1:this._readNormalFace1(this._currentObject.data.substr(e,o-e),n)}}e=o+1,n++,i&&t++}if(e>=this._currentObject.data.length)break}}},{key:"_readInt1",value:function(e){var t=this._currentObject.data.indexOf(";",e);return{refI:parseInt(this._currentObject.data.substr(e,t-e)),endRead:t+1}}},{key:"_readVertex1",value:function(e){var t=this._readLine(e.trim()).substr(0,e.length-2).split(";");this._currentGeo.Geometry.vertices.push(new n.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))),this._currentGeo.Geometry.skinIndices.push(new n.Vector4(0,0,0,0)),this._currentGeo.Geometry.skinWeights.push(new n.Vector4(1,0,0,0)),this._currentGeo.VertexSetedBoneCount.push(0)}},{key:"_readFace1",value:function(e){var t=this._readLine(e.trim()).substr(2,e.length-4).split(",");this._currentGeo.Geometry.faces.push(new n.Face3(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),new n.Vector3(1,1,1).normalize()))}},{key:"_readNormalVector1",value:function(e){var t=this._readLine(e.trim()).substr(0,e.length-2).split(";");this._currentGeo.normalVectors.push(new n.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])))}},{key:"_readNormalFace1",value:function(e,t){var r=this._readLine(e.trim()).substr(2,e.length-4).split(","),a=parseInt(r[0],10),n=this._currentGeo.normalVectors[a];a=parseInt(r[1],10);var i=this._currentGeo.normalVectors[a];a=parseInt(r[2],10);var o=this._currentGeo.normalVectors[a];this._currentGeo.Geometry.faces[t].vertexNormals=[n,i,o]}},{key:"_setMeshNormals",value:function(){for(var e=0,t=0,r=0;;){switch(t){case 0:if(0===r){e=this._readInt1(0).endRead,r=1}else{var a=this._currentObject.data.indexOf(",",e)+1;-1===a&&(a=this._currentObject.data.indexOf(";;",e)+1,t=2,r=0);var n=this._currentObject.data.substr(e,a-e),i=this._readLine(n.trim()).split(";");this._currentGeo.normalVectors.push([parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])]),e=a+1}}if(e>=this._currentObject.data.length)break}}},{key:"_setMeshTextureCoords",value:function(){this._tmpUvArray=[],this._currentGeo.Geometry.faceVertexUvs=[],this._currentGeo.Geometry.faceVertexUvs.push([]);for(var e=0,t=0,r=0;;){switch(t){case 0:if(0===r){e=this._readInt1(0).endRead,r=1}else{var a=this._currentObject.data.indexOf(",",e)+1;0===a&&(a=this._currentObject.data.length,t=2,r=0);var i=this._currentObject.data.substr(e,a-e),o=this._readLine(i.trim()).split(";");this.IsUvYReverse?this._tmpUvArray.push(new n.Vector2(parseFloat(o[0]),1-parseFloat(o[1]))):this._tmpUvArray.push(new n.Vector2(parseFloat(o[0]),parseFloat(o[1]))),e=a+1}}if(e>=this._currentObject.data.length)break}this._currentGeo.Geometry.faceVertexUvs[0]=[];for(var s=0;s<this._currentGeo.Geometry.faces.length;s++)this._currentGeo.Geometry.faceVertexUvs[0][s]=[],this._currentGeo.Geometry.faceVertexUvs[0][s].push(this._tmpUvArray[this._currentGeo.Geometry.faces[s].a]),this._currentGeo.Geometry.faceVertexUvs[0][s].push(this._tmpUvArray[this._currentGeo.Geometry.faces[s].b]),this._currentGeo.Geometry.faceVertexUvs[0][s].push(this._tmpUvArray[this._currentGeo.Geometry.faces[s].c]);this._currentGeo.Geometry.uvsNeedUpdate=!0}},{key:"_setMeshMaterialList",value:function(){for(var e=0,t=0,r=0;;){if(r<2){e=this._readInt1(e).endRead,r++}else{var a=this._currentObject.data.indexOf(";",e);-1===a&&(a=this._currentObject.data.length,t=3,r=0);for(var n=this._currentObject.data.substr(e,a-e),i=this._readLine(n.trim()).split(","),o=0;o<i.length;o++)this._currentGeo.Geometry.faces[o].materialIndex=parseInt(i[o]);e=this._currentObject.data.length}if(e>=this._currentObject.data.length||t>=3)break}}},{key:"_setMaterial",value:function(){var e=new n.MeshPhongMaterial({color:16777215*Math.random()});e.side=n.FrontSide,e.name=this._currentObject.name;var t=0,r=this._currentObject.data.indexOf(";;",t),a=this._currentObject.data.substr(t,r-t),i=this._readLine(a.trim()).split(";");e.color.r=parseFloat(i[0]),e.color.g=parseFloat(i[1]),e.color.b=parseFloat(i[2]),t=r+2,r=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,r-t),e.shininess=parseFloat(this._readLine(a)),t=r+1,r=this._currentObject.data.indexOf(";;",t),a=this._currentObject.data.substr(t,r-t);var o=this._readLine(a.trim()).split(";");e.specular.r=parseFloat(o[0]),e.specular.g=parseFloat(o[1]),e.specular.b=parseFloat(o[2]),t=r+2,r=this._currentObject.data.indexOf(";;",t),-1===r&&(r=this._currentObject.data.length),a=this._currentObject.data.substr(t,r-t);var s=this._readLine(a.trim()).split(";");e.emissive.r=parseFloat(s[0]),e.emissive.g=parseFloat(s[1]),e.emissive.b=parseFloat(s[2]);for(var l=null;;){if(!(this._currentObject.children.length>0))break;l=this._currentObject.children.shift(),this.debug&&console.log("processing "+l.name);var u=l.data.substr(1,l.data.length-2);switch(l.type){case"TextureFilename":e.map=this.texloader.load(this.baseDir+u);break;case"BumpMapFilename":e.bumpMap=this.texloader.load(this.baseDir+u),e.bumpScale=.05;break;case"NormalMapFilename":e.normalMap=this.texloader.load(this.baseDir+u),e.normalScale=new n.Vector2(2,2);break;case"EmissiveMapFilename":e.emissiveMap=this.texloader.load(this.baseDir+u);break;case"LightMapFilename":e.lightMap=this.texloader.load(this.baseDir+u)}}this._currentGeo.Materials.push(e)}},{key:"_setSkinWeights",value:function(){var e=new s,t=0,r=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,r-t);t=r+1,e.boneName=a.substr(1,a.length-2),e.BoneIndex=this._currentGeo.BoneInfs.length,r=this._currentObject.data.indexOf(";",t),t=r+1,r=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,r-t);for(var i=this._readLine(a.trim()).split(","),o=0;o<i.length;o++)e.Indeces.push(parseInt(i[o]));t=r+1,r=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,r-t);for(var l=this._readLine(a.trim()).split(","),u=0;u<l.length;u++)e.Weights.push(parseFloat(l[u]));t=r+1,r=this._currentObject.data.indexOf(";",t),r<=0&&(r=this._currentObject.data.length),a=this._currentObject.data.substr(t,r-t);var c=this._readLine(a.trim()).split(",");e.OffsetMatrix=new n.Matrix4,this._ParseMatrixData(e.OffsetMatrix,c),this._currentGeo.BoneInfs.push(e)}},{key:"_makePutBoneList",value:function(e,t){var r=!1;for(var a in this.HieStack)if(this.HieStack[a].name===e||r){r=!0;var i=new n.Bone;if(i.name=this.HieStack[a].name,i.applyMatrix(this.HieStack[a].FrameTransformMatrix),i.matrixWorld=i.matrix,i.FrameTransformMatrix=this.HieStack[a].FrameTransformMatrix,i.pos=(new n.Vector3).setFromMatrixPosition(i.FrameTransformMatrix).toArray(),i.rotq=(new n.Quaternion).setFromRotationMatrix(i.FrameTransformMatrix).toArray(),i.scl=(new n.Vector3).setFromMatrixScale(i.FrameTransformMatrix).toArray(),this.HieStack[a].parentName&&this.HieStack[a].parentName.length>0)for(var o=0;o<t.length;o++)if(this.HieStack[a].parentName===t[o].name){t[o].add(i),i.parent=o;break}t.push(i)}}},{key:"_makeOutputGeometry",value:function(){this._currentGeo.Geometry.computeBoundingBox(),this._currentGeo.Geometry.computeBoundingSphere(),this._currentGeo.Geometry.verticesNeedUpdate=!0,this._currentGeo.Geometry.normalsNeedUpdate=!0,this._currentGeo.Geometry.colorsNeedUpdate=!0,this._currentGeo.Geometry.uvsNeedUpdate=!0,this._currentGeo.Geometry.groupsNeedUpdate=!0;var e=null;if(this._currentGeo.BoneInfs.length>0){var t=[];this._makePutBoneList(this._currentGeo.baseFrame.parentName,t);for(var r=0;r<this._currentGeo.BoneInfs.length;r++){for(var a=0,i=0;i<t.length;i++)if(t[i].name===this._currentGeo.BoneInfs[r].boneName){a=i,t[i].OffsetMatrix=new n.Matrix4,t[i].OffsetMatrix.copy(this._currentGeo.BoneInfs[r].OffsetMatrix);break}for(var o=0;o<this._currentGeo.BoneInfs[r].Indeces.length;o++){var s=this._currentGeo.BoneInfs[r].Indeces[o],l=this._currentGeo.BoneInfs[r].Weights[o];switch(this._currentGeo.VertexSetedBoneCount[s]){case 0:this._currentGeo.Geometry.skinIndices[s].x=a,this._currentGeo.Geometry.skinWeights[s].x=l;break;case 1:this._currentGeo.Geometry.skinIndices[s].y=a,this._currentGeo.Geometry.skinWeights[s].y=l;break;case 2:this._currentGeo.Geometry.skinIndices[s].z=a,this._currentGeo.Geometry.skinWeights[s].z=l;break;case 3:this._currentGeo.Geometry.skinIndices[s].w=a,this._currentGeo.Geometry.skinWeights[s].w=l}this._currentGeo.VertexSetedBoneCount[s]++,this._currentGeo.VertexSetedBoneCount[s]>4&&console.log("warn! over 4 bone weight! :"+s)}}for(var u=0;u<this._currentGeo.Materials.length;u++)this._currentGeo.Materials[u].skinning=!0;for(var c=[],d=0;d<t.length;d++)t[d].OffsetMatrix?c.push(t[d].OffsetMatrix):c.push(new n.Matrix4);var f=(new n.BufferGeometry).fromGeometry(this._currentGeo.Geometry);f.bones=t,e=new n.SkinnedMesh(f,1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials),e.skeleton.boneInverses=c}else{var h=(new n.BufferGeometry).fromGeometry(this._currentGeo.Geometry);e=new n.Mesh(h,1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials)}e.name=this._currentGeo.name;var p=new n.Matrix4,m=this._currentGeo.baseFrame.putBone;if(m&&m.parent){for(;;){if(!(m=m.parent))break;p.multiply(m.FrameTransformMatrix)}e.applyMatrix(p)}this.Meshes.push(e)}},{key:"_readAnimationKey",value:function(){var e=0,t=this._currentObject.data.indexOf(";",e),r=this._currentObject.data.substr(e,t-e);e=t+1;var a=parseInt(this._readLine(r));t=this._currentObject.data.indexOf(";",e),e=t+1,r=this._currentObject.data.substr(e);for(var i=this._readLine(r.trim()).split(";;,"),o=0;o<i.length;o++){var s=i[o].split(";"),l=new c;if(l.type=a,l.Frame=parseInt(s[0]),l.index=this._currentAnimeFrames.keyFrames.length,l.time=l.Frame,4!=a){for(var u=!1,d=0;d<this._currentAnimeFrames.keyFrames.length;d++)if(this._currentAnimeFrames.keyFrames[d].Frame===l.Frame){l=this._currentAnimeFrames.keyFrames[d],u=!0;break}var f=s[2].split(",");switch(a){case 0:l.rot=new n.Quaternion(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),-1*parseFloat(f[0]));break;case 1:l.scl=new n.Vector3(parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2]));break;case 2:l.pos=new n.Vector3(parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2]))}u||this._currentAnimeFrames.keyFrames.push(l)}else l.matrix=new n.Matrix4,this._ParseMatrixData(l.matrix,s[2].split(",")),this._currentAnimeFrames.keyFrames.push(l)}}},{key:"_makeOutputAnimation",value:function(){var e=new u(this.options);e.fps=this.animTicksPerSecond,e.name=this._currentAnime.name,e.make(this._currentAnime.AnimeFrames),this.animations.push(e)}},{key:"assignAnimation",value:function(e,t,r){var a=e,i=t;if(a||(a=this.Meshes[0]),i||(i=this.animations[0]),!a||!i)return null;var o={};o.fps=i.fps,o.name=i.name,o.length=i.length,o.hierarchy=[];for(var s=0;s<a.skeleton.bones.length;s++){for(var l=!1,u=0;u<i.hierarchy.length;u++)if(a.skeleton.bones[s].name===i.hierarchy[u].name){l=!0;var c=i.hierarchy[u].copy();if(c.parent=-1,a.skeleton.bones[s].parent&&"Bone"===a.skeleton.bones[s].parent.type)for(var d=0;d<o.hierarchy.length;d++)o.hierarchy[d].name===a.skeleton.bones[s].parent.name&&(c.parent=d,c.parentName=a.skeleton.bones[s].parent.name);o.hierarchy.push(c);break}if(!l){var f=i.hierarchy[0].copy();f.name=a.skeleton.bones[s].name,f.parent=-1;for(var h=0;h<f.keys.length;h++)f.keys[h].pos&&f.keys[h].pos.set(0,0,0),f.keys[h].scl&&f.keys[h].scl.set(1,1,1),f.keys[h].rot&&f.keys[h].rot.set(0,0,0,1);o.hierarchy.push(f)}}return a.geometry.animations||(a.geometry.animations=[]),a.geometry.animations.push(n.AnimationClip.parseAnimation(o,a.skeleton.bones)),a.animationMixer||(a.animationMixer=new n.AnimationMixer(a)),o}},{key:"_ParseMatrixData",value:function(e,t){e.set(parseFloat(t[0]),parseFloat(t[4]),parseFloat(t[8]),parseFloat(t[12]),parseFloat(t[1]),parseFloat(t[5]),parseFloat(t[9]),parseFloat(t[13]),parseFloat(t[2]),parseFloat(t[6]),parseFloat(t[10]),parseFloat(t[14]),parseFloat(t[3]),parseFloat(t[7]),parseFloat(t[11]),parseFloat(t[15]))}}]),e}();t.default=d},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UnrealBloomPass=t.TexturePass=t.TAARenderPass=t.SSAOPass=t.SSAARenderPass=t.SMAAPass=t.ShaderPass=t.SavePass=t.SAOPass=t.RenderPass=t.Pass=t.OutlinePass=t.MaskPass=t.HalftonePass=t.GlitchPass=t.FilmPass=t.EffectComposer=t.DotScreenPass=t.CubeTexturePass=t.ClearPass=t.ClearMaskPass=t.BokehPass=t.BloomPass=t.AdaptiveToneMappingPass=void 0;var n=r(91),i=a(n),o=r(92),s=a(o),l=r(93),u=a(l),c=r(94),d=a(c),f=r(95),h=a(f),p=r(96),m=a(p),v=r(97),g=a(v),y=r(98),x=a(y),b=r(99),A=a(b),w=r(100),M=a(w),T=r(101),S=a(T),F=r(102),E=a(F),_=r(103),P=a(_),L=r(1),C=a(L),N=r(104),O=a(N),I=r(105),U=a(I),D=r(106),R=a(D),k=r(3),B=a(k),j=r(107),V=a(j),G=r(24),z=a(G),H=r(108),X=a(H),Y=r(109),W=a(Y),Q=r(110),q=a(Q),K=r(111),Z=a(K);t.AdaptiveToneMappingPass=i.default,t.BloomPass=s.default,t.BokehPass=u.default,t.ClearMaskPass=d.default,t.ClearPass=h.default,t.CubeTexturePass=m.default,t.DotScreenPass=g.default,t.EffectComposer=x.default,t.FilmPass=A.default,t.GlitchPass=M.default,t.HalftonePass=S.default,t.MaskPass=E.default,t.OutlinePass=P.default,t.Pass=C.default,t.RenderPass=O.default,t.SAOPass=U.default,t.SavePass=R.default,t.ShaderPass=B.default,t.SMAAPass=V.default,t.SSAARenderPass=z.default,t.SSAOPass=X.default,t.TAARenderPass=W.default,t.TexturePass=q.default,t.UnrealBloomPass=Z.default},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(2),u=a(l),c=r(11),d=a(c),f=r(12),h=a(f),p=function(e,t){s.default.call(this),this.resolution=void 0!==t?t:256,this.needsInit=!0,this.adaptive=void 0===e||!!e,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,void 0===u.default&&console.error("THREE.AdaptiveToneMappingPass relies on THREE.CopyShader");var r=u.default;this.copyUniforms=i.UniformsUtils.clone(r.uniforms),this.materialCopy=new i.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,blending:i.NoBlending,depthTest:!1}),void 0===d.default&&console.error("THREE.AdaptiveToneMappingPass relies on THREE.LuminosityShader"),this.materialLuminance=new i.ShaderMaterial({uniforms:i.UniformsUtils.clone(d.default.uniforms),vertexShader:d.default.vertexShader,fragmentShader:d.default.fragmentShader,blending:i.NoBlending}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D lastLum;","uniform sampler2D currentLum;","uniform float minLuminance;","uniform float delta;","uniform float tau;","void main() {","vec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );","vec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );","float fLastLum = max( minLuminance, lastLum.r );","float fCurrentLum = max( minLuminance, currentLum.r );","fCurrentLum *= fCurrentLum;","float fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));","gl_FragColor.r = fAdaptedLum;","}"].join("\n")},this.materialAdaptiveLum=new i.ShaderMaterial({uniforms:i.UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:i.NoBlending}),void 0===h.default&&console.error("THREE.AdaptiveToneMappingPass relies on THREE.ToneMapShader"),this.materialToneMap=new i.ShaderMaterial({uniforms:i.UniformsUtils.clone(h.default.uniforms),vertexShader:h.default.vertexShader,fragmentShader:h.default.fragmentShader,blending:i.NoBlending}),this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};p.prototype=Object.assign(Object.create(s.default.prototype),{constructor:p,render:function(e,t,r,a,n){this.needsInit&&(this.reset(e),this.luminanceRT.texture.type=r.texture.type,this.previousLuminanceRT.texture.type=r.texture.type,this.currentLuminanceRT.texture.type=r.texture.type,this.needsInit=!1),this.adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=r.texture,e.render(this.scene,this.camera,this.currentLuminanceRT),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=a,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,e.render(this.scene,this.camera,this.luminanceRT),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,e.render(this.scene,this.camera,this.previousLuminanceRT)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=r.texture,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},reset:function(e){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose();var t={minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBAFormat};this.luminanceRT=new i.WebGLRenderTarget(this.resolution,this.resolution,t),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new i.WebGLRenderTarget(this.resolution,this.resolution,t),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,t.minFilter=i.LinearMipMapLinearFilter,this.currentLuminanceRT=new i.WebGLRenderTarget(this.resolution,this.resolution,t),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new i.MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},setAdaptive:function(e){e?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0},setAdaptionRate:function(e){e&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(e))},setMinLuminance:function(e){e&&(this.materialToneMap.uniforms.minLuminance.value=e,this.materialAdaptiveLum.uniforms.minLuminance.value=e)},setMaxLuminance:function(e){e&&(this.materialToneMap.uniforms.maxLuminance.value=e)},setAverageLuminance:function(e){e&&(this.materialToneMap.uniforms.averageLuminance.value=e)},setMiddleGrey:function(e){e&&(this.materialToneMap.uniforms.middleGrey.value=e)},dispose:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}}),t.default=p},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(2),u=a(l),c=r(13),d=a(c),f=function e(t,r,a,n){s.default.call(this),t=void 0!==t?t:1,r=void 0!==r?r:25,a=void 0!==a?a:4,n=void 0!==n?n:256;var o={minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBAFormat};this.renderTargetX=new i.WebGLRenderTarget(n,n,o),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new i.WebGLRenderTarget(n,n,o),this.renderTargetY.texture.name="BloomPass.y",void 0===u.default&&console.error("THREE.BloomPass relies on THREE.CopyShader");var l=u.default;this.copyUniforms=i.UniformsUtils.clone(l.uniforms),this.copyUniforms.opacity.value=t,this.materialCopy=new i.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,blending:i.AdditiveBlending,transparent:!0}),void 0===d.default&&console.error("THREE.BloomPass relies on THREE.ConvolutionShader");var c=d.default;this.convolutionUniforms=i.UniformsUtils.clone(c.uniforms),this.convolutionUniforms.uImageIncrement.value=e.blurX,this.convolutionUniforms.cKernel.value=d.default.buildKernel(a),this.materialConvolution=new i.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{KERNEL_SIZE_FLOAT:r.toFixed(1),KERNEL_SIZE_INT:r.toFixed(0)}}),this.needsSwap=!1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};f.prototype=Object.assign(Object.create(s.default.prototype),{constructor:f,render:function(e,t,r,a,n){n&&e.context.disable(e.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=f.blurX,e.render(this.scene,this.camera,this.renderTargetX,!0),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=f.blurY,e.render(this.scene,this.camera,this.renderTargetY,!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,n&&e.context.enable(e.context.STENCIL_TEST),e.render(this.scene,this.camera,r,this.clear)}}),f.blurX=new i.Vector2(.001953125,0),f.blurY=new i.Vector2(0,.001953125),t.default=f},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(8),s=a(o),l=r(1),u=a(l),c=r(14),d=a(c),f=s.default,h=function(e,t,r){u.default.call(this),this.scene=e,this.camera=t;var a=void 0!==r.focus?r.focus:1,n=void 0!==r.aspect?r.aspect:t.aspect,o=void 0!==r.aperture?r.aperture:.025,s=void 0!==r.maxblur?r.maxblur:1,l=r.width||f.innerWidth||1,c=r.height||f.innerHeight||1;this.renderTargetColor=new i.WebGLRenderTarget(l,c,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBFormat}),this.renderTargetColor.texture.name="BokehPass.color",this.renderTargetDepth=this.renderTargetColor.clone(),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new i.MeshDepthMaterial,this.materialDepth.depthPacking=i.RGBADepthPacking,this.materialDepth.blending=i.NoBlending,void 0===d.default&&console.error("THREE.BokehPass relies on THREE.BokehShader");var h=d.default,p=i.UniformsUtils.clone(h.uniforms);p.tDepth.value=this.renderTargetDepth.texture,p.focus.value=a,p.aspect.value=n,p.aperture.value=o,p.maxblur.value=s,p.nearClip.value=t.near,p.farClip.value=t.far,this.materialBokeh=new i.ShaderMaterial({defines:Object.assign({},h.defines),uniforms:p,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}),this.uniforms=p,this.needsSwap=!1,this.camera2=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene2=new i.Scene,this.quad2=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2),this.oldClearColor=new i.Color,this.oldClearAlpha=1};h.prototype=Object.assign(Object.create(u.default.prototype),{constructor:h,render:function(e,t,r,a,n){this.quad2.material=this.materialBokeh,this.scene.overrideMaterial=this.materialDepth,this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.render(this.scene,this.camera,this.renderTargetDepth,!0),this.uniforms.tColor.value=r.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?e.render(this.scene2,this.camera2):e.render(this.scene2,this.camera2,t,this.clear),this.scene.overrideMaterial=null,e.setClearColor(this.oldClearColor),e.setClearAlpha(this.oldClearAlpha),e.autoClear=this.oldAutoClear}}),t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),i=function(){n.default.call(this),this.needsSwap=!1};i.prototype=Object.create(n.default.prototype),Object.assign(i.prototype,{render:function(e,t,r,a,n){e.state.buffers.stencil.setTest(!1)}}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),i=function(e,t){n.default.call(this),this.needsSwap=!1,this.clearColor=void 0!==e?e:0,this.clearAlpha=void 0!==t?t:0};i.prototype=Object.assign(Object.create(n.default.prototype),{constructor:i,render:function(e,t,r,a,n){var i,o;this.clearColor&&(i=e.getClearColor().getHex(),o=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:r),e.clear(),this.clearColor&&e.setClearColor(i,o)}}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=r(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(e,t,r){o.default.call(this),this.camera=e,this.needsSwap=!1,this.cubeShader=n.ShaderLib.cube,this.cubeMesh=new n.Mesh(new n.BoxBufferGeometry(10,10,10),new n.ShaderMaterial({uniforms:this.cubeShader.uniforms,vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:n.BackSide})),this.envMap=t,this.opacity=void 0!==r?r:1,this.cubeScene=new n.Scene,this.cubeCamera=new n.PerspectiveCamera,this.cubeScene.add(this.cubeMesh)};s.prototype=Object.assign(Object.create(o.default.prototype),{constructor:s,render:function(e,t,r,a,n){var i=e.autoClear;e.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.tCube.value=this.envMap,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,e.render(this.cubeScene,this.cubeCamera,this.renderToScreen?null:r,this.clear),e.autoClear=i}}),t.default=s},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(15),u=a(l),c=function(e,t,r){s.default.call(this),void 0===u.default&&console.error("THREE.DotScreenPass relies on THREE.DotScreenShader");var a=u.default;this.uniforms=i.UniformsUtils.clone(a.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==t&&(this.uniforms.angle.value=t),void 0!==r&&(this.uniforms.scale.value=r),this.material=new i.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,render:function(e,t,r,a,n){this.uniforms.tDiffuse.value=r.texture,this.uniforms.tSize.value.set(r.width,r.height),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}),t.default=c},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(2),s=a(o),l=r(3),u=a(l),c=function(e,t){if(this.renderer=e,void 0===t){var r={minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBAFormat,stencilBuffer:!1},a=e.getDrawingBufferSize();t=new i.WebGLRenderTarget(a.width,a.height,r),t.texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===s.default&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===u.default&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new u.default(s.default)};Object.assign(c.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize();e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(e){var t,r,a=!1,n=this.passes.length;for(r=0;r<n;r++)if(t=this.passes[r],!1!==t.enabled){if(t.render(this.renderer,this.writeBuffer,this.readBuffer,e,a),t.needsSwap){if(a){var o=this.renderer.context;o.stencilFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),o.stencilFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==i.MaskPass&&(t instanceof i.MaskPass?a=!0:t instanceof i.ClearMaskPass&&(a=!1))}},reset:function(e){if(void 0===e){var t=this.renderer.getDrawingBufferSize();e=this.renderTarget1.clone(),e.setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(e,t)}}),t.default=c},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(16),u=a(l),c=function(e,t,r,a){s.default.call(this),void 0===u.default&&console.error("THREE.FilmPass relies on THREE.FilmShader");var n=u.default;this.uniforms=i.UniformsUtils.clone(n.uniforms),this.material=new i.ShaderMaterial({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),void 0!==a&&(this.uniforms.grayscale.value=a),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==t&&(this.uniforms.sIntensity.value=t),void 0!==r&&(this.uniforms.sCount.value=r),this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,render:function(e,t,r,a,n){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=a,this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}),t.default=c},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(17),u=a(l),c=function(e){s.default.call(this),void 0===u.default&&console.error("THREE.GlitchPass relies on THREE.DigitalGlitch");var t=u.default;this.uniforms=i.UniformsUtils.clone(t.uniforms),void 0==e&&(e=64),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new i.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.goWild=!1,this.curF=0,this.generateTrigger()};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,render:function(e,t,r,a,n){this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=i.Math.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=i.Math.randFloat(-1,1),this.uniforms.seed_y.value=i.Math.randFloat(-1,1),this.uniforms.distortion_x.value=i.Math.randFloat(0,1),this.uniforms.distortion_y.value=i.Math.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=i.Math.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=i.Math.randFloat(0,1),this.uniforms.distortion_y.value=i.Math.randFloat(0,1),this.uniforms.seed_x.value=i.Math.randFloat(-.3,.3),this.uniforms.seed_y.value=i.Math.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},generateTrigger:function(){this.randX=i.Math.randInt(120,240)},generateHeightmap:function(e){for(var t=new Float32Array(e*e*3),r=e*e,a=0;a<r;a++){var n=i.Math.randFloat(0,1);t[3*a+0]=n,t[3*a+1]=n,t[3*a+2]=n}var o=new i.DataTexture(t,e,e,i.RGBFormat,i.FloatType);return o.needsUpdate=!0,o}}),t.default=c},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(18),u=a(l),c=function(e,t,r){s.default.call(this),void 0===u.default&&console.error("THREE.HalftonePass requires THREE.HalftoneShader"),this.uniforms=i.UniformsUtils.clone(u.default.uniforms),this.material=new i.ShaderMaterial({uniforms:this.uniforms,fragmentShader:u.default.fragmentShader,vertexShader:u.default.vertexShader}),this.uniforms.width.value=e,this.uniforms.height.value=t;for(var a in r)r.hasOwnProperty(a)&&this.uniforms.hasOwnProperty(a)&&(this.uniforms[a].value=r[a]);this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,render:function(e,t,r,a,n){this.material.uniforms.tDiffuse.value=r.texture,this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},setSize:function(e,t){this.uniforms.width.value=e,this.uniforms.height.value=t}}),t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),i=function(e,t){n.default.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};i.prototype=Object.assign(Object.create(n.default.prototype),{constructor:i,render:function(e,t,r,a,n){var i=e.context,o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);var s,l;this.inverse?(s=0,l=1):(s=1,l=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),o.buffers.stencil.setFunc(i.ALWAYS,s,4294967295),o.buffers.stencil.setClear(l),e.render(this.scene,this.camera,r,this.clear),e.render(this.scene,this.camera,t,this.clear),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setFunc(i.EQUAL,1,4294967295),o.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP)}}),t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(2),u=a(l),c=function(e,t,r,a){this.renderScene=t,this.renderCamera=r,this.selectedObjects=void 0!==a?a:[],this.visibleEdgeColor=new i.Color(1,1,1),this.hiddenEdgeColor=new i.Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,s.default.call(this),this.resolution=void 0!==e?new i.Vector2(e.x,e.y):new i.Vector2(256,256);var n={minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBAFormat},o=Math.round(this.resolution.x/this.downSampleRatio),l=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new i.MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=i.DoubleSide,this.renderTargetMaskBuffer=new i.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new i.MeshDepthMaterial,this.depthMaterial.side=i.DoubleSide,this.depthMaterial.depthPacking=i.RGBADepthPacking,this.depthMaterial.blending=i.NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=i.DoubleSide,this.prepareMaskMaterial.fragmentShader=function(e,t){var r=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,r+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new i.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new i.WebGLRenderTarget(o,l,n),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new i.WebGLRenderTarget(o,l,n),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new i.WebGLRenderTarget(Math.round(o/2),Math.round(l/2),n),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new i.WebGLRenderTarget(o,l,n),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new i.WebGLRenderTarget(Math.round(o/2),Math.round(l/2),n),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new i.Vector2(o,l),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new i.Vector2(Math.round(o/2),Math.round(l/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===u.default&&console.error("THREE.OutlinePass relies on THREE.CopyShader");var c=u.default;this.copyUniforms=i.UniformsUtils.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new i.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:i.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new i.Color,this.oldClearAlpha=1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.tempPulseColor1=new i.Color,this.tempPulseColor2=new i.Color,this.textureMatrix=new i.Matrix4};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,t){this.renderTargetMaskBuffer.setSize(e,t);var r=Math.round(e/this.downSampleRatio),a=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,a),this.renderTargetBlurBuffer1.setSize(r,a),this.renderTargetEdgeBuffer1.setSize(r,a),this.separableBlurMaterial1.uniforms.texSize.value=new i.Vector2(r,a),r=Math.round(r/2),a=Math.round(a/2),this.renderTargetBlurBuffer2.setSize(r,a),this.renderTargetEdgeBuffer2.setSize(r,a),this.separableBlurMaterial2.uniforms.texSize.value=new i.Vector2(r,a)},changeVisibilityOfSelectedObjects:function(e){function t(t){t.isMesh&&(e?(t.visible=t.userData.oldVisible,delete t.userData.oldVisible):(t.userData.oldVisible=t.visible,t.visible=e))}for(var r=0;r<this.selectedObjects.length;r++){this.selectedObjects[r].traverse(t)}},changeVisibilityOfNonSelectedObjects:function(e){function t(e){e.isMesh&&a.push(e)}function r(t){if(t.isMesh||t.isLine||t.isSprite){for(var r=!1,n=0;n<a.length;n++){if(a[n].id===t.id){r=!0;break}}if(!r){var i=t.visible;e&&!t.bVisible||(t.visible=e),t.bVisible=i}}}for(var a=[],n=0;n<this.selectedObjects.length;n++){this.selectedObjects[n].traverse(t)}this.renderScene.traverse(r)},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,t,r,a,n){if(this.selectedObjects.length>0){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,n&&e.context.disable(e.context.STENCIL_TEST),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var s=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.render(this.renderScene,this.renderCamera,this.renderTargetDepthBuffer,!0),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new i.Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.render(this.renderScene,this.renderCamera,this.renderTargetMaskBuffer,!0),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=s,this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.render(this.scene,this.camera,this.renderTargetMaskDownSampleBuffer,!0),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var l=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.quad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new i.Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=i.OutlinePass.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.render(this.scene,this.camera,this.renderTargetBlurBuffer1,!0),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=i.OutlinePass.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=i.OutlinePass.BlurDirectionX,e.render(this.scene,this.camera,this.renderTargetBlurBuffer2,!0),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=i.OutlinePass.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetEdgeBuffer2,!0),this.quad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,n&&e.context.enable(e.context.STENCIL_TEST),e.render(this.scene,this.camera,r,!1),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=r.texture,e.render(this.scene,this.camera))},getPrepareMaskMaterial:function(){return new i.ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new i.Vector2(.5,.5)},textureMatrix:{value:new i.Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new i.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new i.Vector2(.5,.5)},visibleEdgeColor:{value:new i.Vector3(1,1,1)},hiddenEdgeColor:{value:new i.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(e){return new i.ShaderMaterial({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new i.Vector2(.5,.5)},direction:{value:new i.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\t\t\t\t}"})},getOverlayMaterial:function(){return new i.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:i.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),c.BlurDirectionX=new i.Vector2(1,0),c.BlurDirectionY=new i.Vector2(0,1),t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),i=function(e,t,r,a,i){n.default.call(this),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=a,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};i.prototype=Object.assign(Object.create(n.default.prototype),{constructor:i,render:function(e,t,r,a,n){var i=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial;var o,s;this.clearColor&&(o=e.getClearColor().getHex(),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.render(this.scene,this.camera,this.renderToScreen?null:r,this.clear),this.clearColor&&e.setClearColor(o,s),this.scene.overrideMaterial=null,e.autoClear=i}}),t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(19),u=a(l),c=r(20),d=a(c),f=r(2),h=a(f),p=r(21),m=a(p),v=r(22),g=a(v),y=function(e,t,r,a,n){if(s.default.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==r&&r,this.supportsNormalTexture=void 0!==a&&a,this.oldClearColor=new i.Color,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==n?new i.Vector2(n.x,n.y):new i.Vector2(256,256),this.saoRenderTarget=new i.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBAFormat}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new i.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:i.NearestFilter,magFilter:i.NearestFilter,format:i.RGBAFormat}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension){var r=new i.DepthTexture;r.type=i.UnsignedShortType,r.minFilter=i.NearestFilter,r.maxFilter=i.NearestFilter,this.beautyRenderTarget.depthTexture=r,this.beautyRenderTarget.depthBuffer=!0}this.depthMaterial=new i.MeshDepthMaterial,this.depthMaterial.depthPacking=i.RGBADepthPacking,this.depthMaterial.blending=i.NoBlending,this.normalMaterial=new i.MeshNormalMaterial,this.normalMaterial.blending=i.NoBlending,void 0===u.default&&console.error("THREE.SAOPass relies on THREE.SAOShader"),this.saoMaterial=new i.ShaderMaterial({defines:Object.assign({},u.default.defines),fragmentShader:u.default.fragmentShader,vertexShader:u.default.vertexShader,uniforms:i.UniformsUtils.clone(u.default.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=i.NoBlending,void 0===d.default&&console.error("THREE.SAOPass relies on THREE.DepthLimitedBlurShader"),this.vBlurMaterial=new i.ShaderMaterial({uniforms:i.UniformsUtils.clone(d.default.uniforms),defines:Object.assign({},d.default.defines),vertexShader:d.default.vertexShader,fragmentShader:d.default.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=i.NoBlending,this.hBlurMaterial=new i.ShaderMaterial({uniforms:i.UniformsUtils.clone(d.default.uniforms),defines:Object.assign({},d.default.defines),vertexShader:d.default.vertexShader,fragmentShader:d.default.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?r:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=i.NoBlending,void 0===h.default&&console.error("THREE.SAOPass relies on THREE.CopyShader"),this.materialCopy=new i.ShaderMaterial({uniforms:i.UniformsUtils.clone(h.default.uniforms),vertexShader:h.default.vertexShader,fragmentShader:h.default.fragmentShader,blending:i.NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=i.CustomBlending,this.materialCopy.blendSrc=i.DstColorFactor,this.materialCopy.blendDst=i.ZeroFactor,this.materialCopy.blendEquation=i.AddEquation,this.materialCopy.blendSrcAlpha=i.DstAlphaFactor,this.materialCopy.blendDstAlpha=i.ZeroFactor,this.materialCopy.blendEquationAlpha=i.AddEquation,void 0===h.default&&console.error("THREE.SAOPass relies on THREE.UnpackDepthRGBAShader"),this.depthCopy=new i.ShaderMaterial({uniforms:i.UniformsUtils.clone(m.default.uniforms),vertexShader:m.default.vertexShader,fragmentShader:m.default.fragmentShader,blending:i.NoBlending}),this.quadCamera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.quadScene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quadScene.add(this.quad)};y.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},y.prototype=Object.assign(Object.create(s.default.prototype),{constructor:y,render:function(e,t,r,a,n){if(this.renderToScreen&&(this.materialCopy.blending=i.NoBlending,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),1!==this.params.output){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.clearTarget(this.depthRenderTarget),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;var s=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=s,this.hBlurMaterial.uniforms.depthCutoff.value=s,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(g.default.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new i.Vector2(0,1)),g.default.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new i.Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.render(this.scene,this.camera,this.beautyRenderTarget,!0),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));var l=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,l=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),0===this.params.output?l.blending=i.CustomBlending:l.blending=i.NoBlending,this.renderPass(e,l,this.renderToScreen?null:r),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o}},renderPass:function(e,t,r,a,n){var i=e.getClearColor(),o=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1;var l=void 0!==a&&null!==a;l&&(e.setClearColor(a),e.setClearAlpha(n||0)),this.quad.material=t,e.render(this.quadScene,this.quadCamera,r,l),e.autoClear=s,e.setClearColor(i),e.setClearAlpha(o)},renderOverride:function(e,t,r,a,n){var i=e.getClearColor(),o=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,a=t.clearColor||a,n=t.clearAlpha||n;var l=void 0!==a&&null!==a;l&&(e.setClearColor(a),e.setClearAlpha(n||0)),this.scene.overrideMaterial=t,e.render(this.scene,this.camera,r,l),this.scene.overrideMaterial=null,e.autoClear=s,e.setClearColor(i),e.setClearAlpha(o)},setSize:function(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}}),t.default=y},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(2),u=a(l),c=function(e){s.default.call(this),void 0===u.default&&console.error("THREE.SavePass relies on THREE.CopyShader");var t=u.default;this.textureID="tDiffuse",this.uniforms=i.UniformsUtils.clone(t.uniforms),this.material=new i.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new i.WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBFormat,stencilBuffer:!1}),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.quad.material=this.material,e.render(this.scene,this.camera,this.renderTarget,this.clear)}}),t.default=c},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(23),u=a(l),c=function(e,t){s.default.call(this),this.edgesRT=new i.WebGLRenderTarget(e,t,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:i.LinearFilter,format:i.RGBFormat}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new i.WebGLRenderTarget(e,t,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:i.LinearFilter,format:i.RGBAFormat}),this.weightsRT.texture.name="SMAAPass.weights";var r=new Image;r.src=this.getAreaTexture(),this.areaTexture=new i.Texture,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=r,this.areaTexture.format=i.RGBFormat,this.areaTexture.minFilter=i.LinearFilter,this.areaTexture.generateMipmaps=!1,this.areaTexture.needsUpdate=!0,this.areaTexture.flipY=!1;var a=new Image;a.src=this.getSearchTexture(),this.searchTexture=new i.Texture,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=a,this.searchTexture.magFilter=i.NearestFilter,this.searchTexture.minFilter=i.NearestFilter,this.searchTexture.generateMipmaps=!1,this.searchTexture.needsUpdate=!0,this.searchTexture.flipY=!1,void 0===u.default&&console.error("THREE.SMAAPass relies on THREE.SMAAShader"),this.uniformsEdges=i.UniformsUtils.clone(u.default[0].uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new i.ShaderMaterial({defines:Object.assign({},u.default[0].defines),uniforms:this.uniformsEdges,vertexShader:u.default[0].vertexShader,fragmentShader:u.default[0].fragmentShader}),this.uniformsWeights=i.UniformsUtils.clone(u.default[1].uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new i.ShaderMaterial({defines:Object.assign({},u.default[1].defines),uniforms:this.uniformsWeights,vertexShader:u.default[1].vertexShader,fragmentShader:u.default[1].fragmentShader}),this.uniformsBlend=i.UniformsUtils.clone(u.default[2].uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new i.ShaderMaterial({uniforms:this.uniformsBlend,vertexShader:u.default[2].vertexShader,fragmentShader:u.default[2].fragmentShader}),this.needsSwap=!1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,render:function(e,t,r,a,n){this.uniformsEdges.tDiffuse.value=r.texture,this.quad.material=this.materialEdges,e.render(this.scene,this.camera,this.edgesRT,this.clear),this.quad.material=this.materialWeights,e.render(this.scene,this.camera,this.weightsRT,this.clear),this.uniformsBlend.tColor.value=r.texture,this.quad.material=this.materialBlend,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)},setSize:function(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)},getAreaTexture:function(){return"data:image/png;base64,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"},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}}),t.default=c},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(3),s=a(o),l=r(25),u=a(l),c=function(e,t,r,a){if(void 0===u.default)return console.warn("THREE.SSAOPass depends on THREE.SSAOShader"),new s.default;s.default.call(this,u.default),this.width=void 0!==r?r:512,this.height=void 0!==a?a:256,this.renderToScreen=!1,this.camera2=t,this.scene2=e,this.depthMaterial=new i.MeshDepthMaterial,this.depthMaterial.depthPacking=i.RGBADepthPacking,this.depthMaterial.blending=i.NoBlending,this.depthRenderTarget=new i.WebGLRenderTarget(this.width,this.height,{minFilter:i.LinearFilter,magFilter:i.LinearFilter}),this.uniforms.tDepth.value=this.depthRenderTarget.texture,this.uniforms.size.value.set(this.width,this.height),this.uniforms.cameraNear.value=this.camera2.near,this.uniforms.cameraFar.value=this.camera2.far,this.uniforms.radius.value=4,this.uniforms.onlyAO.value=!1,this.uniforms.aoClamp.value=.25,this.uniforms.lumInfluence.value=.7;Object.defineProperties(this,{radius:{get:function(){return this.uniforms.radius.value},set:function(e){this.uniforms.radius.value=e}},onlyAO:{get:function(){return this.uniforms.onlyAO.value},set:function(e){this.uniforms.onlyAO.value=e}},aoClamp:{get:function(){return this.uniforms.aoClamp.value},set:function(e){this.uniforms.aoClamp.value=e}},lumInfluence:{get:function(){return this.uniforms.lumInfluence.value},set:function(e){this.uniforms.lumInfluence.value=e}}})};c.prototype=Object.create(s.default.prototype),c.prototype.render=function(e,t,r,a,n){this.scene2.overrideMaterial=this.depthMaterial,e.render(this.scene2,this.camera2,this.depthRenderTarget,!0),this.scene2.overrideMaterial=null,s.default.prototype.render.call(this,e,t,r,a,n)},c.prototype.setScene=function(e){this.scene2=e},c.prototype.setCamera=function(e){this.camera2=e,this.uniforms.cameraNear.value=this.camera2.near,this.uniforms.cameraFar.value=this.camera2.far},c.prototype.setSize=function(e,t){this.width=e,this.height=t,this.uniforms.size.value.set(this.width,this.height),this.depthRenderTarget.setSize(this.width,this.height)},t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i=r(24),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(e,t,r){void 0===o.default&&console.error("THREE.TAARenderPass relies on THREE.SSAARenderPass"),o.default.call(this,e,t,r),this.sampleLevel=0,this.accumulate=!1};s.JitterVectors=o.default.JitterVectors,s.prototype=Object.assign(Object.create(o.default.prototype),{constructor:s,render:function(e,t,r,a){if(!this.accumulate)return o.default.prototype.render.call(this,e,t,r,a),void(this.accumulateIndex=-1);var i=s.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new n.WebGLRenderTarget(r.width,r.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new n.WebGLRenderTarget(r.width,r.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(o.default.prototype.render.call(this,e,this.holdRenderTarget,r,a),this.accumulateIndex=0);var l=e.autoClear;e.autoClear=!1;var u=1/i.length;if(this.accumulateIndex>=0&&this.accumulateIndex<i.length){this.copyUniforms.opacity.value=u,this.copyUniforms.tDiffuse.value=t.texture;for(var c=Math.pow(2,this.sampleLevel),d=0;d<c;d++){var f=this.accumulateIndex,h=i[f];if(this.camera.setViewOffset&&this.camera.setViewOffset(r.width,r.height,.0625*h[0],.0625*h[1],r.width,r.height),e.render(this.scene,this.camera,t,!0),e.render(this.scene2,this.camera2,this.sampleRenderTarget,0===this.accumulateIndex),++this.accumulateIndex>=i.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var p=this.accumulateIndex*u;p>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,e.render(this.scene2,this.camera2,t,!0)),p<1&&(this.copyUniforms.opacity.value=1-p,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,e.render(this.scene2,this.camera2,t,0===p)),e.autoClear=l}}),t.default=s},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(2),u=a(l),c=function(e,t){s.default.call(this),void 0===u.default&&console.error("THREE.TexturePass relies on THREE.CopyShader");var r=u.default;this.map=e,this.opacity=void 0!==t?t:1,this.uniforms=i.UniformsUtils.clone(r.uniforms),this.material=new i.ShaderMaterial({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};c.prototype=Object.assign(Object.create(s.default.prototype),{constructor:c,render:function(e,t,r,a,n){var i=e.autoClear;e.autoClear=!1,this.quad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.render(this.scene,this.camera,this.renderToScreen?null:r,this.clear),e.autoClear=i}}),t.default=c},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),o=r(1),s=a(o),l=r(2),u=a(l),c=r(26),d=a(c),f=function(e,t,r,a){s.default.call(this),this.strength=void 0!==t?t:1,this.radius=r,this.threshold=a,this.resolution=void 0!==e?new i.Vector2(e.x,e.y):new i.Vector2(256,256);var n={minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:i.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);this.renderTargetBright=new i.WebGLRenderTarget(o,l,n),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var c=0;c<this.nMips;c++){var f=new i.WebGLRenderTarget(o,l,n);f.texture.name="UnrealBloomPass.h"+c,f.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(f);var f=new i.WebGLRenderTarget(o,l,n);f.texture.name="UnrealBloomPass.v"+c,f.texture.generateMipmaps=!1,this.renderTargetsVertical.push(f),o=Math.round(o/2),l=Math.round(l/2)}void 0===d.default&&console.error("THREE.UnrealBloomPass relies on THREE.LuminosityHighPassShader");var h=d.default;this.highPassUniforms=i.UniformsUtils.clone(h.uniforms),this.highPassUniforms.luminosityThreshold.value=a,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new i.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,defines:{}}),this.separableBlurMaterials=[];for(var p=[3,5,7,9,11],o=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2),c=0;c<this.nMips;c++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(p[c])),this.separableBlurMaterials[c].uniforms.texSize.value=new i.Vector2(o,l),o=Math.round(o/2),l=Math.round(l/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;var m=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=m,this.bloomTintColors=[new i.Vector3(1,1,1),new i.Vector3(1,1,1),new i.Vector3(1,1,1),new i.Vector3(1,1,1),new i.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===u.default&&console.error("THREE.BloomPass relies on THREE.CopyShader");var v=u.default;this.copyUniforms=i.UniformsUtils.clone(v.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new i.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:v.vertexShader,fragmentShader:v.fragmentShader,blending:i.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new i.Color,this.oldClearAlpha=1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new i.Scene,this.basic=new i.MeshBasicMaterial,this.quad=new i.Mesh(new i.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};f.prototype=Object.assign(Object.create(s.default.prototype),{constructor:f,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(var e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var r=Math.round(e/2),a=Math.round(t/2);this.renderTargetBright.setSize(r,a);for(var n=0;n<this.nMips;n++)this.renderTargetsHorizontal[n].setSize(r,a),this.renderTargetsVertical[n].setSize(r,a),this.separableBlurMaterials[n].uniforms.texSize.value=new i.Vector2(r,a),r=Math.round(r/2),a=Math.round(a/2)},render:function(e,t,r,a,n){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.setClearColor(new i.Color(0,0,0),0),n&&e.context.disable(e.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=r.texture,e.render(this.scene,this.camera,void 0,!0)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.quad.material=this.materialHighPassFilter,e.render(this.scene,this.camera,this.renderTargetBright,!0);for(var s=this.renderTargetBright,l=0;l<this.nMips;l++)this.quad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[l].uniforms.direction.value=i.UnrealBloomPass.BlurDirectionX,e.render(this.scene,this.camera,this.renderTargetsHorizontal[l],!0),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=i.UnrealBloomPass.BlurDirectionY,e.render(this.scene,this.camera,this.renderTargetsVertical[l],!0),s=this.renderTargetsVertical[l];this.quad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.render(this.scene,this.camera,this.renderTargetsHorizontal[0],!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,n&&e.context.enable(e.context.STENCIL_TEST),this.renderToScreen?e.render(this.scene,this.camera,void 0,!1):e.render(this.scene,this.camera,r,!1),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o},getSeperableBlurMaterial:function(e){return new i.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new i.Vector2(.5,.5)},direction:{value:new i.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new i.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),f.BlurDirectionX=new i.Vector2(1,0),f.BlurDirectionY=new i.Vector2(0,1),t.default=f},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterRefractionShader=t.VignetteShader=t.VerticalTiltShiftShader=t.VerticalBlurShader=t.UnpackDepthRGBAShader=t.TriangleBlurShader=t.ToneMapShader=t.TechnicolorShader=t.SSAOShader=t.SobelOperatorShader=t.SMAAShader=t.SepiaShader=t.SAOShader=t.RGBShiftShader=t.PixelShader=t.ParallaxShader=t.NormalMapShader=t.MirrorShader=t.LuminosityShader=t.LuminosityHighPassShader=t.KaleidoShader=t.HueSaturationShader=t.HorizontalTiltShiftShader=t.HorizontalBlurShader=t.HalftoneShader=t.GammaCorrectionShader=t.FXAAShader=t.FresnelShader=t.FreiChenShader=t.FocusShader=t.FilmShader=t.DotScreenShader=t.DOFMipMapShader=t.DigitalGlitch=t.DepthLimitedBlurShader=t.CopyShader=t.ConvolutionShader=t.ColorifyShader=t.ColorCorrectionShader=t.BrightnessContrastShader=t.BokehShader2=t.BokehShader=t.BlurShaderUtils=t.BlendShader=t.BleachBypassShader=t.BasicShader=void 0;var n=r(113),i=a(n),o=r(114),s=a(o),l=r(115),u=a(l),c=r(22),d=a(c),f=r(14),h=a(f),p=r(116),m=a(p),v=r(117),g=a(v),y=r(118),x=a(y),b=r(119),A=a(b),w=r(13),M=a(w),T=r(2),S=a(T),F=r(20),E=a(F),_=r(17),P=a(_),L=r(120),C=a(L),N=r(15),O=a(N),I=r(16),U=a(I),D=r(121),R=a(D),k=r(122),B=a(k),j=r(123),V=a(j),G=r(124),z=a(G),H=r(125),X=a(H),Y=r(18),W=a(Y),Q=r(126),q=a(Q),K=r(127),Z=a(K),J=r(128),$=a(J),ee=r(129),te=a(ee),re=r(26),ae=a(re),ne=r(11),ie=a(ne),oe=r(130),se=a(oe),le=r(131),ue=a(le),ce=r(132),de=(a(ce),r(133)),fe=a(de),he=r(134),pe=a(he),me=r(135),ve=a(me),ge=r(19),ye=a(ge),xe=r(136),be=a(xe),Ae=r(23),we=a(Ae),Me=r(137),Te=a(Me),Se=r(25),Fe=a(Se),Ee=r(138),_e=a(Ee),Pe=r(12),Le=a(Pe),Ce=r(139),Ne=a(Ce),Oe=r(21),Ie=a(Oe),Ue=r(140),De=a(Ue),Re=r(141),ke=a(Re),Be=r(142),je=a(Be),Ve=r(143),Ge=a(Ve);t.BasicShader=i.default,t.BleachBypassShader=s.default,t.BlendShader=u.default,t.BlurShaderUtils=d.default,t.BokehShader=h.default,t.BokehShader2=m.default,t.BrightnessContrastShader=g.default,t.ColorCorrectionShader=x.default,t.ColorifyShader=A.default,t.ConvolutionShader=M.default,t.CopyShader=S.default,t.DepthLimitedBlurShader=E.default,t.DigitalGlitch=P.default,t.DOFMipMapShader=C.default,t.DotScreenShader=O.default,t.FilmShader=U.default,t.FocusShader=R.default,t.FreiChenShader=B.default,t.FresnelShader=V.default,t.FXAAShader=z.default,t.GammaCorrectionShader=X.default,t.HalftoneShader=W.default,t.HorizontalBlurShader=q.default,t.HorizontalTiltShiftShader=Z.default,t.HueSaturationShader=$.default,t.KaleidoShader=te.default,t.LuminosityHighPassShader=ae.default,t.LuminosityShader=ie.default,t.MirrorShader=se.default,t.NormalMapShader=ue.default,t.ParallaxShader=fe.default,t.PixelShader=pe.default,t.RGBShiftShader=ve.default,t.SAOShader=ye.default,t.SepiaShader=be.default,t.SMAAShader=we.default,t.SobelOperatorShader=Te.default,t.SSAOShader=Fe.default,t.TechnicolorShader=_e.default,t.ToneMapShader=Le.default,t.TriangleBlurShader=Ne.default,t.UnpackDepthRGBAShader=Ie.default,t.VerticalBlurShader=De.default,t.VerticalTiltShiftShader=ke.default,t.VignetteShader=je.default,t.WaterRefractionShader=Ge.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["void main() {","gl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 base = texture2D( tDiffuse, vUv );","vec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );","float lum = dot( lumCoeff, base.rgb );","vec3 blend = vec3( lum );","float L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );","vec3 result1 = 2.0 * base.rgb * blend;","vec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );","vec3 newColor = mix( result1, result2, L );","float A2 = opacity * base.a;","vec3 mixRGB = A2 * newColor.rgb;","mixRGB += ( ( 1.0 - A2 ) * base.rgb );","gl_FragColor = vec4( mixRGB, base.a );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","vec4 texel1 = texture2D( tDiffuse1, vUv );","vec4 texel2 = texture2D( tDiffuse2, vUv );","gl_FragColor = opacity * mix( texel1, texel2, mixRatio );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{textureWidth:{value:1},textureHeight:{value:1},focalDepth:{value:1},focalLength:{value:24},fstop:{value:.9},tColor:{value:null},tDepth:{value:null},maxblur:{value:1},showFocus:{value:0},manualdof:{value:0},vignetting:{value:0},depthblur:{value:0},threshold:{value:.5},gain:{value:2},bias:{value:.5},fringe:{value:.7},znear:{value:.1},zfar:{value:100},noise:{value:1},dithering:{value:1e-4},pentagon:{value:0},shaderFocus:{value:1},focusCoords:{value:new n.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float textureWidth;","uniform float textureHeight;","uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below","uniform float focalLength; //focal length in mm","uniform float fstop; //f-stop value","uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)","/*","make sure that these two values are the same for your camera, otherwise distances will be wrong.","*/","uniform float znear; // camera clipping start","uniform float zfar; // camera clipping end","//------------------------------------------","//user variables","const int samples = SAMPLES; //samples on the first ring","const int rings = RINGS; //ring count","const int maxringsamples = rings * samples;","uniform bool manualdof; // manual dof calculation","float ndofstart = 1.0; // near dof blur start","float ndofdist = 2.0; // near dof blur falloff distance","float fdofstart = 1.0; // far dof blur start","float fdofdist = 3.0; // far dof blur falloff distance","float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)","uniform bool vignetting; // use optical lens vignetting","float vignout = 1.3; // vignetting outer border","float vignin = 0.0; // vignetting inner border","float vignfade = 22.0; // f-stops till vignete fades","uniform bool shaderFocus;","// disable if you use external focalDepth value","uniform vec2 focusCoords;","// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)","// if center of screen use vec2(0.5, 0.5);","uniform float maxblur;","//clamp value of max blur (0.0 = no blur, 1.0 default)","uniform float threshold; // highlight threshold;","uniform float gain; // highlight gain;","uniform float bias; // bokeh edge bias","uniform float fringe; // bokeh chromatic aberration / fringing","uniform bool noise; //use noise instead of pattern for sample dithering","uniform float dithering;","uniform bool depthblur; // blur the depth buffer","float dbsize = 1.25; // depth blur size","/*","next part is experimental","not looking good with small sample and ring count","looks okay starting from samples = 4, rings = 4","*/","uniform bool pentagon; //use pentagon as bokeh shape?","float feather = 0.4; //pentagon shape feather","//------------------------------------------","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float penta(vec2 coords) {","//pentagonal shape","float scale = float(rings) - 1.3;","vec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","vec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","vec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","vec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","vec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","vec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","vec4  one = vec4( 1.0 );","vec4 P = vec4((coords),vec2(scale, scale));","vec4 dist = vec4(0.0);","float inorout = -4.0;","dist.x = dot( P, HS0 );","dist.y = dot( P, HS1 );","dist.z = dot( P, HS2 );","dist.w = dot( P, HS3 );","dist = smoothstep( -feather, feather, dist );","inorout += dot( dist, one );","dist.x = dot( P, HS4 );","dist.y = HS5.w - abs( P.z );","dist = smoothstep( -feather, feather, dist );","inorout += dist.x;","return clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) {","// Depth buffer blur","float d = 0.0;","float kernel[9];","vec2 offset[9];","vec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;","offset[0] = vec2(-wh.x,-wh.y);","offset[1] = vec2( 0.0, -wh.y);","offset[2] = vec2( wh.x -wh.y);","offset[3] = vec2(-wh.x,  0.0);","offset[4] = vec2( 0.0,   0.0);","offset[5] = vec2( wh.x,  0.0);","offset[6] = vec2(-wh.x, wh.y);","offset[7] = vec2( 0.0,  wh.y);","offset[8] = vec2( wh.x, wh.y);","kernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","kernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","kernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","for( int i=0; i<9; i++ ) {","float tmp = getDepth( coords + offset[ i ] );","d += tmp * kernel[i];","}","return d;","}","vec3 color(vec2 coords,float blur) {","//processing the sample","vec3 col = vec3(0.0);","vec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);","col.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","col.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","col.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","vec3 lumcoeff = vec3(0.299,0.587,0.114);","float lum = dot(col.rgb, lumcoeff);","float thresh = max((lum-threshold)*gain, 0.0);","return col+mix(vec3(0.0),col,thresh*blur);","}","vec3 debugFocus(vec3 col, float blur, float depth) {","float edge = 0.002*depth; //distance based edge smoothing","float m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","float e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","col = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","col = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","return col;","}","float linearize(float depth) {","return -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette() {","float dist = distance(vUv.xy, vec2(0.5,0.5));","dist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","return clamp(dist,0.0,1.0);","}","float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {","float rings2 = float(rings);","float step = PI*2.0 / float(ringsamples);","float pw = cos(j*step)*i;","float ph = sin(j*step)*i;","float p = 1.0;","if (pentagon) {","p = penta(vec2(pw,ph));","}","col += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;","return 1.0 * mix(1.0, i /rings2, bias) * p;","}","void main() {","//scene depth calculation","float depth = linearize( getDepth( vUv.xy ) );","// Blur depth?","if (depthblur) {","depth = linearize(bdepth(vUv.xy));","}","//focal plane calculation","float fDepth = focalDepth;","if (shaderFocus) {","fDepth = linearize( getDepth( focusCoords ) );","}","// dof blur factor calculation","float blur = 0.0;","if (manualdof) {","float a = depth-fDepth; // Focal plane","float b = (a-fdofstart)/fdofdist; // Far DoF","float c = (-a-ndofstart)/ndofdist; // Near Dof","blur = (a>0.0) ? b : c;","} else {","float f = focalLength; // focal length in mm","float d = fDepth*1000.0; // focal plane in mm","float o = depth*1000.0; // depth in mm","float a = (o*f)/(o-f);","float b = (d*f)/(d-f);","float c = (d-f)/(d*fstop*CoC);","blur = abs(a-b)*c;","}","blur = clamp(blur,0.0,1.0);","// calculation of pattern for dithering","vec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;","// getting blur x and y step factor","float w = (1.0/textureWidth)*blur*maxblur+noise.x;","float h = (1.0/textureHeight)*blur*maxblur+noise.y;","// calculation of final color","vec3 col = vec3(0.0);","if(blur < 0.05) {","//some optimization thingy","col = texture2D(tColor, vUv.xy).rgb;","} else {","col = texture2D(tColor, vUv.xy).rgb;","float s = 1.0;","int ringsamples;","for (int i = 1; i <= rings; i++) {","/*unboxstart*/","ringsamples = i * samples;","for (int j = 0 ; j < maxringsamples ; j++) {","if (j >= ringsamples) break;","s += gather(float(i), float(j), ringsamples, col, w, h, blur);","}","/*unboxend*/","}","col /= s; //divide by sample count","}","if (showFocus) {","col = debugFocus(col, blur, depth);","}","if (vignetting) {","col *= vignette();","}","gl_FragColor.rgb = col;","gl_FragColor.a = 1.0;","} "].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},brightness:{value:0},contrast:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float brightness;","uniform float contrast;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb += brightness;","if (contrast > 0.0) {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;","} else {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;","}","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{tDiffuse:{value:null},powRGB:{value:new n.Vector3(2,2,2)},mulRGB:{value:new n.Vector3(1,1,1)},addRGB:{value:new n.Vector3(0,0,0)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 powRGB;","uniform vec3 mulRGB;","uniform vec3 addRGB;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{tDiffuse:{value:null},color:{value:new n.Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","gl_FragColor = vec4( v * color, texel.w );","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},maxblur:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float focus;","uniform float maxblur;","uniform sampler2D tColor;","uniform sampler2D tDepth;","varying vec2 vUv;","void main() {","vec4 depth = texture2D( tDepth, vUv );","float factor = depth.x - focus;","vec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );","gl_FragColor = col;","gl_FragColor.a = 1.0;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},screenWidth:{value:1024},screenHeight:{value:1024},sampleDistance:{value:.94},waveFactor:{value:.00125}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float screenWidth;","uniform float screenHeight;","uniform float sampleDistance;","uniform float waveFactor;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color, org, tmp, add;","float sample_dist, f;","vec2 vin;","vec2 uv = vUv;","add = color = org = texture2D( tDiffuse, uv );","vin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );","sample_dist = dot( vin, vin ) * 2.0;","f = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;","vec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );","add += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","color = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );","color = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );","gl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{tDiffuse:{value:null},aspect:{value:new n.Vector2(512,512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform vec2 aspect;","vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);","mat3 G[9];","const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );","const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );","const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );","const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );","const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );","const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );","const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );","const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );","const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );","void main(void)","{","G[0] = g0,","G[1] = g1,","G[2] = g2,","G[3] = g3,","G[4] = g4,","G[5] = g5,","G[6] = g6,","G[7] = g7,","G[8] = g8;","mat3 I;","float cnv[9];","vec3 sample;","for (float i=0.0; i<3.0; i++) {","for (float j=0.0; j<3.0; j++) {","sample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;","I[int(i)][int(j)] = length(sample);","}","}","for (int i=0; i<9; i++) {","float dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","cnv[i] = dp3 * dp3;","}","float M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);","float S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);","gl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{mRefractionRatio:{value:1.02},mFresnelBias:{value:.1},mFresnelPower:{value:2},mFresnelScale:{value:1},tCube:{value:null}},vertexShader:["uniform float mRefractionRatio;","uniform float mFresnelBias;","uniform float mFresnelScale;","uniform float mFresnelPower;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","vec3 I = worldPosition.xyz - cameraPosition;","vReflect = reflect( I, worldNormal );","vRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );","vRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );","vRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );","vReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","vec4 refractedColor = vec4( 1.0 );","refractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;","refractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;","refractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;","gl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{tDiffuse:{value:null},resolution:{value:new n.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immedates.","    // Immedates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","gl_FragColor = LinearToGamma( tex, float( GAMMA_FACTOR ) );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},h:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float hh = h * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","float angle = hue * 3.14159265;","float s = sin(angle), c = cos(angle);","vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","float len = length(gl_FragColor.rgb);","gl_FragColor.rgb = vec3(","dot(gl_FragColor.rgb, weights.xyz),","dot(gl_FragColor.rgb, weights.zxy),","dot(gl_FragColor.rgb, weights.yzx)",");","float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","if (saturation > 0.0) {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","} else {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","}","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},sides:{value:6},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float sides;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 p = vUv - 0.5;","float r = length(p);","float a = atan(p.y, p.x) + angle;","float tau = 2. * 3.1416 ;","a = mod(a, tau/sides);","a = abs(a - tau/sides/2.) ;","p = r * vec2(cos(a), sin(a));","vec4 color = texture2D(tDiffuse, p + 0.5);","gl_FragColor = color;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},side:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform int side;","varying vec2 vUv;","void main() {","vec2 p = vUv;","if (side == 0){","if (p.x > 0.5) p.x = 1.0 - p.x;","}else if (side == 1){","if (p.x < 0.5) p.x = 1.0 - p.x;","}else if (side == 2){","if (p.y < 0.5) p.y = 1.0 - p.y;","}else if (side == 3){","if (p.y > 0.5) p.y = 1.0 - p.y;","} ","vec4 color = texture2D(tDiffuse, p);","gl_FragColor = color;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{heightMap:{value:null},resolution:{value:new n.Vector2(512,512)},scale:{value:new n.Vector2(1,1)},height:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float height;","uniform vec2 resolution;","uniform sampler2D heightMap;","varying vec2 vUv;","void main() {","float val = texture2D( heightMap, vUv ).x;","float valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;","float valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;","gl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );","}"].join("\n")};t.default=i},function(e,t,r){"use strict";var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a);n.ShaderLib.ocean_sim_vertex={vertexShader:["varying vec2 vUV;","void main (void) {","vUV = position.xy * 0.5 + 0.5;","gl_Position = vec4(position, 1.0 );","}"].join("\n")},n.ShaderLib.ocean_subtransform={uniforms:{u_input:{value:null},u_transformSize:{value:512},u_subtransformSize:{value:250}},fragmentShader:["precision highp float;","#include <common>","uniform sampler2D u_input;","uniform float u_transformSize;","uniform float u_subtransformSize;","varying vec2 vUV;","vec2 multiplyComplex (vec2 a, vec2 b) {","return vec2(a[0] * b[0] - a[1] * b[1], a[1] * b[0] + a[0] * b[1]);","}","void main (void) {","#ifdef HORIZONTAL","float index = vUV.x * u_transformSize - 0.5;","#else","float index = vUV.y * u_transformSize - 0.5;","#endif","float evenIndex = floor(index / u_subtransformSize) * (u_subtransformSize * 0.5) + mod(index, u_subtransformSize * 0.5);","#ifdef HORIZONTAL","vec4 even = texture2D(u_input, vec2(evenIndex + 0.5, gl_FragCoord.y) / u_transformSize).rgba;","vec4 odd = texture2D(u_input, vec2(evenIndex + u_transformSize * 0.5 + 0.5, gl_FragCoord.y) / u_transformSize).rgba;","#else","vec4 even = texture2D(u_input, vec2(gl_FragCoord.x, evenIndex + 0.5) / u_transformSize).rgba;","vec4 odd = texture2D(u_input, vec2(gl_FragCoord.x, evenIndex + u_transformSize * 0.5 + 0.5) / u_transformSize).rgba;","#endif","float twiddleArgument = -2.0 * PI * (index / u_subtransformSize);","vec2 twiddle = vec2(cos(twiddleArgument), sin(twiddleArgument));","vec2 outputA = even.xy + multiplyComplex(twiddle, odd.xy);","vec2 outputB = even.zw + multiplyComplex(twiddle, odd.zw);","gl_FragColor = vec4(outputA, outputB);","}"].join("\n")},n.ShaderLib.ocean_initial_spectrum={uniforms:{u_wind:{value:new n.Vector2(10,10)},u_resolution:{value:512},u_size:{value:250}},fragmentShader:["precision highp float;","#include <common>","const float G = 9.81;","const float KM = 370.0;","const float CM = 0.23;","uniform vec2 u_wind;","uniform float u_resolution;","uniform float u_size;","float omega (float k) {","return sqrt(G * k * (1.0 + pow2(k / KM)));","}","float tanh (float x) {","return (1.0 - exp(-2.0 * x)) / (1.0 + exp(-2.0 * x));","}","void main (void) {","vec2 coordinates = gl_FragCoord.xy - 0.5;","float n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;","float m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;","vec2 K = (2.0 * PI * vec2(n, m)) / u_size;","float k = length(K);","float l_wind = length(u_wind);","float Omega = 0.84;","float kp = G * pow2(Omega / l_wind);","float c = omega(k) / k;","float cp = omega(kp) / kp;","float Lpm = exp(-1.25 * pow2(kp / k));","float gamma = 1.7;","float sigma = 0.08 * (1.0 + 4.0 * pow(Omega, -3.0));","float Gamma = exp(-pow2(sqrt(k / kp) - 1.0) / 2.0 * pow2(sigma));","float Jp = pow(gamma, Gamma);","float Fp = Lpm * Jp * exp(-Omega / sqrt(10.0) * (sqrt(k / kp) - 1.0));","float alphap = 0.006 * sqrt(Omega);","float Bl = 0.5 * alphap * cp / c * Fp;","float z0 = 0.000037 * pow2(l_wind) / G * pow(l_wind / cp, 0.9);","float uStar = 0.41 * l_wind / log(10.0 / z0);","float alpham = 0.01 * ((uStar < CM) ? (1.0 + log(uStar / CM)) : (1.0 + 3.0 * log(uStar / CM)));","float Fm = exp(-0.25 * pow2(k / KM - 1.0));","float Bh = 0.5 * alpham * CM / c * Fm * Lpm;","float a0 = log(2.0) / 4.0;","float am = 0.13 * uStar / CM;","float Delta = tanh(a0 + 4.0 * pow(c / cp, 2.5) + am * pow(CM / c, 2.5));","float cosPhi = dot(normalize(u_wind), normalize(K));","float S = (1.0 / (2.0 * PI)) * pow(k, -4.0) * (Bl + Bh) * (1.0 + Delta * (2.0 * cosPhi * cosPhi - 1.0));","float dk = 2.0 * PI / u_size;","float h = sqrt(S / 2.0) * dk;","if (K.x == 0.0 && K.y == 0.0) {","h = 0.0;","}","gl_FragColor = vec4(h, 0.0, 0.0, 0.0);","}"].join("\n")},n.ShaderLib.ocean_phase={uniforms:{u_phases:{value:null},u_deltaTime:{value:null},u_resolution:{value:null},u_size:{value:null}},fragmentShader:["precision highp float;","#include <common>","const float G = 9.81;","const float KM = 370.0;","varying vec2 vUV;","uniform sampler2D u_phases;","uniform float u_deltaTime;","uniform float u_resolution;","uniform float u_size;","float omega (float k) {","return sqrt(G * k * (1.0 + k * k / KM * KM));","}","void main (void) {","float deltaTime = 1.0 / 60.0;","vec2 coordinates = gl_FragCoord.xy - 0.5;","float n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;","float m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;","vec2 waveVector = (2.0 * PI * vec2(n, m)) / u_size;","float phase = texture2D(u_phases, vUV).r;","float deltaPhase = omega(length(waveVector)) * u_deltaTime;","phase = mod(phase + deltaPhase, 2.0 * PI);","gl_FragColor = vec4(phase, 0.0, 0.0, 0.0);","}"].join("\n")},n.ShaderLib.ocean_spectrum={uniforms:{u_size:{value:null},u_resolution:{value:null},u_choppiness:{value:null},u_phases:{value:null},u_initialSpectrum:{value:null}},fragmentShader:["precision highp float;","#include <common>","const float G = 9.81;","const float KM = 370.0;","varying vec2 vUV;","uniform float u_size;","uniform float u_resolution;","uniform float u_choppiness;","uniform sampler2D u_phases;","uniform sampler2D u_initialSpectrum;","vec2 multiplyComplex (vec2 a, vec2 b) {","return vec2(a[0] * b[0] - a[1] * b[1], a[1] * b[0] + a[0] * b[1]);","}","vec2 multiplyByI (vec2 z) {","return vec2(-z[1], z[0]);","}","float omega (float k) {","return sqrt(G * k * (1.0 + k * k / KM * KM));","}","void main (void) {","vec2 coordinates = gl_FragCoord.xy - 0.5;","float n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;","float m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;","vec2 waveVector = (2.0 * PI * vec2(n, m)) / u_size;","float phase = texture2D(u_phases, vUV).r;","vec2 phaseVector = vec2(cos(phase), sin(phase));","vec2 h0 = texture2D(u_initialSpectrum, vUV).rg;","vec2 h0Star = texture2D(u_initialSpectrum, vec2(1.0 - vUV + 1.0 / u_resolution)).rg;","h0Star.y *= -1.0;","vec2 h = multiplyComplex(h0, phaseVector) + multiplyComplex(h0Star, vec2(phaseVector.x, -phaseVector.y));","vec2 hX = -multiplyByI(h * (waveVector.x / length(waveVector))) * u_choppiness;","vec2 hZ = -multiplyByI(h * (waveVector.y / length(waveVector))) * u_choppiness;","if (waveVector.x == 0.0 && waveVector.y == 0.0) {","h = vec2(0.0);","hX = vec2(0.0);","hZ = vec2(0.0);","}","gl_FragColor = vec4(hX + multiplyByI(h), hZ);","}"].join("\n")},n.ShaderLib.ocean_normals={uniforms:{u_displacementMap:{value:null},u_resolution:{value:null},u_size:{value:null}},fragmentShader:["precision highp float;","varying vec2 vUV;","uniform sampler2D u_displacementMap;","uniform float u_resolution;","uniform float u_size;","void main (void) {","float texel = 1.0 / u_resolution;","float texelSize = u_size / u_resolution;","vec3 center = texture2D(u_displacementMap, vUV).rgb;","vec3 right = vec3(texelSize, 0.0, 0.0) + texture2D(u_displacementMap, vUV + vec2(texel, 0.0)).rgb - center;","vec3 left = vec3(-texelSize, 0.0, 0.0) + texture2D(u_displacementMap, vUV + vec2(-texel, 0.0)).rgb - center;","vec3 top = vec3(0.0, 0.0, -texelSize) + texture2D(u_displacementMap, vUV + vec2(0.0, -texel)).rgb - center;","vec3 bottom = vec3(0.0, 0.0, texelSize) + texture2D(u_displacementMap, vUV + vec2(0.0, texel)).rgb - center;","vec3 topRight = cross(right, top);","vec3 topLeft = cross(top, left);","vec3 bottomLeft = cross(left, bottom);","vec3 bottomRight = cross(bottom, right);","gl_FragColor = vec4(normalize(topRight + topLeft + bottomLeft + bottomRight), 1.0);","}"].join("\n")},n.ShaderLib.ocean_main={uniforms:{u_displacementMap:{value:null},u_normalMap:{value:null},u_geometrySize:{value:null},u_size:{value:null},u_projectionMatrix:{value:null},u_viewMatrix:{value:null},u_cameraPosition:{value:null},u_skyColor:{value:null},u_oceanColor:{value:null},u_sunDirection:{value:null},u_exposure:{value:null}},vertexShader:["precision highp float;","varying vec3 vPos;","varying vec2 vUV;","uniform mat4 u_projectionMatrix;","uniform mat4 u_viewMatrix;","uniform float u_size;","uniform float u_geometrySize;","uniform sampler2D u_displacementMap;","void main (void) {","vec3 newPos = position + texture2D(u_displacementMap, uv).rgb * (u_geometrySize / u_size);","vPos = newPos;","vUV = uv;","gl_Position = u_projectionMatrix * u_viewMatrix * vec4(newPos, 1.0);","}"].join("\n"),fragmentShader:["precision highp float;","varying vec3 vPos;","varying vec2 vUV;","uniform sampler2D u_displacementMap;","uniform sampler2D u_normalMap;","uniform vec3 u_cameraPosition;","uniform vec3 u_oceanColor;","uniform vec3 u_skyColor;","uniform vec3 u_sunDirection;","uniform float u_exposure;","vec3 hdr (vec3 color, float exposure) {","return 1.0 - exp(-color * exposure);","}","void main (void) {","vec3 normal = texture2D(u_normalMap, vUV).rgb;","vec3 view = normalize(u_cameraPosition - vPos);","float fresnel = 0.02 + 0.98 * pow(1.0 - dot(normal, view), 5.0);","vec3 sky = fresnel * u_skyColor;","float diffuse = clamp(dot(normal, normalize(u_sunDirection)), 0.0, 1.0);","vec3 water = (1.0 - fresnel) * u_oceanColor * u_skyColor * diffuse;","vec3 color = sky + water;","gl_FragColor = vec4(hdr(color, u_exposure), 1.0);","}"].join("\n")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={modes:{none:"NO_PARALLAX",basic:"USE_BASIC_PARALLAX",steep:"USE_STEEP_PARALLAX",occlusion:"USE_OCLUSION_PARALLAX",relief:"USE_RELIEF_PARALLAX"},uniforms:{bumpMap:{value:null},map:{value:null},parallaxScale:{value:null},parallaxMinLayers:{value:null},parallaxMaxLayers:{value:null}},vertexShader:["varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","void main() {","vUv = uv;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D bumpMap;","uniform sampler2D map;","uniform float parallaxScale;","uniform float parallaxMinLayers;","uniform float parallaxMaxLayers;","varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","#ifdef USE_BASIC_PARALLAX","vec2 parallaxMap( in vec3 V ) {","float initialHeight = texture2D( bumpMap, vUv ).r;","vec2 texCoordOffset = parallaxScale * V.xy * initialHeight;","return vUv - texCoordOffset;","}","#else","vec2 parallaxMap( in vec3 V ) {","float numLayers = mix( parallaxMaxLayers, parallaxMinLayers, abs( dot( vec3( 0.0, 0.0, 1.0 ), V ) ) );","float layerHeight = 1.0 / numLayers;","float currentLayerHeight = 0.0;","vec2 dtex = parallaxScale * V.xy / V.z / numLayers;","vec2 currentTextureCoords = vUv;","float heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","for ( int i = 0; i < 30; i += 1 ) {","if ( heightFromTexture <= currentLayerHeight ) {","break;","}","currentLayerHeight += layerHeight;","currentTextureCoords -= dtex;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","}","#ifdef USE_STEEP_PARALLAX","return currentTextureCoords;","#elif defined( USE_RELIEF_PARALLAX )","vec2 deltaTexCoord = dtex / 2.0;","float deltaHeight = layerHeight / 2.0;","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","const int numSearches = 5;","for ( int i = 0; i < numSearches; i += 1 ) {","deltaTexCoord /= 2.0;","deltaHeight /= 2.0;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","if( heightFromTexture > currentLayerHeight ) {","currentTextureCoords -= deltaTexCoord;","currentLayerHeight += deltaHeight;","} else {","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","}","}","return currentTextureCoords;","#elif defined( USE_OCLUSION_PARALLAX )","vec2 prevTCoords = currentTextureCoords + dtex;","float nextH = heightFromTexture - currentLayerHeight;","float prevH = texture2D( bumpMap, prevTCoords ).r - currentLayerHeight + layerHeight;","float weight = nextH / ( nextH - prevH );","return prevTCoords * weight + currentTextureCoords * ( 1.0 - weight );","#else","return vUv;","#endif","}","#endif","vec2 perturbUv( vec3 surfPosition, vec3 surfNormal, vec3 viewPosition ) {","vec2 texDx = dFdx( vUv );","vec2 texDy = dFdy( vUv );","vec3 vSigmaX = dFdx( surfPosition );","vec3 vSigmaY = dFdy( surfPosition );","vec3 vR1 = cross( vSigmaY, surfNormal );","vec3 vR2 = cross( surfNormal, vSigmaX );","float fDet = dot( vSigmaX, vR1 );","vec2 vProjVscr = ( 1.0 / fDet ) * vec2( dot( vR1, viewPosition ), dot( vR2, viewPosition ) );","vec3 vProjVtex;","vProjVtex.xy = texDx * vProjVscr.x + texDy * vProjVscr.y;","vProjVtex.z = dot( surfNormal, viewPosition );","return parallaxMap( vProjVtex );","}","void main() {","vec2 mapUv = perturbUv( -vViewPosition, normalize( vNormal ), normalize( vViewPosition ) );","gl_FragColor = texture2D( map, mapUv );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},resolution:{value:null},pixelSize:{value:1}},vertexShader:["varying highp vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float pixelSize;","uniform vec2 resolution;","varying highp vec2 vUv;","void main(){","vec2 dxy = pixelSize / resolution;","vec2 coord = dxy * floor( vUv / dxy );","gl_FragColor = texture2D(tDiffuse, coord);","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, vUv + offset);","vec4 cga = texture2D(tDiffuse, vUv);","vec4 cb = texture2D(tDiffuse, vUv - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float amount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color = texture2D( tDiffuse, vUv );","vec3 c = color.rgb;","color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );","color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );","color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );","gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{tDiffuse:{value:null},resolution:{value:new n.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","vec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","const mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","const mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","float tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","float tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","float tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","float tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","float tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","float tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","float tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","float tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","float tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","float valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","Gx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","Gx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","float valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","Gy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","Gy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","float G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","gl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","vec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","gl_FragColor = newTex;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),i={uniforms:{texture:{value:null},delta:{value:new n.Vector2(1,1)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#define ITERATIONS 10.0","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 vUv;","void main() {","vec4 color = vec4( 0.0 );","float total = 0.0;","float offset = rand( vUv );","for ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {","float percent = ( t + offset - 0.5 ) / ITERATIONS;","float weight = 1.0 - abs( percent );","color += texture2D( texture, vUv + delta * percent ) * weight;","total += weight;","}","gl_FragColor = color / total;","}"].join("\n")};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},v:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float vv = v * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={uniforms:{color:{type:"c",value:null},time:{type:"f",value:0},tDiffuse:{type:"t",value:null},tDudv:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec2 vUv;","varying vec4 vUvRefraction;","void main() {","\tvUv = uv;","\tvUvRefraction = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float time;","uniform sampler2D tDiffuse;","uniform sampler2D tDudv;","varying vec2 vUv;","varying vec4 vUvRefraction;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );","}","void main() {"," float waveStrength = 0.1;"," float waveSpeed = 0.03;","\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;","\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );","\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;"," vec4 uv = vec4( vUvRefraction );"," uv.xy += distortion;","\tvec4 base = texture2DProj( tDiffuse, uv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Volume=void 0;var a=r(10),n=function(e){return e&&e.__esModule?e:{default:e}}(a);t.Volume=n.default}]));